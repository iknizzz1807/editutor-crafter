title: High-Level System Component Diagram

high_level_system: High-Level System Component Diagram {
  shape: rectangle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"

  # Main Components
  gf_math: GF Math {
    shape: rectangle
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    label: |md
      **GF Math**
      Galois Field Arithmetic
      - Polynomial operations
      - Finite field multiplication
      - Byte substitution basis
    |
  }

  aes_core: AES Core {
    shape: rectangle
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    label: |md
      **AES Core**
      Block Cipher Engine
      - SubBytes
      - ShiftRows
      - MixColumns
      - AddRoundKey
    |
  }

  key_expansion: Key Expansion {
    shape: rectangle
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    label: |md
      **Key Expansion**
      - Generates round keys
      - Uses Rijndael key schedule
      - 128/192/256-bit key support
    |
  }

  cipher_modes: Cipher Modes {
    shape: rectangle
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    label: |md
      **Cipher Modes**
      - CBC (Cipher Block Chaining)
      - ECB (Electronic Codebook)
      - Padding (PKCS#7)
      - IV management
    |
  }

  # External Inputs/Outputs
  plaintext_input: Plaintext {
    shape: parallelogram
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }

  key_input: Key {
    shape: parallelogram
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }

  ciphertext_output: Ciphertext {
    shape: parallelogram
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }

  iv_input: IV {
    shape: parallelogram
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }

  # Data Flows
  key_input -> key_expansion: "Initial Key"
  plaintext_input -> cipher_modes: "Input Data"
  iv_input -> cipher_modes: "Initialization Vector"
  
  key_expansion -> aes_core: "Round Keys"
  gf_math -> aes_core: "GF Operations"
  
  cipher_modes -> aes_core: "Block Data"
  aes_core -> cipher_modes: "Encrypted Block"
  
  cipher_modes -> ciphertext_output: "Final Ciphertext"

  # Dependencies
  aes_core -> gf_math: "depends on" {
    style.stroke-dash: 3
    style.stroke: "#8b949e"
  }
  
  cipher_modes -> key_expansion: "requires" {
    style.stroke-dash: 3
    style.stroke: "#8b949e"
  }
  
  cipher_modes -> aes_core: "uses" {
    style.stroke-dash: 3
    style.stroke: "#8b949e"
  }
}