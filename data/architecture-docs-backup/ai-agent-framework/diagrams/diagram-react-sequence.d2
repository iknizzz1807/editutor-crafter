title: ReAct Loop Sequence Diagram
desc: Illustrates the iterative Reasoning-Acting loop used by AI agents to complete complex tasks through planning, tool execution, and observation.

shape: sequence_diagram

user: User {
  class: actor_style
}
agent_controller: Agent Controller {
  class: component_style
}
reasoning_engine: Reasoning Engine {
  class: component_style
}
tool_executor: Tool Executor {
  class: component_style
}
knowledge_memory: Knowledge Memory {
  class: memory_style
}
task_memory: Task Memory {
  class: memory_style
}

user -> agent_controller: Submit query: "What were the main causes..."
agent_controller -> task_memory: Store initial task context
task_memory -> agent_controller: Acknowledged

agent_controller -> reasoning_engine: Plan task decomposition
reasoning_engine -> knowledge_memory: Retrieve relevant context
knowledge_memory -> reasoning_engine: Context loaded
reasoning_engine -> agent_controller: "Plan: 1. Research → 2. Outline → 3. Draft → 4. Edit"

group "ReAct Loop for Step 1: Research" {
  agent_controller -> reasoning_engine: Reason: What to search for about 2008 financial crisis?
  reasoning_engine -> knowledge_memory: Check existing knowledge
  knowledge_memory -> reasoning_engine: Knowledge gaps identified
  reasoning_engine -> agent_controller: Decision: Search for '2008 financial crisis causes'
  
  agent_controller -> tool_executor: Act: Execute web_search(query)
  tool_executor -> knowledge_memory: Store search results
  knowledge_memory -> tool_executor: Stored
  tool_executor -> agent_controller: Observation: Search results with 3 sources
  
  agent_controller -> reasoning_engine: Reason: Evaluate sources relevance
  reasoning_engine -> agent_controller: Decision: Sources are reputable, proceed to extraction
}

group "ReAct Loop for Step 2: Information Extraction" {
  agent_controller -> reasoning_engine: Reason: Extract key causes from results
  reasoning_engine -> agent_controller: Decision: Use extract_causes() tool
  
  agent_controller -> tool_executor: Act: Execute extract_causes(results)
  tool_executor -> knowledge_memory: Store extracted causes
  knowledge_memory -> tool_executor: Stored
  tool_executor -> agent_controller: Observation: 5 main causes identified
  
  agent_controller -> reasoning_engine: Reason: Check if we need more sources
  reasoning_engine -> knowledge_memory: Verify completeness
  knowledge_memory -> reasoning_engine: Minimum 3 sources satisfied
  reasoning_engine -> agent_controller: Decision: Research complete
}

group "ReAct Loop for Step 3: Synthesis" {
  agent_controller -> reasoning_engine: Reason: How to structure bullet points?
  reasoning_engine -> agent_controller: Decision: Use format_summary() tool
  
  agent_controller -> tool_executor: Act: Execute format_summary(causes, format='bullet')
  tool_executor -> task_memory: Store formatted summary
  task_memory -> tool_executor: Stored
  tool_executor -> agent_controller: Observation: Summary formatted with bullet points
  
  agent_controller -> reasoning_engine: Reason: Verify answer completeness
  reasoning_engine -> task_memory: Check task requirements
  task_memory -> reasoning_engine: All requirements met
  reasoning_engine -> agent_controller: Decision: Task complete
}

agent_controller -> task_memory: Retrieve final answer
task_memory -> agent_controller: Final answer ready
agent_controller -> user: Return: Bullet-point summary with 3 sources

classes: {
  actor_style: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  component_style: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  memory_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.italic: true
  }
}