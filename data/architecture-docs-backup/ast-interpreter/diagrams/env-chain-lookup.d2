title: Environment Chain Lookup

direction: right

classes: {
  env_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  arrow_style: {
    style.stroke: "#8b949e"
    style.font-color: "#8b949e"
    style.stroke-dash: 3
  }
}

global_env: Global Environment {
  class: env_style
  label: "Global Environment\nx = 10"
}

function_env: Function Environment {
  class: env_style
  label: "Function Environment\n(no x defined)"
}

block_env: Block Environment {
  class: env_style
  label: "Block Environment\n(no x defined)"
}

# Environment chain connections
function_env -> global_env: parent
block_env -> function_env: parent

# Lookup process arrows
block_env -> function_env: lookup(x) (not found) {
  class: arrow_style
}
function_env -> global_env: lookup(x) (found) {
  class: arrow_style
}

note: |md
  ## Lexical Scoping & Shadowing
  - Lookup follows the **parent chain** from innermost to outermost
  - Variables in inner scopes can **shadow** same-named outer variables
  - Lookup stops at first matching declaration
| {
  shape: page
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  near: bottom-center
}