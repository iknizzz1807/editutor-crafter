original: Original ELF Layout {
  shape: rectangle
  style.fill: "#0f3460"
  style.stroke: "#8b949e"
  label: |md
    **Original ELF Layout**
    (Virtual Address Space)
  |

  vspace: Virtual Address Space {
    direction: down
    shape: rectangle
    style.stroke: "#8b949e"
    style.stroke-dash: 2
    style.fill: "transparent"

    high_addr: "Higher Address" {
      shape: text
      style.font-color: "#8b949e"
    }

    data_seg: .data Segment {
      shape: rectangle
      height: 60
      style.fill: "#1a1a2e"
      style.stroke: "#d7797b"
      style.bold: true
      label: |md
        **.data Segment**
        (Read/Write Data)
      |
    }

    text_seg: .text Segment {
      shape: rectangle
      height: 100
      style.fill: "#1a1a2e"
      style.stroke: "#3fb950"
      style.bold: true
      label: |md
        **.text Segment**
        (Executable Code)
      |
    }

    low_addr: "Lower Address" {
      shape: text
      style.font-color: "#8b949e"
    }
  }
}

injected: "ELF Layout After Injection" {
  shape: rectangle
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  label: |md
    **ELF Layout After Injection**
    (Virtual Address Space)
  |

  vspace2: Virtual Address Space {
    direction: down
    shape: rectangle
    style.stroke: "#8b949e"
    style.stroke-dash: 2
    style.fill: "transparent"

    high_addr2: "Higher Address" {
      shape: text
      style.font-color: "#8b949e"
    }

    inject_seg: .inject Segment {
      shape: rectangle
      height: 80
      style.fill: "#1a1a2e"
      style.stroke: "#d7797b"
      style.bold: true
      label: |md
        **.inject Segment**
        (Injected Hook Code)
      |
    }

    data_seg2: .data Segment {
      shape: rectangle
      height: 60
      style.fill: "#1a1a2e"
      style.stroke: "#d7797b"
      style.bold: true
      label: |md
        **.data Segment**
        (Read/Write Data)
      |
    }

    text_seg2: .text Segment {
      shape: rectangle
      height: 100
      style.fill: "#1a1a2e"
      style.stroke: "#3fb950"
      style.bold: true
      label: |md
        **.text Segment**
        (Executable Code)
      |

      trampoline: "Trampoline" {
        shape: rectangle
        style.fill: "#2a4d2a"
        style.stroke: "#3fb950"
        style.stroke-width: 2
        style.font-color: "#ffffff"
        label: |md
          **Trampoline**
          1. Save Registers
          2. Jump to .inject
        |
      }
    }

    low_addr2: "Lower Address" {
      shape: text
      style.font-color: "#8b949e"
    }
  }

  trampoline -> inject_seg: "jmp .inject" {
    style.stroke: "#3fb950"
    style.stroke-dash: 3
    style.animated: true
    style.font-color: "#3fb950"
  }
}

original -> injected: "Injection Process" {
  style.stroke: "#8b949e"
  style.font-color: "#8b949e"
  target-arrowhead.shape: triangle
}