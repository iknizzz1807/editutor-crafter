shape: sequence_diagram

title: Sequence: Static Binary Patching

description: |md
Sequence diagram showing the interaction between a User, the main Tool, and the components to statically patch an on-disk binary file.
|

user: User
tool: "Binary Instrumentation Tool" {
  class: process_style
}

elf_loader: "ELF Loader"
patch_planner: "Patch Planner"
trampoline_gen: "Trampoline Generator"
section_injector: "Section Injector"
file_writer: "File Writer"

user -> tool: invoke with binary path and symbol
tool -> elf_loader: load binary
elf_loader -> tool: parsed ELF structure
tool -> patch_planner: plan patch at symbol X
patch_planner -> tool: patch location and metadata
tool -> trampoline_gen: generate trampoline with hook
trampoline_gen -> tool: generated code blob and relocations
tool -> section_injector: inject section with trampoline
section_injector -> tool: updated ELF with new .patch section
tool -> file_writer: write patched binary to disk
file_writer -> tool: file write successful
tool -> user: instrumentation complete

classes: {
  process_style: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}