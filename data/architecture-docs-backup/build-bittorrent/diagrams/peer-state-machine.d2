direction: right

# Initial state
initial: {
  shape: circle
  style.fill: "#3fb950"
  style.stroke: "#3fb950"
  width: 20
  height: 20
}

# Four main states
choked_not_interested: "Choked\nNot Interested" {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

choked_interested: "Choked\nInterested" {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

unchoked_not_interested: "Unchoked\nNot Interested" {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

unchoked_interested: "Unchoked\nInterested" {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

# Initial connection
initial -> choked_not_interested: start

# Interest transitions (vertical)
choked_not_interested -> choked_interested: interested {
  style.stroke: "#8b949e"
}
choked_interested -> choked_not_interested: not interested {
  style.stroke: "#8b949e"
}

unchoked_not_interested -> unchoked_interested: interested {
  style.stroke: "#8b949e"
}
unchoked_interested -> unchoked_not_interested: not interested {
  style.stroke: "#8b949e"
}

# Choke transitions (horizontal)
choked_not_interested -> unchoked_not_interested: unchoke {
  style.stroke: "#8b949e"
}
unchoked_not_interested -> choked_not_interested: choke {
  style.stroke: "#8b949e"
}

choked_interested -> unchoked_interested: unchoke {
  style.stroke: "#8b949e"
}
unchoked_interested -> choked_interested: choke {
  style.stroke: "#8b949e"
}

# Legend
legend: Legend {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  note: |md
    **Messages:**
    • interested/not interested: peer state
    • choke/unchoke: remote peer action
    
    **Active state:** Unchoked + Interested
    (can send requests and download)
  | {
    shape: page
    style.fill: "#0f3460"
    style.font-color: "#e6edf3"
  }
}