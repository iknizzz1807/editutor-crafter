dns_message: DNS Message {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
  
  header: Header (12 bytes) {
    shape: class
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    
    id: ID (16 bits)
    flags: Flags (16 bits)
    qdcount: QDCOUNT (16 bits)
    ancount: ANCOUNT (16 bits)
    nscount: NSCOUNT (16 bits)
    arcount: ARCOUNT (16 bits)
  }
  
  question: Question Section {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    
    q1: Question Record {
      shape: class
      qname: QNAME (variable)
      qtype: QTYPE (16 bits)
      qclass: QCLASS (16 bits)
    }
  }
  
  answer: Answer Section {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    
    rr1: Resource Record {
      shape: class
      name: NAME (variable)
      type: TYPE (16 bits)
      class: CLASS (16 bits)
      ttl: TTL (32 bits)
      rdlength: RDLENGTH (16 bits)
      rdata: RDATA (variable)
    }
  }
  
  authority: Authority Section {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    
    rr2: Resource Record {
      shape: class
      name: NAME (variable)
      type: TYPE (16 bits)
      class: CLASS (16 bits)
      ttl: TTL (32 bits)
      rdlength: RDLENGTH (16 bits)
      rdata: RDATA (variable)
    }
  }
  
  additional: Additional Section {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    
    rr3: Resource Record {
      shape: class
      name: NAME (variable)
      type: TYPE (16 bits)
      class: CLASS (16 bits)
      ttl: TTL (32 bits)
      rdlength: RDLENGTH (16 bits)
      rdata: RDATA (variable)
    }
  }
}

compression: Name Compression {
  style.fill: "#1a1a2e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
  
  pointer: Pointer (2 bytes) {
    shape: class
    bits: 11XXXXXXXXXXXXXX
  }
  
  reference: Points to offset in message
}

# Relationships showing structure
dns_message.header -> dns_message.question: Controls count via QDCOUNT {
  style.stroke: "#8b949e"
}
dns_message.header -> dns_message.answer: Controls count via ANCOUNT {
  style.stroke: "#8b949e"
}
dns_message.header -> dns_message.authority: Controls count via NSCOUNT {
  style.stroke: "#8b949e"
}
dns_message.header -> dns_message.additional: Controls count via ARCOUNT {
  style.stroke: "#8b949e"
}

# Name compression relationships
compression.pointer -> dns_message.question.q1.qname: Compresses names {
  style.stroke: "#3fb950"
  style.stroke-dash: 5
}
compression.pointer -> dns_message.answer.rr1.name: Compresses names {
  style.stroke: "#3fb950"
  style.stroke-dash: 5
}
compression.pointer -> dns_message.authority.rr2.name: Compresses names {
  style.stroke: "#3fb950"
  style.stroke-dash: 5
}