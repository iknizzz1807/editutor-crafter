container_process: Container Process {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

overlayfs: OverlayFS Layered Filesystem {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true

  merged_view: Merged View {
    shape: rectangle
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }

  upper_layer: Upper Layer (Writable) {
    shape: rectangle
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }

  lower_layers: Lower Layers (Read-Only) {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"

    base_image: Base Image (e.g., Ubuntu) {
      shape: rectangle
      style.stroke: "#8b949e"
    }
    packages: Installed Packages {
      shape: rectangle
      style.stroke: "#8b949e"
    }
    app_code: Application Code {
      shape: rectangle
      style.stroke: "#8b949e"
    }

    base_image -> packages: stacked
    packages -> app_code: stacked
  }

  work_dir: Work Directory {
    shape: package
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }

  lower_layers -> merged_view: transparent overlay
  upper_layer -> merged_view: capture modifications
  work_dir -> upper_layer: atomic operations
}

container_process -> overlayfs.merged_view: "sees unified\nfilesystem"
overlayfs.merged_view -> overlayfs.lower_layers: read (if not in upper)
overlayfs.merged_view -> overlayfs.upper_layer: write/create/delete
overlayfs.upper_layer -> overlayfs.lower_layers: copy-on-write

note: |md
  **Key Properties:**
  - Lower layers are read-only and shared
  - Upper layer stores container-specific changes
  - Work directory enables atomic operations
  - Merged view provides unified filesystem
| {
  shape: page
  style.fill: "#1a1a2e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}