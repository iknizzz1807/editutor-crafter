title: System Component Diagram
desc: Shows all major components of the container runtime (CLI, Container Manager, Namespace Controller, cgroup Manager, Filesystem Manager, Network Manager, Image Handler) and their relationships. Include arrows showing data flow and dependencies.

# Theme and styling
direction: right

# Main container runtime system
system: Container Runtime System {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  # User interface layer
  cli: CLI (Command Line Interface) {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.bold: true
  }
  
  # Core orchestration component
  container_manager: Container Manager {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.bold: true
  }
  
  # Isolation layer components
  isolation_layer: Isolation Layer {
    style.fill: "#1a1a2e"
    style.stroke: "#8b949e"
    
    namespace_controller: Namespace Controller {
      shape: circle
      style.fill: "#1a1a2e"
      style.stroke: "#3fb950"
    }
    
    cgroup_manager: cgroup Manager {
      shape: circle
      style.fill: "#1a1a2e"
      style.stroke: "#3fb950"
    }
    
    filesystem_manager: Filesystem Manager {
      shape: hexagon
      style.fill: "#1a1a2e"
      style.stroke: "#3fb950"
    }
    
    network_manager: Network Manager {
      shape: cloud
      style.fill: "#1a1a2e"
      style.stroke: "#3fb950"
    }
  }
  
  # Image management component
  image_handler: Image Handler {
    shape: package
    style.fill: "#16213e"
    style.stroke: "#3fb950"
  }
}

# External dependencies
host_kernel: Host Linux Kernel {
  shape: cylinder
  style.fill: "#1a1a2e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

container_images: Container Images {
  shape: cylinder
  style.fill: "#1a1a2e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

# Data flow and dependencies
cli -> container_manager: "commands\n(run, stop, list)"
container_manager -> image_handler: "requests images"
image_handler -> container_images: "pulls/stores"
container_manager -> namespace_controller: "create namespaces"
container_manager -> cgroup_manager: "set resource limits"
container_manager -> filesystem_manager: "setup root filesystem"
container_manager -> network_manager: "configure networking"

# System dependencies on Linux kernel
namespace_controller -> host_kernel: "uses\nPID, mount, network, etc."
cgroup_manager -> host_kernel: "uses\nCPU, memory, I/O controls"
filesystem_manager -> host_kernel: "uses\nchroot, pivot_root, OverlayFS"
network_manager -> host_kernel: "uses\nveth pairs, bridge, iptables"

# Component interactions
namespace_controller -> filesystem_manager: "mount namespace setup"
network_manager -> namespace_controller: "network namespace"
image_handler -> filesystem_manager: "provides layers"