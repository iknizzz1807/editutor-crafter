direction: down

title: Object and Heap Data Model {
  style.font-size: 24
  style.fill: "#1a1a2e"
  style.font-color: "#e6edf3"
}

ObjectHeader: Object Header {
  shape: class
  size: "Size (bytes)"
  mark_bit: "Mark Bit"
  generation: "Generation ID"
  type_info: "Type Information"
  
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

Object: Managed Object {
  shape: class
  header: "ObjectHeader"
  data: "Object Data"
  
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

HeapManager: Heap Organization {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  YoungGeneration: Young Generation {
    eden: "Eden Space"
    survivor1: "Survivor 1"
    survivor2: "Survivor 2"
    
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    
    eden -> survivor1: "promote"
    survivor1 -> survivor2: "copy"
  }
  
  OldGeneration: Old Generation {
    shape: class
    regions: "Memory Regions"
    large_objects: "Large Object Space"
    
    style.fill: "#0f3460"
    style.stroke: "#3fb950" 
    style.font-color: "#e6edf3"
  }
  
  YoungGeneration -> OldGeneration: "tenure (age threshold)"
}

FreeListNode: Free List Node {
  shape: class
  size: "Block Size"
  next: "Next Free Block"
  prev: "Previous Free Block"
  
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

RememberedSet: Remembered Set Entry {
  shape: class
  old_object: "Old Object Ref"
  young_object: "Young Object Ref"
  card_index: "Card Table Index"
  
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

RootSet: Root Set {
  shape: class
  stack_refs: "Stack References"
  global_refs: "Global References" 
  register_refs: "Register References"
  
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

ObjectHeader -> Object: "1:1"
Object -> HeapManager.YoungGeneration: "allocated in" {
  style.stroke: "#8b949e"
}
Object -> HeapManager.OldGeneration: "or allocated in" {
  style.stroke: "#8b949e"
}

FreeListNode -> FreeListNode: "linked list (0:*)"
HeapManager -> FreeListNode: "maintains free space (1:*)" {
  style.stroke: "#8b949e"
}

RememberedSet -> HeapManager.OldGeneration: "tracks refs from (1:*)" {
  style.stroke: "#3fb950"
  style.bold: true
}
RememberedSet -> HeapManager.YoungGeneration: "tracks refs to (1:*)" {
  style.stroke: "#3fb950" 
  style.bold: true
}

RootSet -> Object: "references (1:*)" {
  style.stroke: "#8b949e"
}

note: |md
  **Key Relationships:**
  - Each Object has exactly one ObjectHeader
  - Objects allocated in either generation
  - RememberedSet enables efficient generational GC
  - FreeListNodes form linked lists by size class
| {
  shape: page
  style.fill: "#1a1a2e"
  style.font-color: "#e6edf3"
}