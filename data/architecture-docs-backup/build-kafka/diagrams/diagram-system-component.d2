direction: right

title: System Component Overview

dark_theme: {
  style: {
    stroke: "#3fb950"
    fill: "#1a1a2e"
    font-color: "#e6edf3"
    font-size: 16
    bold: true
  }
}

# Core Components
producers: Producers {
  style: {
    fill: "#0f3460"
    stroke: "#3fb950"
  }
  
  producer_1: Producer
  producer_2: Producer
  producer_n: Producer...
}

broker_cluster: "Broker Cluster" {
  style: {
    fill: "#0f3460"
    stroke: "#3fb950"
    double-border: true
  }
  
  broker_1: Broker (Leader)
  broker_2: Broker
  broker_n: Broker...
  
  group_coordinator: Group Coordinator {
    style: {
      fill: "#16213e"
      stroke: "#7ee787"
    }
  }
}

consumer_groups: "Consumer Groups" {
  style: {
    fill: "#0f3460"
    stroke: "#3fb950"
  }
  
  group_a: Consumer Group A {
    consumer_1: Consumer
    consumer_2: Consumer
    consumer_n: Consumer...
  }
  
  group_b: Consumer Group B {
    consumer_1: Consumer
    consumer_2: Consumer
  }
}

# Data Flow (Produce/Fetch)
producers.producer_1 -> broker_cluster.broker_1: produce
producers.producer_2 -> broker_cluster.broker_2: produce
producers.producer_n -> broker_cluster.broker_n: produce

consumer_groups.group_a.consumer_1 -> broker_cluster.broker_1: fetch
consumer_groups.group_a.consumer_2 -> broker_cluster.broker_2: fetch
consumer_groups.group_b.consumer_1 -> broker_cluster.broker_1: fetch

# Control Flow (Metadata Requests)
producers.producer_1 -> broker_cluster.broker_1: metadata
consumer_groups.group_a.consumer_1 -> broker_cluster.broker_1: metadata

# Control Flow (Group Coordination)
consumer_groups.group_a.consumer_1 -> broker_cluster.group_coordinator: join/heartbeat
consumer_groups.group_a.consumer_2 -> broker_cluster.group_coordinator: join/heartbeat
consumer_groups.group_b.consumer_1 -> broker_cluster.group_coordinator: join/heartbeat

# Broker Cluster Internal Connections
broker_cluster.broker_1 -> broker_cluster.broker_2: replication
broker_cluster.broker_2 -> broker_cluster.broker_n: replication
broker_cluster.broker_1 -- broker_cluster.group_coordinator: coordination

# Legend/Notes
legend: {
  note1: "Data Flow (Produce/Fetch)" {
    shape: text
  }
  note2: "Control Flow (Metadata)" {
    shape: text
  }
  note3: "Control Flow (Heartbeat/Join)" {
    shape: text
  }
  
  data_example: Arrow -> Arrow: solid
  control_example: Arrow -> Arrow: dashed
  
  data_example.style.stroke-dash: 0
  control_example.style.stroke-dash: 3
}

# Style Data Flow Arrows
producers.producer_1 -> broker_cluster.broker_1: {style.stroke-dash: 0}
producers.producer_2 -> broker_cluster.broker_2: {style.stroke-dash: 0}
producers.producer_n -> broker_cluster.broker_n: {style.stroke-dash: 0}
consumer_groups.group_a.consumer_1 -> broker_cluster.broker_1: {style.stroke-dash: 0}
consumer_groups.group_a.consumer_2 -> broker_cluster.broker_2: {style.stroke-dash: 0}
consumer_groups.group_b.consumer_1 -> broker_cluster.broker_1: {style.stroke-dash: 0}

# Style Control Flow Arrows
producers.producer_1 -> broker_cluster.broker_1: metadata {style.stroke-dash: 3}
consumer_groups.group_a.consumer_1 -> broker_cluster.broker_1: metadata {style.stroke-dash: 3}
consumer_groups.group_a.consumer_1 -> broker_cluster.group_coordinator: join/heartbeat {style.stroke-dash: 3}
consumer_groups.group_a.consumer_2 -> broker_cluster.group_coordinator: join/heartbeat {style.stroke-dash: 3}
consumer_groups.group_b.consumer_1 -> broker_cluster.group_coordinator: join/heartbeat {style.stroke-dash: 3}
