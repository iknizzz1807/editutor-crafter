title: Static Linker Component Diagram

classes: {
  component_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  data_style: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  flow_style: {
    style.stroke: "#8b949e"
    style.font-color: "#8b949e"
  }
}

static_linker: Static Linker {
  class: component_style
  shape: rectangle

  elf_reader: ELF Reader {
    class: component_style
  }

  section_merger: Section Merger {
    class: component_style
  }

  symbol_resolver: Symbol Resolver {
    class: component_style
  }

  relocation_applier: Relocation Applier {
    class: component_style
  }

  executable_writer: Executable Writer {
    class: component_style
  }

  # Internal data flow
  elf_reader -> section_merger: "Sections with\nalignment constraints" {
    class: flow_style
  }
  
  elf_reader -> symbol_resolver: "Symbol definitions\n& references" {
    class: flow_style
  }
  
  section_merger -> relocation_applier: "Merged section\nlayout & addresses" {
    class: flow_style
  }
  
  symbol_resolver -> relocation_applier: "Resolved symbol\naddresses" {
    class: flow_style
  }
  
  relocation_applier -> executable_writer: "Patched code & data\nwith relocations applied" {
    class: flow_style
  }
}

# External inputs
object_files: ".o Files (ELF)" {
  class: data_style
  shape: cylinder
  near: top-left
}

linker_script: "Linker Script (Optional)" {
  class: data_style
  shape: page
  near: top-center
}

# External outputs
executable: "Executable (ELF)" {
  class: data_style
  shape: cylinder
  near: bottom-right
}

error_output: "Error Messages\n(undefined symbols, etc.)" {
  class: data_style
  shape: page
  near: bottom-left
}

# External connections
object_files -> static_linker.elf_reader: "Reads ELF headers,\nsections, symbols,\nrelocations" {
  class: flow_style
}

linker_script -> static_linker.section_merger: "Memory layout\n& section ordering" {
  class: flow_style
}

static_linker.symbol_resolver -> error_output: "Undefined symbol\nerrors" {
  class: flow_style
}

static_linker.executable_writer -> executable: "Writes ELF headers,\nprogram headers,\nmerged sections" {
  class: flow_style
}