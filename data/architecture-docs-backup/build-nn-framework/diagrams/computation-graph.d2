direction: right

title: Computation Graph Structure {
  style.font-size: 24
  style.bold: true
  style.fill: "#1a1a2e"
  style.font-color: "#e6edf3"
}

# Input tensors
x: "x\n(input)" {
  shape: oval
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

w1: "W₁\n(weight)" {
  shape: oval
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

b1: "b₁\n(bias)" {
  shape: oval
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

# Operations
matmul1: "MatMul" {
  shape: rectangle
  style.fill: "#0f3460"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

add1: "Add" {
  shape: rectangle
  style.fill: "#0f3460"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

relu1: "ReLU" {
  shape: rectangle
  style.fill: "#0f3460"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

w2: "W₂\n(weight)" {
  shape: oval
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

matmul2: "MatMul" {
  shape: rectangle
  style.fill: "#0f3460"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

loss: "Loss" {
  shape: rectangle
  style.fill: "#0f3460"
  style.stroke: "#d63031"
  style.font-color: "#e6edf3"
  style.bold: true
}

# Intermediate tensors
h1: "h₁\n(hidden)" {
  shape: oval
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

a1: "a₁\n(activated)" {
  shape: oval
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

y: "ŷ\n(output)" {
  shape: oval
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

target: "y\n(target)" {
  shape: oval
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

# Forward pass connections
x -> matmul1: "forward" {
  style.stroke: "#3fb950"
  style.bold: true
}
w1 -> matmul1: {
  style.stroke: "#3fb950"
  style.bold: true
}
matmul1 -> h1: {
  style.stroke: "#3fb950"
  style.bold: true
}
h1 -> add1: {
  style.stroke: "#3fb950"
  style.bold: true
}
b1 -> add1: {
  style.stroke: "#3fb950"
  style.bold: true
}
add1 -> relu1: {
  style.stroke: "#3fb950"
  style.bold: true
}
relu1 -> a1: {
  style.stroke: "#3fb950"
  style.bold: true
}
a1 -> matmul2: {
  style.stroke: "#3fb950"
  style.bold: true
}
w2 -> matmul2: {
  style.stroke: "#3fb950"
  style.bold: true
}
matmul2 -> y: {
  style.stroke: "#3fb950"
  style.bold: true
}
y -> loss: {
  style.stroke: "#3fb950"
  style.bold: true
}
target -> loss: {
  style.stroke: "#3fb950"
  style.bold: true
}

# Backward pass connections (gradient flow)
loss -> y: "∇ᵧ" {
  style.stroke: "#ff6b6b"
  style.stroke-dash: 5
  style.animated: true
}
y -> matmul2: "∇w₂, ∇a₁" {
  style.stroke: "#ff6b6b"
  style.stroke-dash: 5
  style.animated: true
}
matmul2 -> a1: "∇a₁" {
  style.stroke: "#ff6b6b"
  style.stroke-dash: 5
  style.animated: true
}
a1 -> relu1: {
  style.stroke: "#ff6b6b"
  style.stroke-dash: 5
}
relu1 -> add1: {
  style.stroke: "#ff6b6b"
  style.stroke-dash: 5
}
add1 -> h1: "∇h₁, ∇b₁" {
  style.stroke: "#ff6b6b"
  style.stroke-dash: 5
}
h1 -> matmul1: {
  style.stroke: "#ff6b6b"
  style.stroke-dash: 5
}
matmul1 -> x: "∇w₁, ∇x" {
  style.stroke: "#ff6b6b"
  style.stroke-dash: 5
}

legend: Legend {
  forward_flow: "Forward Pass (Data Flow)" {
    style.stroke: "#3fb950"
    style.bold: true
  }
  backward_flow: "Backward Pass (Gradient Flow)" {
    style.stroke: "#ff6b6b"
    style.stroke-dash: 5
  }
  tensors: "Tensors (Data Nodes)" {
    shape: oval
    style.fill: "#16213e"
    style.stroke: "#3fb950"
  }
  operations: "Operations (Compute Nodes)" {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
  }
  style.fill: "#1a1a2e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}