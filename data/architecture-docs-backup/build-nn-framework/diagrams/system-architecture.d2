title: Neural Framework System Architecture {
  style.font-size: 24
  style.font-color: "#e6edf3"
}

tensor_ops: Tensor Operations Layer {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  tensor: Tensor {
    shape: class
    style.stroke: "#3fb950"
    style.bold: true
  }
  
  operation: Operation {
    shape: class
    style.stroke: "#3fb950"
  }
  
  add_op: AddOperation
  mul_op: MulOperation
  matmul_op: MatMulOperation
  
  operation -> add_op
  operation -> mul_op
  operation -> matmul_op
  
  tensor <-> operation: transforms
}

autodiff: Autodiff Engine {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  grad_fn: GradientFunction {
    shape: class
    style.stroke: "#3fb950"
    style.bold: true
  }
  
  backward: BackwardPass
  forward: ForwardPass
  
  grad_fn -> backward
  grad_fn -> forward
}

neural_modules: Neural Modules Layer {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  module: Module {
    shape: class
    style.stroke: "#3fb950"
    style.bold: true
  }
  
  linear: Linear
  conv: Conv2d
  relu: ReLU
  
  module -> linear
  module -> conv
  module -> relu
}

optimizers: Optimizers Layer {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  optimizer: Optimizer {
    shape: class
    style.stroke: "#3fb950"
    style.bold: true
  }
  
  sgd: SGD
  adam: Adam
  
  optimizer -> sgd
  optimizer -> adam
}

# Dependencies between layers
neural_modules -> autodiff: uses gradients {
  style.stroke: "#8b949e"
}

autodiff -> tensor_ops: operates on tensors {
  style.stroke: "#8b949e"
}

optimizers -> neural_modules: updates parameters {
  style.stroke: "#8b949e"
}

optimizers -> tensor_ops: modifies tensors {
  style.stroke: "#8b949e"
}

# Key relationships
tensor_ops.tensor -> autodiff.grad_fn: tracks computation {
  style.stroke: "#3fb950"
  style.bold: true
}

neural_modules.module -> tensor_ops.tensor: contains parameters {
  style.stroke: "#3fb950"
}