direction: right

# Initial state
idle: Idle {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

# Compilation states
parsing: Parsing Pattern {
  shape: circle
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

constructing_nfa: Constructing NFA {
  shape: circle
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

optimizing_dfa: Optimizing DFA {
  shape: circle
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

ready: Ready for Matching {
  shape: circle
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

executing: Executing Match {
  shape: circle
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

# Error states
syntax_error: Syntax Error {
  shape: circle
  style.fill: "#d63031"
  style.stroke: "#e17055"
  style.font-color: "#ffffff"
  style.bold: true
}

nfa_error: NFA Construction Error {
  shape: circle
  style.fill: "#d63031"
  style.stroke: "#e17055"
  style.font-color: "#ffffff"
  style.bold: true
}

resource_error: Resource Exhausted {
  shape: circle
  style.fill: "#d63031"
  style.stroke: "#e17055"
  style.font-color: "#ffffff"
  style.bold: true
}

# Transitions
idle -> parsing: compile(pattern)
parsing -> constructing_nfa: syntax valid
parsing -> syntax_error: invalid syntax
constructing_nfa -> optimizing_dfa: NFA built
constructing_nfa -> nfa_error: construction failed
optimizing_dfa -> ready: DFA optimized
optimizing_dfa -> resource_error: state explosion
ready -> executing: match(input)
executing -> ready: match complete
executing -> resource_error: timeout/memory limit
syntax_error -> idle: reset
nfa_error -> idle: reset
resource_error -> idle: reset

# Style arrows
*.style.stroke: "#8b949e"
*.style.font-color: "#e6edf3"