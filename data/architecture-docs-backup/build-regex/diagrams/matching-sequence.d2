shape: sequence_diagram

style: {
  fill: "#1a1a2e"
  stroke: "#3fb950"
  font-color: "#e6edf3"
}

client: Client {
  style: {
    fill: "#16213e"
    stroke: "#3fb950"
    font-color: "#e6edf3"
    bold: true
  }
}

regex_engine: Regex Engine {
  style: {
    fill: "#16213e"
    stroke: "#3fb950"
    font-color: "#e6edf3"
    bold: true
  }
}

nfa: NFA Automaton {
  style: {
    fill: "#16213e"
    stroke: "#3fb950"
    font-color: "#e6edf3"
    bold: true
  }
}

epsilon_closure: Epsilon Closure {
  style: {
    fill: "#0f3460"
    stroke: "#3fb950"
    font-color: "#e6edf3"
  }
}

state_tracker: State Tracker {
  style: {
    fill: "#0f3460"
    stroke: "#3fb950"
    font-color: "#e6edf3"
  }
}

client -> regex_engine: match(pattern, input) {
  style.stroke: "#8b949e"
}

regex_engine -> nfa: initialize() {
  style.stroke: "#8b949e"
}

nfa -> epsilon_closure: compute_closure(start_state) {
  style.stroke: "#8b949e"
}

epsilon_closure -> nfa: initial_state_set {
  style.stroke: "#8b949e"
}

nfa -> state_tracker: set_current_states(state_set) {
  style.stroke: "#8b949e"
}

regex_engine -> nfa: process_character(char) {
  style.stroke: "#8b949e"
}

nfa -> state_tracker: get_current_states() {
  style.stroke: "#8b949e"
}

state_tracker -> nfa: current_states {
  style.stroke: "#8b949e"
}

nfa -> nfa: compute_transitions(states, char) {
  style.stroke: "#8b949e"
}

nfa -> epsilon_closure: compute_closure(next_states) {
  style.stroke: "#8b949e"
}

epsilon_closure -> nfa: expanded_state_set {
  style.stroke: "#8b949e"
}

nfa -> state_tracker: update_states(new_state_set) {
  style.stroke: "#8b949e"
}

regex_engine -> nfa: check_acceptance() {
  style.stroke: "#8b949e"
}

nfa -> state_tracker: get_current_states() {
  style.stroke: "#8b949e"
}

state_tracker -> nfa: final_states {
  style.stroke: "#8b949e"
}

nfa -> nfa: contains_accept_state(final_states) {
  style.stroke: "#8b949e"
}

nfa -> regex_engine: match_result {
  style.stroke: "#8b949e"
}

regex_engine -> client: boolean(matched) {
  style.stroke: "#3fb950"
  style.bold: true
}