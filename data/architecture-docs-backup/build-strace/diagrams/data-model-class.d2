title: Data Model Relationships
description: A class diagram showing the main data structures for a system call tracer

classes: {
  dark_theme: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  class_style: {
    shape: class
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

data_model: Data Model {
  class: dark_theme
  
  process_context: ProcessContext {
    class: class_style
    - "pid: int (primary_key)"
    - "ppid: int"
    - "executable: string"
    - "state: ProcessState"
    - "syscall_table: SyscallTable"
    - "active_filters: FilterConfig"
    + "add_event(event: SyscallEvent): void"
    + "apply_filters(config: FilterConfig): void"
    + "get_events(): List<SyscallEvent>"
  }
  
  syscall_event: SyscallEvent {
    class: class_style
    - "timestamp: DateTime"
    - "pid: int"
    - "syscall_number: int"
    - "syscall_name: string"
    - "arguments: MapStringLong"
    - "return_value: long"
    - "entry_time: DateTime"
    - "exit_time: DateTime"
    - "duration: Duration"
    - "entry: SyscallTableEntry"
    + "format_human(): string"
    + "is_success(): bool"
    + "get_arg_names(): List<string>"
  }
  
  syscall_table_entry: SyscallTableEntry {
    class: class_style
    - "number: int (primary_key)"
    - "name: string"
    - "signature: string"
    - "argument_count: int"
    - "argument_names: List<string>"
    - "argument_types: List<string>"
    - "return_type: string"
    + "decode_args(raw_args: List<long>): MapStringLong"
    + "format_call(args: MapStringLong): string"
  }
  
  filter_config: FilterConfig {
    class: class_style
    - "enabled_syscalls: Set<int>"
    - "excluded_syscalls: Set<int>"
    - "pid_filters: Set<int>"
    - "time_range: TupleDateTimeDateTime"
    - "min_duration: Duration"
    - "max_duration: Duration"
    - "return_value_filters: MapStringLong"
    + "is_allowed(event: SyscallEvent): bool"
    + "merge(other: FilterConfig): FilterConfig"
    + "to_json(): string"
  }
}

process_context -> syscall_event: "has many" {
  style.stroke: "#3fb950"
  style.bold: true
}
syscall_event -> syscall_table_entry: "references" {
  style.stroke: "#8b949e"
}
process_context -> filter_config: "has a" {
  style.stroke: "#8b949e"
}