{
  "types": {
    "SyscallEvent": "fields: pid pid_t, number long, args unsigned long[6], retval long, timestamp_start struct timespec, timestamp_end struct timespec, is_entry bool",
    "ProcessContext": "fields: pid pid_t, state ProcessState, syscall_state SyscallState, config FilterConfig",
    "SyscallTableEntry": "fields: number long, name const char*, nargs int, arg_types ArgType[]",
    "FilterConfig": "fields: output_file FILE*, filter_set unsigned long*, collect_stats bool, show_timestamps bool, summarize_on_exit bool",
    "struct user_regs_struct": "fields: (system-defined register fields)",
    "ProcessState": "enum values: STATE_NEW, STATE_RUNNING, STATE_IN_SYSCALL_ENTRY, STATE_IN_SYSCALL_EXIT, STATE_STOPPED_BY_SIGNAL, STATE_IN_PTRACE_EVENT, STATE_STOPPED_INITIAL, STATE_TERMINATED",
    "ArgType": "enum values: ARG_INT, ARG_POINTER, ARG_STRING, ARG_IOVEC, ARG_SOCKADDR, ARG_STAT, ARG_UNKNOWN",
    "SyscallState": "fields: pending_event SyscallEvent*, last_syscall_number long, entry_time struct timespec",
    "SyscallStat": "fields: count unsigned long, error_count unsigned long, total_time double",
    "AdvancedFilterConfig": "fields: base FilterConfig, dsl_rules ASTNode**, n_rules int",
    "ASTNode": "fields: type NodeType, u union",
    "NodeType": "enum values: NODE_COMPARE, NODE_LOGICAL, NODE_CALL, NODE_LITERAL, NODE_IDENT",
    "CompareOp": "enum values: OP_EQ, OP_NE, OP_GT, OP_LT, OP_GE, OP_LE, OP_CONTAINS, OP_STARTSWITH, OP_ENDSWITH",
    "LogicalOp": "enum values: LOGIC_AND, LOGIC_OR",
    "ProtocolDecoder": "struct (function pointer)"
  },
  "methods": {
    "tracer_main_loop(pid_t initial_pid) void": "Main event loop that waits for tracee stops and dispatches events",
    "read_string_from_tracee(pid_t pid, unsigned long addr) char*": "Safely reads a NULL-terminated string from tracee's memory at address addr",
    "decode_syscall_arguments(SyscallTableEntry *entry, unsigned long args[]) void": "Formats syscall arguments based on their types (int, string, pointer, etc.)",
    "handle_fork_event(pid_t parent_pid, unsigned long child_pid) void": "Attaches tracer to a newly forked child process",
    "should_trace_syscall(long syscall_num, FilterConfig *config) bool": "Checks if a syscall passes the user's filter criteria",
    "ptrace_or_die(enum __ptrace_request request, pid_t pid, void *addr, void *data) long": "Wrapper for ptrace that prints error and exits on failure",
    "ptrace_with_error(enum __ptrace_request request, pid_t pid, void *addr, void *data, int *saved_errno) long": "Wrapper for ptrace that returns -1 on error and sets errno",
    "ptrace_getregs_safe(pid_t pid, struct user_regs_struct *regs) int": "Reads registers safely, returning 0 on success, -1 on failure",
    "ptrace_continue_with_signal(pid_t pid, int signal) void": "Continues a stopped tracee with proper signal handling",
    "create_process_context(pid_t pid, const FilterConfig* base_config) ProcessContext*": "Allocates and initializes a new ProcessContext, copying configuration from base_config",
    "destroy_process_context(ProcessContext* ctx) void": "Frees all resources associated with a ProcessContext and removes from process table",
    "copy_filter_config(FilterConfig* dest, const FilterConfig* src) int": "Deep copies a FilterConfig including bitset allocation",
    "free_filter_config(FilterConfig* config) void": "Frees memory allocated within a FilterConfig",
    "should_trace_syscall(long syscall_num, const FilterConfig* config) bool": "Checks if a syscall number passes the filter bitset",
    "update_process_state(ProcessContext* ctx, ProcessState new_state) void": "Updates process state with special handling for transitions",
    "find_process_context(pid_t pid) ProcessContext*": "Looks up ProcessContext by PID in global process table",
    "remove_process_context(pid_t pid) void": "Finds and destroys ProcessContext for given PID",
    "create_syscall_event(pid_t pid, long number, const unsigned long args[MAX_SYSCALL_ARGS], bool is_entry) SyscallEvent*": "Allocates and initializes a new SyscallEvent with current timestamp",
    "decode_syscall_arguments(pid_t pid, const SyscallTableEntry* entry, unsigned long args[MAX_SYSCALL_ARGS], bool is_entry, long retval) void": "Formats syscall arguments based on their types",
    "extract_syscall_info(pid_t pid, struct user_regs_struct* regs, long* num, unsigned long args[MAX_SYSCALL_ARGS]) int": "Extracts syscall number and arguments from tracee's registers",
    "parse_filter_expression(FilterConfig* config, const char* expr, const SyscallTableEntry syscall_table[]) int": "Parses a comma-separated list of syscall names into a filter bitset",
    "record_syscall_entry(ProcessContext* ctx, long num, unsigned long args[MAX_SYSCALL_ARGS]) void": "Creates and stores a pending SyscallEvent with start timestamp",
    "record_syscall_exit(ProcessContext* ctx, long retval) void": "Finalizes pending event, updates stats, triggers output",
    "output_syscall_event(const ProcessContext* ctx, const SyscallEvent* event) void": "Formats and outputs a single syscall event line with atomic write",
    "print_statistics_summary(const FilterConfig* config, const SyscallStat global_stats[]) void": "Prints aggregated statistics table to configured output",
    "debug_printf(const char *format, ...) void": "Print formatted debug message with PID and timestamp",
    "decode_wait_status(int status, char *buf, size_t bufsz) void": "Decode waitpid status into human-readable string",
    "dump_registers(pid_t pid, struct user_regs_struct *regs) void": "Print all registers for debugging",
    "inspect_tracee_memory(pid_t pid, unsigned long addr, size_t words) void": "Safe wrapper to inspect a memory address in tracee",
    "evaluate_advanced_filter(long syscall_num, const SyscallEvent *event, const ProcessContext *ctx, const AdvancedFilterConfig *config) bool": "Determines if a syscall event should be traced using bitset and DSL rules",
    "parse_filter_expression_advanced(AdvancedFilterConfig *config, const char *expr, const SyscallTableEntry syscall_table[]) int": "Parses an advanced filter expression string into bitset and AST rules",
    "dsl_parse_expression(const char *expr) ASTNode*": "Parses a DSL expression string into an AST",
    "dsl_eval_expression(const ASTNode *node, const SyscallEvent *event, const ProcessContext *ctx) bool": "Evaluates an AST node against a syscall event and process context",
    "dsl_free_ast(ASTNode *node) void": "Frees memory allocated for an AST",
    "dsl_func_contains(const char *haystack, const char *needle) bool": "Built-in DSL function for string containment check",
    "modify_syscall_args(pid_t pid, struct user_regs_struct *regs, const SyscallEvent *event) void": "Future: Modifies tracee's registers/memory before syscall entry",
    "spoof_syscall_return(pid_t pid, struct user_regs_struct *regs, long spoofed_value) void": "Future: Overwrites syscall return value in tracee's registers"
  },
  "constants": {
    "PTRACE_O_TRACESYSGOOD": "ptrace option to distinguish syscall stops from signal stops",
    "MAX_STRING_READ_LEN": "4096",
    "SYSCALL_TABLE_SIZE": "450",
    "__WALL": "waitpid flag to wait for all children, including those not created by our process",
    "SIGTRAP": "Signal number used by ptrace for breakpoints and events",
    "ESRCH": "errno value indicating process doesn't exist",
    "MAX_SYSCALL_ARGS": "6",
    "FILTER_SET_SIZE": "Macro calculating bitset size in unsigned longs for SYSCALL_TABLE_SIZE bits",
    "CLOCK_MONOTONIC": "Clock ID for monotonic system-wide timer, used with clock_gettime",
    "EPERM": "errno value indicating operation not permitted",
    "EIO": "errno value indicating input/output error",
    "EFAULT": "errno value indicating bad address",
    "EINVAL": "errno value indicating invalid argument"
  },
  "terms": {
    "tracee": "The process being traced",
    "tracer": "The process doing the tracing (our program)",
    "syscall entry": "The moment a tracee invokes a syscall (enters kernel mode)",
    "syscall exit": "The moment a tracee returns from a syscall (returns to user mode)",
    "ptrace stop": "A state where the tracee is halted, waiting for the tracer to issue a ptrace command",
    "scope creep": "The tendency for projects to grow beyond their original intent",
    "ABI": "Application Binary Interface - the low-level interface between programs and the OS/kernel",
    "ProcessContext": "Structure tracking state, configuration, and statistics for a single traced process",
    "SyscallEvent": "Complete record of a single system call invocation from entry to exit",
    "waitpid polling": "Using waitpid() in a loop to detect process state changes",
    "bitset": "Array of bits where each bit represents whether a syscall number should be traced",
    "pending_event": "SyscallEvent awaiting exit completion, stored in ProcessContext's syscall_state",
    "process table": "Global collection of all ProcessContext structures for currently traced processes",
    "SyscallTable": "Static lookup table mapping syscall numbers to names and argument metadata",
    "wall-clock time": "Actual elapsed time measured by a system clock, includes waiting and scheduling delays",
    "filter bitset": "Array of bits where each bit represents whether a syscall number should be traced",
    "atomic line write": "Writing a complete line of output in a single operation to prevent interleaving",
    "error range": "The range of return values (-4095 to -1) that Linux uses to indicate syscall errors",
    "zombie state": "A process that has exited but whose exit status hasn't been reaped by its parent",
    "TOCTOU": "Time-of-Check-Time-of-Use race condition",
    "Domain-Specific Language (DSL)": "A custom, small programming language designed for a specific task, in this case expressing filter conditions for syscall tracing",
    "AST (Abstract Syntax Tree)": "A tree representation of the grammatical structure of source code, used to evaluate expressions",
    "rule engine": "A component that evaluates a set of conditional rules against incoming data to determine an outcome",
    "protocol dissector": "A component that interprets raw network packet data according to a specific communication protocol (e.g., HTTP, DNS)",
    "client-server model": "An architectural pattern where a server provides resources/services and clients request them, enabling separation of concerns (e.g., GUI frontend from tracing backend)",
    "ring buffer": "A circular data structure used for buffering a stream of data between a producer (tracer) and consumer (network transport)",
    "TOCTOU (Time-of-Check-Time-of-Use)": "A race condition vulnerability where the state of a resource changes between the time it is checked and the time it is used, leading to incorrect behavior"
  }
}