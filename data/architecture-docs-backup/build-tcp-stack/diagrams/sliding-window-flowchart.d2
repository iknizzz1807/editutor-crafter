direction: right

title: Sliding Window Send Algorithm
description: A flowchart for the sender's logic in a TCP implementation

Start: {
  shape: oval
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

Check_Window: {
  shape: diamond
  label: "Within cwnd & rwnd?"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

Send_Segment: {
  label: "Send segment"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

Start_Timer: {
  label: "Start/restart timer"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

Wait_Event: {
  label: "Wait for event"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

ACK_Received: {
  shape: diamond
  label: "ACK received?"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

New_ACK: {
  shape: diamond
  label: "New ACK?"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

Slide_Window: {
  label: "Slide window forward"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

Timeout: {
  shape: diamond
  label: "Timeout?"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

Retransmit: {
  label: "Retransmit oldest unacked segment"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

Reset_Timer: {
  label: "Reset timer"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

Dup_ACK: {
  shape: diamond
  label: "Duplicate ACK?"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

Increment_DupCount: {
  label: "Increment duplicate ACK count"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

Fast_Retransmit: {
  shape: diamond
  label: "3 duplicate ACKs?"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
}

# Main flow
Start -> Check_Window

Check_Window -> Send_Segment: Yes
Check_Window --x Check_Window: No (wait)

Send_Segment -> Start_Timer -> Wait_Event

# Event handling branches
Wait_Event -> ACK_Received
Wait_Event -> Timeout
Wait_Event -> Dup_ACK

# ACK Received branch
ACK_Received -> New_ACK: Yes
ACK_Received --x Wait_Event: No

New_ACK -> Slide_Window: Yes {
  style.stroke-dash: 3
}
New_ACK --x Increment_DupCount: No

Slide_Window -> Check_Window: More data

# Timeout branch
Timeout -> Retransmit: Yes
Timeout --x Wait_Event: No

Retransmit -> Reset_Timer -> Wait_Event

# Duplicate ACK branch
Dup_ACK -> Increment_DupCount: Yes
Dup_ACK --x Wait_Event: No

Increment_DupCount -> Fast_Retransmit

Fast_Retransmit -> Retransmit: Yes
Fast_Retransmit --x Wait_Event: No

# Styling
style {
  stroke: "#8b949e"
  font-color: "#e6edf3"
}

style Start {
  style.bold: true
}