direction: right

# Initial state
init: Initialize {
  shape: circle
  style.fill: "#3fb950"
  style.stroke: "#3fb950"
  style.font-color: "#000000"
}

# Main training states
forward: Forward Pass {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

loss: Loss Computation {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

backward: Backward Pass {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

update: Parameter Update {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

# Final state
complete: Training Complete {
  shape: circle
  style.fill: "#d63031"
  style.stroke: "#d63031"
  style.font-color: "#ffffff"
}

# State transitions
init -> forward: start training {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

forward -> loss: compute predictions {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

loss -> backward: calculate loss {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

backward -> update: compute gradients {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

update -> forward: next batch {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

update -> complete: training finished {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

# Error handling transitions
forward -> init: reset on error {
  style.stroke: "#d63031"
  style.stroke-dash: 5
  style.font-color: "#d63031"
}

loss -> init: validation error {
  style.stroke: "#d63031"
  style.stroke-dash: 5
  style.font-color: "#d63031"
}

backward -> init: gradient explosion {
  style.stroke: "#d63031"
  style.stroke-dash: 5
  style.font-color: "#d63031"
}