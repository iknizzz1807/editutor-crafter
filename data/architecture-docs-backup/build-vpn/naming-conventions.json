{
  "types": {
    "Interface": "fields: Name string, fd *os.File, mtu int",
    "Encryptor": "fields: gcm cipher.AEAD, nonce NonceGenerator",
    "TUNInterface": "virtual network interface for packet interception",
    "UDPTransport": "fields: conn *net.UDPConn, peers map[uint32]*PeerInfo, peersMu sync.RWMutex, bufferPool *BufferPool, addressMgr *AddressManager, stopCh chan struct{}, wg sync.WaitGroup",
    "AESGCMEncryption": "fields: gcm cipher.AEAD, nonce *NonceGenerator, antiReplay *AntiReplayWindow, stats *CryptoStats, keyRotationTime time.Time",
    "DHKeyExchange": "fields: localID uint32, sessions map[uint64]*VPNSession, sessionsMu sync.RWMutex, transport UDPTransport, random *SecureRandom",
    "RouteManager": "fields: mu sync.RWMutex, config *RoutingConfig, backup *RouteBackup, dnsManager *DNSManager, tunInterface string, serverAddress net.IP, originalGW net.IP, isConfigured bool",
    "Config": "fields: Network NetworkConfig, Mode string, ServerAddr string, ListenPort int, Crypto CryptoConfig, Routing RoutingConfig, LogLevel string, LogFile string",
    "NetworkConfig": "fields: TUNName string, TUNAddress string, TUNNetmask string, MTU int, UDPPort int",
    "CryptoConfig": "fields: PreSharedKey string, KeyRotation time.Duration, DHGroupSize int",
    "RoutingConfig": "fields: DefaultRoute bool, Routes []string, DNSServers []string, EnableNAT bool",
    "EncryptedPacket": "fields: PacketType uint8, PeerID uint32, Sequence uint64, Nonce []byte, Payload []byte, AuthTag []byte",
    "HandshakeMessage": "key exchange and control messages",
    "VPNSession": "fields: SessionID uint64, LocalID uint32, RemoteID uint32, State SessionState, StateMu sync.RWMutex, EphemeralKeys *EphemeralKeyPair, SessionKeys *SessionKeys, CreatedAt time.Time, LastActivity time.Time, HandshakeTimeout time.Timer",
    "PeerInfo": "fields: ID uint32, PublicAddr net.UDPAddr, PrivateAddr net.UDPAddr, LastSeen time.Time, BytesSent uint64, BytesReceived uint64, PacketsSent uint64, PacketsReceived uint64, ConnectionState SessionState, KeepaliveInterval time.Duration, KeepaliveTimeout time.Duration, NATType string",
    "AntiReplayWindow": "fields: windowSize uint32, highestSequence uint64, window map[uint64]bool, mu sync.RWMutex, stats *ReplayStats",
    "SessionState": "enumeration of session lifecycle states",
    "ifReq": "fields: Name [16]byte, Flags uint16, pad [22]byte",
    "BufferPool": "fields: pool sync.Pool, size int",
    "AddressManager": "fields: mu sync.RWMutex, peers map[uint32]*AddressState, timeout time.Duration",
    "AddressState": "fields: Primary net.UDPAddr, Backup net.UDPAddr, LastUpdate time.Time, Confirmed bool, FailCount int",
    "PacketBuffer": "fields: data []byte, pool *BufferPool",
    "NonceGenerator": "fields: counter uint64, epochStart time.Time, mu sync.Mutex",
    "CryptoStats": "fields: PacketsEncrypted uint64, PacketsDecrypted uint64, AuthFailures uint64, ReplayAttempts uint64, NonceResetCount uint64, AverageEncryptTime float64, AverageDecryptTime float64, LastKeyRotation time.Time",
    "SessionKeys": "fields: C2SEncrypt [32]byte, S2CEncrypt [32]byte, C2SAuth [32]byte, S2CAuth [32]byte, ControlKey [32]byte, CreatedAt time.Time",
    "EphemeralKeyPair": "fields: Private [32]byte, Public [32]byte",
    "NATManager": "fields: mu sync.RWMutex, tunInterface string, externalInterface string, installedRules []iptablesRule, isConfigured bool",
    "RouteBackup": "fields: mu sync.RWMutex, originalRoutes []RouteEntry, addedRoutes []RouteEntry, backupFile string, timestamp time.Time",
    "DNSManager": "fields: originalResolv string, backupFile string",
    "RouteEntry": "fields: Destination string, Gateway string, Interface string, Metric int, Flags string",
    "iptablesRule": "fields: table string, chain string, rule string",
    "VPNCoordinator": "fields: config *Config, tunInterface *TUNInterface, transport *UDPTransport, encryption *AESGCMEncryption, keyExchange *DHKeyExchange, routeManager *RouteManager, sessions map[uint32]*VPNSession, sessionsMu sync.RWMutex, packetProcessor *PacketProcessor, connManager *ConnectionManager, ctx context.Context, cancel context.CancelFunc, wg sync.WaitGroup, stats *CoordinatorStats",
    "CoordinatorStats": "fields: PacketsProcessed uint64, BytesTransferred uint64, ActiveSessions int32, HandshakesCompleted uint64, ErrorsEncountered uint64, UptimeStart time.Time",
    "ConnectionManager": "fields: coordinator *VPNCoordinator, handshakeTimeout time.Duration, retryAttempts int, peerStates map[uint32]*PeerConnectionState, statesMu sync.RWMutex",
    "PeerConnectionState": "fields: PeerID uint32, State SessionState, LastHandshake time.Time, HandshakeCount int, RetryBackoff time.Duration, ErrorHistory []ConnectionError",
    "PacketProcessor": "fields: coordinator *VPNCoordinator, inboundQueue chan *ProcessingContext, outboundQueue chan *ProcessingContext, bufferPool *BufferPool, maxQueueDepth int",
    "ProcessingContext": "fields: Packet []byte, PeerID uint32, Direction PacketDirection, Timestamp time.Time, RetryCount int, ErrorHistory []error, Buffer *PacketBuffer",
    "VPNError": "fields: Type ErrorType, Component string, Operation string, Underlying error, Context map[string]interface{}, Timestamp time.Time, Recoverable bool",
    "ErrorHandler": "fields: coordinator *VPNCoordinator, recoveryMu sync.RWMutex, strategies map[ErrorType]RecoveryStrategy, monitoring *ErrorMonitor",
    "NetworkRecoveryManager": "fields: transport *UDPTransport, healthChecker *ConnectionHealthChecker, mu sync.RWMutex, recoveryInProgress map[uint32]bool",
    "RetryStrategy": "fields: MaxAttempts int, InitialDelay time.Duration, MaxDelay time.Duration, BackoffFactor float64, Jitter bool",
    "ExponentialBackoff": "fields: strategy RetryStrategy, rand *rand.Rand",
    "ErrorType": "enumeration of error categories",
    "ConnectionHealthChecker": "network connectivity monitoring component",
    "RecoveryStrategy": "strategy pattern for different recovery approaches",
    "ErrorMonitor": "error statistics and monitoring component",
    "CryptoTestVector": "fields: Name string, Key []byte, Nonce []byte, Plaintext []byte, AAD []byte, Ciphertext []byte, AuthTag []byte",
    "LoadTestConfig": "fields: Duration time.Duration, PacketRate int, PacketSize int, ConcurrentFlows int",
    "LoadTester": "fields: config *LoadTestConfig, metrics *LoadTestMetrics",
    "SecurityTestSuite": "fields: t *testing.T",
    "E2ETestSuite": "fields: t *testing.T, serverProc *VPNProcess, clientProc *VPNProcess, cleanup []func()",
    "VPNProcess": "process management for VPN instances",
    "VPNLogger": "fields: logger *logrus.Logger, component string",
    "LogConfig": "fields: Level string, Output string, Format string, Component string",
    "ExponentialBackoffStrategy": "fields: MaxAttempts int, InitialDelay time.Duration, MaxDelay time.Duration, BackoffFactor float64",
    "DiagnosticRunner": "fields: logger *VPNLogger, config *DiagnosticConfig",
    "DiagnosticConfig": "fields: NetworkTimeout time.Duration, CryptoTestCount int, SystemCheckDepth int, EnablePacketTrace bool",
    "DiagnosticResult": "fields: TestName string, Success bool, Error error, Details map[string]interface{}, Duration time.Duration, Suggestions []string",
    "CryptoEngine": "abstracted crypto implementation interface"
  },
  "methods": {
    "CreateTUN(name string) (*Interface, error)": "creates new TUN interface",
    "ReadPacket() ([]byte, error)": "reads IP packet from TUN",
    "WritePacket(packet []byte) error": "writes IP packet to TUN",
    "Encrypt(plaintext []byte) ([]byte, error)": "encrypts IP packet with authentication",
    "Decrypt(ciphertext []byte) ([]byte, error)": "decrypts and authenticates packet",
    "Close() error": "cleanup interface resources",
    "LoadConfig(filename string) (*Config, error)": "loads and validates configuration from file",
    "ValidateConfig(config *Config) error": "performs comprehensive configuration validation",
    "SerializeEncryptedPacket() ([]byte, error)": "converts packet to wire format",
    "DeserializeEncryptedPacket(data []byte) (*EncryptedPacket, error)": "parses wire format to packet structure",
    "CheckAntiReplay(sequence uint64) bool": "verifies packet against replay window",
    "RotateKeys(newSharedSecret []byte) error": "updates encryption key preserving state",
    "NewVPNSession(localID, remoteID uint32) *VPNSession": "creates new session with initialized state",
    "configureInterfaceAddr(name, addr string) error": "sets IP address for interface",
    "bringInterfaceUp(name string) error": "enables interface for packet processing",
    "NewUDPTransport(config *NetworkConfig) (*UDPTransport, error)": "creates new UDP transport instance",
    "Start() error": "begins transport layer event loop",
    "SendPacket(peerID uint32, data []byte) error": "transmits encrypted packet to specific peer",
    "RegisterPeer(peerID uint32, addr net.UDPAddr) error": "adds new peer to transport layer",
    "NewBufferPool(size int) *BufferPool": "creates buffer pool with fixed-size buffers",
    "Get() []byte": "returns buffer from pool",
    "Put(buf []byte)": "returns buffer to pool for reuse",
    "UpdateAddress(peerID uint32, addr net.UDPAddr) bool": "learns or updates peer address",
    "GetAddress(peerID uint32) (net.UDPAddr, bool)": "returns best known address for peer",
    "MarkFailed(peerID uint32)": "records failed transmission attempt",
    "NewAESGCMEncryption(sessionKey []byte) (*AESGCMEncryption, error)": "creates encryption instance with session key",
    "Generate() ([]byte, error)": "produces unique nonce for encryption",
    "InitiateHandshake(remoteID uint32) (*VPNSession, error)": "starts key exchange with remote peer",
    "HandleHandshakeMessage(msg *HandshakeMessage, senderAddr net.UDPAddr) error": "processes incoming handshake messages and advances connection state",
    "DeriveSessionKeys(sharedSecret [32]byte, sessionID uint64, localID, remoteID uint32) (*SessionKeys, error)": "uses HKDF to generate session keys",
    "NewVPNSession(sessionID uint64, localID, remoteID uint32) *VPNSession": "creates new session with initialized state",
    "UpdateState(newState SessionState)": "safely transitions session state",
    "RotateKeys(keyExchange *DHKeyExchange) error": "initiates key rotation",
    "GenerateKeyPair() (*EphemeralKeyPair, error)": "creates ephemeral key pair",
    "ComputeSharedSecret(peerPublic [32]byte) ([32]byte, error)": "performs ECDH computation",
    "NewRouteManager(config *RoutingConfig) *RouteManager": "creates new routing manager instance",
    "ConfigureVPNRouting(tunInterface string, serverAddr net.IP) error": "sets up routing table for VPN operation",
    "RestoreOriginalRouting() error": "removes VPN routes and restores original configuration",
    "NewNATManager() *NATManager": "creates new NAT configuration manager",
    "ConfigureNAT(tunInterface, externalInterface string) error": "sets up iptables rules for VPN server NAT",
    "RemoveNAT() error": "removes all installed iptables rules",
    "NewRouteBackup(backupFile string) *RouteBackup": "creates new route backup manager",
    "CaptureCurrentRoutes() error": "saves current routing table state",
    "RestoreRoutes() error": "removes added routes and restores original routing state",
    "NewDNSManager() *DNSManager": "creates DNS configuration manager",
    "BackupDNSConfig() error": "saves current DNS configuration",
    "SetVPNDNS(dnsServers []string) error": "configures DNS servers for VPN usage",
    "RestoreDNSConfig() error": "restores original DNS settings",
    "NewVPNCoordinator(config *Config) (*VPNCoordinator, error)": "creates fully configured VPN coordinator instance",
    "InitiateConnection(peerID uint32, address net.UDPAddr) error": "begins connection establishment with remote peer",
    "StartPacketProcessing(ctx context.Context) error": "begins main packet processing event loop",
    "ProcessOutboundPacket(ctx *ProcessingContext) error": "handles packets from TUN interface destined for VPN tunnel",
    "ProcessInboundPacket(ctx *ProcessingContext) error": "handles packets from UDP transport destined for local delivery",
    "SerializeHandshakeMessage(msg *HandshakeMessage) ([]byte, error)": "converts handshake to wire format",
    "DeserializeHandshakeMessage(data []byte) (*HandshakeMessage, error)": "parses wire format to handshake structure",
    "HandleError(ctx context.Context, err error) error": "processes errors and initiates recovery",
    "RecoverNetworkFailure(ctx context.Context, networkErr *VPNError) error": "handles network-related failures",
    "RecoverCryptographicFailure(ctx context.Context, cryptoErr *VPNError) error": "handles crypto-related failures",
    "DetectNetworkFailures(ctx context.Context)": "monitors network health and detects failures",
    "RecoverPeerConnection(ctx context.Context, peerID uint32) error": "attempts to restore peer connectivity",
    "NewNetworkError(component, operation string, err error, recoverable bool) *VPNError": "creates categorized network error",
    "Retry(ctx context.Context, fn RetryFunc) error": "executes retry logic with exponential backoff",
    "GenerateTestKey(size int) []byte": "creates test key with specified size",
    "VerifyNonceUniqueness(generator NonceGenerator, count int)": "tests nonce generator for collisions",
    "SetupVPNTunnel(ctx context.Context) error": "establishes complete VPN connection for testing",
    "RunLoadTest(ctx context.Context, vpnEndpoint string) *LoadTestResults": "executes performance test with specified parameters",
    "TestReplayAttack()": "validates anti-replay protection",
    "TestPacketFlow()": "validates complete packet journey",
    "NewVPNLogger(config LogConfig) (*VPNLogger, error)": "creates configured logger instance",
    "WithFields(fields logrus.Fields) *logrus.Entry": "creates entry with common debugging fields",
    "PacketLog(direction, operation string, packet []byte, err error)": "logs packet-related events with hex payload",
    "CryptoLog(operation string, peerID uint32, nonce []byte, success bool, err error)": "logs cryptographic operations with relevant context",
    "SessionLog(sessionID uint64, oldState, newState string, peerID uint32, err error)": "logs session state transitions and handshake events",
    "NewCryptoError(component, operation string, err error, recoverable bool) *VPNError": "creates categorized cryptographic error",
    "WithContext(key string, value interface{}) *VPNError": "adds contextual information to error",
    "ShouldRecover(err *VPNError) bool": "determines if recovery should be attempted",
    "GetBackoffDelay(attempt int) time.Duration": "calculates delay for retry attempt",
    "Recover(ctx context.Context, err *VPNError) error": "attempts to recover from error",
    "RunFullDiagnostics(ctx context.Context) ([]DiagnosticResult, error)": "executes complete VPN system diagnostics",
    "TestTUNInterface(ctx context.Context) DiagnosticResult": "validates TUN interface operations",
    "TestCryptoOperations(ctx context.Context) DiagnosticResult": "validates encryption and key exchange",
    "TestNetworkConnectivity(ctx context.Context, remoteAddr net.UDPAddr) DiagnosticResult": "validates network-level functionality",
    "GenerateDebugReport(ctx context.Context) (string, error)": "creates comprehensive system report"
  },
  "constants": {
    "IFF_TUN": "TUN interface type flag",
    "IFF_NO_PI": "no protocol info header flag",
    "TUNSETIFF": "ioctl command for interface creation",
    "AES_256_KEY_SIZE": "32 bytes for AES-256 keys",
    "GCM_NONCE_SIZE": "12 bytes for AES-GCM nonces",
    "MTU_DEFAULT": "1420 bytes default MTU accounting for VPN overhead",
    "PacketTypeData": "1 - encrypted user traffic",
    "PacketTypeHandshake": "2 - key exchange messages",
    "PacketTypeKeepalive": "3 - connection maintenance",
    "GCM_TAG_SIZE": "16 bytes for authentication tags",
    "VPN_MAGIC_NUMBER": "0x56504E01 - protocol version identifier",
    "MAX_PACKET_SIZE": "65535 bytes maximum packet size",
    "MIN_HANDSHAKE_SIZE": "38 bytes minimum handshake message size",
    "MAX_HANDSHAKE_SIZE": "4096 bytes maximum handshake message size",
    "ENCRYPTED_HEADER_SIZE": "44 bytes fixed encrypted packet header size",
    "ErrorTypeNetwork": "network failure category",
    "ErrorTypeCrypto": "cryptographic failure category",
    "ErrorTypeSystem": "system-level failure category",
    "ErrorTypeConfig": "configuration failure category",
    "ErrorTypeResource": "resource exhaustion category"
  },
  "terms": {
    "TUN interface": "virtual network interface that operates at IP layer",
    "TAP interface": "virtual network interface that operates at Ethernet layer",
    "packet interception": "capturing network packets before normal routing",
    "authenticated encryption": "encryption providing confidentiality and authenticity",
    "nonce": "number used once for unique encryption",
    "key exchange": "protocol for establishing shared cryptographic keys",
    "routing table": "kernel data structure that determines packet forwarding",
    "NAT masquerading": "network address translation for internet access",
    "perfect forward secrecy": "property ensuring past sessions remain secure if keys leak",
    "man-in-the-middle attack": "attack where adversary intercepts and potentially modifies communications",
    "anti-replay protection": "mechanism detecting duplicate packets",
    "session state": "current phase of VPN connection lifecycle",
    "key rotation": "periodic replacement of encryption keys",
    "wire format": "binary representation of packets for network transmission",
    "file descriptor": "kernel handle for accessing network socket",
    "ioctl": "input/output control system call for device configuration",
    "UDP transport": "UDP-based communication layer for VPN packets",
    "peer connection": "managed connection to remote VPN endpoint",
    "I/O multiplexing": "concurrent handling of multiple file descriptors",
    "NAT traversal": "techniques for connecting through network address translation",
    "address learning": "automatic discovery of peer network addresses",
    "keepalive": "periodic messages to maintain connection state",
    "connection state": "current status of peer connection",
    "buffer pool": "reusable memory buffers for packet processing",
    "event loop": "main processing loop for handling I/O events",
    "sliding window algorithm": "bounded duplicate detection method",
    "authentication tag": "cryptographic signature proving authenticity",
    "nonce reuse": "catastrophic failure using same nonce twice",
    "timing attack": "attack exploiting execution time variations",
    "side-channel attack": "attack using implementation characteristics",
    "ephemeral keys": "temporary keys generated fresh for each session",
    "key derivation": "process of generating multiple keys from shared secret",
    "split tunneling": "routing only specific traffic through VPN while allowing other traffic direct access",
    "DNS leak": "domain name resolution requests bypassing VPN tunnel",
    "IPv6 leak": "IPv6 traffic bypassing IPv4 VPN tunnel",
    "route metric": "priority value determining which route is selected when multiple routes match",
    "default gateway": "router that handles traffic for destinations not in routing table",
    "connection tracking": "kernel mechanism maintaining state for NAT translations",
    "iptables": "Linux firewall configuration utility",
    "netfilter": "Linux kernel packet filtering framework",
    "wire protocol": "binary representation of packets for network transmission",
    "connection establishment flow": "step-by-step process from initial handshake to established tunnel",
    "packet processing pipeline": "how packets flow through TUN → encrypt → UDP → decrypt → TUN",
    "handshake message": "key exchange and authentication messages",
    "encrypted data packet": "user traffic encrypted and tunneled through VPN",
    "control message": "connection maintenance and management messages",
    "component coordination": "orchestrating interactions between VPN components",
    "hierarchical timeout strategy": "progressive timeout system with multiple escalation levels",
    "fail-closed reconnection": "security-first reconnection that blocks traffic during failures",
    "authentication failure detection": "monitoring and responding to cryptographic verification failures",
    "nonce exhaustion prevention": "proactive key rotation before nonce counter limits",
    "side-channel attack mitigation": "protection against timing and information leakage attacks",
    "TUN interface error handling": "managing virtual network interface failures",
    "routing table manipulation failures": "handling errors in system route modifications",
    "privilege escalation handling": "managing elevated permissions and capability requirements",
    "resource exhaustion management": "preventing and handling system resource limits",
    "exponential backoff": "retry strategy with increasing delay intervals",
    "circuit breaker pattern": "failure isolation and recovery mechanism",
    "graceful degradation": "maintaining partial functionality during failures",
    "milestone validation": "verification that implementation meets milestone requirements",
    "unit testing": "testing individual components in isolation",
    "integration testing": "testing component interactions and data flow",
    "end-to-end testing": "complete system validation with real traffic",
    "performance testing": "load and throughput validation",
    "security testing": "validation of cryptographic and security properties",
    "structured logging": "logging with consistent field formats and metadata",
    "packet capture": "recording network packets for analysis",
    "tcpdump": "command-line packet capture utility",
    "wireshark": "graphical network protocol analyzer",
    "netstat": "network statistics and connection information tool",
    "ss": "modern socket statistics utility",
    "MTU discovery": "process of determining maximum transmission unit",
    "diagnostic runner": "system for executing comprehensive VPN diagnostics",
    "error categorization": "systematic classification of failure types",
    "recovery strategy": "approach for handling and recovering from failures",
    "multi-threading": "concurrent execution using multiple threads for parallel processing",
    "zero-copy packet processing": "packet handling without redundant memory copies between operations",
    "hardware acceleration": "using specialized hardware for cryptographic operations",
    "certificate-based authentication": "identity verification using X.509 digital certificates",
    "congestion control": "algorithm for managing network bandwidth utilization",
    "configuration management": "systematic approach to handling system configuration across environments",
    "monitoring and observability": "comprehensive system visibility through metrics, logging, and tracing",
    "client management interface": "administrative tools for managing VPN users and connections",
    "buffer chain architecture": "packet representation as linked list of buffer segments",
    "thread-per-component": "architectural pattern assigning dedicated threads to each major component",
    "Noise Protocol Framework": "standardized cryptographic handshake protocol with formal security analysis",
    "BBR congestion control": "bottleneck bandwidth and RTT algorithm for network congestion management",
    "structured audit logging": "systematic logging with consistent formats for compliance and analysis",
    "distributed tracing": "end-to-end request tracking across multiple system components",
    "PKI": "public key infrastructure for certificate management",
    "quality of service": "traffic prioritization based on application requirements",
    "post-quantum cryptography": "cryptographic algorithms resistant to quantum computer attacks",
    "memory-mapped I/O": "direct memory access to kernel buffers for zero-copy operations",
    "layered configuration": "hierarchical configuration system with multiple sources and precedence"
  }
}