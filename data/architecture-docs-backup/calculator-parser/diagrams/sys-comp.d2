title: System Component Diagram
description: Shows the three main components (Lexer, Parser, Evaluator) and their data flow: Input String → Tokens → AST → Number. Also shows the Environment (symbol table) interacting with the Evaluator.

classes: {
  component_style: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.stroke-width: 2
  }
  data_style: {
    style.fill: "#0f3460"
    style.stroke: "#58a6ff"
    style.font-color: "#e6edf3"
    style.stroke-width: 1
  }
  interface_style: {
    style.stroke: "#8b949e"
    style.stroke-dash: 3
    style.font-color: "#8b949e"
  }
}

calculator_system: Calculator Parser System {
  shape: rectangle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.stroke-width: 3

  input: "Input String" {
    class: data_style
    shape: parallelogram
  }

  lexer: Lexer {
    class: component_style
    label: |md
      **Lexer**
      Tokenizes input string
    |
  }

  tokens: Tokens {
    class: data_style
    shape: cylinder
    label: |md
      **Tokens**
      Stream of lexical units
      (numbers, operators, parentheses)
    |
  }

  parser: Parser {
    class: component_style
    label: |md
      **Parser**
      Builds AST according to
      operator precedence and
      associativity rules
    |
  }

  ast: AST {
    class: data_style
    shape: hexagon
    label: |md
      **Abstract Syntax Tree**
      Hierarchical representation
      of expression structure
    |
  }

  evaluator: Evaluator {
    class: component_style
    label: |md
      **Evaluator**
      Recursively evaluates
      AST nodes to compute
      final result
    |
  }

  result: Number {
    class: data_style
    shape: circle
    style.fill: "#1e7b1e"
    style.stroke: "#3fb950"
    label: |md
      **Result**
      Final numeric output
    |
  }

  environment: Environment {
    class: component_style
    shape: rectangle
    label: "Environment\nSymbol table for variable bindings\n(future extension)"
  }

  # Data flow
  input -> lexer: "raw expression"
  lexer -> tokens: "tokenizes"
  tokens -> parser: "parses"
  parser -> ast: "builds"
  ast -> evaluator: "evaluates"
  evaluator -> result: "computes"

  # Environment interaction
  evaluator <-> environment: {
    label: "lookup/store variables"
    class: interface_style
  }

  # Optional: Show error paths
  lexer_error: Lexer Error {
    shape: cloud
    style.fill: "#5c1a1a"
    style.stroke: "#ff6b6b"
    style.font-color: "#ffcccb"
  }

  parser_error: Parser Error {
    shape: cloud
    style.fill: "#5c1a1a"
    style.stroke: "#ff6b6b"
    style.font-color: "#ffcccb"
  }

  eval_error: Evaluation Error {
    shape: cloud
    style.fill: "#5c1a1a"
    style.stroke: "#ff6b6b"
    style.font-color: "#ffcccb"
  }

  lexer -> lexer_error: "invalid tokens"
  parser -> parser_error: "syntax errors"
  evaluator -> eval_error: "runtime errors"
}
