title: Service Data Model and Boundaries {
  style.font-size: 20
  style.bold: true
  style.font-color: "#e6edf3"
}

users_service: Users Service {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.stroke-width: 2
  style.font-color: "#e6edf3"

  user: User {
    shape: class
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    
    id: string
    email: string
    password_hash: string
    first_name: string
    last_name: string
    phone: string
    created_at: timestamp
    status: enum
  }

  auth: Authentication {
    shape: class
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
    
    user_id: string
    session_token: string
    refresh_token: string
    expires_at: timestamp
  }
}

products_service: Products Service {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.stroke-width: 2
  style.font-color: "#e6edf3"

  product: Product {
    shape: class
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    
    id: string
    name: string
    description: string
    price: decimal
    category: string
    sku: string
    created_at: timestamp
    status: enum
  }

  inventory: Inventory {
    shape: class
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
    
    product_id: string
    available_quantity: int
    reserved_quantity: int
    last_updated: timestamp
  }
}

orders_service: Orders Service {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.stroke-width: 2
  style.font-color: "#e6edf3"

  order: Order {
    shape: class
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    
    id: string
    user_id: string
    total_amount: decimal
    status: enum
    shipping_address: json
    created_at: timestamp
    updated_at: timestamp
  }

  order_item: OrderItem {
    shape: class
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
    
    order_id: string
    product_id: string
    quantity: int
    unit_price: decimal
    subtotal: decimal
  }
}

payments_service: Payments Service {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.stroke-width: 2
  style.font-color: "#e6edf3"

  payment: Payment {
    shape: class
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    
    id: string
    order_id: string
    user_id: string
    amount: decimal
    method: enum
    status: enum
    transaction_id: string
    processed_at: timestamp
  }

  payment_method: PaymentMethod {
    shape: class
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
    
    id: string
    user_id: string
    type: enum
    card_last4: string
    expires_at: string
    is_default: boolean
  }
}

# Internal relationships within bounded contexts
users_service.user -> users_service.auth: owns {
  style.stroke: "#8b949e"
}

products_service.product -> products_service.inventory: tracks {
  style.stroke: "#8b949e"
}

orders_service.order -> orders_service.order_item: contains {
  style.stroke: "#8b949e"
}

payments_service.payment -> payments_service.payment_method: uses {
  style.stroke: "#8b949e"
}

# Cross-service relationships (by reference only)
orders_service.order -- users_service.user: user_id reference {
  style.stroke: "#e17055"
  style.stroke-dash: 5
}

orders_service.order_item -- products_service.product: product_id reference {
  style.stroke: "#e17055"
  style.stroke-dash: 5
}

payments_service.payment -- orders_service.order: order_id reference {
  style.stroke: "#e17055"
  style.stroke-dash: 5
}

payments_service.payment_method -- users_service.user: user_id reference {
  style.stroke: "#e17055"
  style.stroke-dash: 5
}

legend: |md
  **Legend**
  • Solid lines: Direct ownership within bounded context
  • Dashed lines: Cross-service references (no direct access)
  • Each service owns its data exclusively
| {
  shape: page
  style.fill: "#0f3460"
  style.font-color: "#e6edf3"
  style.stroke: "#8b949e"
}