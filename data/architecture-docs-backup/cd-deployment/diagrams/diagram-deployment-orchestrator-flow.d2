direction: right
shape: rectangle

title: Flowchart: Deployment Orchestrator Decision Logic

classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
    style.border-radius: 3
  }
  decision: {
    shape: diamond
    style.fill: "#1a1a2e"
    style.stroke: "#f0883e"
    style.font-color: "#e6edf3"
    style.border-radius: 3
  }
  rollback: {
    style.fill: "#1a1a2e"
    style.stroke: "#f85149"
    style.font-color: "#e6edf3"
    style.bold: true
    style.border-radius: 3
  }
  success: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    style.border-radius: 3
  }
}

start: Start Deployment {
  class: process
}

deploy_new_version: Deploy New Version to Green Environment {
  class: process
}

health_check: Health Check Passed? {
  class: decision
}

smoke_test: Smoke Tests Passed? {
  class: decision
}

switch_traffic: Switch Traffic (Blue â†’ Green) {
  class: process
}

monitor: Monitor New Production (Green) {
  class: process
}

decommission: Decommission Old Environment (Blue) {
  class: process
}

rollback_deploy: Rollback: Redeploy Previous Version {
  class: rollback
}

rollback_switch: Rollback: Switch Back (Green â†’ Blue) {
  class: rollback
}

end_success: Deployment Successful {
  class: success
}

end_failure: Deployment Failed {
  class: rollback
}

# Flow connections
start -> deploy_new_version
deploy_new_version -> health_check

health_check -> smoke_test: Yes
health_check -> rollback_deploy: No

smoke_test -> switch_traffic: Yes
smoke_test -> rollback_deploy: No

switch_traffic -> monitor

monitor -> decommission: After Grace Period
decommission -> end_success

# Rollback flows
rollback_deploy -> rollback_switch
rollback_switch -> end_failure