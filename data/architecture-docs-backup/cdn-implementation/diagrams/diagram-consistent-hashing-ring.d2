title: Consistent Hashing Ring for Edge Distribution

# Define color styles
classes: {
  ring_bg: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.stroke-width: 2
  }
  edge_node: {
    shape: hexagon
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.stroke-width: 2
    style.font-color: "#e6edf3"
    style.bold: true
  }
  cache_key: {
    shape: circle
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.stroke-width: 1
    style.font-color: "#e6edf3"
    width: 40
    height: 40
  }
  key_label: {
    style.font-size: 10
    style.font-color: "#8b949e"
    style.italic: true
  }
  edge_label: {
    style.font-color: "#3fb950"
    style.bold: true
  }
}

# Main hashing ring
ring: Consistent Hashing Ring {
  class: ring_bg
  shape: circle
  width: 500
  height: 500
  label: ""
}

# Edge nodes placed around the ring
edge_us: Edge-US {
  class: edge_node
  near: top-center
  label: "Edge-US\n192.0.2.1"
}

edge_eu: Edge-EU {
  class: edge_node
  near: center-right
  label: "Edge-EU\n192.0.2.2"
}

edge_asia: Edge-ASIA {
  class: edge_node
  near: bottom-center
  label: "Edge-ASIA\n192.0.2.3"
}

edge_au: Edge-AU {
  class: edge_node
  near: center-left
  label: "Edge-AU\n192.0.2.4"
}

edge_sa: Edge-SA {
  class: edge_node
  near: top-right
  label: "Edge-SA\n192.0.2.5"
}

edge_africa: Edge-AFRICA {
  class: edge_node
  near: bottom-right
  label: "Edge-AFRICA\n192.0.2.6"
}

# Cache keys placed around the ring
key1: "0x3A7F" {
  class: cache_key
  near: top-right
  label: "K1"
}
key1_label: "hash('/image.jpg')" {
  class: key_label
}

key2: "0x8B2C" {
  class: cache_key
  near: center-right
  label: "K2"
}
key2_label: "hash('/style.css')" {
  class: key_label
}

key3: "0xD45E" {
  class: cache_key
  near: bottom-right
  label: "K3"
}
key3_label: "hash('/script.js')" {
  class: key_label
}

key4: "0x1F9A" {
  class: cache_key
  near: bottom-left
  label: "K4"
}
key4_label: "hash('/data.json')" {
  class: key_label
}

key5: "0x6C83" {
  class: cache_key
  near: center-left
  label: "K5"
}
key5_label: "hash('/video.mp4')" {
  class: key_label
}

key6: "0xA2B5" {
  class: cache_key
  near: top-left
  label: "K6"
}
key6_label: "hash('/index.html')" {
  class: key_label
}

# Arrows showing key to edge mapping (clockwise)
key1 -> edge_sa: "maps to (clockwise)" {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}

key2 -> edge_asia: "maps to (clockwise)" {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}

key3 -> edge_asia: "maps to (clockwise)" {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}

key4 -> edge_au: "maps to (clockwise)" {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}

key5 -> edge_au: "maps to (clockwise)" {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}

key6 -> edge_us: "maps to (clockwise)" {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}

# Legend
legend: Legend {
  shape: rectangle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  near: bottom-left

  legend_edge: Edge Node {
    class: edge_node
  }

  legend_key: Cache Key {
    class: cache_key
  }

  legend_arrow: "Key -> Edge mapping" {
    style.font-color: "#8b949e"
  }

  legend_edge -> legend_key: "Explanation" {
    style.stroke: transparent
  }
}
