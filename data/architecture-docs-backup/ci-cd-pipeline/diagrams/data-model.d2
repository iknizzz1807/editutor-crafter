direction: down

classes: {
  entity: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  relationship: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

Pipeline: {
  shape: class
  class: entity
  "- id: string"
  "- name: string"
  "- version: string"
  "- status: PipelineStatus"
  "- trigger: TriggerConfig"
  "- created_at: DateTime"
  "- updated_at: DateTime"
  "+ execute(): void"
  "+ abort(): void"
  "+ get_status(): PipelineStatus"
}

Stage: {
  shape: class
  class: entity
  "- id: string"
  "- name: string"
  "- pipeline_id: string"
  "- order: int"
  "- status: StageStatus"
  "- depends_on: string[]"
  "- parallel: boolean"
  "+ can_execute(): boolean"
  "+ execute(): StageResult"
}

Job: {
  shape: class
  class: entity
  "- id: string"
  "- name: string"
  "- stage_id: string"
  "- status: JobStatus"
  "- image: string"
  "- commands: string[]"
  "- environment: Map<string, string>"
  "- timeout: Duration"
  "- started_at: DateTime"
  "- finished_at: DateTime"
  "+ run(): JobResult"
  "+ cancel(): void"
}

Step: {
  shape: class
  class: entity
  "- id: string"
  "- name: string"
  "- job_id: string"
  "- command: string"
  "- status: StepStatus"
  "- exit_code: int"
  "- output: string"
  "- error: string"
  "- duration: Duration"
  "+ execute(): StepResult"
}

Artifact: {
  shape: class
  class: entity
  "- id: string"
  "- name: string"
  "- pipeline_id: string"
  "- job_id: string"
  "- artifact_type: ArtifactType"
  "- path: string"
  "- size: long"
  "- checksum: string"
  "- created_at: DateTime"
  "+ download(): Stream"
  "+ verify(): boolean"
}

Deployment: {
  shape: class
  class: entity
  "- id: string"
  "- pipeline_id: string"
  "- environment: string"
  "- status: DeploymentStatus"
  "- artifacts: string[]"
  "- config: DeploymentConfig"
  "- deployed_at: DateTime"
  "- rollback_id: string"
  "+ deploy(): DeploymentResult"
  "+ rollback(): void"
}

Pipeline -> Stage: contains {class: relationship}
Stage -> Job: executes {class: relationship}
Job -> Step: "composed of" {class: relationship}
Job -> Artifact: produces {class: relationship}
Pipeline -> Artifact: stores {class: relationship}
Pipeline -> Deployment: triggers {class: relationship}
Deployment -> Artifact: uses {class: relationship}