title: Job Dependency Graph

classes: {
  start_job: {
    style.fill: "#3fb950"
    style.stroke: "#28a745"
    style.font-color: "#ffffff"
    style.bold: true
  }
  build_job: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  test_job: {
    style.fill: "#16213e"
    style.stroke: "#ffc107"
    style.font-color: "#e6edf3"
  }
  deploy_job: {
    style.fill: "#0f3460"
    style.stroke: "#dc3545"
    style.font-color: "#e6edf3"
  }
  sync_job: {
    style.fill: "#6f42c1"
    style.stroke: "#8b949e"
    style.font-color: "#ffffff"
    style.bold: true
  }
}

# Source control trigger
start: Trigger {
  class: start_job
  shape: circle
}

# Build stage
build_frontend: Build Frontend {
  class: build_job
}

build_backend: Build Backend {
  class: build_job
}

build_database: Build DB Schema {
  class: build_job
}

# Test stage (parallel execution)
unit_tests: Unit Tests {
  class: test_job
}

integration_tests: Integration Tests {
  class: test_job
}

frontend_tests: Frontend Tests {
  class: test_job
}

security_scan: Security Scan {
  class: test_job
}

# Synchronization point
package: Package Artifacts {
  class: sync_job
}

# Deployment stages
deploy_staging: Deploy to Staging {
  class: deploy_job
}

e2e_tests: E2E Tests {
  class: test_job
}

deploy_prod: Deploy to Production {
  class: deploy_job
}

notify: Notify Team {
  class: start_job
  shape: circle
}

# Dependencies - Build stage
start -> build_frontend
start -> build_backend  
start -> build_database

# Dependencies - Test stage (parallel after builds)
build_frontend -> unit_tests
build_frontend -> frontend_tests
build_backend -> unit_tests
build_backend -> integration_tests
build_backend -> security_scan
build_database -> integration_tests

# Synchronization - all tests must complete before packaging
unit_tests -> package
integration_tests -> package
frontend_tests -> package
security_scan -> package

# Deployment pipeline
package -> deploy_staging
deploy_staging -> e2e_tests
e2e_tests -> deploy_prod
deploy_prod -> notify

# Edge labels
start -> build_frontend: triggers
start -> build_backend: triggers
start -> build_database: triggers
unit_tests -> package: passes
integration_tests -> package: passes
frontend_tests -> package: passes
security_scan -> package: passes
package -> deploy_staging: artifacts
e2e_tests -> deploy_prod: verified
deploy_prod -> notify: success