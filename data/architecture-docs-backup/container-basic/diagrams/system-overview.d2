title: Container System Component Overview {
  near: top-center
  style.font-size: 24
  style.bold: true
  style.font-color: "#e6edf3"
}

classes: {
  container_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  kernel_style: {
    style.fill: "#16213e"
    style.stroke: "#ffd32a"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  
  process_style: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  boundary_style: {
    style.fill: "#2d1b69"
    style.stroke: "#74b9ff"
    style.font-color: "#e6edf3"
    style.stroke-dash: 5
  }
  
  flow_style: {
    style.stroke: "#fd79a8"
    style.font-color: "#fd79a8"
  }
}

host_kernel: Host Kernel {
  class: kernel_style
  
  namespace_subsystem: Namespace Subsystem {
    class: container_style
  }
  
  cgroup_subsystem: Cgroup Subsystem {
    class: container_style
  }
  
  scheduler: Process Scheduler {
    class: container_style
  }
}

container_runtime: Container Runtime {
  class: container_style
  
  namespace_mgr: Namespace Manager {
    class: process_style
    pid_ns: PID Namespace
    mount_ns: Mount Namespace  
    net_ns: Network Namespace
  }
  
  cgroup_mgr: Cgroup Manager {
    class: process_style
    cpu_ctrl: CPU Controller
    memory_ctrl: Memory Controller
    io_ctrl: I/O Controller
  }
}

isolation_boundary: Namespace Isolation Boundary {
  class: boundary_style
  
  container_proc: Container Process {
    class: process_style
    isolated_pid: "PID 1 (isolated)"
    private_mounts: Private Mounts
    network_stack: Network Stack
  }
}

host_resources: Host Resources {
  class: container_style
  cpu: CPU Cores
  memory: Physical Memory
  storage: Storage I/O
  network: Network Interfaces
}

# Namespace management flows
namespace_mgr -> host_kernel.namespace_subsystem: create namespaces
host_kernel.namespace_subsystem -> isolation_boundary: establish boundaries
namespace_mgr -> container_proc: configure isolation

# Cgroup resource control flows  
cgroup_mgr -> host_kernel.cgroup_subsystem: configure limits {
  class: flow_style
}
host_kernel.cgroup_subsystem -> host_resources: enforce limits {
  class: flow_style
}
cgroup_mgr -> container_proc: apply constraints {
  class: flow_style
}

# Process lifecycle
host_kernel.scheduler -> container_proc: schedule execution
container_proc -> isolation_boundary: operate within bounds

# Cross-component coordination
namespace_mgr <-> cgroup_mgr: coordinate setup
host_kernel.namespace_subsystem <-> host_kernel.cgroup_subsystem: kernel coordination