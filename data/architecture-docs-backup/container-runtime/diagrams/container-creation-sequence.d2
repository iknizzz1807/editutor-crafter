title: Container Creation Sequence
shape: sequence_diagram

runtime: Runtime Manager
namespace: Namespace Manager
cgroup: Cgroup Controller
filesystem: Filesystem Manager
network: Network Manager
process: Process Manager

runtime -> namespace: Create namespaces (PID, Mount, Network, UTS, User)
namespace -> runtime: Namespaces created

runtime -> cgroup: Setup cgroup hierarchy
cgroup -> cgroup: Configure memory limits
cgroup -> cgroup: Configure CPU limits
cgroup -> cgroup: Configure I/O limits
cgroup -> runtime: Cgroup configured

runtime -> filesystem: Prepare container filesystem
filesystem -> filesystem: Create overlay mount
filesystem -> filesystem: Mount container rootfs
filesystem -> filesystem: Bind mount volumes
filesystem -> runtime: Filesystem ready

runtime -> network: Configure container networking
network -> network: Create veth pair
network -> network: Setup bridge connection
network -> network: Configure IP address
network -> runtime: Network configured

runtime -> process: Start container process
process -> process: Enter namespaces
process -> process: Join cgroup
process -> process: Change root filesystem
process -> process: Execute container command
process -> runtime: Process started

runtime.style.fill: "#16213e"
runtime.style.stroke: "#3fb950"
runtime.style.font-color: "#e6edf3"
runtime.style.bold: true

namespace.style.fill: "#1a1a2e"
namespace.style.stroke: "#8b949e"
namespace.style.font-color: "#e6edf3"

cgroup.style.fill: "#1a1a2e"
cgroup.style.stroke: "#8b949e"
cgroup.style.font-color: "#e6edf3"

filesystem.style.fill: "#1a1a2e"
filesystem.style.stroke: "#8b949e"
filesystem.style.font-color: "#e6edf3"

network.style.fill: "#1a1a2e"
network.style.stroke: "#8b949e"
network.style.font-color: "#e6edf3"

process.style.fill: "#1a1a2e"
process.style.stroke: "#8b949e"
process.style.font-color: "#e6edf3"