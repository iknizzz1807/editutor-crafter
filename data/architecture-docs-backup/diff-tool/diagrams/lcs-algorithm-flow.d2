classes: {
  container_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  process_style: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  decision_style: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  
  important_style: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
}

start: Start {
  shape: circle
  style.fill: "#3fb950"
  style.font-color: "#000000"
  style.stroke: "#3fb950"
}

init: "Initialize DP Matrix\n(m+1) x (n+1)" {
  class: process_style
}

setup: "Fill First Row & Column\nwith Zeros" {
  class: process_style
}

matrix_build: "Matrix Construction" {
  class: container_style
  
  outer_loop: "For i = 1 to m" {
    class: process_style
  }
  
  inner_loop: "For j = 1 to n" {
    class: process_style
  }
  
  compare: "text1[i-1] == text2[j-1] ?" {
    shape: diamond
    class: decision_style
  }
  
  match: "dp[i][j] = dp[i-1][j-1] + 1" {
    class: important_style
  }
  
  no_match: "dp[i][j] = max(\ndp[i-1][j],\ndp[i][j-1])" {
    class: process_style
  }
  
  outer_loop -> inner_loop
  inner_loop -> compare
  compare -> match: "Yes\n(Match)"
  compare -> no_match: "No\n(Different)"
  match -> inner_loop: "Continue"
  no_match -> inner_loop: "Continue"
}

matrix_done: "Matrix Complete\nLCS Length = dp[m][n]" {
  class: important_style
}

backtrack: "Backtracking Process" {
  class: container_style
  
  start_back: "Start at dp[m][n]" {
    class: process_style
  }
  
  check_chars: "Current chars match?" {
    shape: diamond
    class: decision_style
  }
  
  add_char: "Add char to LCS\nMove diagonal ↖" {
    class: important_style
  }
  
  choose_path: "Choose max(\nleft ←, up ↑)" {
    shape: diamond
    class: decision_style
  }
  
  move_left: "Move left ←" {
    class: process_style
  }
  
  move_up: "Move up ↑" {
    class: process_style
  }
  
  at_origin: "At (0,0)?" {
    shape: diamond
    class: decision_style
  }
  
  start_back -> check_chars
  check_chars -> add_char: "Yes"
  check_chars -> choose_path: "No"
  add_char -> at_origin
  choose_path -> move_left: "Left > Up"
  choose_path -> move_up: "Up ≥ Left"
  move_left -> at_origin
  move_up -> at_origin
  at_origin -> check_chars: "No\n(Continue)"
}

result: "Reverse LCS String\nReturn Result" {
  class: important_style
}

end_node: End {
  shape: circle
  style.fill: "#3fb950"
  style.font-color: "#000000"
  style.stroke: "#3fb950"
  style.double-border: true
}

start -> init
init -> setup
setup -> matrix_build.outer_loop
matrix_build.match -> matrix_done: "All cells processed"
matrix_build.no_match -> matrix_done: "All cells processed"
matrix_done -> backtrack.start_back
backtrack.at_origin -> result: "Yes\n(Done)"
result -> end_node