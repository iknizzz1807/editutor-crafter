direction: right

classes: {
  state: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  error_state: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
  recovery_state: {
    style.fill: "#fdcb6e"
    style.stroke: "#e17055"
    style.font-color: "#2d3436"
  }
  initial_state: {
    style.fill: "#3fb950"
    style.stroke: "#00b894"
    style.font-color: "#ffffff"
    label: ""
  }
  final_state: {
    style.fill: "#636e72"
    style.stroke: "#2d3436"
    style.font-color: "#ffffff"
    style.double-border: true
  }
}

init: {
  shape: circle
  class: initial_state
}

parsing: Normal Parsing {
  shape: circle
  class: state
}

error_detected: Error Detected {
  shape: circle
  class: error_state
}

validation_failure: Validation Failure {
  shape: circle
  class: error_state
}

recovery_attempt: Recovery Attempt {
  shape: circle
  class: recovery_state
}

partial_recovery: Partial Recovery {
  shape: circle
  class: recovery_state
}

graceful_degradation: Graceful Degradation {
  shape: circle
  class: recovery_state
}

complete_failure: Complete Failure {
  shape: circle
  class: final_state
}

success: Parse Complete {
  shape: circle
  class: final_state
}

init -> parsing: "Start parsing"

parsing -> parsing: "Valid data found"
parsing -> success: "EOF reached successfully"
parsing -> error_detected: "Invalid data encountered"
parsing -> validation_failure: "Format validation fails"

error_detected -> recovery_attempt: "Attempt recovery"
validation_failure -> recovery_attempt: "Try to recover"
error_detected -> complete_failure: "Critical error"

recovery_attempt -> parsing: "Recovery successful"
recovery_attempt -> partial_recovery: "Partial success"
recovery_attempt -> complete_failure: "Recovery failed"

partial_recovery -> parsing: "Continue with warnings"
partial_recovery -> graceful_degradation: "Cannot continue safely"

graceful_degradation -> success: "Extract available data"
graceful_degradation -> complete_failure: "Too much corruption"

validation_failure -> complete_failure: "Header corruption"