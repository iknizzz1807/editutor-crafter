direction: right

classes: {
  main_component: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  external_system: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  storage_backend: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

title: System Architecture Overview {
  near: top-center
  style.font-size: 20
  style.bold: true
  style.font-color: "#e6edf3"
}

core_system: Core Upload Service {
  class: main_component
  
  upload_manager: Upload Manager {
    class: main_component
    shape: rectangle
  }
  
  session_store: Session Store {
    class: main_component
    shape: cylinder
  }
  
  virus_scanner: Virus Scanner {
    class: main_component
    shape: rectangle
  }
  
  storage_abstraction: Storage Abstraction {
    class: main_component
    shape: rectangle
  }
  
  upload_manager -> session_store: manage state
  upload_manager -> virus_scanner: scan chunks
  upload_manager -> storage_abstraction: store files
  virus_scanner -> session_store: update status
}

external_services: External Services {
  class: external_system
  
  clamav: ClamAV Engine {
    class: external_system
    shape: hexagon
  }
}

storage_backends: Storage Backends {
  class: storage_backend
  
  s3_storage: AWS S3 {
    class: storage_backend
    shape: cloud
  }
  
  local_storage: Local Filesystem {
    class: storage_backend
    shape: cylinder
  }
}

client: Client Applications {
  class: external_system
  shape: rectangle
}

client -> core_system.upload_manager: chunked uploads
core_system.virus_scanner -> external_services.clamav: virus scan requests
external_services.clamav -> core_system.virus_scanner: scan results
core_system.storage_abstraction -> storage_backends.s3_storage: cloud storage
core_system.storage_abstraction -> storage_backends.local_storage: local storage