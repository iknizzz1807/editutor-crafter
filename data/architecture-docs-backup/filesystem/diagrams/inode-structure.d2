direction: right

classes: {
  inode_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  block_style: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  pointer_style: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  data_style: {
    style.fill: "#2d3748"
    style.stroke: "#4a90e2"
    style.font-color: "#e6edf3"
  }
}

title: Inode Block Pointer Structure {
  near: top-center
  style.font-size: 20
  style.bold: true
  style.font-color: "#3fb950"
}

small_file: Small File Example (< 48KB) {
  class: inode_style
  
  small_inode: Inode {
    shape: class
    class: inode_style
    "size: 12KB"
    "blocks: 3"
    "direct[0]: Block 100"
    "direct[1]: Block 205" 
    "direct[2]: Block 078"
    "direct[3-11]: NULL"
    "indirect: NULL"
  }
  
  small_data1: "Block 100\nData Pages 0-3" {
    class: data_style
  }
  
  small_data2: "Block 205\nData Pages 4-7" {
    class: data_style
  }
  
  small_data3: "Block 078\nData Pages 8-11" {
    class: data_style
  }
  
  small_inode -> small_data1: "direct[0]"
  small_inode -> small_data2: "direct[1]"
  small_inode -> small_data3: "direct[2]"
}

large_file: Large File Example (> 48KB) {
  class: inode_style
  
  large_inode: Inode {
    shape: class
    class: inode_style
    "size: 2MB"
    "blocks: 513"
    "direct[0-11]: Blocks 100-111"
    "indirect: Block 500"
  }
  
  indirect_block: Indirect Block 500 {
    shape: class
    class: pointer_style
    "ptr[0]: Block 200"
    "ptr[1]: Block 201"
    "ptr[2]: Block 202"
    "..."
    "ptr[500]: Block 700"
  }
  
  direct_data: "Direct Data\nBlocks 100-111\n(48KB)" {
    class: data_style
  }
  
  indirect_data1: "Block 200\nData Pages 48-51" {
    class: data_style
  }
  
  indirect_data2: "Block 201\nData Pages 52-55" {
    class: data_style
  }
  
  indirect_data3: "Block 700\nData Pages N-N+3" {
    class: data_style
  }
  
  large_inode -> direct_data: "direct[0-11]"
  large_inode -> indirect_block: indirect
  indirect_block -> indirect_data1: "ptr[0]"
  indirect_block -> indirect_data2: "ptr[1]"
  indirect_block -> indirect_data3: "ptr[500]"
}

pointer_structure: Block Pointer Architecture {
  class: block_style
  
  architecture: Pointer Levels {
    shape: class
    class: block_style
    "Direct Pointers: 12 × 4KB = 48KB max"
    "Indirect Block: 1024 pointers"
    "Indirect Capacity: 1024 × 4KB = 4MB"
    "Total File Size: 48KB + 4MB = ~4MB max"
  }
  
  access_pattern: Access Patterns {
    shape: class
    class: block_style
    "Small files: 1 inode read → data"
    "Large files: 1 inode + 1 indirect → data"
    "Random access: Calculate block from offset"
    "Sequential: Follow pointer chain"
  }
}

explanation: |md
  ## Key Concepts
  
  **Direct Pointers**: First 12 blocks directly referenced
  **Indirect Block**: Contains 1024 block pointers
  **Sparse Files**: NULL pointers create holes
  **Performance**: Direct access for small files, one extra hop for large files
| {
  shape: page
  class: block_style
  near: bottom-center
}