title: Coverage Tracking Data Flow

classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  data: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  decision: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  storage: {
    style.fill: "#2d1b69"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

start: Start Execution {
  shape: circle
  class: process
}

instrument: Instrumented Target {
  class: process
}

execute: Execute Input {
  class: process
}

hit: Code Block Hit {
  class: data
}

bitmap: Coverage Bitmap {
  shape: cylinder
  class: storage
}

check: New Coverage? {
  shape: diamond
  class: decision
}

update: Update Bitmap {
  class: process
}

add_corpus: Add to Corpus {
  class: process
}

corpus: Input Corpus {
  shape: cylinder
  class: storage
}

discard: Discard Input {
  class: process
}

end: Continue Fuzzing {
  shape: circle
  class: process
}

start -> instrument: Launch
instrument -> execute: Run with test input
execute -> hit: Track execution
hit -> bitmap: Check coverage map
bitmap -> check: Compare coverage
check -> update: Yes {
  style.stroke: "#3fb950"
  style.bold: true
}
check -> discard: No {
  style.stroke: "#e17055"
}
update -> add_corpus: Mark new paths
add_corpus -> corpus: Store valuable input
corpus -> end: Use for mutations
discard -> end: Continue with next input
end -> execute: Next iteration {
  style.stroke-dash: 3
}