classes: {
  message_class: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  enum_class: {
    style.fill: "#16213e"
    style.stroke: "#ffa502"
    style.font-color: "#e6edf3"
  }
  request_class: {
    style.fill: "#0f3460"
    style.stroke: "#3742fa"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  response_class: {
    style.fill: "#2d3436"
    style.stroke: "#00b894"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}

title: Protocol Buffer Message Types {
  near: top-center
  style.font-size: 20
  style.bold: true
  style.font-color: "#e6edf3"
}

# Request Messages
StreamDataRequest: {
  shape: class
  class: request_class
  - "stream_id: string"
  - "batch_size: int32"
  - "filter_criteria: FilterOptions"
}

ProcessingRequest: {
  shape: class  
  class: request_class
  - "data: repeated DataItem"
  - "processing_options: ProcessingConfig"
  - "metadata: RequestMetadata"
}

HealthCheckRequest: {
  shape: class
  class: request_class
  - "service: string"
}

# Response Messages
StreamDataResponse: {
  shape: class
  class: response_class
  - "items: repeated DataItem"
  - "next_token: string"
  - "has_more: bool"
  - "status: StreamStatus"
}

ProcessingResponse: {
  shape: class
  class: response_class
  - "result_id: string"
  - "processed_count: int32"
  - "status: ProcessingStatus"
  - "errors: repeated ErrorDetail"
}

HealthCheckResponse: {
  shape: class
  class: response_class
  - "status: HealthStatus"
  - "message: string"
  - "timestamp: google.protobuf.Timestamp"
}

# Nested Message Types
DataItem: {
  shape: class
  class: message_class
  - "id: string"
  - "payload: bytes"
  - "timestamp: google.protobuf.Timestamp"
  - "tags: \"map<string, string>\""
}

FilterOptions: {
  shape: class
  class: message_class
  - "start_time: google.protobuf.Timestamp"
  - "end_time: google.protobuf.Timestamp"
  - "categories: repeated string"
  - "max_items: int32"
}

ProcessingConfig: {
  shape: class
  class: message_class
  - "algorithm: ProcessingAlgorithm"
  - "parallel_workers: int32"
  - "timeout_seconds: int32"
  - "retry_config: RetryConfig"
}

RequestMetadata: {
  shape: class
  class: message_class
  - "client_id: string"
  - "trace_id: string"
  - "priority: Priority"
  - "headers: \"map<string, string>\""
}

ErrorDetail: {
  shape: class
  class: message_class
  - "code: ErrorCode"
  - "message: string"
  - "field_path: string"
  - "details: google.protobuf.Any"
}

RetryConfig: {
  shape: class
  class: message_class
  - "max_attempts: int32"
  - "base_delay_ms: int32"
  - "max_delay_ms: int32"
  - "backoff_multiplier: float"
}

# Enum Types
StreamStatus: {
  shape: class
  class: enum_class
  - "STREAM_UNKNOWN"
  - "STREAM_ACTIVE"
  - "STREAM_PAUSED"
  - "STREAM_COMPLETED"
  - "STREAM_ERROR"
}

ProcessingStatus: {
  shape: class
  class: enum_class
  - "PROCESSING_UNKNOWN"
  - "PROCESSING_PENDING"
  - "PROCESSING_IN_PROGRESS"
  - "PROCESSING_COMPLETED"
  - "PROCESSING_FAILED"
}

HealthStatus: {
  shape: class
  class: enum_class
  - "HEALTH_UNKNOWN"
  - "HEALTH_SERVING"
  - "HEALTH_NOT_SERVING"
  - "HEALTH_SERVICE_UNKNOWN"
}

ProcessingAlgorithm: {
  shape: class
  class: enum_class
  - "ALGORITHM_DEFAULT"
  - "ALGORITHM_FAST"
  - "ALGORITHM_ACCURATE"
  - "ALGORITHM_BALANCED"
}

Priority: {
  shape: class
  class: enum_class
  - "PRIORITY_LOW"
  - "PRIORITY_NORMAL"
  - "PRIORITY_HIGH"
  - "PRIORITY_URGENT"
}

ErrorCode: {
  shape: class
  class: enum_class
  - "ERROR_UNKNOWN"
  - "ERROR_INVALID_INPUT"
  - "ERROR_RESOURCE_EXHAUSTED"
  - "ERROR_TIMEOUT"
  - "ERROR_INTERNAL"
}

# Request-Response Relationships
StreamDataRequest -> StreamDataResponse: {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}
ProcessingRequest -> ProcessingResponse: {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}
HealthCheckRequest -> HealthCheckResponse: {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}

# Nested Structure Relationships
StreamDataRequest -> FilterOptions: uses
StreamDataResponse -> DataItem: contains
StreamDataResponse -> StreamStatus: uses

ProcessingRequest -> DataItem: contains
ProcessingRequest -> ProcessingConfig: uses
ProcessingRequest -> RequestMetadata: includes
ProcessingResponse -> ProcessingStatus: uses
ProcessingResponse -> ErrorDetail: contains

ProcessingConfig -> ProcessingAlgorithm: uses
ProcessingConfig -> RetryConfig: includes
RequestMetadata -> Priority: uses
ErrorDetail -> ErrorCode: uses

HealthCheckResponse -> HealthStatus: uses