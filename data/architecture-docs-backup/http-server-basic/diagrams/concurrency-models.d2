classes: {
  container_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  client_style: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  thread_style: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  pool_style: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  event_style: {
    style.fill: "#2d1b69"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

title: Concurrency Model Comparison {
  near: top-center
  style.font-color: "#e6edf3"
  style.bold: true
}

clients: Client Connections {
  class: container_style
  
  client1: Client 1 {
    class: client_style
  }
  client2: Client 2 {
    class: client_style
  }
  client3: Client 3 {
    class: client_style
  }
  client4: Client 4 {
    class: client_style
  }
}

model1: Thread-per-Connection {
  class: container_style
  
  thread1: Thread 1 {
    class: thread_style
  }
  thread2: Thread 2 {
    class: thread_style
  }
  thread3: Thread 3 {
    class: thread_style
  }
  thread4: Thread 4 {
    class: thread_style
  }
  
  note1: |md
    **1:1 Mapping**
    Each connection gets
    dedicated thread
  | {
    shape: page
    style.fill: "#1a1a2e"
    style.font-color: "#e6edf3"
  }
}

model2: Thread Pool {
  class: container_style
  
  pool: Worker Pool {
    class: pool_style
    
    worker1: Worker 1 {
      class: thread_style
    }
    worker2: Worker 2 {
      class: thread_style
    }
    worker3: Worker 3 {
      class: thread_style
    }
  }
  
  queue: Request Queue {
    shape: queue
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  note2: |md
    **Fixed Pool Size**
    Limited threads serve
    all connections
  | {
    shape: page
    style.fill: "#1a1a2e"
    style.font-color: "#e6edf3"
  }
  
  queue -> pool: dispatch
}

model3: Event-Driven {
  class: container_style
  
  event_loop: Event Loop {
    class: event_style
  }
  
  handlers: Event Handlers {
    class: event_style
    
    accept_handler: Accept Handler {
      class: event_style
    }
    read_handler: Read Handler {
      class: event_style
    }
    write_handler: Write Handler {
      class: event_style
    }
  }
  
  note3: |md
    **Single Thread**
    Non-blocking I/O with
    event callbacks
  | {
    shape: page
    style.fill: "#1a1a2e"
    style.font-color: "#e6edf3"
  }
  
  event_loop -> handlers: callbacks
}

clients.client1 -> model1.thread1: 1:1
clients.client2 -> model1.thread2: 1:1
clients.client3 -> model1.thread3: 1:1
clients.client4 -> model1.thread4: 1:1

clients.client1 -> model2.queue: enqueue
clients.client2 -> model2.queue: enqueue
clients.client3 -> model2.queue: enqueue
clients.client4 -> model2.queue: enqueue

clients.client1 -> model3.event_loop: events
clients.client2 -> model3.event_loop: events
clients.client3 -> model3.event_loop: events
clients.client4 -> model3.event_loop: events