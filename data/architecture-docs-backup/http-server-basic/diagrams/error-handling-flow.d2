title: Error Handling and Recovery

classes: {
  error_source: {
    style.fill: "#d63031"
    style.font-color: "#ffffff"
    style.stroke: "#e17055"
    style.bold: true
  }
  detection: {
    style.fill: "#fdcb6e"
    style.font-color: "#2d3436"
    style.stroke: "#e84393"
  }
  classification: {
    style.fill: "#6c5ce7"
    style.font-color: "#ffffff"
    style.stroke: "#a29bfe"
  }
  recovery: {
    style.fill: "#00b894"
    style.font-color: "#ffffff"
    style.stroke: "#00cec9"
  }
  response: {
    style.fill: "#0984e3"
    style.font-color: "#ffffff"
    style.stroke: "#74b9ff"
  }
}

error_sources: Error Sources {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  network: Network Errors {
    class: error_source
  }
  parsing: HTTP Parsing Errors {
    class: error_source
  }
  filesystem: File System Errors {
    class: error_source
  }
}

detection: Error Detection {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  socket_check: Socket Operation Check {
    class: detection
  }
  parse_validation: HTTP Parse Validation {
    class: detection
  }
  file_access: File Access Check {
    class: detection
  }
}

classifier: Error Classifier {
  shape: diamond
  class: classification
}

error_types: Error Categories {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  client_error: Client Error (4xx) {
    class: classification
  }
  server_error: Server Error (5xx) {
    class: classification
  }
  recoverable: Recoverable Error {
    class: classification
  }
}

recovery_actions: Recovery Actions {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  close_connection: Close Connection {
    class: recovery
  }
  retry_operation: Retry Operation {
    class: recovery
  }
  fallback_response: Send Fallback Response {
    class: recovery
  }
  log_error: Log Error Details {
    class: recovery
  }
}

http_responses: HTTP Error Responses {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  bad_request: 400 Bad Request {
    class: response
  }
  not_found: 404 Not Found {
    class: response
  }
  server_error: 500 Internal Server Error {
    class: response
  }
  service_unavailable: 503 Service Unavailable {
    class: response
  }
}

error_sources.network -> detection.socket_check: detect
error_sources.parsing -> detection.parse_validation: detect
error_sources.filesystem -> detection.file_access: detect

detection.socket_check -> classifier: classify error
detection.parse_validation -> classifier: classify error
detection.file_access -> classifier: classify error

classifier -> error_types.client_error: malformed request
classifier -> error_types.server_error: system failure
classifier -> error_types.recoverable: transient issue

error_types.client_error -> recovery_actions.log_error: record
error_types.server_error -> recovery_actions.close_connection: terminate
error_types.recoverable -> recovery_actions.retry_operation: attempt again

error_types.client_error -> http_responses.bad_request: return 400
error_types.client_error -> http_responses.not_found: return 404
error_types.server_error -> http_responses.server_error: return 500
error_types.recoverable -> http_responses.service_unavailable: return 503

recovery_actions.fallback_response -> http_responses.server_error: default response
recovery_actions.retry_operation -> classifier: re-evaluate {style.stroke-dash: 3}