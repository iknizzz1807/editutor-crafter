title: HTTPS Client System Components

classes: {
  layer: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  component: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  crypto: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  external: {
    style.fill: "#2d1b69"
    style.stroke: "#e17055"
    style.font-color: "#e6edf3"
  }
}

application: Application Layer {
  class: layer
  
  https_client: HTTPS Client Interface {
    class: component
  }
  
  request_handler: Request Handler {
    class: component
  }
  
  response_parser: Response Parser {
    class: component
  }
}

tls: TLS Layer {
  class: layer
  
  handshake_engine: Handshake Engine {
    class: component
  }
  
  record_layer: Record Layer {
    class: component
  }
  
  state_machine: Connection State Machine {
    class: component
  }
}

crypto_layer: Cryptographic Layer {
  class: layer
  
  key_derivation: Key Derivation (HKDF) {
    class: crypto
  }
  
  aead_cipher: AEAD Cipher (AES-GCM) {
    class: crypto
  }
  
  ecdh: ECDH Key Exchange {
    class: crypto
  }
  
  hash_functions: Hash Functions {
    class: crypto
  }
}

validation: Certificate Validation {
  class: layer
  
  cert_parser: Certificate Parser {
    class: component
  }
  
  chain_validator: Chain Validator {
    class: component
  }
  
  revocation_check: Revocation Checker {
    class: component
  }
}

transport: Transport Layer {
  class: layer
  
  tcp_socket: TCP Socket {
    class: component
  }
  
  buffer_manager: Buffer Manager {
    class: component
  }
}

external_deps: External Dependencies {
  class: external
  
  ca_store: CA Certificate Store {
    class: external
    shape: cylinder
  }
  
  ocsp_server: OCSP Server {
    class: external
    shape: cloud
  }
  
  target_server: Target HTTPS Server {
    class: external
    shape: cloud
  }
}

# Application flow
https_client -> request_handler: initiate request
request_handler -> handshake_engine: establish TLS
response_parser -> https_client: parsed response

# TLS handshake flow
handshake_engine -> state_machine: manage connection state
handshake_engine -> record_layer: send/receive records
state_machine -> ecdh: perform key exchange
handshake_engine -> cert_parser: process server certificate

# Cryptographic operations
record_layer -> aead_cipher: encrypt/decrypt data
handshake_engine -> key_derivation: derive session keys
key_derivation -> hash_functions: HMAC operations
ecdh -> key_derivation: shared secret

# Certificate validation chain
cert_parser -> chain_validator: validate certificate chain
chain_validator -> ca_store: verify against trusted CAs
chain_validator -> revocation_check: check certificate status
revocation_check -> ocsp_server: OCSP requests

# Transport operations
record_layer -> tcp_socket: send TLS records
tcp_socket -> buffer_manager: manage I/O buffers
tcp_socket <-> target_server: network communication

# Data flow arrows
aead_cipher -> record_layer: encrypted application data {style.stroke: "#3fb950"}
buffer_manager -> record_layer: received TLS records {style.stroke: "#3fb950"}