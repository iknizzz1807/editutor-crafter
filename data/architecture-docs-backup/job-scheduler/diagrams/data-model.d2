direction: right

classes: {
  entity: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  relationship: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

Job: {
  shape: class
  class: entity
  - "id: string"
  - "name: string"
  - "description: string"
  - "payload: JSON"
  - "status: JobStatus"
  - "priority: int"
  - "max_retries: int"
  - "retry_count: int"
  - "created_at: timestamp"
  - "updated_at: timestamp"
  - "next_run_at: timestamp"
  - "last_run_at: timestamp"
  - "schedule_id: string (FK)"
  - "assigned_worker_id: string (FK)"
  + "execute(): Result"
  + "can_retry(): boolean"
  + "is_due(): boolean"
}

Worker: {
  shape: class
  class: entity
  - "id: string"
  - "name: string"
  - "status: WorkerStatus"
  - "capacity: int"
  - "current_load: int"
  - "capabilities: string[]"
  - "last_heartbeat: timestamp"
  - "created_at: timestamp"
  - "updated_at: timestamp"
  + "is_available(): boolean"
  + "can_handle(job: Job): boolean"
  + "send_heartbeat(): void"
}

Schedule: {
  shape: class
  class: entity
  - "id: string"
  - "name: string"
  - "description: string"
  - "is_active: boolean"
  - "timezone: string"
  - "created_at: timestamp"
  - "updated_at: timestamp"
  - "cron_expression_id: string (FK)"
  + "get_next_run(): timestamp"
  + "is_due(now: timestamp): boolean"
}

CronExpression: {
  shape: class
  class: entity
  - "id: string"
  - "expression: string"
  - "description: string"
  - "minute: string"
  - "hour: string"
  - "day_of_month: string"
  - "month: string"
  - "day_of_week: string"
  - "created_at: timestamp"
  + "parse(): CronFields"
  + "next_execution(from: timestamp): timestamp"
  + "is_valid(): boolean"
}

Job -> Schedule: {
  class: relationship
  label: "belongs to\n(many:1)"
}

Job -> Worker: {
  class: relationship
  label: "assigned to\n(many:1)"
}

Schedule -> CronExpression: {
  class: relationship
  label: "uses\n(many:1)"
}

Worker -> Job: {
  class: relationship
  label: "executes\n(1:many)"
}

title: {
  label: Data Model Relationships
  shape: text
  style.font-size: 24
  style.font-color: "#e6edf3"
  style.bold: true
  near: top-center
}