title: JWT Library Component Architecture

classes: {
  component: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  interface: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  external: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

# External Interfaces
token_api: Token Creation API {
  class: external
  shape: rectangle
}

verify_api: Token Verification API {
  class: external
  shape: rectangle
}

# Core JWT Library
jwt_lib: JWT Library {
  class: interface
  
  encoder: Encoder Component {
    class: component
    - "payload: JSON"
    - "header: Header"
    + "encode(claims: Claims): string"
    + "base64_encode(data: bytes): string"
  }
  
  signer: Signer Component {
    class: component
    - "algorithm: Algorithm"
    - "private_key: Key"
    + "sign(data: string): Signature"
    + "get_algorithm(): string"
  }
  
  validator: Validator Component {
    class: component
    - "public_key: Key"
    - "validation_rules: Rules"
    + "verify_signature(token: string): boolean"
    + "validate_claims(claims: Claims): boolean"
    + "check_expiration(exp: timestamp): boolean"
  }
  
  # Component Dependencies
  encoder -> signer: uses for signing
  validator -> signer: uses algorithm info
}

# External Dependencies
crypto_lib: Cryptographic Library {
  class: external
  shape: cylinder
  - "RSA/HMAC algorithms"
  - "Key management"
}

time_service: Time Service {
  class: external
  shape: rectangle
  - "Current timestamp"
  - "Expiration validation"
}

# External API flows
token_api -> jwt_lib.encoder: create token
jwt_lib.encoder -> jwt_lib.signer: sign payload
jwt_lib.signer -> crypto_lib: cryptographic operations

verify_api -> jwt_lib.validator: verify token
jwt_lib.validator -> crypto_lib: signature verification
jwt_lib.validator -> time_service: time validation

# Return flows
jwt_lib.validator -> verify_api: validation result
jwt_lib.signer -> token_api: signed token

# Styling arrows
token_api -> jwt_lib.encoder: {
  style.stroke: "#8b949e"
}
jwt_lib.encoder -> jwt_lib.signer: {
  style.stroke: "#8b949e"
}
jwt_lib.signer -> crypto_lib: {
  style.stroke: "#8b949e"
}
verify_api -> jwt_lib.validator: {
  style.stroke: "#8b949e"
}
jwt_lib.validator -> crypto_lib: {
  style.stroke: "#8b949e"
}
jwt_lib.validator -> time_service: {
  style.stroke: "#8b949e"
}
jwt_lib.validator -> verify_api: {
  style.stroke: "#8b949e"
}
jwt_lib.signer -> token_api: {
  style.stroke: "#8b949e"
}
validator -> signer: {
  style.stroke: "#8b949e"
}