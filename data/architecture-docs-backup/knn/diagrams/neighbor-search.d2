direction: down

classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  decision: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  data: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

start: Start {
  shape: circle
  style.fill: "#3fb950"
  style.font-color: "#ffffff"
  class: process
}

input: Input:\nQuery Point & K {
  class: process
}

init_distances: Initialize\nDistances Array {
  class: process
}

linear_search: Linear Search {
  shape: rectangle
  class: data
  
  loop_start: For each\ntraining point {
    class: process
  }
  
  calc_distance: Calculate distance\n(Euclidean/Manhattan) {
    class: process
  }
  
  store_distance: Store distance\nand index {
    class: process
  }
  
  loop_start -> calc_distance
  calc_distance -> store_distance
  store_distance -> loop_start: Next point
}

sort_distances: Sort distances\nascending {
  class: process
}

select_k: Select top K\nneighbors {
  class: process
}

tie_check: Ties at\nK-th position? {
  shape: diamond
  class: decision
}

tie_breaking: Tie Breaking {
  shape: rectangle
  class: data
  
  random_select: Random selection\namong tied distances {
    class: process
  }
  
  first_occurrence: Select first\noccurrence {
    class: process
  }
  
  additional_criteria: Use additional\ncriteria (e.g., class) {
    class: process
  }
}

final_neighbors: Final K\nneighbors selected {
  class: process
}

output: Output:\nNeighbor indices\nand distances {
  shape: circle
  style.fill: "#3fb950"
  style.font-color: "#ffffff"
  class: process
}

start -> input
input -> init_distances
init_distances -> linear_search
linear_search -> sort_distances
sort_distances -> select_k
select_k -> tie_check

tie_check -> tie_breaking: Yes
tie_check -> final_neighbors: No

tie_breaking -> final_neighbors
final_neighbors -> output

tie_breaking.random_select -> tie_breaking.first_occurrence: or
tie_breaking.first_occurrence -> tie_breaking.additional_criteria: or

start.style.bold: true
output.style.bold: true