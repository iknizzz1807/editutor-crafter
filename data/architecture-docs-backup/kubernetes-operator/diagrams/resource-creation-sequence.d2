shape: sequence_diagram

kubectl: kubectl
mutating_webhook: Mutating Webhook
validating_webhook: Validating Webhook
api_server: API Server
etcd: etcd
controller: Controller

kubectl -> api_server: POST /api/v1/customresources
api_server -> mutating_webhook: AdmissionReview (mutate)
mutating_webhook -> api_server: AdmissionResponse (modified resource)
api_server -> validating_webhook: AdmissionReview (validate)
validating_webhook -> api_server: AdmissionResponse (allowed/denied)
api_server -> etcd: Store resource
etcd -> api_server: Confirmation
api_server -> kubectl: 201 Created
api_server -> controller: Watch event (ADDED)
controller -> api_server: GET resource details
api_server -> controller: Resource spec
controller -> controller: Reconcile logic
controller -> api_server: Update status
api_server -> etcd: Store status update
etcd -> api_server: Confirmation

kubectl.style.fill: "#1a1a2e"
kubectl.style.stroke: "#3fb950"
kubectl.style.font-color: "#e6edf3"

mutating_webhook.style.fill: "#1a1a2e"
mutating_webhook.style.stroke: "#3fb950"
mutating_webhook.style.font-color: "#e6edf3"

validating_webhook.style.fill: "#1a1a2e"
validating_webhook.style.stroke: "#3fb950"
validating_webhook.style.font-color: "#e6edf3"

api_server.style.fill: "#1a1a2e"
api_server.style.stroke: "#3fb950"
api_server.style.font-color: "#e6edf3"
api_server.style.bold: true

etcd.style.fill: "#16213e"
etcd.style.stroke: "#3fb950"
etcd.style.font-color: "#e6edf3"

controller.style.fill: "#1a1a2e"
controller.style.stroke: "#3fb950"
controller.style.font-color: "#e6edf3"
controller.style.bold: true