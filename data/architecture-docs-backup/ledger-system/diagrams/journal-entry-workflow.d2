shape: sequence_diagram

classes: {
  api_style: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  system_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  error_style: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
  }
}

API: API Layer {
  class: api_style
}

Recorder: Transaction Recorder {
  class: system_style
}

BalanceEngine: Balance Engine {
  class: system_style
}

AuditSystem: Audit System {
  class: system_style
}

API -> Recorder: 1. POST journal entry
Recorder -> Recorder: 2. Validate entry format
Recorder -> Recorder: 3. Check debit/credit balance
Recorder -> BalanceEngine: 4. Request account locks
BalanceEngine -> Recorder: 5. Locks acquired
Recorder -> Recorder: 6. Begin transaction
Recorder -> BalanceEngine: 7. Calculate new balances
BalanceEngine -> Recorder: 8. Balance calculations
Recorder -> AuditSystem: 9. Create audit record
AuditSystem -> Recorder: 10. Audit record created
Recorder -> Recorder: 11. Commit transaction
Recorder -> BalanceEngine: 12. Release locks
Recorder -> API: 13. Entry posted successfully