title: Data Model and Type Relationships {
  near: top-center
  style.font-size: 18
  style.bold: true
  style.font-color: "#e6edf3"
}

classes: {
  primary_type: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.stroke-width: 2
  }
  flow_arrow: {
    style.stroke: "#3fb950"
    style.stroke-width: 2
    style.font-color: "#e6edf3"
  }
  note_style: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
    style.stroke-dash: 3
  }
}

Dataset: {
  shape: class
  class: primary_type
  "- features: np.ndarray"
  "- targets: np.ndarray"
  "- feature_names: List[str]"
  "- n_samples: int"
  "- n_features: int"
  "+ split(test_size: float): Tuple[Dataset, Dataset]"
  "+ normalize(): Dataset"
  "+ add_bias_column(): Dataset"
}

ModelParameters: {
  shape: class
  class: primary_type
  "- weights: np.ndarray"
  "- bias: float"
  "- learning_rate: float"
  "- regularization: float"
  "+ initialize_random(n_features: int): void"
  "+ update(gradients: np.ndarray): void"
  "+ copy(): ModelParameters"
}

TrainingHistory: {
  shape: class
  class: primary_type
  "- losses: List[float]"
  "- epochs: List[int]"
  "- learning_rates: List[float]"
  "- weight_history: List[np.ndarray]"
  "- convergence_reached: bool"
  "+ record_epoch(loss: float, weights: np.ndarray): void"
  "+ get_final_loss(): float"
  "+ plot_convergence(): void"
}

PredictionResult: {
  shape: class
  class: primary_type
  "- predictions: np.ndarray"
  "- confidence_intervals: np.ndarray"
  "- r_squared: float"
  "- mse: float"
  "- mae: float"
  "+ add_metrics(actual: np.ndarray): void"
  "+ get_residuals(actual: np.ndarray): np.ndarray"
  "+ plot_predictions(): void"
}

pipeline_note: |md
  **Data Flow Pipeline**
  Raw data → Training → Prediction
| {
  shape: page
  class: note_style
  near: top-right
}

Dataset -> ModelParameters: "initializes" {
  class: flow_arrow
}

Dataset -> TrainingHistory: "feeds training process" {
  class: flow_arrow
}

ModelParameters -> TrainingHistory: "updated during training" {
  class: flow_arrow
}

ModelParameters -> PredictionResult: "generates predictions" {
  class: flow_arrow
}

TrainingHistory -> ModelParameters: "guides optimization" {
  class: flow_arrow
  style.stroke-dash: 5
}

transformation_flow: |md
  **Key Transformations:**
  • Dataset.features → ModelParameters.weights
  • Training updates → TrainingHistory.losses  
  • Final weights → PredictionResult.predictions
| {
  shape: page
  class: note_style
  near: bottom-center
}