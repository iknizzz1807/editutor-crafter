classes: {
  state: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  transition: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  final_state: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    style.double-border: true
  }
  error_state: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
  start: {
    style.fill: "#3fb950"
    style.stroke: "#3fb950"
  }
}

title: Model Training State Machine {
  style.font-size: 24
  style.bold: true
  style.font-color: "#e6edf3"
  near: top-center
}

init: {
  shape: circle
  label: ""
  class: start
}

uninitialized: Uninitialized {
  shape: circle
  class: state
}

data_loaded: Data Loaded {
  shape: circle
  class: state
}

training: Training {
  shape: circle
  class: state
}

converged: Converged {
  shape: circle
  class: final_state
}

failed: Failed {
  shape: circle
  class: error_state
}

init -> uninitialized {
  class: transition
}

uninitialized -> data_loaded: "load_data()" {
  class: transition
}

data_loaded -> training: "fit()" {
  class: transition
}

training -> converged: convergence achieved {
  class: transition
}

training -> failed: max iterations / error {
  class: transition
}

converged -> data_loaded: "load_data()" {
  class: transition
}

failed -> data_loaded: "load_data()" {
  class: transition
}

converged -> converged: "predict()" {
  class: transition
}

data_loaded -> data_loaded: "predict() [if model exists]" {
  class: transition
}

training -> training: gradient step {
  class: transition
}