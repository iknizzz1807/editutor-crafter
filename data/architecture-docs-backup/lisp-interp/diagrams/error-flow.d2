classes: {
  error_style: {
    style.fill: "#d63031"
    style.font-color: "#ffffff"
    style.stroke: "#e17055"
    style.bold: true
  }
  process_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  decision_style: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  recovery_style: {
    style.fill: "#0f3460"
    style.stroke: "#74b9ff"
    style.font-color: "#e6edf3"
  }
}

tokenizer: Tokenizer Stage {
  class: process_style
}

char_error: Invalid Character\nDetected {
  shape: diamond
  class: error_style
}

token_error: Malformed Token\nDetected {
  shape: diamond
  class: error_style
}

parser: Parser Stage {
  class: process_style
}

syntax_error: Syntax Error\nDetected {
  shape: diamond
  class: error_style
}

structure_error: Invalid Structure\nDetected {
  shape: diamond
  class: error_style
}

evaluator: Evaluator Stage {
  class: process_style
}

runtime_error: Runtime Error\nDetected {
  shape: diamond
  class: error_style
}

semantic_error: Semantic Error\nDetected {
  shape: diamond
  class: error_style
}

error_classifier: Error Classifier {
  class: decision_style
  shape: diamond
}

recoverable: Recoverable? {
  class: decision_style
  shape: diamond
}

token_recovery: Skip Invalid\nCharacters {
  class: recovery_style
}

parse_recovery: Resync to Next\nExpression {
  class: recovery_style
}

eval_recovery: Return Default\nValue {
  class: recovery_style
}

error_reporter: Generate Error\nMessage {
  class: error_style
}

continue_processing: Continue\nProcessing {
  class: process_style
}

halt_processing: Halt\nExecution {
  class: error_style
}

tokenizer -> char_error: Invalid input
tokenizer -> token_error: Malformed token
char_error -> error_classifier
token_error -> error_classifier

parser -> syntax_error: Parse failure
parser -> structure_error: Invalid AST
syntax_error -> error_classifier
structure_error -> error_classifier

evaluator -> runtime_error: Execution failure
evaluator -> semantic_error: Type mismatch
runtime_error -> error_classifier
semantic_error -> error_classifier

error_classifier -> recoverable: Classify error type

recoverable -> token_recovery: Yes (tokenizer)
recoverable -> parse_recovery: Yes (parser)
recoverable -> eval_recovery: Yes (evaluator)
recoverable -> error_reporter: No (fatal)

token_recovery -> continue_processing
parse_recovery -> continue_processing
eval_recovery -> continue_processing

error_reporter -> halt_processing

continue_processing -> tokenizer: Resume tokenizing
continue_processing -> parser: Resume parsing
continue_processing -> evaluator: Resume evaluation