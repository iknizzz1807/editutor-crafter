classes: {
  config_class: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  data_class: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  metrics_class: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  relationship: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

title: Data Model and Configuration Schema {
  shape: text
  style.font-size: 20
  style.font-color: "#e6edf3"
  style.bold: true
  near: top-center
}

TrainingConfig: {
  shape: class
  class: config_class
  - "model_name: string"
  - "max_seq_length: int"
  - "batch_size: int" 
  - "learning_rate: float"
  - "num_epochs: int"
  - "warmup_steps: int"
  - "save_strategy: string"
  - "eval_strategy: string"
  - "logging_steps: int"
  - "output_dir: string"
  - "seed: int"
  + "validate(): bool"
  + "to_dict(): Dict"
  + "from_dict(data: Dict): TrainingConfig"
}

LoRAConfig: {
  shape: class
  class: config_class
  - "rank: int"
  - "alpha: int"
  - "dropout: float"
  - "target_modules: List[string]"
  - "bias: string"
  - "task_type: string"
  - "inference_mode: bool"
  - "fan_in_fan_out: bool"
  + "validate(): bool"
  + "get_peft_config(): PeftConfig"
  + "calculate_trainable_params(): int"
}

QuantizationConfig: {
  shape: class
  class: config_class
  - "load_in_4bit: bool"
  - "load_in_8bit: bool"
  - "bnb_4bit_compute_dtype: string"
  - "bnb_4bit_quant_type: string"
  - "bnb_4bit_use_double_quant: bool"
  - "bnb_8bit_compute_dtype: string"
  - "bnb_8bit_use_fp32_cpu_offload: bool"
  + "validate(): bool"
  + "get_bnb_config(): BitsAndBytesConfig"
  + "is_enabled(): bool"
}

TrainingData: {
  shape: class
  class: data_class
  - "instruction: string"
  - "input_text: string"
  - "output_text: string"
  - "conversation_id: string"
  - "metadata: Dict"
  - "input_ids: List[int]"
  - "attention_mask: List[int]"
  - "labels: List[int]"
  + "tokenize(tokenizer): Dict"
  + "format_prompt(): string"
  + "validate(): bool"
  + "to_chat_format(): Dict"
}

EvaluationMetrics: {
  shape: class
  class: metrics_class
  - "loss: float"
  - "perplexity: float"
  - "bleu_score: float"
  - "rouge_scores: Dict"
  - "exact_match: float"
  - "f1_score: float"
  - "eval_samples: int"
  - "eval_steps: int"
  - "timestamp: string"
  + "calculate_composite_score(): float"
  + "to_dict(): Dict"
  + "save_to_file(path: string): void"
  + "compare_with(other: EvaluationMetrics): Dict"
}

TrainingConfig -> LoRAConfig: configures {
  class: relationship
}

TrainingConfig -> QuantizationConfig: uses {
  class: relationship
}

TrainingConfig -> TrainingData: processes {
  class: relationship
}

TrainingConfig -> EvaluationMetrics: generates {
  class: relationship
}

LoRAConfig -> QuantizationConfig: compatible_with {
  class: relationship
}

TrainingData -> EvaluationMetrics: evaluated_by {
  class: relationship
}