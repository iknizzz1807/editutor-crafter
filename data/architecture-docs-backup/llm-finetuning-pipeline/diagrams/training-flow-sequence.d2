shape: sequence_diagram

data_loader: DataLoader
lora_manager: LoRAManager  
quant_handler: QuantizationHandler
training_orchestrator: TrainingOrchestrator
eval_runner: EvaluationRunner

data_loader.style.fill: "#1a1a2e"
data_loader.style.stroke: "#3fb950"
data_loader.style.font-color: "#e6edf3"

lora_manager.style.fill: "#1a1a2e"
lora_manager.style.stroke: "#3fb950"
lora_manager.style.font-color: "#e6edf3"

quant_handler.style.fill: "#1a1a2e"
quant_handler.style.stroke: "#3fb950"
quant_handler.style.font-color: "#e6edf3"

training_orchestrator.style.fill: "#16213e"
training_orchestrator.style.stroke: "#3fb950"
training_orchestrator.style.font-color: "#e6edf3"
training_orchestrator.style.bold: true

eval_runner.style.fill: "#1a1a2e"
eval_runner.style.stroke: "#3fb950"
eval_runner.style.font-color: "#e6edf3"

training_orchestrator -> data_loader: initialize_datasets()
data_loader -> training_orchestrator: dataset_ready
training_orchestrator -> quant_handler: setup_quantization()
quant_handler -> training_orchestrator: quantized_model
training_orchestrator -> lora_manager: configure_adapters()
lora_manager -> training_orchestrator: lora_config
training_orchestrator -> data_loader: get_train_batch()
data_loader -> training_orchestrator: batch_data
training_orchestrator -> lora_manager: forward_pass()
lora_manager -> training_orchestrator: adapter_outputs
training_orchestrator -> lora_manager: backward_pass()
lora_manager -> training_orchestrator: gradients_updated
training_orchestrator -> eval_runner: run_evaluation()
eval_runner -> data_loader: get_eval_batch()
data_loader -> eval_runner: eval_data
eval_runner -> lora_manager: inference_mode()
lora_manager -> eval_runner: predictions
eval_runner -> training_orchestrator: metrics_report
training_orchestrator -> lora_manager: save_checkpoint()
lora_manager -> training_orchestrator: checkpoint_saved
training_orchestrator -> lora_manager: export_model()
lora_manager -> training_orchestrator: model_exported