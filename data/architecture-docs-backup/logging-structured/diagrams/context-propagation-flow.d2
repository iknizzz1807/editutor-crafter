shape: sequence_diagram

client: Client
function_a: Function A
function_b: Function B
function_c: Function C
async_task: Async Task
database: Database

client -> function_a: "request (correlation_id: req-123)"
function_a -> function_a: "create context {user_id: user-456, session: sess-789}"
function_a -> function_b: "call_with_context(correlation_id: req-123, context)"
function_b -> function_b: inherit context fields
function_b -> function_c: "nested_call(correlation_id: req-123, context)"
function_c -> function_c: log with full context
function_c -> database: "query (correlation_id: req-123)"
database -> function_c: result
function_c -> function_b: return data
function_b -> async_task: "spawn_task(correlation_id: req-123, context)"
function_b -> function_a: return processed_data
async_task -> async_task: context propagated across boundary
async_task -> database: "background_operation (correlation_id: req-123)"
database -> async_task: success
function_a -> client: "response (correlation_id: req-123)"

client.style.fill: "#1a1a2e"
client.style.font-color: "#e6edf3"
client.style.stroke: "#3fb950"

function_a.style.fill: "#1a1a2e"
function_a.style.font-color: "#e6edf3"
function_a.style.stroke: "#3fb950"

function_b.style.fill: "#1a1a2e"
function_b.style.font-color: "#e6edf3"
function_b.style.stroke: "#3fb950"

function_c.style.fill: "#1a1a2e"
function_c.style.font-color: "#e6edf3"
function_c.style.stroke: "#3fb950"

async_task.style.fill: "#16213e"
async_task.style.font-color: "#e6edf3"
async_task.style.stroke: "#3fb950"
async_task.style.bold: true

database.style.fill: "#0f3460"
database.style.font-color: "#e6edf3"
database.style.stroke: "#3fb950"