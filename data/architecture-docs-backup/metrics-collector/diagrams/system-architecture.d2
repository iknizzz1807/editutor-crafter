# System Architecture Overview
classes: {
  component: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  storage: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  api: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}

scrape_engine: Scrape Engine {
  class: component
  scraper: Metrics Scraper
  discovery: Service Discovery
  scheduler: Scrape Scheduler
  
  scraper -> discovery: discover targets
  scheduler -> scraper: trigger scrapes
}

storage_layer: Storage Layer {
  class: storage
  tsdb: Time Series Database {
    shape: cylinder
  }
  compactor: Data Compactor
  wal: Write-Ahead Log {
    shape: page
  }
  
  wal -> tsdb: commit data
  compactor -> tsdb: compress blocks
}

query_engine: Query Engine {
  class: component
  parser: PromQL Parser
  executor: Query Executor
  cache: Query Cache {
    shape: cylinder
  }
  
  parser -> executor: parsed query
  executor -> cache: cache results
}

http_api: HTTP API {
  class: api
  metrics: /metrics endpoint
  query: /query endpoint
  admin: /admin endpoint
  
  query -> metrics: expose metrics
}

# Data flow arrows
scrape_engine -> storage_layer: raw metrics data {
  style.stroke: "#8b949e"
  style.stroke-width: 2
}

storage_layer -> query_engine: time series data {
  style.stroke: "#8b949e"
  style.stroke-width: 2
}

query_engine -> http_api: query results {
  style.stroke: "#8b949e"
  style.stroke-width: 2
}

http_api -> query_engine: PromQL queries {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}

# External interactions
clients: External Clients {
  shape: cloud
  style.fill: "#2d3748"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

targets: Monitored Services {
  shape: cloud
  style.fill: "#2d3748"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

clients -> http_api: HTTP requests {
  style.stroke: "#3fb950"
  style.stroke-width: 2
}

scrape_engine -> targets: scrape metrics {
  style.stroke: "#3fb950"
  style.stroke-dash: 3
}