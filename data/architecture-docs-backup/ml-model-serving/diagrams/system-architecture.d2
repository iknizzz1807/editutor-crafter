title: System Architecture Overview {
  near: top-center
  style.font-size: 24
  style.bold: true
  style.font-color: "#e6edf3"
}

classes: {
  gateway: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  core_service: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  monitoring: {
    style.fill: "#16213e"
    style.stroke: "#ffd93d"
    style.font-color: "#e6edf3"
  }
  data_flow: {
    style.stroke: "#8b949e"
    style.stroke-width: 2
  }
  control_flow: {
    style.stroke: "#3fb950"
    style.stroke-width: 2
  }
}

gateway: API Gateway {
  class: gateway
  load_balancer: Load Balancer
  rate_limiter: Rate Limiter
  auth: Authentication
}

routing: A/B Router {
  class: core_service
  traffic_split: Traffic Splitter
  experiment_config: Experiment Config
}

batching: Batching System {
  class: core_service
  request_queue: Request Queue {
    shape: queue
  }
  batch_processor: Batch Processor
  scheduler: Dynamic Scheduler
}

models: Model Loader {
  class: core_service
  model_cache: Model Cache {
    shape: cylinder
  }
  framework_adapter: Framework Adapter
  gpu_manager: GPU Manager
}

versions: Version Manager {
  class: core_service
  model_registry: Model Registry {
    shape: cylinder
  }
  deployment_controller: Deployment Controller
}

monitoring: Monitoring & Observability {
  class: monitoring
  metrics: Metrics Collector
  logs: Log Aggregator
  alerts: Alert Manager
  dashboard: Dashboard {
    shape: page
  }
}

gateway -> routing: route requests {
  class: data_flow
}

routing -> batching: prediction requests {
  class: data_flow
}

batching -> models: batched inference {
  class: data_flow
}

models -> batching: predictions {
  class: data_flow
}

batching -> gateway: responses {
  class: data_flow
}

versions -> models: load models {
  class: control_flow
}

versions -> routing: version config {
  class: control_flow
}

monitoring -> gateway: collect metrics {
  class: control_flow
}

monitoring -> batching: monitor queues {
  class: control_flow
}

monitoring -> models: resource metrics {
  class: control_flow
}