shape: sequence_diagram

orchestrator: Training Orchestrator {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

resource_manager: Resource Manager {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

worker1: Worker Node 1 {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

worker2: Worker Node 2 {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

checkpoint: Checkpoint Storage {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

orchestrator -> resource_manager: Request GPU allocation
resource_manager -> orchestrator: GPU cluster assignment
orchestrator -> checkpoint: Load latest checkpoint
checkpoint -> orchestrator: Model state and metadata
orchestrator -> worker1: Initialize training job
orchestrator -> worker2: Initialize training job
worker1 -> checkpoint: Download model weights
worker2 -> checkpoint: Download model weights
worker1 -> orchestrator: Ready for training
worker2 -> orchestrator: Ready for training
orchestrator -> worker1: Start training epoch
orchestrator -> worker2: Start training epoch
worker1 -> worker2: Exchange gradients
worker2 -> worker1: Exchange gradients
worker1 -> orchestrator: Batch complete
worker2 -> orchestrator: Batch complete
orchestrator -> worker1: Continue training
orchestrator -> worker2: Continue training
worker2 -> orchestrator: Node failure detected
orchestrator -> resource_manager: Request replacement node
resource_manager -> orchestrator: New node allocated
orchestrator -> checkpoint: Save current state
checkpoint -> orchestrator: Checkpoint saved
orchestrator -> worker1: Pause training
orchestrator -> worker_new: Initialize replacement node
checkpoint -> worker_new: Restore from checkpoint
worker_new -> orchestrator: Ready to resume
orchestrator -> worker1: Resume training
orchestrator -> worker_new: Resume training

worker_new: Worker Node 3 {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}