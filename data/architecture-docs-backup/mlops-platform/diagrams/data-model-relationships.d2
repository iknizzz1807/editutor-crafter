classes: {
  entity: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  relationship: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

title: Core Entity Relationships {
  near: top-center
  style.font-size: 20
  style.bold: true
  style.font-color: "#e6edf3"
}

experiment: Experiment {
  shape: class
  class: entity
  - "id: string"
  - "name: string"
  - "description: string"
  - "created_at: datetime"
  - "updated_at: datetime"
  - "status: ExperimentStatus"
  - "tags: string[]"
  - "metadata: JSON"
}

run: Run {
  shape: class
  class: entity
  - "id: string"
  - "experiment_id: string"
  - "name: string"
  - "status: RunStatus"
  - "start_time: datetime"
  - "end_time: datetime"
  - "parameters: JSON"
  - "metrics: JSON"
  - "artifacts_path: string"
}

model: Model {
  shape: class
  class: entity
  - "id: string"
  - "name: string"
  - "description: string"
  - "framework: string"
  - "created_at: datetime"
  - "tags: string[]"
  - "task_type: MLTaskType"
}

model_version: ModelVersion {
  shape: class
  class: entity
  - "id: string"
  - "model_id: string"
  - "run_id: string"
  - "version: string"
  - "artifact_uri: string"
  - "signature: ModelSignature"
  - "created_at: datetime"
  - "stage: ModelStage"
  - "metrics: JSON"
}

pipeline: Pipeline {
  shape: class
  class: entity
  - "id: string"
  - "name: string"
  - "description: string"
  - "definition: JSON"
  - "schedule: string"
  - "created_at: datetime"
  - "updated_at: datetime"
  - "status: PipelineStatus"
}

deployment: Deployment {
  shape: class
  class: entity
  - "id: string"
  - "model_version_id: string"
  - "name: string"
  - "environment: string"
  - "endpoint_url: string"
  - "status: DeploymentStatus"
  - "created_at: datetime"
  - "config: JSON"
  - "replicas: int"
}

experiment -> run: "1:N has runs" {
  class: relationship
}

run -> model_version: "1:1 produces" {
  class: relationship
}

model -> model_version: "1:N has versions" {
  class: relationship
}

model_version -> deployment: "1:N deployed as" {
  class: relationship
}

pipeline -> run: "1:N executes" {
  class: relationship
}

pipeline -> experiment: "N:M can trigger" {
  class: relationship
}