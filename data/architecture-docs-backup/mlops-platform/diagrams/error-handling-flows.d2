classes: {
  failure: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
  }
  
  recovery: {
    style.fill: "#00b894"
    style.stroke: "#00a085"
    style.font-color: "#ffffff"
  }
  
  decision: {
    style.fill: "#fdcb6e"
    style.stroke: "#f39c12"
    style.font-color: "#2d3436"
  }
  
  monitor: {
    style.fill: "#6c5ce7"
    style.stroke: "#5f3dc4"
    style.font-color: "#ffffff"
  }
  
  alert: {
    style.fill: "#fd79a8"
    style.stroke: "#e84393"
    style.font-color: "#ffffff"
  }
}

title: |md
  # Failure Recovery Flows
  MLOps Platform Error Handling and Recovery Paths
|

training_pipeline: Training Pipeline Failures {
  train_start: Training Job Started
  
  train_failure: Training Failed {
    shape: diamond
    class: failure
  }
  
  check_retry: Retry Attempts < 3? {
    shape: diamond
    class: decision
  }
  
  auto_retry: Automatic Retry {
    class: recovery
  }
  
  resource_check: Check Resource Availability {
    class: decision
    shape: diamond
  }
  
  scale_resources: Scale Up Resources {
    class: recovery
  }
  
  manual_intervention: Manual Investigation Required {
    class: alert
  }
  
  train_start -> train_failure: fails
  train_failure -> check_retry
  check_retry -> auto_retry: Yes
  check_retry -> resource_check: No
  auto_retry -> train_start: restart
  resource_check -> scale_resources: Available
  resource_check -> manual_intervention: Exhausted
  scale_resources -> train_start: retry with more resources
}

deployment_rollback: Deployment Rollbacks {
  deploy_start: Model Deployment
  
  health_check: Health Check Failed {
    shape: diamond
    class: failure
  }
  
  rollback_decision: Critical Service? {
    shape: diamond
    class: decision
  }
  
  immediate_rollback: Immediate Rollback {
    class: recovery
  }
  
  canary_stop: Stop Canary Deployment {
    class: recovery
  }
  
  previous_version: Restore Previous Version {
    class: recovery
  }
  
  deploy_complete: Deployment Successful {
    class: recovery
  }
  
  deploy_start -> health_check: validate
  health_check -> rollback_decision: fails
  health_check -> deploy_complete: passes
  rollback_decision -> immediate_rollback: Yes
  rollback_decision -> canary_stop: No
  immediate_rollback -> previous_version
  canary_stop -> previous_version
}

monitoring_alerts: Monitoring Alert Escalation {
  metric_threshold: Metric Threshold Exceeded {
    class: monitor
  }
  
  alert_severity: Severity Level? {
    shape: diamond
    class: decision
  }
  
  auto_scale: Auto-scaling Triggered {
    class: recovery
  }
  
  team_notification: Notify On-call Team {
    class: alert
  }
  
  escalation: Escalate to Management {
    class: alert
  }
  
  incident_response: Incident Response Team {
    class: alert
  }
  
  resolved: Issue Resolved {
    class: recovery
  }
  
  metric_threshold -> alert_severity
  alert_severity -> auto_scale: Low
  alert_severity -> team_notification: Medium
  alert_severity -> escalation: High
  escalation -> incident_response: if unresolved
  team_notification -> incident_response: if unresolved after 30min
  auto_scale -> resolved
  incident_response -> resolved
}

data_corruption: Data Corruption Recovery {
  corruption_detected: Data Corruption Detected {
    class: failure
  }
  
  backup_available: Backup Available? {
    shape: diamond
    class: decision
  }
  
  restore_backup: Restore from Backup {
    class: recovery
  }
  
  data_validation: Validate Restored Data {
    class: recovery
  }
  
  manual_recovery: Manual Data Recovery {
    class: alert
  }
  
  data_loss_assessment: Assess Data Loss {
    class: decision
    shape: diamond
  }
  
  acceptable_loss: Loss Acceptable? {
    shape: diamond
    class: decision
  }
  
  continue_ops: Continue Operations {
    class: recovery
  }
  
  emergency_stop: Emergency Stop {
    class: failure
  }
  
  corruption_detected -> backup_available
  backup_available -> restore_backup: Yes
  backup_available -> manual_recovery: No
  restore_backup -> data_validation
  data_validation -> continue_ops: valid
  data_validation -> manual_recovery: corrupted
  manual_recovery -> data_loss_assessment
  data_loss_assessment -> acceptable_loss
  acceptable_loss -> continue_ops: Yes
  acceptable_loss -> emergency_stop: No
}

cross_component: Cross-Component Dependencies {
  training_pipeline.manual_intervention -> monitoring_alerts.incident_response: escalate training issues
  deployment_rollback.previous_version -> data_corruption.backup_available: check data consistency
  monitoring_alerts.resolved -> deployment_rollback.deploy_start: retry deployment
  data_corruption.emergency_stop -> deployment_rollback.immediate_rollback: cascade failure
}