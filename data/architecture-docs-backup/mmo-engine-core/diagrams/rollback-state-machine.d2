title: Rollback System States

classes: {
  state: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  initial: {
    style.fill: "#3fb950"
    style.stroke: "#3fb950"
    style.font-color: "#1a1a2e"
    style.bold: true
  }
  final: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.double-border: true
    style.bold: true
  }
  transition: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

init: {
  shape: circle
  label: ""
  class: initial
}

predicting: {
  shape: circle
  label: "Predicting"
  class: state
}

waiting: {
  shape: circle
  label: "Waiting for\nConfirmation"
  class: state
}

rolling_back: {
  shape: circle
  label: "Rolling Back"
  class: state
}

resimulating: {
  shape: circle
  label: "Resimulating"
  class: state
}

synchronized: {
  shape: circle
  label: "Synchronized"
  class: final
}

init -> predicting: {
  label: "Client Input"
  class: transition
}

predicting -> waiting: {
  label: "Send to Server"
  class: transition
}

waiting -> synchronized: {
  label: "Server Confirms"
  class: transition
}

waiting -> rolling_back: {
  label: "Server Rejects"
  class: transition
}

rolling_back -> resimulating: {
  label: "State Restored"
  class: transition
}

resimulating -> synchronized: {
  label: "Simulation Complete"
  class: transition
}

synchronized -> predicting: {
  label: "New Input"
  class: transition
}

predicting -> predicting: {
  label: "Additional Input"
  class: transition
}