title: Chronos Engine System Overview

classes: {
  subsystem: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  interface: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  data_flow: {
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

spatial_engine: Spatial Engine {
  class: subsystem
  
  grid_manager: Grid Manager {
    class: interface
  }
  
  proximity_queries: Proximity Queries {
    class: interface
  }
  
  spatial_hash: Spatial Hash {
    class: interface
  }
}

interest_manager: Interest Manager {
  class: subsystem
  
  subscription_service: Subscription Service {
    class: interface
  }
  
  relevancy_filter: Relevancy Filter {
    class: interface
  }
  
  update_distributor: Update Distributor {
    class: interface
  }
}

network_layer: Network Layer {
  class: subsystem
  
  packet_manager: Packet Manager {
    class: interface
  }
  
  compression: Compression {
    class: interface
  }
  
  connection_pool: Connection Pool {
    class: interface
  }
}

rollback_system: Rollback System {
  class: subsystem
  
  state_snapshots: State Snapshots {
    class: interface
  }
  
  command_buffer: Command Buffer {
    class: interface
  }
  
  conflict_resolver: Conflict Resolver {
    class: interface
  }
}

game_loop: Game Loop {
  class: interface
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.bold: true
}

spatial_engine.proximity_queries -> interest_manager.subscription_service: Entity positions {
  class: data_flow
}

interest_manager.update_distributor -> network_layer.packet_manager: Filtered updates {
  class: data_flow
}

network_layer.connection_pool -> rollback_system.command_buffer: Player inputs {
  class: data_flow
}

rollback_system.state_snapshots -> spatial_engine.grid_manager: Rollback state {
  class: data_flow
}

game_loop -> spatial_engine: Update positions {
  class: data_flow
}

game_loop -> interest_manager: Process subscriptions {
  class: data_flow
}

game_loop -> network_layer: Send/Receive packets {
  class: data_flow
}

game_loop -> rollback_system: Validate & rollback {
  class: data_flow
}

spatial_engine.spatial_hash <-> interest_manager.relevancy_filter: Spatial queries {
  class: data_flow
}

rollback_system.conflict_resolver -> interest_manager.update_distributor: Corrected state {
  class: data_flow
}