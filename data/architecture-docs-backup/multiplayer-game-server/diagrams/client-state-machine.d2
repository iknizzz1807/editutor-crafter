direction: right

# State definitions
connecting: Connecting {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

synchronizing: Synchronizing {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

playing: Playing {
  shape: circle
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

predicting: Predicting {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

reconciling: Reconciling {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

disconnected: Disconnected {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

initial: "" {
  shape: circle
  style.fill: "#3fb950"
  width: 20
  height: 20
}

# State transitions
initial -> connecting: connect()

connecting -> synchronizing: handshake complete
connecting -> disconnected: connection failed

synchronizing -> playing: initial state received
synchronizing -> disconnected: sync timeout

playing -> predicting: player input
playing -> reconciling: server state mismatch
playing -> disconnected: network error

predicting -> playing: prediction confirmed
predicting -> reconciling: prediction error
predicting -> disconnected: network error

reconciling -> playing: state reconciled
reconciling -> predicting: reconciliation complete\nwith new input
reconciling -> disconnected: reconciliation failed

disconnected -> connecting: reconnect attempt

# Styling for arrows
*.style.stroke: "#8b949e"
*.style.font-color: "#e6edf3"