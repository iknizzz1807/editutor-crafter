title: Data Model and Type Relationships {
  style.font-size: 24
  style.bold: true
  style.fill: "#1a1a2e"
  style.font-color: "#e6edf3"
}

game_state: Game State Layer {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  world: World {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  entity: Entity {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  player: Player {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  projectile: Projectile {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  world -> entity: contains
  entity -> player: inherits
  entity -> projectile: inherits
}

network_layer: Network Message Layer {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  message_base: Message {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  
  input_msg: InputMessage {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  state_msg: StateMessage {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  event_msg: EventMessage {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  serializer: Serializer {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#d63031"
    style.font-color: "#ffffff"
    style.bold: true
  }
  
  message_base -> input_msg: inherits
  message_base -> state_msg: inherits
  message_base -> event_msg: inherits
  serializer -> message_base: serializes
}

historical_layer: Historical Data Layer {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  snapshot: Snapshot {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  
  input_buffer: InputBuffer {
    shape: queue
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  state_history: StateHistory {
    shape: cylinder
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  replay_data: ReplayData {
    shape: page
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  snapshot -> state_history: stored in
  input_buffer -> replay_data: archived to
}

game_state -> network_layer: serialized to {
  style.stroke: "#8b949e"
}

network_layer -> historical_layer: archived as {
  style.stroke: "#8b949e"
}

game_state.world -> historical_layer.snapshot: creates {
  style.stroke: "#8b949e"
}

network_layer.input_msg -> historical_layer.input_buffer: buffered in {
  style.stroke: "#8b949e"
}

historical_layer.snapshot -> game_state.world: restores to {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}