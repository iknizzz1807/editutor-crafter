direction: down

classes: {
  layer_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  neuron_style: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  weight_style: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.stroke-dash: 3
  }
  loss_style: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
  gradient_style: {
    style.stroke: "#3fb950"
    style.font-color: "#3fb950"
    style.bold: true
  }
}

loss: Loss Function {
  class: loss_style
  shape: diamond
}

output_layer: Output Layer {
  class: layer_style
  
  out_neuron1: "Neuron 1" {
    class: neuron_style
  }
  out_neuron2: "Neuron 2" {
    class: neuron_style
  }
  
  out_w11: "w₁₁" {
    class: weight_style
    shape: circle
  }
  out_w12: "w₁₂" {
    class: weight_style
    shape: circle
  }
  out_w21: "w₂₁" {
    class: weight_style
    shape: circle
  }
  out_w22: "w₂₂" {
    class: weight_style
    shape: circle
  }
  out_b1: "b₁" {
    class: weight_style
    shape: circle
  }
  out_b2: "b₂" {
    class: weight_style
    shape: circle
  }
}

hidden_layer: Hidden Layer {
  class: layer_style
  
  hid_neuron1: "Neuron 1" {
    class: neuron_style
  }
  hid_neuron2: "Neuron 2" {
    class: neuron_style
  }
  
  hid_w11: "w₁₁" {
    class: weight_style
    shape: circle
  }
  hid_w12: "w₁₂" {
    class: weight_style
    shape: circle
  }
  hid_w21: "w₂₁" {
    class: weight_style
    shape: circle
  }
  hid_w22: "w₂₂" {
    class: weight_style
    shape: circle
  }
  hid_b1: "b₁" {
    class: weight_style
    shape: circle
  }
  hid_b2: "b₂" {
    class: weight_style
    shape: circle
  }
}

input_layer: Input Layer {
  class: layer_style
  
  inp_neuron1: "Input 1" {
    class: neuron_style
  }
  inp_neuron2: "Input 2" {
    class: neuron_style
  }
}

loss -> output_layer.out_neuron1: "∂L/∂out₁" {
  class: gradient_style
}
loss -> output_layer.out_neuron2: "∂L/∂out₂" {
  class: gradient_style
}

output_layer.out_neuron1 -> output_layer.out_w11: "∂L/∂w₁₁" {
  class: gradient_style
}
output_layer.out_neuron1 -> output_layer.out_w12: "∂L/∂w₁₂" {
  class: gradient_style
}
output_layer.out_neuron1 -> output_layer.out_b1: "∂L/∂b₁" {
  class: gradient_style
}

output_layer.out_neuron2 -> output_layer.out_w21: "∂L/∂w₂₁" {
  class: gradient_style
}
output_layer.out_neuron2 -> output_layer.out_w22: "∂L/∂w₂₂" {
  class: gradient_style
}
output_layer.out_neuron2 -> output_layer.out_b2: "∂L/∂b₂" {
  class: gradient_style
}

output_layer.out_neuron1 -> hidden_layer.hid_neuron1: "Chain rule" {
  class: gradient_style
  style.stroke-dash: 5
}
output_layer.out_neuron2 -> hidden_layer.hid_neuron2: "Chain rule" {
  class: gradient_style
  style.stroke-dash: 5
}

hidden_layer.hid_neuron1 -> hidden_layer.hid_w11: "∂L/∂w₁₁" {
  class: gradient_style
}
hidden_layer.hid_neuron1 -> hidden_layer.hid_w12: "∂L/∂w₁₂" {
  class: gradient_style
}
hidden_layer.hid_neuron1 -> hidden_layer.hid_b1: "∂L/∂b₁" {
  class: gradient_style
}

hidden_layer.hid_neuron2 -> hidden_layer.hid_w21: "∂L/∂w₂₁" {
  class: gradient_style
}
hidden_layer.hid_neuron2 -> hidden_layer.hid_w22: "∂L/∂w₂₂" {
  class: gradient_style
}
hidden_layer.hid_neuron2 -> hidden_layer.hid_b2: "∂L/∂b₂" {
  class: gradient_style
}

title: Gradient Flow Through Network {
  near: top-center
  style.font-size: 24
  style.bold: true
  style.font-color: "#e6edf3"
}