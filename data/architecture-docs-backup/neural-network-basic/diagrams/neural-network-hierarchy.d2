classes: {
  primary: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  secondary: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

title: Neural Network Component Hierarchy {
  near: top-center
  style.font-size: 18
  style.font-color: "#e6edf3"
  style.bold: true
}

MLP: MLP {
  shape: class
  class: primary
  - "layers: List[Layer]"
  + "__init__(nin: int, nouts: List[int])"
  + "__call__(x: Value): List[Value]"
  + "parameters(): List[Value]"
}

Layer: Layer {
  shape: class
  class: primary
  - "neurons: List[Neuron]"
  + "__init__(nin: int, nout: int)"
  + "__call__(x: List[Value]): List[Value]"
  + "parameters(): List[Value]"
}

Neuron: Neuron {
  shape: class
  class: primary
  - "w: List[Value]"
  - "b: Value"
  + "__init__(nin: int)"
  + "__call__(x: List[Value]): Value"
  + "parameters(): List[Value]"
}

Value: Value {
  shape: class
  class: secondary
  - "data: float"
  - "grad: float"
  - "_children: set"
  - "_op: string"
  - "_backward: function"
  + "__init__(data: float, children: tuple, op: string)"
  + "__add__(other: Value): Value"
  + "__mul__(other: Value): Value"
  + "tanh(): Value"
  + "backward(): void"
}

MLP -> Layer: "1..*" {
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

Layer -> Neuron: "1..*" {
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

Neuron -> Value: "weights & bias" {
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

composition_note: |md
  **Composition Hierarchy**
  - MLP contains multiple Layers
  - Layer contains multiple Neurons  
  - Neuron contains Value objects for weights and bias
  - Value enables automatic differentiation
| {
  shape: page
  near: bottom-right
  style.fill: "#0f3460"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}