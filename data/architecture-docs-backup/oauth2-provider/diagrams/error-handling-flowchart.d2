title: OAuth2 Error Response Handling

error_detection: Error Detection {
  shape: diamond
  style.fill: "#d63031"
  style.font-color: "#ffffff"
  style.stroke: "#e17055"
}

classification: Error Classification {
  shape: rectangle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

client_errors: Client Errors (4xx) {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  invalid_request: {
    shape: rectangle
    label: "invalid_request\n(Missing parameters)"
    style.fill: "#d63031"
    style.font-color: "#ffffff"
  }
  
  unauthorized_client: {
    shape: rectangle
    label: "unauthorized_client\n(Client not authorized)"
    style.fill: "#d63031"
    style.font-color: "#ffffff"
  }
  
  access_denied: {
    shape: rectangle
    label: "access_denied\n(User denied access)"
    style.fill: "#d63031"
    style.font-color: "#ffffff"
  }
  
  unsupported_response_type: {
    shape: rectangle
    label: "unsupported_response_type\n(Invalid response type)"
    style.fill: "#d63031"
    style.font-color: "#ffffff"
  }
  
  invalid_scope: {
    shape: rectangle
    label: "invalid_scope\n(Invalid/unknown scope)"
    style.fill: "#d63031"
    style.font-color: "#ffffff"
  }
}

server_errors: Server Errors (5xx) {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  server_error: {
    shape: rectangle
    label: "server_error\n(Internal server error)"
    style.fill: "#fd7e14"
    style.font-color: "#ffffff"
  }
  
  temporarily_unavailable: {
    shape: rectangle
    label: "temporarily_unavailable\n(Service unavailable)"
    style.fill: "#fd7e14"
    style.font-color: "#ffffff"
  }
}

response_formatter: Response Formatter {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

oauth2_response: OAuth2 Error Response {
  shape: class
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  - "error: string (required)"
  - "error_description: string (optional)"
  - "error_uri: string (optional)"
  - "state: string (if provided)"
}

response_delivery: Response Delivery {
  shape: diamond
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

redirect_response: Redirect Response {
  shape: rectangle
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  label: "HTTP 302 Redirect\nto client redirect_uri\nwith error parameters"
}

direct_response: Direct JSON Response {
  shape: rectangle
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  label: "HTTP 400/401/500\nJSON error response"
}

logging: Security Logging {
  shape: cylinder
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

error_detection -> classification: Categorize error type

classification -> client_errors: Client-side errors
classification -> server_errors: Server-side errors

client_errors -> response_formatter
server_errors -> response_formatter

response_formatter -> oauth2_response: Format standardized\nerror response

oauth2_response -> response_delivery: Determine delivery method

response_delivery -> redirect_response: Authorization endpoint\nerrors with valid\nredirect_uri
response_delivery -> direct_response: Token endpoint errors\nor invalid redirect_uri

response_formatter -> logging: Log security events

classes: {
  error_path: {
    style.stroke: "#d63031"
    style.stroke-width: 2
  }
}