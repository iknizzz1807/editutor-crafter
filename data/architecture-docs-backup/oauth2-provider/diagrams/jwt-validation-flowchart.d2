title: JWT Validation Process

classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  decision: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  success: {
    style.fill: "#00b894"
    style.stroke: "#3fb950"
    style.font-color: "#ffffff"
    style.bold: true
  }
  error: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
  start: {
    style.fill: "#3fb950"
    style.stroke: "#00b894"
    style.font-color: "#ffffff"
  }
}

start: Receive JWT Token {
  shape: oval
  class: start
}

extract: Extract Header & Payload {
  class: process
}

parse_check: Valid JSON Structure? {
  shape: diamond
  class: decision
}

parse_error: Invalid Token Format {
  class: error
}

sig_verify: Verify Signature {
  class: process
}

sig_valid: Signature Valid? {
  shape: diamond
  class: decision
}

sig_error: Invalid Signature {
  class: error
}

claims_check: Validate Claims {
  class: process
}

exp_check: Token Expired? {
  shape: diamond
  class: decision
}

exp_error: Token Expired {
  class: error
}

aud_check: Valid Audience? {
  shape: diamond
  class: decision
}

aud_error: Invalid Audience {
  class: error
}

iss_check: Valid Issuer? {
  shape: diamond
  class: decision
}

iss_error: Invalid Issuer {
  class: error
}

revoke_check: Check Revocation List {
  class: process
}

revoked: Token Revoked? {
  shape: diamond
  class: decision
}

revoke_error: Token Revoked {
  class: error
}

success: Token Valid - Grant Access {
  class: success
}

start -> extract
extract -> parse_check
parse_check -> parse_error: No
parse_check -> sig_verify: Yes
sig_verify -> sig_valid
sig_valid -> sig_error: No
sig_valid -> claims_check: Yes
claims_check -> exp_check
exp_check -> exp_error: Yes
exp_check -> aud_check: No
aud_check -> aud_error: No
aud_check -> iss_check: Yes
iss_check -> iss_error: No
iss_check -> revoke_check: Yes
revoke_check -> revoked
revoked -> revoke_error: Yes
revoked -> success: No