classes: {
  detection: {
    style.fill: "#0f3460"
    style.stroke: "#f39c12"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  classification: {
    style.fill: "#1a1a2e"
    style.stroke: "#e74c3c"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  recovery: {
    style.fill: "#16213e"
    style.stroke: "#27ae60"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  decision: {
    style.fill: "#2c3e50"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  critical: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
}

detection_layer: Error Detection Layer {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  validation: Input Validation {
    class: detection
  }
  
  integrity: Data Integrity Check {
    class: detection
  }
  
  heartbeat: System Heartbeat {
    class: detection
  }
  
  timeout: Timeout Monitor {
    class: detection
  }
}

error_detected: Error Detected {
  shape: diamond
  class: decision
}

classification: Error Classification {
  class: classification
}

severity_check: Severity Level? {
  shape: diamond
  class: decision
}

failure_types: Failure Type Analysis {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  order_error: Order Validation Error {
    class: classification
  }
  
  state_corruption: State Corruption {
    class: critical
  }
  
  network_failure: Network Failure {
    class: classification
  }
  
  system_overload: System Overload {
    class: classification
  }
}

recovery_strategies: Recovery Strategies {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  graceful_degradation: Graceful Degradation {
    class: recovery
  }
  
  circuit_breaker: Circuit Breaker {
    class: recovery
  }
  
  state_restore: State Restoration {
    class: recovery
  }
  
  failover: System Failover {
    class: critical
  }
}

audit_log: Audit & Logging {
  class: recovery
  shape: cylinder
}

monitoring: Real-time Monitoring {
  class: detection
  shape: cloud
}

recovery_success: Recovery Successful? {
  shape: diamond
  class: decision
}

escalation: Manual Escalation {
  class: critical
}

normal_operation: Resume Normal Operation {
  class: recovery
  shape: oval
}

detection_layer.validation -> error_detected: Error Found
detection_layer.integrity -> error_detected: Corruption Detected
detection_layer.heartbeat -> error_detected: Missed Heartbeat
detection_layer.timeout -> error_detected: Timeout Exceeded

error_detected -> classification: Analyze Error

classification -> severity_check: Classify

severity_check -> failure_types.order_error: Low Severity
severity_check -> failure_types.state_corruption: Critical
severity_check -> failure_types.network_failure: Medium
severity_check -> failure_types.system_overload: High

failure_types.order_error -> recovery_strategies.graceful_degradation: Handle Gracefully
failure_types.network_failure -> recovery_strategies.circuit_breaker: Break Circuit
failure_types.system_overload -> recovery_strategies.circuit_breaker: Throttle
failure_types.state_corruption -> recovery_strategies.state_restore: Emergency Restore

recovery_strategies.graceful_degradation -> recovery_success: Attempt Recovery
recovery_strategies.circuit_breaker -> recovery_success: Try Recovery
recovery_strategies.state_restore -> recovery_success: Restore from Backup
recovery_strategies.failover -> recovery_success: Switch Systems

recovery_success -> normal_operation: Yes
recovery_success -> escalation: No

escalation -> recovery_strategies.failover: Trigger Failover

classification -> audit_log: Log Error Details
recovery_strategies.graceful_degradation -> audit_log: Log Recovery
recovery_strategies.circuit_breaker -> audit_log: Log Actions
recovery_strategies.state_restore -> audit_log: Log Restoration
recovery_strategies.failover -> audit_log: Log Failover

monitoring -> detection_layer.heartbeat: Monitor Health
monitoring -> detection_layer.timeout: Track Timeouts
monitoring -> audit_log: Stream Metrics

normal_operation -> monitoring: Continue Monitoring