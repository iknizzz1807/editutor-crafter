classes: {
  process: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  decision: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  output: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  filter: {
    style.fill: "#2d1b69"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

parsed_packets: Parsed Packets {
  class: process
}

bpf_filter: BPF Filter {
  shape: diamond
  class: filter
}

bpf_match: BPF Match? {
  shape: diamond
  class: decision
}

display_filter: Display Filter {
  shape: diamond
  class: filter
}

display_match: Display Match? {
  shape: diamond
  class: decision
}

format_selection: Output Format Selection {
  shape: diamond
  class: decision
}

text_formatter: Text Formatter {
  class: process
}

json_formatter: JSON Formatter {
  class: process
}

pcap_formatter: PCAP Formatter {
  class: process
}

hex_formatter: Hex Dump Formatter {
  class: process
}

console_output: Console Output {
  class: output
}

file_output: File Output {
  class: output
}

dropped: Dropped {
  class: output
  style.fill: "#d63031"
}

parsed_packets -> bpf_filter: Apply BPF
bpf_filter -> bpf_match: Evaluate
bpf_match -> dropped: No Match
bpf_match -> display_filter: Match
display_filter -> display_match: Evaluate
display_match -> dropped: No Match
display_match -> format_selection: Match

format_selection -> text_formatter: Text
format_selection -> json_formatter: JSON
format_selection -> pcap_formatter: PCAP
format_selection -> hex_formatter: Hex

text_formatter -> console_output
text_formatter -> file_output
json_formatter -> console_output
json_formatter -> file_output
pcap_formatter -> file_output
hex_formatter -> console_output
hex_formatter -> file_output