title: Error Handling Decision Flow {
  near: top-center
  style.font-size: 18
  style.bold: true
  style.font-color: "#e6edf3"
}

classes: {
  decision: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  process: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  error: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
  success: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

start: Start {
  shape: circle
  class: success
}

validate_input: Validate Input Parameters {
  shape: diamond
  class: decision
}

check_algo: Check Algorithm Availability {
  shape: diamond
  class: decision
}

verify_salt: Verify Salt Integrity {
  shape: diamond
  class: decision
}

check_hash: Check Hash Corruption {
  shape: diamond
  class: decision
}

missing_params: Missing Required Parameters {
  class: error
}

invalid_algo: Invalid Algorithm Specified {
  class: error
}

corrupted_salt: Corrupted Salt Data {
  class: error
}

corrupted_hash: Corrupted Hash Data {
  class: error
}

log_error: Log Security Event {
  class: process
}

return_generic: Return Generic Error {
  class: process
}

fallback_algo: Use Fallback Algorithm {
  class: process
}

regenerate_salt: Regenerate Salt {
  class: process
}

rehash: Rehash with New Salt {
  class: process
}

proceed: Proceed with Operation {
  class: success
}

secure_fail: Secure Failure Mode {
  class: error
}

start -> validate_input

validate_input -> missing_params: Invalid/Missing
validate_input -> check_algo: Valid

check_algo -> invalid_algo: Not Available
check_algo -> verify_salt: Available

verify_salt -> corrupted_salt: Corrupted
verify_salt -> check_hash: Valid

check_hash -> corrupted_hash: Corrupted
check_hash -> proceed: Valid

missing_params -> log_error
invalid_algo -> fallback_algo
corrupted_salt -> regenerate_salt
corrupted_hash -> rehash

log_error -> return_generic
return_generic -> secure_fail

fallback_algo -> verify_salt
regenerate_salt -> check_hash
rehash -> proceed

error_note: |md
  ## Security Principles
  - **No information leakage** in error messages
  - **Fail securely** with generic responses
  - **Log security events** for monitoring
  - **Graceful degradation** when possible
| {
  shape: page
  near: bottom-left
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}