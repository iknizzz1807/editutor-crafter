title: PBKDF2 Key Derivation Process

classes: {
  input_style: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  process_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  decision_style: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  output_style: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}

password: Password Input {
  shape: rectangle
  class: input_style
}

salt: Salt {
  shape: rectangle
  class: input_style
}

iterations: Iteration Count\n(e.g., 100,000) {
  shape: rectangle
  class: input_style
}

init: Initialize PBKDF2 {
  shape: rectangle
  class: process_style
}

u1: U1 = HMAC(Password, Salt || 1) {
  shape: rectangle
  class: process_style
}

counter: i = 1 {
  shape: rectangle
  class: process_style
}

hmac_round: Ui = HMAC(Password, Ui-1) {
  shape: rectangle
  class: process_style
}

xor_accumulate: T1 = T1 ⊕ Ui {
  shape: rectangle
  class: process_style
}

increment: i = i + 1 {
  shape: rectangle
  class: process_style
}

check_iterations: i ≤ iterations? {
  shape: diamond
  class: decision_style
}

derived_key: Derived Key = T1 {
  shape: rectangle
  class: output_style
}

password -> init
salt -> init
iterations -> init

init -> u1: First HMAC

u1 -> counter: Set counter
u1 -> xor_accumulate: T1 = U1

counter -> hmac_round

hmac_round -> xor_accumulate: XOR with accumulator

xor_accumulate -> increment

increment -> check_iterations

check_iterations -> hmac_round: Yes {
  style.stroke: "#3fb950"
}

check_iterations -> derived_key: No {
  style.stroke: "#e17055"
}

iteration_note: |md
  **Key Security Properties:**
  
  • Each round depends on previous
  • Cannot be parallelized
  • Computational cost scales linearly
  • Same effort for attacker and user
| {
  shape: page
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
  near: top-right
}