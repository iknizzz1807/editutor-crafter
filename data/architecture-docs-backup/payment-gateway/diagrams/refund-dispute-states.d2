title: Refund and Dispute State Machines {
  near: top-center
  style.font-size: 20
  style.bold: true
  style.font-color: "#e6edf3"
}

classes: {
  state_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  
  start_state: {
    style.fill: "#3fb950"
    style.stroke: "#3fb950"
    style.font-color: "#ffffff"
  }
  
  success_state: {
    style.fill: "#00b894"
    style.stroke: "#3fb950"
    style.font-color: "#ffffff"
    style.bold: true
  }
  
  error_state: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
  
  warning_state: {
    style.fill: "#fdcb6e"
    style.stroke: "#e17055"
    style.font-color: "#2d3436"
    style.bold: true
  }
  
  transition_style: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

refund_system: Refund Processing State Machine {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  refund_init: {
    shape: circle
    class: start_state
    label: ""
  }
  
  refund_pending: Pending {
    shape: circle
    class: state_style
  }
  
  refund_succeeded: Succeeded {
    shape: circle
    class: success_state
    style.double-border: true
  }
  
  refund_failed: Failed {
    shape: circle
    class: error_state
    style.double-border: true
  }
  
  refund_init -> refund_pending: Create Refund {
    class: transition_style
  }
  
  refund_pending -> refund_succeeded: Payment Provider Success {
    class: transition_style
  }
  
  refund_pending -> refund_failed: Payment Provider Error {
    class: transition_style
  }
  
  refund_pending -> refund_pending: Processing... {
    class: transition_style
  }
}

dispute_system: Dispute Handling State Machine {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  dispute_init: {
    shape: circle
    class: start_state
    label: ""
  }
  
  warning_needs_response: Warning Needs Response {
    shape: circle
    class: warning_state
  }
  
  under_review: Under Review {
    shape: circle
    class: state_style
  }
  
  charge_refunded: Charge Refunded {
    shape: circle
    class: error_state
    style.double-border: true
  }
  
  dispute_resolved: Dispute Won {
    shape: circle
    class: success_state
    style.double-border: true
  }
  
  dispute_init -> warning_needs_response: Dispute Created {
    class: transition_style
  }
  
  warning_needs_response -> under_review: Evidence Submitted {
    class: transition_style
  }
  
  warning_needs_response -> charge_refunded: No Response / Accept {
    class: transition_style
  }
  
  under_review -> dispute_resolved: Dispute Won {
    class: transition_style
  }
  
  under_review -> charge_refunded: Dispute Lost {
    class: transition_style
  }
  
  under_review -> under_review: Additional Evidence {
    class: transition_style
  }
}

legend: State Legend {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  near: bottom-right
  
  legend_start: Initial State {
    shape: circle
    class: start_state
  }
  
  legend_process: Processing {
    shape: circle
    class: state_style
  }
  
  legend_success: Success {
    shape: circle
    class: success_state
    style.double-border: true
  }
  
  legend_warning: Warning {
    shape: circle
    class: warning_state
  }
  
  legend_error: Failed/Lost {
    shape: circle
    class: error_state
    style.double-border: true
  }
}