direction: down

classes: {
  container: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  process: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  decision: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  data: {
    style.fill: "#2d3748"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  feedback: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
}

title: Evaluation and Optimization Pipeline {
  class: container
  near: top-center
}

dataset_creation: Dataset Creation {
  class: container
  
  ground_truth: Ground Truth Dataset {
    class: data
    shape: cylinder
  }
  
  synthetic_gen: Synthetic Data Generator {
    class: process
  }
  
  human_annotation: Human Annotation {
    class: process
  }
  
  dataset_validation: Dataset Validation {
    class: process
  }
  
  synthetic_gen -> ground_truth: generates samples
  human_annotation -> ground_truth: validates & labels
  dataset_validation -> ground_truth: quality check
}

metrics_computation: Metrics Computation {
  class: container
  
  retrieval_metrics: Retrieval Metrics {
    class: process
    
    precision: "• Precision@K\n• Recall@K\n• NDCG"
  }
  
  generation_metrics: Generation Metrics {
    class: process
    
    quality: "• ROUGE\n• BLEU\n• Semantic Similarity\n• Faithfulness"
  }
  
  combined_metrics: Combined Metrics {
    class: process
    
    end_to_end: "• Answer Relevance\n• Context Utilization\n• Factual Accuracy"
  }
}

ab_testing: A/B Testing Setup {
  class: container
  
  traffic_split: Traffic Splitter {
    class: decision
    shape: diamond
  }
  
  variant_a: Variant A {
    class: process
  }
  
  variant_b: Variant B {
    class: process
  }
  
  results_collector: Results Collector {
    class: process
  }
  
  statistical_test: Statistical Testing {
    class: process
  }
  
  traffic_split -> variant_a: 50%
  traffic_split -> variant_b: 50%
  variant_a -> results_collector: metrics
  variant_b -> results_collector: metrics
  results_collector -> statistical_test: analyze
}

optimization: Optimization Feedback {
  class: container
  
  performance_analysis: Performance Analysis {
    class: process
  }
  
  improvement_check: Significant Improvement? {
    class: decision
    shape: diamond
  }
  
  deploy_changes: Deploy Changes {
    class: feedback
  }
  
  rollback: Rollback & Iterate {
    class: feedback
  }
  
  parameter_tuning: Parameter Tuning {
    class: process
  }
  
  performance_analysis -> improvement_check: evaluate results
  improvement_check -> deploy_changes: Yes
  improvement_check -> rollback: No
  rollback -> parameter_tuning: adjust parameters
}

dataset_creation.ground_truth -> metrics_computation.retrieval_metrics: evaluation data
dataset_creation.ground_truth -> metrics_computation.generation_metrics: reference answers

metrics_computation.retrieval_metrics -> ab_testing.traffic_split: baseline metrics
metrics_computation.generation_metrics -> ab_testing.traffic_split: baseline metrics
metrics_computation.combined_metrics -> ab_testing.traffic_split: baseline metrics

ab_testing.statistical_test -> optimization.performance_analysis: test results
optimization.parameter_tuning -> metrics_computation.retrieval_metrics: new configuration
optimization.deploy_changes -> ab_testing.traffic_split: production update