title: Role Hierarchy Structure

classes: {
  admin_style: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
  manager_style: {
    style.fill: "#fdcb6e"
    style.stroke: "#e17055"
    style.font-color: "#2d3436"
    style.bold: true
  }
  employee_style: {
    style.fill: "#74b9ff"
    style.stroke: "#0984e3"
    style.font-color: "#ffffff"
  }
  viewer_style: {
    style.fill: "#a29bfe"
    style.stroke: "#6c5ce7"
    style.font-color: "#ffffff"
  }
  validation_style: {
    style.fill: "#00b894"
    style.stroke: "#00a085"
    style.font-color: "#ffffff"
    style.bold: true
  }
  container_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

hierarchy: Role Hierarchy {
  class: container_style
  
  admin: Admin {
    shape: circle
    class: admin_style
  }
  
  manager: Manager {
    shape: circle
    class: manager_style
  }
  
  employee: Employee {
    shape: circle
    class: employee_style
  }
  
  viewer: Viewer {
    shape: circle
    class: viewer_style
  }
  
  admin -> manager: inherits from
  manager -> employee: inherits from
  employee -> viewer: inherits from
}

permissions: Permission Flow {
  class: container_style
  
  admin_perms: "• Create/Delete\n• Modify Roles\n• System Config\n• All Lower Perms" {
    shape: page
    style.fill: "#d63031"
    style.font-color: "#ffffff"
  }
  
  manager_perms: "• Manage Team\n• Approve Requests\n• View Reports\n• All Lower Perms" {
    shape: page
    style.fill: "#fdcb6e"
    style.font-color: "#2d3436"
  }
  
  employee_perms: "• Edit Own Data\n• Submit Requests\n• Access Resources\n• All Lower Perms" {
    shape: page
    style.fill: "#74b9ff"
    style.font-color: "#ffffff"
  }
  
  viewer_perms: "• Read-Only Access\n• View Public Data" {
    shape: page
    style.fill: "#a29bfe"
    style.font-color: "#ffffff"
  }
}

validation: Cycle Detection {
  class: container_style
  
  validator: Cycle Detector {
    shape: diamond
    class: validation_style
  }
  
  dag_check: DAG Validation {
    shape: hexagon
    class: validation_style
  }
  
  error_state: Circular Reference\nDetected {
    shape: parallelogram
    style.fill: "#e17055"
    style.stroke: "#d63031"
    style.font-color: "#ffffff"
  }
  
  validator -> dag_check: validate hierarchy
  dag_check -> error_state: if cycle found
}

hierarchy.admin -> permissions.admin_perms: grants
hierarchy.manager -> permissions.manager_perms: grants
hierarchy.employee -> permissions.employee_perms: grants
hierarchy.viewer -> permissions.viewer_perms: grants

hierarchy -> validation.validator: validated by {
  style.stroke: "#00b894"
  style.stroke-dash: 3
}

note: |md
  ## Role Inheritance Rules
  - Higher roles inherit ALL permissions from lower roles
  - DAG structure prevents circular dependencies
  - Real-time cycle detection on role modifications
  - Permission accumulation flows upward
| {
  shape: page
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  near: bottom-right
}