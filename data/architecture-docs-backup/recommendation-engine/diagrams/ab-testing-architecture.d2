title: A/B Testing and Experimentation Framework

classes: {
  container: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  component: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  storage: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  important: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}

experiment_config: Experiment Configuration {
  class: container
  
  config_mgmt: Config Management {
    class: component
  }
  
  variant_def: Variant Definitions {
    class: component
  }
  
  rules_engine: Assignment Rules {
    class: component
  }
  
  config_mgmt -> variant_def: defines variants
  config_mgmt -> rules_engine: sets rules
}

user_assignment: User Assignment System {
  class: container
  
  traffic_splitter: Traffic Splitter {
    class: important
  }
  
  hash_service: Hash Service {
    class: component
  }
  
  assignment_cache: Assignment Cache {
    class: storage
    shape: cylinder
  }
  
  traffic_splitter -> hash_service: user hashing
  hash_service -> assignment_cache: cache assignments
}

algorithm_variants: Algorithm Variants {
  class: container
  
  variant_a: Collaborative Filtering {
    class: component
  }
  
  variant_b: Matrix Factorization {
    class: component
  }
  
  variant_c: Content-Based {
    class: component
  }
  
  variant_d: Hybrid Approach {
    class: component
  }
}

metric_collection: Metric Collection {
  class: container
  
  event_tracker: Event Tracker {
    class: important
  }
  
  metrics_aggregator: Metrics Aggregator {
    class: component
  }
  
  experiment_db: Experiment Database {
    class: storage
    shape: cylinder
  }
  
  event_tracker -> metrics_aggregator: raw events
  metrics_aggregator -> experiment_db: aggregated metrics
}

analysis_reporting: Analysis & Reporting {
  class: container
  
  stat_engine: Statistical Engine {
    class: important
  }
  
  significance_test: Significance Testing {
    class: component
  }
  
  dashboard: Results Dashboard {
    class: component
  }
  
  stat_engine -> significance_test: statistical analysis
  significance_test -> dashboard: test results
}

user_request: User Request {
  class: component
  shape: oval
}

# Main flow connections
user_request -> user_assignment: incoming request
experiment_config -> user_assignment: experiment rules
user_assignment -> algorithm_variants: route to variant

algorithm_variants -> metric_collection: track interactions
algorithm_variants -> user_request: recommendations {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}

metric_collection -> analysis_reporting: experiment data
analysis_reporting -> experiment_config: optimization feedback {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}

# Internal connections
experiment_config.rules_engine -> user_assignment.traffic_splitter: assignment logic
user_assignment.assignment_cache -> algorithm_variants: variant selection

notes: |md
  ## Key Components
  - **Traffic Splitter**: Assigns users to experiment variants
  - **Variant Systems**: Different recommendation algorithms
  - **Event Tracker**: Captures user interactions and outcomes
  - **Statistical Engine**: Analyzes experiment results
| {
  shape: page
  class: storage
  near: bottom-right
}