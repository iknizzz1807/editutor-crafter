title: Collaborative Filtering Process

classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  
  decision: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  data: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  
  cold_start: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
}

start: Start {
  shape: circle
  class: process
}

user_data: Collect User\nInteraction Data {
  class: data
}

matrix_construction: Construct User-Item\nMatrix {
  class: process
}

sparsity_check: Check Data\nSparsity {
  shape: diamond
  class: decision
}

cold_start_detection: New User/Item? {
  shape: diamond
  class: decision
}

cold_start_handler: Cold Start Handler {
  class: cold_start
  
  popular_items: Recommend\nPopular Items {
    class: cold_start
  }
  
  demographic: Use Demographic\nFiltering {
    class: cold_start
  }
  
  content_based: Apply Content-Based\nFallback {
    class: cold_start
  }
}

similarity_computation: Similarity Computation {
  class: process
  
  cosine: Cosine Similarity\ncos(u,v) = u·v/(||u|| ||v||) {
    class: process
  }
  
  pearson: Pearson Correlation\nr = Σ(x-x̄)(y-ȳ)/√(Σ(x-x̄)²Σ(y-ȳ)²) {
    class: process
  }
}

neighborhood_selection: Select K-Nearest\nNeighbors {
  class: process
}

rating_prediction: Rating Prediction {
  class: process
}

confidence_check: Sufficient\nConfidence? {
  shape: diamond
  class: decision
}

recommendations: Generate\nRecommendations {
  class: process
}

end: End {
  shape: circle
  class: process
}

# Main flow
start -> user_data
user_data -> matrix_construction
matrix_construction -> sparsity_check

# Cold start branch
sparsity_check -> cold_start_detection: High Sparsity
cold_start_detection -> cold_start_handler: Yes

cold_start_handler.popular_items -> recommendations
cold_start_handler.demographic -> recommendations  
cold_start_handler.content_based -> recommendations

# Normal processing flow
sparsity_check -> similarity_computation: Sufficient Data
cold_start_detection -> similarity_computation: No

# Similarity methods
similarity_computation.cosine -> neighborhood_selection
similarity_computation.pearson -> neighborhood_selection

neighborhood_selection -> rating_prediction
rating_prediction -> confidence_check

# Confidence check
confidence_check -> recommendations: Yes
confidence_check -> cold_start_handler: No

recommendations -> end