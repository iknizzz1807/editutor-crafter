title: Data Model and Entity Relationships

classes: {
  entity: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  matrix: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  feature: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

core_entities: Core Entities {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"

  user: User {
    shape: class
    class: entity
    "- user_id: string"
    "- email: string"
    "- created_at: timestamp"
    "- demographics: Dict"
    "- preferences: List[string]"
    "+ get_interactions(): List[Interaction]"
    "+ get_features(): UserFeatures"
  }

  item: Item {
    shape: class
    class: entity
    "- item_id: string"
    "- title: string"
    "- category: string"
    "- tags: List[string]"
    "- metadata: Dict"
    "- created_at: timestamp"
    "+ get_interactions(): List[Interaction]"
    "+ get_features(): ItemFeatures"
  }

  interaction: Interaction {
    shape: class
    class: entity
    "- user_id: string"
    "- item_id: string"
    "- rating: float"
    "- timestamp: timestamp"
    "- interaction_type: string"
    "- implicit_feedback: float"
    "+ is_positive(): bool"
    "+ get_weight(): float"
  }
}

model_structures: Model Data Structures {
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"

  similarity_matrix: SimilarityMatrix {
    shape: class
    class: matrix
    "- matrix: sparse_matrix"
    "- user_index: Dict[string, int]"
    "- item_index: Dict[string, int]"
    "- similarity_type: string"
    "+ get_similar_users(user_id: string): List[Tuple]"
    "+ get_similar_items(item_id: string): List[Tuple]"
    "+ compute_similarity(): void"
  }

  latent_factors: LatentFactorMatrix {
    shape: class
    class: matrix
    "- user_factors: ndarray[n_users, n_factors]"
    "- item_factors: ndarray[n_items, n_factors]"
    "- n_factors: int"
    "- regularization: float"
    "+ factorize(interactions: Matrix): void"
    "+ predict(user_id: string, item_id: string): float"
    "+ get_user_vector(user_id: string): ndarray"
  }

  interaction_matrix: InteractionMatrix {
    shape: class
    class: matrix
    "- matrix: sparse_matrix[n_users, n_items]"
    "- user_mapping: Dict[string, int]"
    "- item_mapping: Dict[string, int]"
    "- is_implicit: bool"
    "+ add_interaction(user_id: string, item_id: string, rating: float): void"
    "+ get_user_vector(user_id: string): sparse_vector"
    "+ get_sparsity(): float"
  }
}

feature_vectors: Feature Vectors {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"

  user_features: UserFeatures {
    shape: class
    class: feature
    "- user_id: string"
    "- demographic_vector: ndarray"
    "- preference_vector: ndarray"
    "- behavior_vector: ndarray"
    "- embedding: ndarray"
    "+ extract_features(user: User): ndarray"
    "+ normalize(): void"
    "+ get_feature_names(): List[string]"
  }

  item_features: ItemFeatures {
    shape: class
    class: feature
    "- item_id: string"
    "- content_vector: ndarray"
    "- category_vector: ndarray"
    "- tag_vector: ndarray"
    "- embedding: ndarray"
    "+ extract_features(item: Item): ndarray"
    "+ compute_tfidf(): sparse_matrix"
    "+ get_feature_names(): List[string]"
  }

  content_features: ContentFeatures {
    shape: class
    class: feature
    "- feature_matrix: sparse_matrix"
    "- vocabulary: Dict[string, int]"
    "- tfidf_transformer: TfidfTransformer"
    "- feature_names: List[string]"
    "+ vectorize_text(text: string): sparse_vector"
    "+ fit_transform(documents: List[string]): sparse_matrix"
    "+ get_similarity(vec1: ndarray, vec2: ndarray): float"
  }
}

core_entities.user -> core_entities.interaction: creates
core_entities.item -> core_entities.interaction: receives
core_entities.interaction -> model_structures.interaction_matrix: populates

core_entities.interaction -> model_structures.similarity_matrix: computes from
model_structures.interaction_matrix -> model_structures.latent_factors: factorizes into
core_entities.user -> feature_vectors.user_features: extracts to
core_entities.item -> feature_vectors.item_features: extracts to

feature_vectors.item_features -> feature_vectors.content_features: uses
model_structures.latent_factors -> feature_vectors.user_features: enriches
model_structures.latent_factors -> feature_vectors.item_features: enriches

model_structures.similarity_matrix <-> feature_vectors.user_features: user similarity
model_structures.similarity_matrix <-> feature_vectors.item_features: item similarity