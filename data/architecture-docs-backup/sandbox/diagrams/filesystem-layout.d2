title: Isolated Filesystem Layout

classes: {
  container: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  essential: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  mounted: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
    style.stroke-dash: 3
  }
  restricted: {
    style.fill: "#2d1b69"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
  }
}

sandbox_root: Sandbox Root (/) {
  class: container
  
  bin: /bin {
    class: essential
    sh: sh
    cat: cat
    ls: ls
    echo: echo
  }
  
  lib: /lib {
    class: essential
    libc: libc.so.6
    libdl: libdl.so.2
    loader: ld-linux.so.2
  }
  
  proc: /proc {
    class: mounted
    label: /proc\n(mounted procfs)
    version: version
    cpuinfo: cpuinfo
    meminfo: meminfo
  }
  
  dev: /dev {
    class: mounted
    label: /dev\n(minimal devfs)
    null: null
    zero: zero
    urandom: urandom
  }
  
  tmp: /tmp {
    class: essential
    label: /tmp\n(writable)
  }
  
  etc: /etc {
    class: essential
    passwd: passwd
    group: group
    hosts: hosts
  }
}

host_system: Host System {
  class: restricted
  
  real_root: Real Root (/) {
    class: restricted
    real_bin: /bin
    real_lib: /lib
    real_usr: /usr
    real_var: /var
    real_home: /home
  }
}

chroot_barrier: chroot() Barrier {
  shape: diamond
  style.fill: "#d63031"
  style.font-color: "#ffffff"
  style.bold: true
}

sandbox_root -> chroot_barrier: process view
chroot_barrier -> host_system: blocked access {style.stroke: "#d63031"; style.stroke-dash: 5}

note: |md
  ## Filesystem Isolation Strategy
  
  **Essential Directories**: Minimal binaries and libraries
  **Mounted Filesystems**: Virtual filesystems (proc, dev)  
  **Access Control**: chroot() prevents escape to host
  **Principle**: Convincing but restricted environment
| {
  shape: page
  near: top-right
  style.fill: "#16213e"
  style.font-color: "#e6edf3"
}