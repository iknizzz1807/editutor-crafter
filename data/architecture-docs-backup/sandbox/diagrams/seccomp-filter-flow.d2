title: Seccomp BPF Filter Evaluation {
  near: top-center
  style.font-size: 18
  style.bold: true
  style.font-color: "#e6edf3"
}

classes: {
  process_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  decision_style: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  
  action_style: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  
  kill_style: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
  
  allow_style: {
    style.fill: "#00b894"
    style.stroke: "#00cec9"
    style.font-color: "#ffffff"
    style.bold: true
  }
}

syscall: System Call Made {
  shape: rectangle
  class: process_style
}

bpf_entry: Enter BPF Program {
  shape: rectangle
  class: process_style
}

load_args: Load Syscall Arguments {
  shape: rectangle
  class: action_style
}

check_syscall: Check Syscall Number {
  shape: diamond
  class: decision_style
}

check_args: Check Arguments {
  shape: diamond
  class: decision_style
}

decision: Make Decision {
  shape: diamond
  class: decision_style
}

allow_action: SECCOMP_RET_ALLOW {
  shape: rectangle
  class: allow_style
}

errno_action: SECCOMP_RET_ERRNO {
  shape: rectangle
  class: action_style
}

kill_action: SECCOMP_RET_KILL {
  shape: rectangle
  class: kill_style
}

continue_exec: Continue Execution {
  shape: rectangle
  class: allow_style
}

return_error: Return Error Code {
  shape: rectangle
  class: action_style
}

terminate: Terminate Process {
  shape: rectangle
  class: kill_style
}

syscall -> bpf_entry: intercept {
  style.stroke: "#8b949e"
}

bpf_entry -> load_args {
  style.stroke: "#8b949e"
}

load_args -> check_syscall {
  style.stroke: "#8b949e"
}

check_syscall -> check_args: allowed syscall {
  style.stroke: "#8b949e"
}

check_syscall -> decision: blocked syscall {
  style.stroke: "#8b949e"
}

check_args -> decision {
  style.stroke: "#8b949e"
}

decision -> allow_action: ALLOW {
  style.stroke: "#00b894"
}

decision -> errno_action: ERRNO {
  style.stroke: "#fdcb6e"
}

decision -> kill_action: KILL {
  style.stroke: "#d63031"
}

allow_action -> continue_exec {
  style.stroke: "#00b894"
}

errno_action -> return_error {
  style.stroke: "#fdcb6e"
}

kill_action -> terminate {
  style.stroke: "#d63031"
}