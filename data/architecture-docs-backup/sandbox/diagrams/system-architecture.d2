title: System Architecture Overview

# Define component styling
classes: {
  core_component: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  
  orchestrator: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    style.double-border: true
  }
  
  sandboxed: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
    style.stroke-dash: 3
  }
  
  system_resource: {
    style.fill: "#2d3748"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

# Main orchestrator
orchestrator: Sandbox Orchestrator {
  class: orchestrator
}

# Core security components
security_layer: Security Layer {
  class: core_component
  
  namespace_mgr: Namespace Manager {
    class: core_component
  }
  
  filesystem_iso: Filesystem Isolator {
    class: core_component
  }
  
  seccomp_filter: Seccomp Filter {
    class: core_component
  }
  
  cgroup_mgr: Cgroup Manager {
    class: core_component
  }
  
  capability_dropper: Capability Dropper {
    class: core_component
  }
}

# Sandboxed environment
sandbox_env: Sandboxed Environment {
  class: sandboxed
  
  untrusted_process: Untrusted Process {
    class: sandboxed
    shape: circle
  }
  
  isolated_view: Isolated System View {
    class: sandboxed
    
    virtual_fs: Virtual Filesystem {
      class: sandboxed
    }
    
    limited_syscalls: Limited Syscalls {
      class: sandboxed
    }
    
    restricted_caps: Restricted Capabilities {
      class: sandboxed
    }
  }
}

# Host system resources
host_system: Host System Resources {
  class: system_resource
  
  real_fs: Real Filesystem {
    class: system_resource
    shape: cylinder
  }
  
  kernel: Kernel {
    class: system_resource
  }
  
  hardware: Hardware {
    class: system_resource
  }
}

# Orchestrator manages all security components
orchestrator -> security_layer.namespace_mgr: Configure namespaces
orchestrator -> security_layer.filesystem_iso: Setup filesystem isolation
orchestrator -> security_layer.seccomp_filter: Apply syscall filtering
orchestrator -> security_layer.cgroup_mgr: Enforce resource limits
orchestrator -> security_layer.capability_dropper: Drop privileges

# Security layer creates sandbox
security_layer -> sandbox_env: Creates isolated environment

# Namespace manager creates isolated view
security_layer.namespace_mgr -> sandbox_env.isolated_view: Creates namespace isolation

# Filesystem isolator limits file access
security_layer.filesystem_iso -> sandbox_env.isolated_view.virtual_fs: Provides restricted filesystem view

# Seccomp filters syscalls
security_layer.seccomp_filter -> sandbox_env.isolated_view.limited_syscalls: Blocks dangerous syscalls

# Capability dropper restricts permissions
security_layer.capability_dropper -> sandbox_env.isolated_view.restricted_caps: Removes privileges

# Cgroup manager monitors resources
security_layer.cgroup_mgr -> sandbox_env.untrusted_process: Limits CPU/memory

# Process interacts with isolated view
sandbox_env.untrusted_process -> sandbox_env.isolated_view: Sees only isolated resources

# Host system provides underlying resources
host_system.real_fs -> security_layer.filesystem_iso: Real filesystem access
host_system.kernel -> security_layer.seccomp_filter: Syscall interception
host_system.hardware -> security_layer.cgroup_mgr: Resource monitoring