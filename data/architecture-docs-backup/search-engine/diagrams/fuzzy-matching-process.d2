title: Fuzzy Search Algorithm

classes: {
  container_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950" 
    style.font-color: "#e6edf3"
  }
  process_style: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  decision_style: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  data_style: {
    style.fill: "#2d1b69"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

start: Start {
  shape: circle
  style.fill: "#3fb950"
  style.font-color: "#000"
  label: ""
}

query_input: Query Term Input {
  class: process_style
}

length_filter: Length-based\nPre-filtering {
  class: process_style
}

ngram_extraction: Extract N-grams\nfrom Query {
  class: process_style
}

ngram_lookup: N-gram Index\nLookup {
  class: process_style
}

candidate_gen: Generate\nCandidate Terms {
  class: process_style
}

has_candidates: Has\nCandidates? {
  shape: diamond
  class: decision_style
}

edit_distance: Calculate Edit\nDistance {
  class: process_style
}

distance_filter: Distance <=\nThreshold? {
  shape: diamond
  class: decision_style
}

score_calc: Calculate\nFuzzy Score {
  class: process_style
}

collect_results: Collect\nMatched Terms {
  class: process_style
}

rank_results: Rank by\nSimilarity Score {
  class: process_style
}

return_matches: Return\nFuzzy Matches {
  class: process_style
}

no_matches: Return\nNo Matches {
  class: process_style
}

# Data stores
ngram_index: N-gram Index {
  shape: cylinder
  class: data_style
}

vocab: Term Vocabulary {
  shape: cylinder
  class: data_style
}

# Flow connections
start -> query_input
query_input -> length_filter: term
length_filter -> ngram_extraction: length constraints
ngram_extraction -> ngram_lookup: n-grams
ngram_lookup -> ngram_index
ngram_index -> candidate_gen: matching terms
candidate_gen -> has_candidates
has_candidates -> edit_distance: Yes
has_candidates -> no_matches: No
edit_distance -> distance_filter: Levenshtein distance
distance_filter -> score_calc: Yes
distance_filter -> collect_results: No (skip)
score_calc -> collect_results: weighted score
collect_results -> rank_results
rank_results -> return_matches

# Data access
ngram_lookup <-> ngram_index: query
edit_distance <-> vocab: lookup terms

container: Fuzzy Matching Pipeline {
  class: container_style
}