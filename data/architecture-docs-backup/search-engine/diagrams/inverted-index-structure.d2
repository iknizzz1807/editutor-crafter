# Inverted Index Data Model
direction: right

classes: {
  container_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  class_style: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  example_style: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  
  highlight_style: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}

# Core Data Structures
core: Core Data Model {
  class: container_style
  
  Document: Document {
    shape: class
    class: class_style
    "- id: string"
    "- fields: Map<string, string>"
    "- created_at: timestamp"
    "+ get_field(name: string): string"
    "+ get_tokens(): List<Token>"
  }
  
  Term: Term {
    shape: class
    class: class_style
    "- text: string"
    "- normalized: string"
    "- frequency: u32"
    "+ normalize(): string"
    "+ stem(): string"
  }
  
  PostingList: Posting List {
    shape: class
    class: highlight_style
    "- term: string"
    "- document_frequency: u32"
    "- postings: List<Posting>"
    "+ add_posting(doc_id: string, positions: List<u32>)"
    "+ get_documents(): List<string>"
  }
  
  Posting: Posting {
    shape: class
    class: class_style
    "- document_id: string"
    "- term_frequency: u32"
    "- positions: List<u32>"
    "- field_name: string"
    "+ calculate_tf(): f64"
  }
}

# Index Structure
index: Index Structure {
  class: container_style
  
  InvertedIndex: Inverted Index {
    shape: class
    class: highlight_style
    "- vocabulary: Map<string, PostingList>"
    "- document_count: u32"
    "- total_terms: u64"
    "+ add_document(doc: Document)"
    "+ search(term: string): PostingList"
    "+ get_idf(term: string): f64"
  }
  
  IndexMetadata: Index Metadata {
    shape: class
    class: class_style
    "- version: string"
    "- created_at: timestamp"
    "- last_updated: timestamp"
    "- document_count: u32"
    "- unique_terms: u32"
  }
}

# Example Data
examples: Example Data {
  class: container_style
  
  doc1: Document 1 {
    shape: class
    class: example_style
    "- id: \"doc1\""
    "- title: \"Search Engine Basics\""
    "- content: \"search engines use inverted indexes\""
  }
  
  doc2: Document 2 {
    shape: class
    class: example_style
    "- id: \"doc2\""
    "- title: \"Information Retrieval\""
    "- content: \"inverted indexes enable fast search\""
  }
  
  term_search: Term: "search" {
    shape: class
    class: example_style
    "- text: \"search\""
    "- normalized: \"search\""
    "- document_frequency: 2"
  }
  
  posting_list_search: PostingList: "search" {
    shape: class
    class: example_style
    "- term: \"search\""
    "- document_frequency: 2"
    "- postings: [doc1_posting, doc2_posting]"
  }
}

# Position information
position_info: Position Details {
  class: container_style
  
  position_note: |md
    **Positional Information**
    - Position 0: "search" in doc1 at word index 0
    - Position 3: "search" in doc2 at word index 3
    - Enables phrase queries and proximity scoring
  | {
    shape: page
    class: example_style
  }
}

# Relationships
core.Document -> core.Term: tokenizes into
core.Term -> core.PostingList: maps to
core.PostingList -> core.Posting: contains
core.Posting -> core.Document: references
index.InvertedIndex -> core.PostingList: stores
index.InvertedIndex -> index.IndexMetadata: maintains

# Example relationships
examples.doc1 -> examples.term_search: contains
examples.doc2 -> examples.term_search: contains
examples.term_search -> examples.posting_list_search: creates