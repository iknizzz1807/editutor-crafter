direction: right

classes: {
  state: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  transition: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  initial: {
    style.fill: "#3fb950"
    style.stroke: "#3fb950"
    style.font-color: "#1a1a2e"
  }
  final: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.double-border: true
    style.font-color: "#e6edf3"
  }
}

init: {
  shape: circle
  class: initial
  label: ""
}

start: {
  shape: circle
  class: state
  label: "START"
}

parsing_token: {
  shape: circle
  class: state
  label: "PARSING\nTOKEN"
}

in_phrase: {
  shape: circle
  class: state
  label: "IN\nPHRASE"
}

field_filter: {
  shape: circle
  class: state
  label: "FIELD\nFILTER"
}

operator: {
  shape: circle
  class: state
  label: "OPERATOR"
}

range_query: {
  shape: circle
  class: state
  label: "RANGE\nQUERY"
}

fuzzy_match: {
  shape: circle
  class: state
  label: "FUZZY\nMATCH"
}

complete: {
  shape: circle
  class: final
  label: "COMPLETE"
}

error: {
  shape: circle
  class: state
  label: "ERROR"
  style.fill: "#d63031"
  style.stroke: "#d63031"
  style.font-color: "#ffffff"
}

init -> start: {
  class: transition
}

start -> parsing_token: {
  class: transition
  label: "token"
}

parsing_token -> parsing_token: {
  class: transition
  label: "alphanumeric"
}

parsing_token -> in_phrase: {
  class: transition
  label: "quote (\")"
}

parsing_token -> field_filter: {
  class: transition
  label: "colon (:)"
}

parsing_token -> operator: {
  class: transition
  label: "AND/OR/NOT"
}

parsing_token -> range_query: {
  class: transition
  label: "bracket ([)"
}

parsing_token -> fuzzy_match: {
  class: transition
  label: "tilde (~)"
}

in_phrase -> parsing_token: {
  class: transition
  label: "closing quote"
}

in_phrase -> error: {
  class: transition
  label: "unclosed phrase"
}

field_filter -> parsing_token: {
  class: transition
  label: "field value"
}

field_filter -> range_query: {
  class: transition
  label: "bracket ([)"
}

operator -> parsing_token: {
  class: transition
  label: "next term"
}

range_query -> parsing_token: {
  class: transition
  label: "closing bracket"
}

range_query -> error: {
  class: transition
  label: "invalid range"
}

fuzzy_match -> parsing_token: {
  class: transition
  label: "distance value"
}

parsing_token -> complete: {
  class: transition
  label: "end of input"
}

operator -> complete: {
  class: transition
  label: "end of input"
}

field_filter -> complete: {
  class: transition
  label: "end of input"
}

range_query -> complete: {
  class: transition
  label: "end of input"
}

fuzzy_match -> complete: {
  class: transition
  label: "end of input"
}

error -> start: {
  class: transition
  label: "reset"
}