shape: sequence_diagram

title: "Sequence: Synchronous Invocation (Cold Start)"
description: "Interaction for a cold start invocation: route request, acquire warm instance (miss), create cold instance, load code, execute, return response."

user: User
gateway: Gateway
controller: Controller {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}
worker_pool: Worker Pool {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}
storage: Storage {
  shape: cylinder
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

cold_instance: Cold Instance {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.bold: true
  style.font-color: "#e6edf3"
}

user -> gateway: "1. Request"
gateway -> controller: "2. Route Request"
controller -> worker_pool: "3. Acquire Warm Instance"
worker_pool -> controller: "4. Miss (No Warm Instance)"
controller -> worker_pool: "5. Create Cold Instance"
cold_instance -> storage: "7. Load Code"
cold_instance -> cold_instance: "8. Execute Function"
cold_instance -> worker_pool: "9. Return Result"
worker_pool -> controller: "10. Return Response"
controller -> gateway: "11. Return Response"
gateway -> user: "12. Return Response"