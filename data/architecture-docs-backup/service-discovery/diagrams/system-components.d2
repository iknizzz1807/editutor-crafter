title: System Component Architecture

# Define style classes
classes: {
  core_component: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  external: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  data_flow: {
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  health_flow: {
    style.stroke: "#ff6b6b"
    style.font-color: "#e6edf3"
    style.stroke-dash: 3
  }
}

# External services and clients
external_services: External Services {
  class: external
  service_a: Service A
  service_b: Service B
  service_c: Service C
}

client_apps: Client Applications {
  class: external
  web_app: Web App
  mobile_api: Mobile API
  worker: Background Worker
}

# Main system components
system: Service Discovery System {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  registry_core: Registry Core {
    class: core_component
    service_store: Service Store {
      shape: cylinder
      style.fill: "#1a1a2e"
      style.stroke: "#3fb950"
      style.font-color: "#e6edf3"
    }
    registration_mgr: Registration Manager
    lookup_engine: Lookup Engine
  }
  
  health_checker: Health Checker {
    class: core_component
    monitor: Health Monitor
    scheduler: Check Scheduler
    validator: Status Validator
  }
  
  http_api: HTTP API {
    class: core_component
    register_endpoint: "/register"
    discover_endpoint: "/discover"
    health_endpoint: "/health"
  }
}

# Service registration flow
external_services.service_a -> system.http_api.register_endpoint: Register Service {
  class: data_flow
}
system.http_api.register_endpoint -> system.registry_core.registration_mgr: Store Registration {
  class: data_flow
}
system.registry_core.registration_mgr -> system.registry_core.service_store: Persist Service Data {
  class: data_flow
}

# Health checking flow
system.health_checker.scheduler -> system.registry_core.service_store: Get Services {
  class: health_flow
}
system.health_checker.monitor -> external_services: Health Checks {
  class: health_flow
}
system.health_checker.validator -> system.registry_core.service_store: Update Status {
  class: health_flow
}

# Service discovery flow
client_apps.web_app -> system.http_api.discover_endpoint: Discover Services {
  class: data_flow
}
system.http_api.discover_endpoint -> system.registry_core.lookup_engine: Query Services {
  class: data_flow
}
system.registry_core.lookup_engine -> system.registry_core.service_store: Fetch Healthy Services {
  class: data_flow
}
system.registry_core.lookup_engine -> system.http_api.discover_endpoint: Return Results {
  class: data_flow
}
system.http_api.discover_endpoint -> client_apps.web_app: Service List {
  class: data_flow
}

# Internal component interactions
system.registry_core.registration_mgr -> system.health_checker.scheduler: Trigger Initial Check {
  class: data_flow
}
system.registry_core.service_store <-> system.registry_core.lookup_engine: Read Service Data {
  class: data_flow
}

# Health status API
client_apps.mobile_api -> system.http_api.health_endpoint: Check System Health {
  class: data_flow
}