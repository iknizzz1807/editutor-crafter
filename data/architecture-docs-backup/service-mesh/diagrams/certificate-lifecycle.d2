title: Certificate Lifecycle State Machine

classes: {
  state: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  initial: {
    style.fill: "#3fb950"
    style.stroke: "#3fb950"
    style.font-color: "#1a1a2e"
  }
  final: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.double-border: true
  }
  transition: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

init: {
  shape: circle
  class: initial
  label: ""
}

pending: Pending {
  shape: circle
  class: state
}

active: Active {
  shape: circle
  class: state
}

rotating: Rotating {
  shape: circle
  class: state
}

expired: Expired {
  shape: circle
  class: final
}

revoked: Revoked {
  shape: circle
  class: final
}

init -> pending: Certificate Request {
  class: transition
}

pending -> active: Validation Success {
  class: transition
}

pending -> revoked: Validation Failure {
  class: transition
}

active -> rotating: Rotation Request {
  class: transition
}

active -> expired: Time Expiry {
  class: transition
}

active -> revoked: Manual Revocation {
  class: transition
}

rotating -> active: New Certificate Ready {
  class: transition
}

rotating -> expired: Rotation Timeout {
  class: transition
}

rotating -> revoked: Rotation Failure {
  class: transition
}