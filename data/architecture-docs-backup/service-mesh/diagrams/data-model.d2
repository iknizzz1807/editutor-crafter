title: Core Data Structures

classes: {
  primary_entity: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.stroke-width: 2
  }
  secondary_entity: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  relationship: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

Service: {
  shape: class
  class: primary_entity
  - "id: string"
  - "name: string"
  - "namespace: string"
  - "version: string"
  - "endpoints: \"List<Endpoint>\""
  - "health_status: HealthStatus"
  - "labels: \"Map<string, string>\""
  - "last_updated: Timestamp"
  + "add_endpoint(endpoint: Endpoint): void"
  + "remove_endpoint(id: string): bool"
  + "get_healthy_endpoints(): \"List<Endpoint>\""
  + "update_health(status: HealthStatus): void"
}

Endpoint: {
  shape: class
  class: primary_entity
  - "id: string"
  - "address: IPAddress"
  - "port: int"
  - "protocol: Protocol"
  - "weight: int"
  - "health_status: HealthStatus"
  - "metadata: \"Map<string, string>\""
  - "last_health_check: Timestamp"
  - "active_connections: int"
  + "is_healthy(): bool"
  + "update_metrics(latency: Duration, success: bool): void"
  + "get_connection_count(): int"
}

Certificate: {
  shape: class
  class: primary_entity
  - "id: string"
  - "subject: string"
  - "issuer: string"
  - "serial_number: string"
  - "not_before: Timestamp"
  - "not_after: Timestamp"
  - "certificate_pem: string"
  - "private_key_pem: string"
  - "ca_chain: \"List<Certificate>\""
  + "is_valid(): bool"
  + "expires_within(duration: Duration): bool"
  + "get_subject_alt_names(): \"List<string>\""
}

Connection: {
  shape: class
  class: secondary_entity
  - "id: string"
  - "source_address: IPAddress"
  - "destination_address: IPAddress"
  - "source_port: int"
  - "destination_port: int"
  - "protocol: Protocol"
  - "state: ConnectionState"
  - "created_at: Timestamp"
  - "last_activity: Timestamp"
  - "bytes_sent: int"
  - "bytes_received: int"
  - "tls_enabled: bool"
  - "certificate_id: string"
  + "is_active(): bool"
  + "update_activity(): void"
  + "close(): void"
}

LoadBalancer: {
  shape: class
  class: secondary_entity
  - "service_id: string"
  - "algorithm: LBAlgorithm"
  - "endpoints: \"List<Endpoint>\""
  - "health_check_interval: Duration"
  - "circuit_breaker_config: CircuitBreakerConfig"
  - "sticky_sessions: bool"
  - "session_affinity_key: string"
  + "select_endpoint(request: Request): Endpoint"
  + "update_endpoint_health(endpoint_id: string, healthy: bool): void"
  + "get_endpoint_metrics(endpoint_id: string): Metrics"
  + "rebalance(): void"
}

Service -> Endpoint: contains {
  class: relationship
  label: "1:N"
}

LoadBalancer -> Service: manages {
  class: relationship
  label: "1:1"
}

LoadBalancer -> Endpoint: routes_to {
  class: relationship
  label: "1:N"
}

Connection -> Endpoint: connects_to {
  class: relationship
  label: "N:1"
}

Connection -> Certificate: secured_by {
  class: relationship
  label: "N:1"
}

Certificate -> Service: authenticates {
  class: relationship
  label: "N:N"
}