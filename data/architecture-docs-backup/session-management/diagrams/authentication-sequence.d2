shape: sequence_diagram

Client: Client
WebApp: Web App
SessionManager: Session Manager
Storage: Storage Backend
CookieManager: Cookie Security

Client -> WebApp: POST /login (username, password)
WebApp -> WebApp: Validate credentials
WebApp -> SessionManager: createSession(userId, deviceInfo)
SessionManager -> SessionManager: Generate session ID
SessionManager -> SessionManager: Generate CSRF token
SessionManager -> Storage: store(sessionId, sessionData)
Storage -> SessionManager: Success
SessionManager -> CookieManager: createSecureCookie(sessionId, csrfToken)
CookieManager -> SessionManager: Secure cookie data
SessionManager -> WebApp: Session created
WebApp -> Client: HTTP 200 + Set-Cookie headers
Client -> WebApp: GET /dashboard (with session cookie)
WebApp -> SessionManager: validateSession(sessionId, csrfToken)
SessionManager -> Storage: retrieve(sessionId)
Storage -> SessionManager: SessionData
SessionManager -> SessionManager: Verify expiry & CSRF
SessionManager -> WebApp: Session valid
WebApp -> Client: Dashboard content

classes: {
  actor_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

Client.class: actor_style
WebApp.class: actor_style
SessionManager.class: actor_style
Storage.class: actor_style
CookieManager.class: actor_style