direction: down

classes: {
  system_container: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.stroke-width: 2
  }
  storage_container: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  component: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  storage: {
    style.fill: "#2d3748"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  security: {
    style.fill: "#742a2a"
    style.stroke: "#f56565"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}

web_app: Web Application {
  class: component
}

session_system: Session Management System {
  class: system_container
  
  session_manager: Session Manager {
    class: component
  }
  
  cookie_security: Cookie Security Layer {
    class: security
  }
  
  device_tracker: Device Tracker {
    class: component
  }
}

storage_layer: Storage Backends {
  class: storage_container
  
  redis: Redis Cache {
    shape: cylinder
    class: storage
  }
  
  database: Database {
    shape: cylinder
    class: storage
  }
  
  memory: Memory Store {
    shape: cylinder
    class: storage
  }
}

web_app -> session_system.session_manager: Create/Validate Session
session_system.session_manager -> web_app: Session Data

session_system.session_manager -> session_system.cookie_security: Secure Cookie
session_system.cookie_security -> web_app: HTTP Response

session_system.session_manager -> session_system.device_tracker: Track Device
session_system.device_tracker -> session_system.session_manager: Device Info

session_system.session_manager -> storage_layer.redis: Cache Session
session_system.session_manager -> storage_layer.database: Persist Session
session_system.session_manager -> storage_layer.memory: Local Cache

storage_layer.redis -> session_system.session_manager: Session Data
storage_layer.database -> session_system.session_manager: Session Data
storage_layer.memory -> session_system.session_manager: Cached Data

title: System Architecture Overview {
  near: top-center
  style.font-size: 18
  style.bold: true
  style.font-color: "#e6edf3"
}