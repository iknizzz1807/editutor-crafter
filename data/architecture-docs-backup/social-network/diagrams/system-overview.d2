title: System Architecture Overview {
  near: top-center
  style.font-size: 24
  style.bold: true
  style.font-color: "#e6edf3"
}

classes: {
  container: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  service: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  database: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  external: {
    style.fill: "#2d3748"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

load_balancer: Load Balancer {
  class: external
}

cdn: CDN {
  shape: cloud
  class: external
}

api_services: API Services {
  class: container
  
  user_service: User Service {
    class: service
  }
  
  post_service: Post Service {
    class: service
  }
  
  feed_service: Feed Service {
    class: service
  }
  
  notification_service: Notification Service {
    class: service
  }
}

data_layer: Data Layer {
  class: container
  
  postgresql: PostgreSQL {
    shape: cylinder
    class: database
  }
  
  redis: Redis Cache {
    shape: cylinder
    class: database
  }
  
  media_storage: Media Storage {
    shape: package
    class: database
  }
}

load_balancer -> api_services.user_service: Route user requests
load_balancer -> api_services.post_service: Route post requests
load_balancer -> api_services.feed_service: Route feed requests

api_services.user_service -> data_layer.postgresql: User data
api_services.post_service -> data_layer.postgresql: Post data
api_services.feed_service -> data_layer.redis: Feed cache
api_services.notification_service -> data_layer.redis: Real-time data

api_services.post_service -> data_layer.media_storage: Upload media
cdn -> data_layer.media_storage: Fetch media

api_services.post_service -> api_services.feed_service: New post event
api_services.user_service -> api_services.notification_service: User events
api_services.feed_service -> api_services.notification_service: Feed updates

cdn -> load_balancer: Static content {
  style.stroke-dash: 3
}