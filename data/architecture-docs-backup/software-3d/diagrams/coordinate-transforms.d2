direction: right

classes: {
  coordinate_space: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  matrix_op: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  final_output: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}

object_coords: Object Coordinates {
  shape: rectangle
  class: coordinate_space
  label: |md
    **Object Space**
    Local model coordinates
    (chair's own "up/forward")
  |
}

model_matrix: Model Matrix {
  shape: diamond
  class: matrix_op
  label: |md
    **Model Transform**
    Translation × Rotation × Scale
  |
}

world_coords: World Coordinates {
  shape: rectangle
  class: coordinate_space
  label: |md
    **World Space**
    Shared studio coordinates
    (common floor/walls/lighting)
  |
}

view_matrix: View Matrix {
  shape: diamond
  class: matrix_op
  label: |md
    **View Transform**
    Camera position & orientation
  |
}

camera_coords: Camera Coordinates {
  shape: rectangle
  class: coordinate_space
  label: |md
    **Camera Space**
    Camera's viewfinder perspective
    (forward = toward subject)
  |
}

projection_matrix: Projection Matrix {
  shape: diamond
  class: matrix_op
  label: |md
    **Projection Transform**
    3D → 2D with perspective
  |
}

clip_coords: Clip Coordinates {
  shape: rectangle
  class: coordinate_space
  label: |md
    **Clip Space**
    Homogeneous coordinates
    (w-component for perspective)
  |
}

perspective_divide: Perspective Divide {
  shape: diamond
  class: matrix_op
  label: |md
    **Divide by W**
    (x/w, y/w, z/w)
  |
}

screen_coords: Screen Coordinates {
  shape: rectangle
  class: final_output
  label: |md
    **Screen Space**
    Final 2D pixel positions
    (ready for rasterization)
  |
}

homogeneous_note: |md
  ## Why Homogeneous Coordinates?
  - **4D vectors** (x, y, z, w) for 3D points
  - Enable perspective projection mathematically
  - Like accounting for perspective effects in photography
| {
  shape: page
  near: top-center
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

mvp_note: |md
  ## Model-View-Projection Pipeline
  Digital equivalent of:
  1. **Positioning subjects** (Model)
  2. **Aiming camera** (View)  
  3. **Capturing with perspective** (Projection)
| {
  shape: page
  near: bottom-center
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

object_coords -> model_matrix: transform
model_matrix -> world_coords: positioned
world_coords -> view_matrix: transform
view_matrix -> camera_coords: camera view
camera_coords -> projection_matrix: transform
projection_matrix -> clip_coords: projected
clip_coords -> perspective_divide: normalize
perspective_divide -> screen_coords: final pixels

object_coords.style.stroke-width: 3
world_coords.style.stroke-width: 3
camera_coords.style.stroke-width: 3
screen_coords.style.stroke-width: 3