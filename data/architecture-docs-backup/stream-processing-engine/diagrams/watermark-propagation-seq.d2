shape: sequence_diagram

title: Watermark Propagation Across Parallel Streams

description: |md
Shows how watermarks are generated at a source, propagated downstream,
and how an operator (like a window) waits for the minimum watermark from
all its input partitions before advancing its own clock.
|

source: Source
p1: Partition 1
p2: Partition 2
p3: Partition 3
window: Window Operator
downstream: Downstream



source -> p1: "Event {data: A, timestamp: 1000}"
source -> p2: "Event {data: B, timestamp: 1005}"
source -> p3: "Event {data: C, timestamp: 1002}"

source -> p1: "Watermark: 950"
source -> p2: "Watermark: 950"
source -> p3: "Watermark: 950"


p1 -> window: "Event A (ts: 1000)"
p1 -> window: "Watermark: 950"
p2 -> window: "Event B (ts: 1005)"
p2 -> window: "Watermark: 950"
p3 -> window: "Event C (ts: 1002)"
p3 -> window: "Watermark: 950"


source -> p1: "Event {data: D, timestamp: 1010}"
source -> p2: "Event {data: E, timestamp: 1015}"
source -> p3: "Event {data: F, timestamp: 1008}"

source -> p1: "Watermark: 1000"
source -> p2: "Watermark: 1005"
source -> p3: "Watermark: 998"

p1 -> window: "Event D (ts: 1010)"
p1 -> window: "Watermark: 1000"
p2 -> window: "Event E (ts: 1015)"
p2 -> window: "Watermark: 1005"
p3 -> window: "Event F (ts: 1008)"
p3 -> window: "Watermark: 998"



source -> p3: "Event {data: G, timestamp: 1020}"
source -> p3: "Watermark: 1010"
p3 -> window: "Event G (ts: 1020)"
p3 -> window: "Watermark: 1010"


window -> downstream: "Window Results [950-1000]"
