shape: sequence_diagram

keyboard: Keyboard
terminal: Terminal (Raw Mode)
input_handler: Input Handler
prefix_detector: Prefix Detector
command_processor: Command Processor
active_pane: Active Pane

keyboard -> terminal: keystroke
terminal -> input_handler: raw input event
input_handler -> prefix_detector: check keystroke
prefix_detector -> input_handler: normal key
input_handler -> active_pane: forward to PTY

keyboard -> terminal: Ctrl-b (prefix)
terminal -> input_handler: prefix keystroke
input_handler -> prefix_detector: check keystroke
prefix_detector -> input_handler: prefix detected
input_handler -> command_processor: enter command mode

keyboard -> terminal: command key
terminal -> input_handler: command keystroke
input_handler -> command_processor: process command
command_processor -> input_handler: execute action
input_handler -> active_pane: route result

keyboard.style.fill: "#1a1a2e"
keyboard.style.stroke: "#3fb950"
keyboard.style.font-color: "#e6edf3"

terminal.style.fill: "#1a1a2e"
terminal.style.stroke: "#3fb950"
terminal.style.font-color: "#e6edf3"

input_handler.style.fill: "#16213e"
input_handler.style.stroke: "#3fb950"
input_handler.style.font-color: "#e6edf3"
input_handler.style.bold: true

prefix_detector.style.fill: "#1a1a2e"
prefix_detector.style.stroke: "#3fb950"
prefix_detector.style.font-color: "#e6edf3"

command_processor.style.fill: "#1a1a2e"
command_processor.style.stroke: "#3fb950"
command_processor.style.font-color: "#e6edf3"

active_pane.style.fill: "#0f3460"
active_pane.style.stroke: "#3fb950"
active_pane.style.font-color: "#e6edf3"