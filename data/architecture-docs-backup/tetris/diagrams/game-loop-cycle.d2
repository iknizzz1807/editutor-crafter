title: Game Loop Update Cycle

classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  decision: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  start_end: {
    style.fill: "#3fb950"
    style.font-color: "#1a1a2e"
    style.bold: true
  }
}

start: Start {
  shape: circle
  class: start_end
}

handle_input: Handle Input {
  shape: rectangle
  class: process
}

update_gravity: Update Gravity {
  shape: rectangle
  class: process
}

check_collisions: Check Collisions {
  shape: rectangle
  class: process
}

collision_check: Collision Detected? {
  shape: diamond
  class: decision
}

lock_piece: Lock Current Piece {
  shape: rectangle
  class: process
}

spawn_piece: Spawn New Piece {
  shape: rectangle
  class: process
}

check_lines: Check for Complete Lines {
  shape: rectangle
  class: process
}

clear_lines: Clear Lines & Score {
  shape: rectangle
  class: process
}

update_board: Update Board State {
  shape: rectangle
  class: process
}

render: Render Frame {
  shape: rectangle
  class: process
}

frame_complete: Frame Complete {
  shape: circle
  class: start_end
}

start -> handle_input: Begin Loop
handle_input -> update_gravity: Process Player Input
update_gravity -> check_collisions: Apply Gravity
check_collisions -> collision_check: Test Movement
collision_check -> update_board: No {style.stroke: "#3fb950"}
collision_check -> lock_piece: Yes {style.stroke: "#e17055"}
lock_piece -> spawn_piece: Lock in Place
spawn_piece -> check_lines: Generate Next Piece
check_lines -> clear_lines: Lines Found
clear_lines -> update_board: Update Score
update_board -> render: State Updated
render -> frame_complete: Draw to Screen
frame_complete -> handle_input: Next Frame {style.stroke: "#8b949e"; style.stroke-dash: 3}