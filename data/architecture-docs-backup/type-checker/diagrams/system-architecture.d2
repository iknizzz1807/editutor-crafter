direction: right

classes: {
  primary: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  secondary: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  flow: {
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

title: Type Checker System Architecture {
  shape: text
  style.font-size: 24
  style.font-color: "#e6edf3"
  style.bold: true
}

type_rep: Type Representation {
  class: primary
  
  primitive: Primitive Types {
    class: secondary
    shape: rectangle
  }
  
  compound: Compound Types {
    class: secondary
    shape: rectangle
  }
  
  variables: Type Variables {
    class: secondary
    shape: rectangle
  }
  
  constraints: Type Constraints {
    class: secondary
    shape: rectangle
  }
}

environment: Environment {
  class: primary
  
  bindings: Variable Bindings {
    class: secondary
    shape: cylinder
  }
  
  scopes: Scope Stack {
    class: secondary
    shape: rectangle
  }
  
  context: Type Context {
    class: secondary
    shape: rectangle
  }
}

inference: Inference Engine {
  class: primary
  
  unification: Unification {
    class: secondary
    shape: rectangle
  }
  
  constraint_gen: Constraint Generation {
    class: secondary
    shape: rectangle
  }
  
  solver: Constraint Solver {
    class: secondary
    shape: rectangle
  }
}

error_reporter: Error Reporter {
  class: primary
  
  collector: Error Collector {
    class: secondary
    shape: rectangle
  }
  
  formatter: Error Formatter {
    class: secondary
    shape: rectangle
  }
  
  diagnostics: Diagnostic Output {
    class: secondary
    shape: page
  }
}

type_rep -> environment: type definitions {
  class: flow
}

environment -> inference: lookup types {
  class: flow
}

inference -> type_rep: create type variables {
  class: flow
}

inference -> environment: update bindings {
  class: flow
}

inference -> error_reporter: type errors {
  class: flow
}

environment -> error_reporter: scope errors {
  class: flow
}

type_rep -> error_reporter: malformed types {
  class: flow
}

inference.constraint_gen -> inference.solver: constraints {
  class: flow
}

inference.solver -> inference.unification: unify types {
  class: flow
}

error_reporter.collector -> error_reporter.formatter: raw errors {
  class: flow
}

error_reporter.formatter -> error_reporter.diagnostics: formatted output {
  class: flow
}