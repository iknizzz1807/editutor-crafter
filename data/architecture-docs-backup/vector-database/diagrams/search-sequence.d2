shape: sequence_diagram

client: Client
api: API Gateway
query_proc: Query Processor
hnsw: HNSW Index
distance: Distance Computer
filter: Metadata Filter
ranker: Result Ranker

client -> api: POST /search
api -> query_proc: validate query vector
query_proc -> hnsw: search(vector, k, ef)
hnsw -> hnsw: navigate graph layers
hnsw -> distance: compute distances
distance -> hnsw: similarity scores
hnsw -> query_proc: candidate vectors
query_proc -> filter: apply metadata filters
filter -> query_proc: filtered candidates
query_proc -> ranker: rank by distance
ranker -> query_proc: top-k results
query_proc -> api: search results
api -> client: JSON response

classes: {
  dark_theme: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

client.class: dark_theme
api.class: dark_theme
query_proc.class: dark_theme
hnsw.class: dark_theme
distance.class: dark_theme
filter.class: dark_theme
ranker.class: dark_theme