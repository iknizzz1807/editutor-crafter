Video: Video {
  shape: sql_table
  id: uuid {constraint: primary_key}
  filename: varchar
  original_size: bigint
  duration_seconds: int
  upload_status: varchar
  created_at: timestamp
  updated_at: timestamp
  metadata_json: text
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

TranscodingJob: TranscodingJob {
  shape: sql_table
  id: uuid {constraint: primary_key}
  video_id: uuid {constraint: foreign_key}
  status: varchar
  priority: int
  progress_percent: int
  started_at: timestamp
  completed_at: timestamp
  error_message: text
  transcoding_params: text
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

HLSManifest: HLSManifest {
  shape: sql_table
  id: uuid {constraint: primary_key}
  video_id: uuid {constraint: foreign_key}
  manifest_type: varchar
  quality_level: varchar
  resolution: varchar
  bitrate: int
  manifest_path: varchar
  created_at: timestamp
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

VideoSegment: VideoSegment {
  shape: sql_table
  id: uuid {constraint: primary_key}
  manifest_id: uuid {constraint: foreign_key}
  segment_index: int
  duration_seconds: decimal
  file_path: varchar
  file_size: bigint
  created_at: timestamp
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

Video -> TranscodingJob: "1:N\ntriggers transcoding" {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

Video -> HLSManifest: "1:N\nproduces manifests" {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

HLSManifest -> VideoSegment: "1:N\ncontains segments" {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

TranscodingJob -> HLSManifest: "creates" {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
  style.stroke-dash: 3
}

title: Data Model Relationships {
  near: top-center
  style.font-size: 20
  style.bold: true
  style.font-color: "#e6edf3"
}