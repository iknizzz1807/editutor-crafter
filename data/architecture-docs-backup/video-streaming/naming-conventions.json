{
  "types": {
    "StorageService": "fields: basePath string, file operation methods",
    "DatabaseService": "fields: db connection, query methods",
    "UploadService": "fields: handles chunked uploads and validation",
    "TranscodingService": "fields: manages FFmpeg processes and job queue",
    "Video": "fields: id UUID, filename string, processing_status enum",
    "TranscodingJob": "fields: id UUID, video_id UUID, quality_config JSON, status enum",
    "HLSManifest": "fields: id UUID, video_id UUID, quality string, manifest_path string",
    "UploadSession": "fields: session_id UUID, expected_size integer, chunk_size integer",
    "FFmpegWrapper": "direct FFmpeg interaction and process management",
    "QualityLadder": "fields: generates quality configurations based on source video",
    "ManifestGenerator": "fields: databaseService DatabaseService, storageService StorageService",
    "StreamingService": "fields: manifest serving methods, segment delivery methods",
    "HlsWrapper": "videoElement HTMLVideoElement, hls Hls instance, eventHandlers Map",
    "AnalyticsManager": "events array, sessionId string, startTime timestamp",
    "VideoPlayer": "container HTMLElement, hlsWrapper HlsWrapper, analytics AnalyticsManager",
    "WorkflowCoordinator": "fields: databaseService DatabaseService, pollingIntervalMs number, isRunning boolean, activeWorkers Map",
    "TransactionHelper": "fields: db DatabaseService",
    "UploadCompletionHandler": "fields: transcodingService TranscodingService, storageService StorageService, transactionHelper TransactionHelper",
    "TranscodingToStreamingCoordinator": "fields: manifestGenerator ManifestGenerator, streamingService StreamingService, transactionHelper TransactionHelper",
    "ClientStreamingHandler": "fields: databaseService DatabaseService, storageService StorageService, manifestGenerator ManifestGenerator",
    "TestDatabaseService": "fields: extends DatabaseService with test isolation",
    "MockFFmpegProcess": "fields: simulates FFmpeg process behavior",
    "VideoOutputValidator": "fields: validates HLS output correctness",
    "HLSValidator": "HLS output validation tools",
    "UploadDiagnostics": "upload session analysis and validation",
    "FFmpegDebugger": "FFmpeg process monitoring and debugging",
    "LiveIngestServer": "fields: config object, mediaServer NodeMediaServer, activeStreams Map",
    "AnalyticsEventCollector": "fields: db Pool, batchSize number, flushInterval number, eventBuffer array",
    "QualityDecisionEngine": "fields: decisionWeights object, config object, decisionHistory Map",
    "CDNOrchestrator": "fields: cdnConfig object, db DatabaseService, storage StorageService",
    "LiveStream": "fields: id UUID, broadcaster_id UUID, title string, status enum, start_time timestamp, viewer_count integer, ingest_url string, playback_url string",
    "LiveSegment": "fields: id UUID, stream_id UUID, sequence_number integer, duration_ms integer, file_path string, created_at timestamp, quality string",
    "BroadcastSession": "fields: id UUID, stream_id UUID, connection_id string, bitrate integer, resolution string, started_at timestamp, last_heartbeat timestamp",
    "ViewerSession": "fields: id UUID, stream_id UUID, client_ip string, user_agent string, joined_at timestamp, last_ping timestamp, quality string",
    "VideoThumbnail": "fields: id UUID, video_id UUID, thumbnail_type enum, timestamp_ms integer, file_path string, width integer, height integer, file_size integer, created_at timestamp",
    "ThumbnailSet": "fields: id UUID, video_id UUID, poster_thumbnail_id UUID, timeline_interval_ms integer, total_count integer, storage_path string",
    "CustomThumbnail": "fields: id UUID, video_id UUID, uploaded_by UUID, file_path string, is_active boolean, upload_timestamp timestamp",
    "PlaybackEvent": "fields: timestamp timestamptz, session_id UUID, video_id UUID, event_type string, quality string, position_ms integer, client_ip inet, user_agent text",
    "ViewingSession": "fields: session_id UUID, video_id UUID, viewer_id UUID, started_at timestamptz, ended_at timestamptz, total_watch_time_ms integer, qualities_used text[], device_type string",
    "ContentMetrics": "fields: video_id UUID, date date, view_count integer, unique_viewers integer, total_watch_time_ms bigint, completion_rate decimal, avg_quality string",
    "SystemMetrics": "fields: timestamp timestamptz, component string, metric_name string, metric_value double, labels jsonb",
    "QualityDecision": "fields: timestamp timestamptz, session_id UUID, selected_quality string, available_qualities string[], decision_factors jsonb, bandwidth_estimate integer, device_score decimal",
    "DeviceCapability": "fields: fingerprint_hash string, screen_width integer, screen_height integer, supported_codecs string[], processing_score decimal, is_mobile boolean, battery_conscious boolean",
    "ContentCharacteristics": "fields: video_id UUID, motion_complexity decimal, average_brightness decimal, detail_density decimal, recommended_qualities jsonb, encoding_efficiency jsonb",
    "ViewerPreference": "fields: viewer_id UUID, preferred_max_quality string, accessibility_needs string[], battery_optimization boolean, data_saver boolean, updated_at timestamptz"
  },
  "methods": {
    "saveUploadedFile(buffer, name, category)": "saves file and returns metadata",
    "handleChunkedUpload(req, res)": "processes individual upload chunks",
    "startTranscoding(videoId, inputPath, outputDir)": "begins FFmpeg transcoding pipeline",
    "spawnFFmpegProcess(input, output, quality)": "spawns FFmpeg child process",
    "parseFFmpegProgress(line, duration)": "extracts progress from FFmpeg output",
    "validateUploadFile(file, metadata)": "validates files against platform constraints",
    "validateTranscodingConfig(inputMetadata, outputConfig)": "ensures transcoding meets quality goals",
    "validateHLSOutput(manifestPath, segmentPaths)": "validates HLS output",
    "validatePerformanceMetrics(metrics)": "checks performance goals",
    "Video.create(db, videoData)": "creates new video record",
    "Video.findById(db, videoId)": "retrieves video record",
    "Video.updateProcessingStatus(db, newStatus)": "updates processing status",
    "Video.extractMetadata(filePath)": "extract metadata using FFprobe",
    "TranscodingJob.createForVideo(db, videoId, qualityConfig)": "creates transcoding job for video",
    "TranscodingJob.claimNextJob(db, workerId)": "claims next pending job",
    "TranscodingJob.updateProgress(db, progressPercent)": "updates job progress",
    "TranscodingJob.markCompleted(db, outputPath, segmentCount)": "mark job as completed",
    "TranscodingJob.markFailed(db, errorMessage, canRetry)": "marks job as failed",
    "generateMasterPlaylist(videoId)": "create master M3U8 with quality variants",
    "generateVariantPlaylist(transcodingJobId)": "create quality-specific segment playlist",
    "validatePlaylistContent(content, type)": "ensures HLS specification compliance",
    "TranscodingJob.findByVideoId(db, videoId)": "finds jobs for video",
    "setCacheHeaders(req, res, next)": "configure CDN-friendly headers",
    "handleRangeRequest(req, res, next)": "process HTTP range requests",
    "loadVideo(videoId, manifestUrl)": "loads HLS content and initializes playback",
    "setupHlsEventHandlers()": "configures HLS.js event listeners",
    "handleQualitySelection(qualityIndex)": "processes manual quality changes",
    "trackPlaybackStart(videoId, manifestUrl)": "records analytics for playback initiation",
    "trackQualitySwitch(fromQuality, toQuality, trigger)": "records quality change events",
    "startAnalyticsHeartbeat()": "begins periodic viewing session tracking",
    "processPendingItems()": "process workflow items - implemented by subclasses",
    "createTranscodingJobsForVideo(video, qualityConfigs)": "atomically create transcoding jobs for video",
    "validateVideoFile(video)": "verify video file integrity and metadata",
    "validateTranscodingOutputs(jobs)": "verify transcoded segments and playlists",
    "updateStreamingAvailability(videoId, completedJobs)": "update video streaming status based on policy",
    "handleMasterPlaylistRequest(req, res)": "serve master M3U8 playlist",
    "handleVariantPlaylistRequest(req, res)": "serve quality-specific playlist",
    "handleSegmentRequest(req, res)": "serve video segments with range support",
    "withTransaction(operation, maxRetries)": "execute operation in database transaction with retry",
    "validateManifestContent(content, type)": "ensures HLS specification compliance",
    "setupTestSchema()": "creates isolated test database schema",
    "cleanupTestData()": "removes test data and resources",
    "createTestVideo(overrides)": "creates test video record with customizable properties",
    "simulateTranscoding()": "emits realistic transcoding progress events",
    "simulateFailure(errorMessage)": "emits FFmpeg failure events",
    "validateHLSOutput(videoId, expectedQualities)": "validates complete HLS transcoding output",
    "validateTranscodingJob(jobId, expectedOutputs)": "validates individual job outputs",
    "parseM3U8Manifest(manifestPath)": "parses and validates HLS manifest files",
    "runConcurrentLoad(options)": "executes performance load testing",
    "validateUploadMilestone()": "comprehensive upload functionality validation",
    "validateTranscodingMilestone()": "comprehensive transcoding functionality validation",
    "collectEvent(event) returns": "adds event to buffer with server-side enrichment",
    "flushEvents() returns": "bulk inserts buffered events to database",
    "bulkInsertEvents(events) returns": "efficient PostgreSQL bulk insert",
    "selectOptimalQuality(selectionContext) returns": "intelligent quality selection with multi-factor analysis",
    "extractDecisionFactors(context) returns": "parses context into weighted decision factors",
    "calculateQualityScores(factors, availableQualities) returns": "computes composite scores for each quality level",
    "applySelectionHysteresis(qualityScores, context) returns": "applies switching logic to prevent quality thrashing",
    "distributeVideoContent(videoId, transcodingJobs) returns": "coordinates CDN distribution of transcoded content",
    "executeDistribution(video, jobs) returns": "uploads content to CDN with cache warming",
    "invalidateVideoContent(videoId, invalidationType) returns": "coordinates cache invalidation across CDN edges",
    "saveUploadedFile(buffer, name, category) returns": "saves file and returns metadata",
    "handleChunkedUpload(req, res) returns": "processes individual upload chunks",
    "startTranscoding(videoId, inputPath, outputDir) returns": "begins FFmpeg transcoding pipeline",
    "spawnFFmpegProcess(input, output, quality) returns": "spawns FFmpeg child process",
    "parseFFmpegProgress(line, duration) returns": "extracts progress from FFmpeg output",
    "validateUploadFile(file, metadata) returns": "validates files against platform constraints",
    "generateMasterPlaylist(videoId) returns": "create master M3U8 with quality variants",
    "generateVariantPlaylist(transcodingJobId) returns": "create quality-specific segment playlist",
    "loadVideo(videoId, manifestUrl) returns": "loads HLS content and initializes playback",
    "setupHlsEventHandlers() returns": "configures HLS.js event listeners",
    "handleQualitySelection(qualityIndex) returns": "processes manual quality changes",
    "trackPlaybackStart(videoId, manifestUrl) returns": "records analytics for playback initiation"
  },
  "constants": {
    "CHUNK_SIZE": "2MB size limit for upload chunks",
    "SEGMENT_DURATION": "6 seconds HLS segment length",
    "QUALITY_LADDER": "array of quality configurations",
    "TRANSCODING_STATES": "PENDING, PROCESSING, COMPLETED, FAILED",
    "MAX_FILE_SIZE": "5GB maximum upload size limit",
    "SUPPORTED_FORMATS": "array of allowed video file extensions",
    "MAX_CONCURRENT_JOBS": "transcoding job limit",
    "RTMP_PORT": "1935 - standard RTMP ingestion port",
    "ANALYTICS_BATCH_SIZE": "1000 events per database flush",
    "ANALYTICS_FLUSH_INTERVAL": "5000ms between automatic flushes",
    "QUALITY_DECISION_WEIGHTS": "bandwidth 0.4, device 0.25, content 0.15, preference 0.1, context 0.1",
    "CDN_CACHE_TTL": "manifest 60s, segments 86400s, thumbnails 604800s",
    "LIVE_SEGMENT_DURATION": "2 seconds for low-latency streaming",
    "THUMBNAIL_EXTRACTION_INTERVAL": "every 10 seconds for timeline previews"
  },
  "terms": {
    "progressive download": "downloading entire video file before playback",
    "adaptive streaming": "automatic quality switching based on bandwidth and device capabilities",
    "manifest file": "M3U8 playlist with segment references",
    "transcoding pipeline": "process converting videos to streaming format",
    "quality rendition": "video encoded at specific resolution and bitrate",
    "HLS segmentation": "splitting video into downloadable chunks",
    "chunked upload": "uploading large files in small sequential pieces",
    "quality ladder": "set of different quality levels for streaming",
    "impedance mismatch": "different operational characteristics between components",
    "job queue pattern": "background processing with queued work items",
    "database-mediated communication": "components coordinate through shared database state",
    "metadata extraction": "reading video properties using FFprobe",
    "zombie job detection": "finding stuck jobs from crashed workers",
    "resumable upload": "ability to continue interrupted uploads from last successful chunk",
    "master playlist": "top-level M3U8 listing quality variants",
    "variant playlist": "quality-specific M3U8 with segment URLs",
    "content-addressed URLs": "URLs containing content hash for cache isolation",
    "progressive activation": "enable streaming as each quality completes",
    "conservative quality switching": "stable quality changes avoiding thrashing",
    "controlled chunk simulation": "test framework that can inject failures at specific upload boundaries",
    "tiered mocking strategy": "different levels of mocking for unit vs integration tests",
    "error injection testing": "systematically introducing failures to validate error handling",
    "workflow coordination testing": "monitoring state changes across component boundaries",
    "temporal coordination testing": "validating behavior across different time scales",
    "integration testing": "validating component interactions and workflows",
    "end-to-end testing": "complete pipeline validation from upload to playback",
    "performance testing": "validating system behavior under load and resource constraints",
    "milestone checkpoints": "verification steps after each development stage",
    "live streaming": "real-time video broadcasting with minimal latency",
    "content delivery network": "geographically distributed servers for global content delivery",
    "cache warming": "proactively loading content to CDN edge servers",
    "cache invalidation": "coordinated removal of stale content from CDN caches",
    "quality decision engine": "intelligent system for optimal streaming quality selection",
    "device capability detection": "identifying client hardware and software capabilities",
    "content-aware quality selection": "quality decisions based on video characteristics",
    "analytics aggregation": "processing raw events into meaningful metrics",
    "thumbnail generation": "extracting representative images from video content",
    "timeline thumbnails": "preview images for video seeking interface",
    "real-time transcoding": "converting live video streams with minimal latency",
    "quality thrashing": "rapid switching between quality levels that degrades experience",
    "cache hit rate": "percentage of requests served from CDN cache versus origin",
    "bandwidth estimation": "measuring available network throughput for quality decisions"
  }
}