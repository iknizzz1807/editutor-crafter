# TLB Entry State Machine

classes: {
  state: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  initial_state: {
    style.fill: "#3fb950"
    style.stroke: "#3fb950"
    style.font-color: "#1a1a2e"
    style.bold: true
  }
  transition: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

init: {
  shape: circle
  class: initial_state
  label: ""
}

Invalid: {
  shape: circle
  class: state
}

Valid: {
  shape: circle
  class: state
}

Dirty: {
  shape: circle
  class: state
}

Replacing: {
  shape: circle
  class: state
}

Flushed: {
  shape: circle
  class: state
}

init -> Invalid: {
  label: "TLB Entry Created"
  class: transition
}

Invalid -> Valid: {
  label: "Page Table Lookup\n(TLB Miss)"
  class: transition
}

Valid -> Invalid: {
  label: "Page Evicted\nfrom Memory"
  class: transition
}

Valid -> Dirty: {
  label: "Write Operation\n(Set Dirty Bit)"
  class: transition
}

Dirty -> Valid: {
  label: "Clean Operation\n(Clear Dirty Bit)"
  class: transition
}

Valid -> Replacing: {
  label: "TLB Full\n(Replacement Needed)"
  class: transition
}

Dirty -> Replacing: {
  label: "TLB Full\n(Replacement Needed)"
  class: transition
}

Replacing -> Flushed: {
  label: "Write Back\n(If Dirty)"
  class: transition
}

Flushed -> Invalid: {
  label: "Entry Removed\nfrom TLB"
  class: transition
}

Replacing -> Invalid: {
  label: "Clean Entry\nReplaced"
  class: transition
}

Invalid -> Invalid: {
  label: "TLB Flush\n(Context Switch)"
  class: transition
}

Valid -> Invalid: {
  label: "TLB Flush\n(Context Switch)"
  class: transition
}

Dirty -> Invalid: {
  label: "TLB Flush\n(Context Switch)"
  class: transition
}