shape: sequence_diagram

user: User {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

scanner: Vulnerability Scanner {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

host_discovery: Host Discovery Engine {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

port_scanner: Port Scanning Engine {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

fingerprinter: Service Fingerprinter {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

vuln_detector: Vulnerability Detector {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

report_gen: Report Generator {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

user -> scanner: Submit target (IP/CIDR)
scanner -> host_discovery: Initialize host discovery
host_discovery -> host_discovery: ICMP ping sweep
host_discovery -> host_discovery: ARP resolution (local)
host_discovery -> host_discovery: TCP SYN probe
host_discovery -> scanner: Return live hosts list

scanner -> port_scanner: Start port scanning
port_scanner -> port_scanner: TCP connect scan
port_scanner -> port_scanner: SYN stealth scan
port_scanner -> port_scanner: UDP probe scan
port_scanner -> scanner: Return open ports per host

scanner -> fingerprinter: Begin service identification
fingerprinter -> fingerprinter: Banner grabbing
fingerprinter -> fingerprinter: Protocol analysis
fingerprinter -> fingerprinter: Version detection
fingerprinter -> scanner: Return service details

scanner -> vuln_detector: Analyze for vulnerabilities
vuln_detector -> vuln_detector: CVE database lookup
vuln_detector -> vuln_detector: Configuration checks
vuln_detector -> vuln_detector: Exploit verification
vuln_detector -> scanner: Return vulnerability findings

scanner -> report_gen: Generate scan report
report_gen -> report_gen: Compile results
report_gen -> report_gen: Risk assessment
report_gen -> report_gen: Format output
report_gen -> scanner: Return formatted report

scanner -> user: Deliver scan results