direction: right

classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  database: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  decision: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  filter: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
}

title: Vulnerability Correlation Process {
  style.font-size: 20
  style.bold: true
  style.font-color: "#e6edf3"
  near: top-center
}

input: Service Discovery Data {
  shape: rectangle
  class: process
}

extract: Extract Service Versions {
  shape: rectangle
  class: process
}

cve_db: CVE Database {
  shape: cylinder
  class: database
}

query: Query CVE Records {
  shape: rectangle
  class: process
}

match: Version Match Found? {
  shape: diamond
  class: decision
}

scoring: Calculate CVSS Score {
  shape: rectangle
  class: process
}

severity: High Severity? {
  shape: diamond
  class: decision
}

fp_filter: False Positive Filter {
  shape: rectangle
  class: filter
}

confidence: High Confidence? {
  shape: diamond
  class: decision
}

report: Generate Vulnerability Report {
  shape: rectangle
  class: process
}

discard: Discard Low Priority {
  shape: rectangle
  style.fill: "#636e72"
  style.stroke: "#74b9ff"
  style.font-color: "#ddd"
}

input -> extract: Parse service data
extract -> query: Service/version info
query -> cve_db: Lookup vulnerabilities
cve_db -> query: CVE records
query -> match: Check version ranges

match -> discard: No {
  style.stroke: "#636e72"
}
match -> scoring: Yes {
  style.stroke: "#00b894"
}

scoring -> severity: CVSS calculated
severity -> discard: Low {
  style.stroke: "#636e72"
}
severity -> fp_filter: High/Critical {
  style.stroke: "#e17055"
}

fp_filter -> confidence: Apply ML filters
confidence -> discard: Low {
  style.stroke: "#636e72"
}
confidence -> report: High {
  style.stroke: "#00b894"
  style.bold: true
}

note: |md
  **Key Filtering Stages:**
  - Version correlation matching
  - CVSS severity thresholds  
  - ML-based false positive detection
  - Confidence scoring validation
| {
  shape: page
  style.fill: "#2d3436"
  style.stroke: "#74b9ff"
  style.font-color: "#ddd"
  near: bottom-right
}