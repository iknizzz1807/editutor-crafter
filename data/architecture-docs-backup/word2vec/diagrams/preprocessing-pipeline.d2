title: Text Preprocessing Pipeline

classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  data: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  output: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}

raw_text: Raw Text Input {
  shape: page
  class: data
}

tokenization: Tokenization {
  shape: rectangle
  class: process
}

tokens: Token List {
  shape: page
  class: data
}

vocab_building: Vocabulary Building {
  shape: rectangle
  class: process
}

vocabulary: Vocabulary {
  shape: cylinder
  class: data
}

word_mapping: Word-to-Index Mapping {
  shape: rectangle
  class: process
}

index_map: Index Mapping {
  shape: cylinder
  class: data
}

subsampling: Frequent Word Subsampling {
  shape: rectangle
  class: process
}

balanced_data: Balanced Dataset {
  shape: page
  class: data
}

pair_generation: Training Pair Generation {
  shape: rectangle
  class: process
}

training_pairs: Training Pairs {
  shape: page
  class: output
}

raw_text -> tokenization: "Split into words"
tokenization -> tokens: "Individual tokens"
tokens -> vocab_building: "Count frequencies"
vocab_building -> vocabulary: "Unique words + counts"
vocabulary -> word_mapping: "Create indices"
word_mapping -> index_map: "Word â†” Index"
index_map -> subsampling: "Apply probability"
subsampling -> balanced_data: "Reduced frequent words"
balanced_data -> pair_generation: "Skip-gram/CBOW"
pair_generation -> training_pairs: "Context-target pairs"