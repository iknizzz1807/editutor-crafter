shape: sequence_diagram

Preprocessor: Preprocessor {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

Model: Word2Vec Model {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

NegSampler: Negative Sampler {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

Optimizer: SGD Optimizer {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

Preprocessor -> Model: word pairs batch
Model -> Model: forward pass (target â†’ context)
Model -> NegSampler: request negative samples
NegSampler -> Model: negative word indices
Model -> Model: compute positive loss
Model -> Model: compute negative loss
Model -> Model: total loss = pos + neg
Model -> Model: backward pass
Model -> Optimizer: gradients (W_in, W_out)
Optimizer -> Model: updated weights
Model -> Preprocessor: batch complete
Preprocessor -> Preprocessor: next batch
Preprocessor -> Model: word pairs batch
Model -> Optimizer: epoch complete