direction: right

classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  decision: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  error: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
  success: {
    style.fill: "#00b894"
    style.stroke: "#00cec9"
    style.font-color: "#ffffff"
    style.bold: true
  }
}

start: Start {
  shape: circle
  style.fill: "#3fb950"
  style.font-color: "#ffffff"
  label: ""
}

discovery: Discover DAG Files {
  class: process
}

load: Load YAML Content {
  class: process
}

parse_yaml: Parse YAML Structure {
  class: process
}

valid_yaml: Valid YAML? {
  shape: diamond
  class: decision
}

yaml_error: YAML Parse Error {
  class: error
}

extract_tasks: Extract Tasks & Dependencies {
  class: process
}

build_graph: Build Internal Graph {
  class: process
}

cycle_check: Detect Cycles {
  class: process
}

has_cycles: Cycles Found? {
  shape: diamond
  class: decision
}

cycle_error: Circular Dependency Error {
  class: error
}

validate_tasks: Validate Task Definitions {
  class: process
}

valid_tasks: All Tasks Valid? {
  shape: diamond
  class: decision
}

validation_error: Task Validation Error {
  class: error
}

register: Register DAG in System {
  class: process
}

success: DAG Successfully Registered {
  class: success
}

start -> discovery
discovery -> load: DAG files found
load -> parse_yaml
parse_yaml -> valid_yaml
valid_yaml -> yaml_error: No
valid_yaml -> extract_tasks: Yes
extract_tasks -> build_graph
build_graph -> cycle_check
cycle_check -> has_cycles
has_cycles -> cycle_error: Yes
has_cycles -> validate_tasks: No
validate_tasks -> valid_tasks
valid_tasks -> validation_error: No
valid_tasks -> register: Yes
register -> success