direction: down

shape: sequence_diagram

coordinator: Coordinator {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

participant1: Participant 1 {
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

participant2: Participant 2 {
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

participant3: Participant 3 {
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

coord_log: Coordinator Log {
  shape: page
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

coordinator -> participant1: PREPARE
coordinator -> participant2: PREPARE
coordinator -> participant3: PREPARE

participant1 -> coordinator: VOTE_ABORT {
  style.stroke: "#d63031"
  style.bold: true
}

participant2 -> coordinator: VOTE_COMMIT {
  style.stroke: "#00b894"
}

coordinator -> coord_log: Log ABORT decision {
  style.stroke: "#3fb950"
  style.bold: true
}

coordinator -> participant1: ABORT {
  style.stroke: "#d63031"
}

coordinator -> participant2: ABORT {
  style.stroke: "#d63031"
}

coordinator -> participant3: ABORT {
  style.stroke: "#d63031"
}

timeout_note: Timeout Scenario {
  shape: page
  style.fill: "#1a1a2e"
  style.stroke: "#fdcb6e"
  style.font-color: "#e6edf3"
}

timeout_note.label: |md
  **Timeout Case:**
  Participant 3 never responds
  → Coordinator waits for timeout
  → Treats as ABORT
  → Logs ABORT and notifies all
|