title: System Component Overview

classes: {
  main_component: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  external_system: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  data_flow: {
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  external_flow: {
    style.stroke: "#8b949e"
    style.font-color: "#8b949e"
  }
}

# External Systems
ad_exchanges: Ad Exchanges {
  class: external_system
  shape: cloud
}

advertisers: Advertisers/DSPs {
  class: external_system
  shape: cloud
}

# Main System Components
lighthouse_system: Lighthouse RTB System {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  gateway: Gateway {
    class: main_component
    label: |md
      **Gateway**
      Request routing & load balancing
      Protocol handling
    |
  }
  
  bidding_engine: Bidding Engine {
    class: main_component
    label: |md
      **Bidding Engine**
      Auction logic & bid calculation
      Campaign targeting
    |
  }
  
  fraud_detection: Fraud Detection {
    class: main_component
    label: |md
      **Fraud Detection**
      Traffic analysis & scoring
      Real-time filtering
    |
  }
  
  global_state: Global State {
    class: main_component
    label: |md
      **Global State**
      Campaign budgets & user profiles
      Distributed synchronization
    |
  }
}

# External to Internal Connections
ad_exchanges -> lighthouse_system.gateway: Bid Requests\n(OpenRTB) {
  class: external_flow
}

lighthouse_system.gateway -> ad_exchanges: Bid Responses\n(<10ms) {
  class: external_flow
}

advertisers -> lighthouse_system.bidding_engine: Campaign Setup\n& Budget Allocation {
  class: external_flow
}

# Internal Component Relationships
lighthouse_system.gateway -> lighthouse_system.bidding_engine: Route Requests {
  class: data_flow
}

lighthouse_system.bidding_engine -> lighthouse_system.fraud_detection: Traffic Validation {
  class: data_flow
}

lighthouse_system.bidding_engine <-> lighthouse_system.global_state: Budget Checks\n& User Data {
  class: data_flow
}

lighthouse_system.fraud_detection -> lighthouse_system.global_state: Update Fraud Scores {
  class: data_flow
}

lighthouse_system.gateway <-> lighthouse_system.global_state: Health Metrics\n& Load Balancing {
  class: data_flow
}

# Performance annotation
performance_note: |md
  ## Performance Requirements
  - **1M QPS** system capacity
  - **Sub-10ms** response latency
  - **99.9%** uptime SLA
| {
  shape: page
  near: top-right
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}