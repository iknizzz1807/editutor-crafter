title: Core Data Model Relationships

classes: {
  dark_fill: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: false
  }
  highlighted: {
    style.stroke: "#3fb950"
    style.stroke-width: 3
    style.bold: true
  }
}

Agent: {
  shape: class
  class: dark_fill
  "id: string"
  "name: string"
  "state: AgentState"
  "capabilities: Tool[]"
  "memory_store: MemoryStore"
  "current_plan: Plan?"
  "active_task: Task?"
}

Tool: {
  shape: class
  class: dark_fill
  "id: string"
  "name: string"
  "description: string"
  "parameters: ParameterSchema[]"
  "execute(params: Map<string, any>): ToolResult"
}

Task: {
  shape: class
  class: "dark_fill highlighted"
  "id: string"
  "description: string"
  "status: TaskStatus"
  "created_at: datetime"
  "updated_at: datetime"
  "result: string?"
  "error: string?"
  "dependencies: Task[]"
}

SubTask: {
  shape: class
  class: dark_fill
  "id: string"
  "parent_id: string"
  "description: string"
  "status: SubTaskStatus"
  "tool_calls: ToolCall[]"
  "result: string?"
}

Plan: {
  shape: class
  class: dark_fill
  "id: string"
  "goal: string"
  "tasks: Task[]"
  "status: PlanStatus"
  "created_at: datetime"
  "execution_order: ExecutionGraph"
}

MemoryEntry: {
  shape: class
  class: dark_fill
  "id: string"
  "type: MemoryType"
  "content: string"
  "timestamp: datetime"
  "embedding: number[]?"
  "metadata: Map<string, any>"
}

Message: {
  shape: class
  class: dark_fill
  "id: string"
  "role: MessageRole"
  "content: string"
  "timestamp: datetime"
  "sender_id: string"
  "receiver_id: string?"
  "context_id: string"
}

Agent -> Tool: "has-a" {style.stroke: "#8b949e"}
Agent -> Plan: "has-a" {style.stroke: "#8b949e"}
Agent -> Task: "has-a" {style.stroke: "#8b949e"}
Agent -> MemoryEntry: "has-a" {style.stroke: "#8b949e"}
Plan -> Task: "composes" {style.stroke: "#3fb950"; style.stroke-width: 2}
Task -> SubTask: "composes" {style.stroke: "#3fb950"; style.stroke-width: 2}
Task -> Tool: "uses" {style.stroke: "#8b949e"}
SubTask -> Tool: "uses" {style.stroke: "#8b949e"}
Task -> Message: "produces" {style.stroke: "#8b949e"}
Message -> MemoryEntry: "derived from" {style.stroke: "#8b949e"; style.stroke-dash: 3}
Task -> MemoryEntry: "references" {style.stroke: "#8b949e"; style.stroke-dash: 3}