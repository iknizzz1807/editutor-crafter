title: Data Model: Span and Trace Relationships
classes: {
  class_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}

Span: {
  shape: class
  class: class_style
  "SpanID: string"
  "TraceID: string"
  "ParentSpanID: string"
  "Name: string"
  "ServiceID: string"
  "StartTime: timestamp"
  "EndTime: timestamp"
  "Attributes: Map<string, any>"
  "Events: SpanEvent[]"
  "Status: SpanStatus"
}

Trace: {
  shape: class
  class: class_style
  "TraceID: string"
  "RootSpan: Span"
  "StartTime: timestamp"
  "EndTime: timestamp"
  "Duration: duration"
  "ServiceCount: int"
  "SpanCount: int"
  "Error: boolean"
}

Service: {
  shape: class
  class: class_style
  "ServiceID: string"
  "Name: string"
  "Environment: string"
  "Version: string"
  "InstanceID: string"
  "Attributes: Map<string, any>"
}

Trace -> Span: contains {
  target-arrowhead: diamond
  style.stroke: "#8b949e"
}

Span -> Trace: "belongs to" {
  style.stroke: "#8b949e"
  style.stroke-dash: 2
}

Service -> Span: produces {
  style.stroke: "#8b949e"
}

Span -> Span: "child of" {
  target-arrowhead: diamond
  style.stroke: "#8b949e"
  style.stroke-dash: 2
}

trace_note: {
  shape: text
  label: |md
    **Trace** = Complete request lifecycle
    - Unique TraceID groups all related spans
    - Contains hierarchical span tree
    - Root span has empty ParentSpanID
  |
  style.fill: "#16213e"
  style.stroke: "#e17055"
  style.font-color: "#e6edf3"
  near: top-left
}
span_note: {
  shape: text
  label: |md
    **Span** = Individual operation
    - Atomic unit of work in one service
    - Contains timing, metadata, events
    - ParentSpanID establishes hierarchy
  |
  style.fill: "#16213e"
  style.stroke: "#e17055"
  style.font-color: "#e6edf3"
  near: top-right
}