elf_binary_t: {
  shape: class
  - buffer: unsigned char*
  - size: size_t
  - ehdr: Elf64_Ehdr*
  - sections: "section_t[]"
  - segments: "segment_t[]"
}

section_t: {
  shape: class
  - type: string
  - name: string
  - data: unsigned char*
  - size: size_t
}

segment_t: {
  shape: class
  - type: Elf64_Phdr
  - offset: size_t
  - vaddr: size_t
}

patch_site_t: {
  shape: class
  - section: section_t
  - offset: size_t
  - original_bytes: "unsigned char[]"
}

trampoline_t: {
  shape: class
  - target_address: size_t
  - hook_address: size_t
  - stub_code: "unsigned char[]"
}

injected_section_t: {
  shape: class
  - name: string
  - data: unsigned char*
  - size: size_t
  - permissions: int
}

elf_binary_t -> section_t: contains
elf_binary_t -> segment_t: contains
section_t -> patch_site_t: contains
patch_site_t -> trampoline_t: "type of"

elf_binary_t -> injected_section_t: contains

classes: {
  container_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.stroke-width: 2
    style.font-color: "#e6edf3"
    style.bold: false
  }
  core_class: {
    shape: class
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.stroke-width: 2
    style.font-color: "#e6edf3"
    style.bold: false
  }
}

elf_binary_t.class: container_style
section_t.class: core_class
segment_t.class: core_class
patch_site_t.class: core_class
trampoline_t.class: core_class
injected_section_t.class: core_class