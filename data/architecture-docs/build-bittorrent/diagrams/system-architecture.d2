title: BitTorrent Client Architecture {
  style.font-size: 24
  style.font-color: "#e6edf3"
}

# External entities
external: External Network {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  tracker: Tracker Server {
    shape: cloud
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  peers: Remote Peers {
    shape: cloud
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

# BitTorrent Client components
client: BitTorrent Client {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
  
  parser: TorrentParser {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  tracker_client: TrackerClient {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  peer_manager: PeerManager {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  
  piece_manager: PieceManager {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}

# File system
filesystem: File System {
  shape: cylinder
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

torrent_file: .torrent File {
  shape: page
  style.fill: "#0f3460"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

# Main flow connections
torrent_file -> client.parser: parse metadata {
  style.stroke: "#8b949e"
}

client.parser -> client.tracker_client: torrent info {
  style.stroke: "#8b949e"
}

client.tracker_client <-> external.tracker: announce/scrape {
  style.stroke: "#8b949e"
}

client.tracker_client -> client.peer_manager: peer list {
  style.stroke: "#8b949e"
}

client.peer_manager <-> external.peers: peer protocol {
  style.stroke: "#8b949e"
}

client.peer_manager <-> client.piece_manager: piece requests/data {
  style.stroke: "#8b949e"
}

client.piece_manager <-> filesystem: read/write pieces {
  style.stroke: "#8b949e"
}

# Information flow
client.parser -> client.piece_manager: piece hashes {
  style.stroke: "#8b949e"
  style.stroke-dash: 5
}