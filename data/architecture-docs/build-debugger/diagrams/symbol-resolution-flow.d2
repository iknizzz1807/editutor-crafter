start: Start {
  shape: circle
  style.fill: "#3fb950"
  style.stroke: "#3fb950"
}

elf_parse: Parse ELF Header {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

section_check: Find Debug Sections {
  shape: diamond
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

no_debug: No Debug Info {
  style.fill: "#d63031"
  style.stroke: "#e17055"
  style.font-color: "#ffffff"
}

dwarf_container: DWARF Processing {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"

  parse_debug: Parse .debug_info
  parse_line: Parse .debug_line
  traverse_die: Traverse DIE Tree {
    shape: diamond
  }
  extract_symbols: Extract Symbol Data
  
  parse_debug -> traverse_die
  parse_line -> extract_symbols
  traverse_die -> extract_symbols: "found DIE"
}

cache_check: Check Symbol Cache {
  shape: diamond
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

cache_hit: Return Cached Result {
  style.fill: "#3fb950"
  style.stroke: "#3fb950"
  style.font-color: "#1a1a2e"
  style.bold: true
}

build_tables: Build Lookup Tables {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

update_cache: Update Cache {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

resolve_symbol: Symbol Resolved {
  shape: circle
  style.fill: "#3fb950"
  style.stroke: "#3fb950"
  style.font-color: "#1a1a2e"
  style.bold: true
}

start -> elf_parse
elf_parse -> section_check
section_check -> no_debug: "no debug sections"
section_check -> cache_check: "debug sections found"
cache_check -> cache_hit: "cache hit"
cache_check -> dwarf_container.parse_debug: "cache miss"
cache_check -> dwarf_container.parse_line: "cache miss"
dwarf_container.extract_symbols -> build_tables
build_tables -> update_cache
update_cache -> resolve_symbol
cache_hit -> resolve_symbol