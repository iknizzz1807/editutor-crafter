shape: sequence_diagram
title: Event Lifecycle Sequence Diagram

Kernel: {
  shape: rectangle
  label: "Kernel Space"
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

eBPF_VM: {
  shape: rectangle
  label: "eBPF VM"
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

User_Space: {
  shape: rectangle
  label: "User Space"
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

Terminal: {
  shape: rectangle
  label: "Terminal"
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

Kernel -> eBPF_VM: "1. do_sys_openat2() called\nProcess PID 1234 invokes open()"
eBPF_VM -> eBPF_VM: "2. eBPF Program Execution\n- Attached via kprobe/tracepoint\n- Collects: PID, timestamp, syscall args\n- Performs initial filtering"
eBPF_VM -> User_Space: "3. Push to Ring Buffer\n- BPF_RINGBUF_OUTPUT()\n- Zero-copy kernelâ†’user transfer\n- Async notification via epoll"
User_Space -> User_Space: "4. Ring Buffer Consumer\n- Poll for available records\n- Parse event structure\n- Extract PID, timestamp, args"
User_Space -> User_Space: "5. Aggregation Logic\n- Update latency histogram map\n- Maintain per-PID counters\n- Calculate rolling statistics"
User_Space -> Terminal: "6. Dashboard Update\n- Format aggregated data\n- Apply ANSI colors/styling\n- Partial screen refresh"
Terminal -> Terminal: "7. Visual Display\n- Real-time histogram\n- Syscall rate counter\n- Top processes by activity"