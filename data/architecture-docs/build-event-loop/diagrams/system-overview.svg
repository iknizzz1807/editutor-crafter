<?xml version="1.0" encoding="utf-8"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" data-d2-version="v0.7.1" preserveAspectRatio="xMinYMin meet" viewBox="0 0 24745 6773"><svg class="d2-947802846 d2-svg" width="24745" height="6773" viewBox="-89 -183 24745 6773"><rect x="-89.000000" y="-183.000000" width="24745.000000" height="6773.000000" rx="0.000000" fill="#FFFFFF" class=" fill-N7" stroke-width="0" /><style type="text/css"><![CDATA[
.d2-947802846 .text {
	font-family: "d2-947802846-font-regular";
}
@font-face {
	font-family: d2-947802846-font-regular;
	src: url("data:application/font-woff;base64,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");
}
@font-face {
	font-family: d2-947802846-font-semibold;
	src: url("data:application/font-woff;base64,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");
}
@keyframes dashdraw {
	from {
		stroke-dashoffset: 0;
	}
}

.d2-947802846 .text-bold {
	font-family: "d2-947802846-font-bold";
}
@font-face {
	font-family: d2-947802846-font-bold;
	src: url("data:application/font-woff;base64,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");
}
.d2-947802846 .text-italic {
	font-family: "d2-947802846-font-italic";
}
@font-face {
	font-family: d2-947802846-font-italic;
	src: url("data:application/font-woff;base64,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");
}
.d2-947802846 .text-mono {
	font-family: "d2-947802846-font-mono";
}
@font-face {
	font-family: d2-947802846-font-mono;
	src: url("data:application/font-woff;base64,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");
}
.d2-947802846 .text-mono-bold {
	font-family: "d2-947802846-font-mono-bold";
}
@font-face {
	font-family: d2-947802846-font-mono-bold;
	src: url("data:application/font-woff;base64,d09GRgABAAAAAB/wAAwAAAAAMzAAAQScAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAABHAAAAGAAAABgmKbWhWNtYXAAAAF8AAABRAAAAihZs3rTZ2FzcAAAAsAAAAAIAAAACAAAABBnbHlmAAACyAAAFcwAAB7si7Ddf2hlYWQAABiUAAAANgAAADYbI9ohaGhlYQAAGMwAAAAkAAAAJAYzAQJobXR4AAAY8AAAAOcAAAG4AdAfV2xvY2EAABnYAAAA3gAAAN7TVcygbWF4cAAAGrgAAAAgAAAAIACiAmpuYW1lAAAa2AAABO8AAA2sAwZtKnBvc3QAAB/IAAAAIAAAACD/uAAzcHJlcAAAH+gAAAAHAAAAB2gGjIUABAJYArwABQAAAooCWAAAAEsCigJYAAABXgAyAR4AAAILAwkDBAMCAgQgAAL3AgA4AwAAAAAAAAAAQURCTwCgACD//wPY/u8AAAQkAcZgAAGfAAAAAAHeApQAAAAgAAN4nKzQSXOLcQDH8U/aRpSipFoltM8jLaXU0qrW1lhjj50skljehO3kBRjvw9HJyVtgLBcZ3J24mDHzN5NDJDn7vYDP/OaLhF4JDOjryaBgSdKgcZHYVhMmbTNlh52m7bLbjAWHHHbEUccsKSopq6iqeeSxJ5565rVP40PRi+hlnI/rIdAlbu8Q91hsE3NtYr1DTP8TwzdZk+bMNt9OmDZjWEZaVkq/2JhIykh4G36F3+Fn+CEZ3oSP4XP4EL6HV+H51/nG+8a7xuiXP80G/3cJp+TddscBZ1x0yU1Fx52Vc828gxYsdpQ84aS7yqpOu6VHrz5Jy6Qs12+FlQasstoag9ZaJ23IesNGbDBqo00uu6HggocyNttirFU92+o+1VV+r332mzXniuuuqrmn5Jzz7nugrsJfAAAA//8BAAD//8EYUxMAAQAB//8AD3icjHl7dBvVue/ee0ZSbMmyZGk0siTrNZJG79dII78ky7b8tuVHbGzHjmMHEpzETkLsxKFx6OURCFQhAQcwtLAKhK7bXuhNoaUuj672lnt5tOueHk45XaeP1ZZS6KGnrTk17Vose+asmZFftD3n/OEZebT3/t6/7/eNgAxQAKAkugowUAJUoAIQAMxpHVo3Q9OUQpGiSSaVomxIS6EK7plrXi/uWzxw4Bk8YFu2nZ5AVzdmxnoOHiz71ksnD9TVfflbcA4ABEoAQL2oAMqAFoA5HaOjMI+HpuRyBUYnHUTJ969//wuDKosKV5nKhjSwGhU25mFn7DjDHI9xL35+bg5goBMAFEcFoAUmQcc5LRM3GAi9XEGINzmFMXE2mfBQlHbzQ+dPczMNbG1re9MtbWONbDSWaOqtr62t70WFqtaG4EA5rupqahrywbsDbpeN2xcMBjwAAAhYfg3VomVgBaDFGUbJBMsycQOp8Hgop1xO6A0GJs6mSLkc3pSeHYzuvTScucnRT6Zc4Xa/vyvmqjX2e2dU/qHzAzOP9jP2MUMlM9HYfCBuN41GYgCBVgBQAhVAqeTdoiVyimbirKC6h6Jav37gUr7nvn0+Y6I7EOhOGFEhd/nkyQfbFrzj+fyoW9RzHABkQAWgFGNEOAiGoAgHMQ6vc+999BH0oMLineceXhTXHgEAmVBBiMX22iPwa9y7a2uosPjI4gYQ1wX5NUShZeAQbPd4/o7tSSrJaOVyOLz3Yl/fvYNNE7Z+Ik77c7SzldFRpQd+7ZhVdT10fPbRPsY+Rpgk80tLT57lfmSLinKyACDjpu4MwSQZLaWltNml55eWnkeF9fWNeajhVsW1QuzVxbXCuqSDoLQM0bm8DF9bXl6EVxcXuZlFSf86fg3hqAAqRP3plKhvUtij1cvlUMueDgxZsvY4w8MHI0dU0foxyp1ohvQ5biB7NCucgUAOADSACmAPUInaaRkdAwkGS+lyD2HffZp79J+Xh99DBe5jqOQ8z8PIHDchyj4GALKjApBJuxzEsSXoRIWN1aJutQAgKyqAKvF7UiglwZpEBqUohYKiacqKEUTtY1kDbsg+tojLFQiLx9uZCIYUchwVPti374ON+bfM/SN9pq8+/vhXTX0j/ea3pLObirmgE8/WkYzHkxR8hdGUwUAQTY/cW43LNJekGypwr1xJ/I+aDzbmYcv9yfO1H4h2e/g1FEfLoBzYdkVfzE56MzeLaQCD+TNNTWfy0tUZN5vjTvGqyj9ycvahnp6HZk8+kv9s7EBrbjwaHc+1HogJMroAQDFUAKpP5T5FbNVt1wdtcy2t8y2DXem6dF0XKtDjvd0HIz+HA2w84QMY8PB51FbUM/xfa6oT8sCKNmv27+n986k7rQ+V0oy53Fxq0kR3mXE2OtUtmdE9FeXePdxXbqXUe2THS1QAYGI9txdtqvx7VulSOqr1g5ZTLS2nWgbba9Pp2vaawz98BhXcoz1dE6HfwclYNOrhPjnAXRHiGefXEI2WQWhXHic8Hpr+NCIJNpKkFQkSob/p9uSQezQSCRnDtkFXlk4fa6s7Fexy5qKusCVq6w1mnHW3qKLhQ1aPvZI0E2UudaQlyg4ng/79lWZrlc6kVzk1kVyYHa8GUMgEVIMKQCHYJVXeu99Dpu8hzeLixqqUe1l+TaxlsoiXWkYr4QQrflQjGK4frbMu6b02m09/v6VuREU1T2XhA9wkzVosLA2/yJ3ITjVTAIJyAFCH2CvAHMboDAaSYdmUjsF+9H+/kC8n1biGVPc8/BoqcD9kD7HsIRZGN+YBBDgAaBAVgFvapzcYCCaDUimGtCJS+KRjMIouth3F2PCjegRxXKmSBSd88lIVjkMIYcXlvic88lKEYXvkHlTgnrEkk1ZrkjW/+KI5kbJaUwkzHNuYf8uWrarK2t4SbK8AALWighh3HcaQRYVTDKbbFlfx7ReeaVAay3GlQVn7xAvfvtZWVqnGVUZVDvbC9DlDwmZLGM5xr3ArF0yM1cqYLoh+1RTzqlzAvV1nE+++/URTeVU5rrGpmx57+2fw+uPuDprucD/O9f1M3FsNAKKKeJ+EjqSDgA6iGsa4f4Nvcf8Ak6Nw5dwo17Eo1GSaX0MkXAdW4AdgWKqmVBgJ9aOgM0jMZi0lmEIL2K9GQsb9Mt7hfeQ6Zgw5jVHGknB29ftbb2LPKnH3PuSoNXX027U2lTfn3ztSStq1SkI9qbdqYzd2c+9VW7ynzPoB3OA0lBtKAQLt/BryoVcBAVxStlMKAd8VzN+saaHjwwFnmxVXzS3JsKo2V8NoNH1w1Bw06Wm7MUQSIZXTzqJXn82brZlbuodubThrbWRCdVai8k2tBkDQLPQ4uC7g8H/S4wSsGM6f7+i7s7tu0parSlr8TS6qwUc3muuCs6r06YGB02m3dUyvc2YDgazTotvvdok4GuHXkAa9CvTAKUrYFMDQAiILfkwKftwSB8HEXPpg0ldvxBVLZ5WYuaMyoNP7DOawOa763K398w2Wyp4vbzQzZtdZovLNinJrOtLRItVeqmiL669wUOFIOhSJvzKps+d8R+eZpp7ppAxxFyFBMjEXa3Xlos60IxaYFuzqP51pOJbTu0tutNSn7U1xptFeoR01C1AABsT6fBNoJPzeDURamEw5iHciU/lAt81iZKoiYe7Di7AGbtTsZ7WlMyWl/hCH4PlZ+ZyAmwk+hOrhOoiDJrB3S3/BMds3lomTDEEV8dTpoUVrGCYuPsA+DfXS/9TWQkg0HqqjPUSVw2T21E1Vh11v3lRSlhqvVbsqVKW+wPjBm9svDBBOvd5J6IWrw1vvDAYyZkqt0+T+yVwdtMZ1uNprq4xX4BVNgfo+r2pGSelqOlwy2R5Nma6itjnRH4ZvVrjNJpdO5zKZ3RXcVY1ZW1mGYypSba6S4tQOALKIOS7ynWJuE1pKK4ZIoW1f2oNZ+qsHe5YcXmvIhF599kBVaGaC+//QFg+bK7lvAAB4HuQBgC+jP8k94DAAQA5uDknP/Xx98fn09nOAQLcYr1d3cJmUwGXolK57CX/xSe6Z718Z/Cl6lTv2Bnfp/K/GuNcABAy/hmzoFYGtC9krkaetBPrc/snPw3DcWuEm7Z4G1ckJeM8cB8LUnj0zqnLRVmGGyMB1IfsFniOZSm4bLNq7ZTh1ohRXxwP28B51MpCsLZjVROmcWq3Wl8LVtDXg8zojN3Ry1+BAiKzkvgYHSINw3/IpXAf6nXJ2uvSsErfvrR7MSy6Fq0328G6PSrXqg+v/Xc7TON/ePt8oXZ0hkgw5xWsRDaTrgoQH0hWI+NYuyhDxbXhL062UpkhCtxvf2s8qMVuPNyMAW7WjwYQrhizb8LaC/mfcTGVOdQ+dbbCY+h+Arp34JtjUjjSiXwT8SaYoUcwWCqUYLbYbf84rcGMLJYKQv0nA1Q+3AWjlob5KuwhCVgezMQJdOxEIgnkAkAuuC31wR6wlPFBo58+qMPeROofPYCXdlvCoHa7OpOtKS88pFGwzxwEIkvyaGEP/bp4TRrQYit24vElyvE13RBpCh1ifR2mOuA+NfOZo8yzd5B70kVZNoqH7BkdqVhWyjVdZK7XK8jLVHkN3TetQoHKENJbolHqdWhus8YXaA5s8y4MuCv1bjH6SSqZSjDgd7QDNu3r3+xfv1N369tuGsKsqajA5elWpg43/e1a+vDz3VXeYKN1ztFQrnJfh11AZXBVyclioHaZYOdoi8v9iqHvJ5rMEK5fOKnFHn2pmAsa5X8XDRgds5TRt7vAm54KrRQ60o+3/5OWreZVBiSsJVf7Si3D1Q3e319vt/pDTiHUnciC4Ksxuu/btOGGbkwz132+TKXBMplTYjtkVZTJcJsMtF7ufM+MlMhzbIzfB1fddHR5PJ3XtmnDvcL3PaZ50tPttLZEnRXluYSaHqxL3oXeIUZDbctzPPvkEIwz3JWRJ8LGnnn2iRl2lxpVGZQyiP/QRAYII6vv4jwaIIEEEDAPCuTY+g+rgKjCLPizmRCq1yxVqdNng0ZhK9SWBmKr0xw/uVRtVeKlR2fG518j00P+R4ycxzG0xwV+/Q3XR7m7XO5wyMxiQsLhVxI3VIjeiJG7UCrH34HVuHSp7YXguz/3jnLiW5NdQJ1oW5lWJGWXwZEJi3VYk6KPweOgwViwuQq/GN/OGZVOMXK6Qy3+b2x+l07k0XUHqjKHO8bAjY6YCN4RrjvaH6fZ4xyCVyqQokjZXpcy2cNnduvqg/5SKGYoz7WzQH7WRFtpJj4z2WkmHfEEZdPiOzJ0IRXoifTlvQzISTtgr3YS7ynM403F3Op4BGKjm15Ad3QPKQBXwbaFasWV+GtNSzu0vYbDjePru4ycupGc77QIRtdsSVmvCZgsGbfZAQNVz9djT1649fexqzynv5MDe/W73/r0Dk94rfifl81FOP4CgFwBUhc6JuSvO6hmUYrQM0fu/LgUa4saZKwvwxJiinCjfWF8Q/MsAgEh0D7AI6zNI8q2C3gZIBcsyDFE7dm93KuZpMPfGjnQ0HappPJY2Z42PDPacPxKKxGhTLxOPj6XZ4ydYTLYonOvn15AO3bM5HxaTSLI8WWQJuwQpiCK4kOxoqzFn7ws4WZtzb1dDpzMedDc6OiMz6Zajddkab6O79ZSK9Jr3W1xap9HiM0wbPJVOV5V5nyfg66mOtRpwpS/jq9sbKPbCMDoncPkpbYJNiTXhIBxJyGjhEA5xjVszCc9vfAxLnodz1l6ribXcd/IQvG1DmgHC/BrSo3PCOZId4iC7pb7OQTgU286C5tRIztREhJNWV7WtKW4LOBq18AL3iZJ0G+turG89pTJ6K/drq7Rk0B6Nqyv8sHFxYY/CP9LcdmNCkFfPryHHpt+ESVPk/5/ixn/tPTlMx8Y7AuGeg8nmm+09+nq7r8XvTFlNQXPCb2mwyakRd2o00XCzytW9MDh6x6AvZBupMPtvHOwddRtCrljA6pl00/7h5qZJRsRRAJAZnQNqAOYyWEoYYNSY4rs4GcjFue/Cn9d3+nR4790LpzOL+5rPfOaB/QAT5xgLugdYQQDUbXfzbSa5M87YZhUINmHFniONNjDQMVPjYB3eZOpgw4FbWLeTtVUfc0YJbxUVs9dgoZTBV+2ssGisCVWwl6FrAxrc0h5ne/0HeoNtRlwTygTivRF4WzBW6SLcLpPLwv2M9hJ2I1FWZnPrLV5CjK3Q+0xbOborRSVfF9sPtUVLBNXVCJbkDjvymz62VQYtiUBVQ5VC8PG+RHa6Pj7W6Q/13KgKW7d9HHRHgzb3JOWTfLwZBkGPFX4NfhH8Aig3p5VNNGAaG5lENqvKxWItLbFYDkDwIk/D58CPBR47TLMsTW/rJ+36qbu5Ecnq1Q6dJW5tCmcyx/7lBrIzunCTSmkMOcI1Y/0HLvC8JBM55TRoBAA2A7lw53np/F3Pm0Qe+wa/Bq+gJ4BMYKULGM0oMGyHrut62YMyfTRQUxMI1NTw0HThAvc+93FNKFhdHQzVSFz4IL8GP0JfASbgAWDBk8E+ncZqjNx56E8UxkDE5rfbouSA68a62vGUPRquwus3pXjrw7THYLNXEl3euKs95U0FvXFqp1QIfgwj8Hb0HJABsJemGYWCp2RfkVEw8vsHHvg9z4MBGEFy9BxOgzb+HABAAdqAUPmCL1qhAVXA2+RycETMlz7wOtoDWYABsJB0EH1w5fUTJwAEALyORqTnp5MOAo0Ij8VaHkcW/i3h+XDSQdTDX147fhxA8A2+B/4E/ULA6BZp1iIlegUvTp06NTWwr69v3wvDv7l06f0bGodfWjjz8rDUN2/je+DT0j4h9smEmLOEXv5DccvA1KlTLzQOv3xm4aXhxhvev3TpNwCCN/hpuIpeAwqB+Urvbd+A3pWVZWw8v5HNi+dO89PwSnGN9H5XO72yAr3LefSd/Po1cc3R4jmxrYlafBkmtQwxZAxRrJrtXwVEuGII+PTkPpnMWMeydUaZbN9kj88X1MrCLBuWaYM+33Kmz5WM2yscBngDNDgqbAxL9afzKqvFmw/VMCV4CVMTynstVlVe8sMRfhr+UdJlOFks2e2JVXqBnyy2W/HlHCHhCqGXU0d8vqAGF2TjmqDP1zO5TyY31rNsvVEu2ze5/DelpvsplrFt6WePJ119GQBBJz+J1Oj/ifGFDOyEHee4b34RO7z+mKTn73g5nEV/EL/XMtrf3fEJ9tt1o/Tdjr0tkIFwifvmOdixuRmCLBhDRsQK+LtAp+gUmWLIFKkgFfRKdupR8ilVXvUU+ehUdn4s+HiuLfD884G23OPB+8U6s/GzyIPuAlFQu+sXlM23SNQWMItQJzmniHXiZCJNJXvrTwzHB+7t75kM55W4rt7nqnWkT3ZX1YSollpneooN1VX5/UMGA6VtrbEsxQ4+cvjicwONx1u5dxizy5P1sC3eEo07Szs75/dOX2wmtB1GK+zSa8aVlNNgEvyAi1zQgO4DGFAAJSgHYErHYA4dg2FJByETqGGqb7CX+0PfYO9p+AoXha+g+zbOCH/wnomJH0xM8DzQ8muoHd2D0+AofzvMIQ84BoUZ/OhnN/nmBKpArICvC0kqySSl+eLP16/PXL8+sTK9sjK9IqwbBCcRjihxneRz0eGPd9x/f8fly+L1ZOflK51XrnReudx5RcII8BSqgP8u94AjYB4ISFEoPg+hCnSznBax41+BR7wrhCtPinObDf4Z3SrU3CF30k3ICBn8M3cbvIP7CyyxfXL4kwtfwr8EIDgIbPA9ad1C0p10J2XEQVjC/QXeYRNWXPjksGRjAnyIXPArwixwyLn57lBqWUKFiFPU7daox6VXm4wlI/ahsC3icenLK40lI7ahVdJKVrgsvnzz1geeBwlwBrmQVe4Bk6Jtk0Xbsnw96oCrcjmYEWWX8X9E1ahE4PMtMAlJgV+RkOI+hIbWh+Eh7vMPa6ESh8reu+bvkuaLP6LO4npaoBZ0ChIw0fIw9xg8/HALNGiFlb3cx7iEw+dRDH4Gi8jlYFaUlwcAfhmuCpg+JaIVNLwBx+D5ueIc9hbKwPvRn4Q4Nu7qp/7qan8glUKZmNfHMD5vTPKdn68Xz9PvnHc2f7RSo++Fu+wBa8zg8mregGOGxOhruvIjZUoy7IKH5rhwuL/BVcwzqV8INb03KUw0P4CG6Wmp9y3za/A7MAfKtibdnRPB5khjgEF/zjPUkB305Py6qipdhdWq8vUw+dHRPNPj66UZxu1mGFo6UwssqA2dFGtHyFhSyNnxrpeYy8xTXZaO5yIPR1/vEH8fEOMFvBIOibxGmIjFwt/mOEVooK2IzC5Rdr3Dpr6KZBihlinkFSp3ZbS2DNNnXDp3GUQ49hr6Ovcr1l/uMMNE7R1n/GQFhLMyRTgSCJVovK3NbsknxdgJPmmkUySMf+OmR1HsCwdf/A8AAAD//wEAAP//Jo9pJwABAAAAAQScDeN3+l8PPPUAAwPoAAAAANwcc6QAAAAA3ZceoP9M/joDDAQkAAEABgACAAAAAAAAAAEAAAPY/u8AAAJY/0z/TAMMAAEAAAAAAAAAAAAAAAAAAABueJxMkDlKBGEUhD8KEwNxSQwNRINBFHRcUEcGlaFRURGDCow6cklN23N4EcUjiBfwEF5CHtRAR9X0X9srmVUZZGZlLmT2ZCYyDzJPMhsy47wdyZzLvMgcypzKrMtcBku3LbMSzbzMjMySzILMgcxIppE5k9mS2Ze5kxnm/7XMQOZKZif9mnCn+Cqzm6yT5FXOWr6rx3LybuIziNemzHF0o/h8yXz28FumlflNt/K7zU6l/ZB5C+9R5jlb1UZ/wXGvy2LwPjjJDW3uHoY/F02XHX7Su/jv8Sle9w8AAP//AQAA//8NrkYEAAAAACoAKgBMAIIAsgDWAOwBAAE0AUoBYAGCAZ4BrgHcAf4CMAJSApoCxAMIAxoDQANcA5gDxgPkA/oEOgRyBKIE2AUQBTYFrAXQBdwF6AYCBiIGVgZ4BqoG4gcYBzgHeAegB8IH3ggWCEIIcgiICOIJIAk4CWQJqAnICgAKRApeCrYK+gsQCzQLQAtMC24LqAu4C8YLzgvaC+YL8gwODCgMOgxMDJIM1gzmDPQNBA0iDXgNmg2qDb4N2A3kDfQOCA4cDkYOUg5aDnIOig6SDqIOug7eDuwPFg8qD2gPdgAAAAEAAABuAfgAKgBuAAYAAQAAAAAAAAAAAAAAAAADAAN4nJyWTW8b1RfGf2OntsdN+88/lNIUKJcSSholEztKoypFArdpVUNISpxSoVIJx3acUfwme9w2rFmwZMVnAMSqqy4QYpUFC5aIFSvEig+AWCA0Z449Y9ckbVWpee7c8/o8595r4J3Y38SxxmzgABRbnONAcYwUvyuOs8KfiseYsS4oPkbZWlecYNp6pDjJj9YvilMsxb5SbLMU+0nxcRZj/yg+ETfxjOKTLCVuKZ5iOvF5gC1IJ75WbDGe0FxWjInED4rjTCR+VjzG2cRvio8xnvhLcYLJ5JjiJJPJ04pTTCZnFNtMJlcUp5lOrik+jkm2FI8zl/xS8Qkyye8Vn8RJKlfW/1hMnVU8weVUL87/uZDq9TXJ26lvFb8QqfkU51N/KH4x0vvpSO8vRXKdieSa4qSdUnyWcbvX48sR31c4ZZ9X/Cppe1nxuYjva4zb7yo2TNi9+l8PZ8M6z6T9ieI3SNsNxdOROG9GaniLJfuh4ovM2t8pnsWxdWasOebSPY3mI3kdMmmdE2shUkOGmfSniheZTX+h+Fqk31Xh8BsMi2TIksEwr6tFWeUo02SbCoYC+3TwqFCngyFPgxJN2rTk/6LslTHMsIuHR4sVFljggfxzKPajOeJZZ4GLzGF4gIvHLoZNKnSo0Oa+RrtBkwYehnWK1P1azBkKNOnSpkTFTOFE1xiu0aQs6BZtmlylSY0yWRzp9DJXyLHKVTa4MuDb8wz85vueh8c3fbuPpPYOrlRtBjLu0sSTzhvc7+85ZMmyzBXqFNmjIlY7VHgoGRZxuITDMpdYlljPXq8rihUxeKJUWVQs0mYPQ5Od59balS597Xy/2zREyWCvgKeWQfYGZRbE30iPu8KVkchd0biNK9bOc1VziyJdahhWcTDc1Kj+hG0Jr/7frkyeX3eFxjNMqsc+LSpssat8hpNZEA49HginIeM1XFGgITPtc9IVFoK+e6wVyLOGYUPiNwYirw1E8DsZNWFZ6TesbDBvqP99irjUKLJNTXbCk1eUvDk+FOyxghlip0NJFGrhiUYdieWIBlUW2OAGa0OVHM1RWf4G2m/T7U9P0J0/Nf55z1EQ5QtmSk5bTlgrCCN3yLPFTTa4zZasc2yySY51tshzXXw32JSTu8E6q+KRFxzs3ZATsM7HGN4nLzZ+7IryEyjmn8mWVN+R2oNZdqnTEs79yh3ptSIdPrvChh2N2vPtiE8Jlx2xNKJfgypdilR1KlpSYV247M1GeOqCiahLL7624X6Vpty0bTm5flTDvt4d/rQGNQU3hPcUqjrPNTP/faNtyunzuwhRXroIZrzTZ78i3Q6uq/qWuHKfBveV4YLwUZDXxMVY71GS7L6vz4WJP3riy+MnvhyIym22cYMpjR9wjX3JVtPqDNvCinhwN/Yr9+iIfh1R16/oM4ni3013yXBP75kmVbnZWsJ5Sc7ivqyC+bnL/CG2Rb0v26LXntjPjshdlteiJtoZ6a2q0ae5Jxx7OhvBHWto0JU3uC27wSmV3sgeWs9wpI72MKd1Dao4J6/CsCbD2o6yeixfh5QZyw6oPcrvQH55VOX98Nm4Iye/KtN8nYf6bq71v4XoA+HSFV4K8kb591jwCoeevXf5qsQvsTdy5sMZnx+Z9Sifp7cc7PYo68EeD7cd5uAo+1G/WEbbKXP/AgAA//8BAAD///u8HqIAAAMAAAAAAAD/tQAyAAAAAQAAAAAAAAAAAAAAAAAAAAC4Af+FsASNAA==");
}
.d2-947802846 .text-mono-italic {
	font-family: "d2-947802846-font-mono-italic";
}
@font-face {
	font-family: d2-947802846-font-mono-italic;
	src: url("data:application/font-woff;base64,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");
}]]></style><style type="text/css"><![CDATA[.shape {
  shape-rendering: geometricPrecision;
  stroke-linejoin: round;
}
.connection {
  stroke-linecap: round;
  stroke-linejoin: round;
}
.blend {
  mix-blend-mode: multiply;
  opacity: 0.5;
}

		.d2-947802846 .fill-N1{fill:#0A0F25;}
		.d2-947802846 .fill-N2{fill:#676C7E;}
		.d2-947802846 .fill-N3{fill:#9499AB;}
		.d2-947802846 .fill-N4{fill:#CFD2DD;}
		.d2-947802846 .fill-N5{fill:#DEE1EB;}
		.d2-947802846 .fill-N6{fill:#EEF1F8;}
		.d2-947802846 .fill-N7{fill:#FFFFFF;}
		.d2-947802846 .fill-B1{fill:#000E3D;}
		.d2-947802846 .fill-B2{fill:#234CDA;}
		.d2-947802846 .fill-B3{fill:#6B8AFB;}
		.d2-947802846 .fill-B4{fill:#A6B8F8;}
		.d2-947802846 .fill-B5{fill:#D2DBFD;}
		.d2-947802846 .fill-B6{fill:#E7EAFF;}
		.d2-947802846 .fill-AA2{fill:#5829DC;}
		.d2-947802846 .fill-AA4{fill:#B4AEF8;}
		.d2-947802846 .fill-AA5{fill:#E4DBFF;}
		.d2-947802846 .fill-AB4{fill:#7FDBF8;}
		.d2-947802846 .fill-AB5{fill:#C3F0FF;}
		.d2-947802846 .stroke-N1{stroke:#0A0F25;}
		.d2-947802846 .stroke-N2{stroke:#676C7E;}
		.d2-947802846 .stroke-N3{stroke:#9499AB;}
		.d2-947802846 .stroke-N4{stroke:#CFD2DD;}
		.d2-947802846 .stroke-N5{stroke:#DEE1EB;}
		.d2-947802846 .stroke-N6{stroke:#EEF1F8;}
		.d2-947802846 .stroke-N7{stroke:#FFFFFF;}
		.d2-947802846 .stroke-B1{stroke:#000E3D;}
		.d2-947802846 .stroke-B2{stroke:#234CDA;}
		.d2-947802846 .stroke-B3{stroke:#6B8AFB;}
		.d2-947802846 .stroke-B4{stroke:#A6B8F8;}
		.d2-947802846 .stroke-B5{stroke:#D2DBFD;}
		.d2-947802846 .stroke-B6{stroke:#E7EAFF;}
		.d2-947802846 .stroke-AA2{stroke:#5829DC;}
		.d2-947802846 .stroke-AA4{stroke:#B4AEF8;}
		.d2-947802846 .stroke-AA5{stroke:#E4DBFF;}
		.d2-947802846 .stroke-AB4{stroke:#7FDBF8;}
		.d2-947802846 .stroke-AB5{stroke:#C3F0FF;}
		.d2-947802846 .background-color-N1{background-color:#0A0F25;}
		.d2-947802846 .background-color-N2{background-color:#676C7E;}
		.d2-947802846 .background-color-N3{background-color:#9499AB;}
		.d2-947802846 .background-color-N4{background-color:#CFD2DD;}
		.d2-947802846 .background-color-N5{background-color:#DEE1EB;}
		.d2-947802846 .background-color-N6{background-color:#EEF1F8;}
		.d2-947802846 .background-color-N7{background-color:#FFFFFF;}
		.d2-947802846 .background-color-B1{background-color:#000E3D;}
		.d2-947802846 .background-color-B2{background-color:#234CDA;}
		.d2-947802846 .background-color-B3{background-color:#6B8AFB;}
		.d2-947802846 .background-color-B4{background-color:#A6B8F8;}
		.d2-947802846 .background-color-B5{background-color:#D2DBFD;}
		.d2-947802846 .background-color-B6{background-color:#E7EAFF;}
		.d2-947802846 .background-color-AA2{background-color:#5829DC;}
		.d2-947802846 .background-color-AA4{background-color:#B4AEF8;}
		.d2-947802846 .background-color-AA5{background-color:#E4DBFF;}
		.d2-947802846 .background-color-AB4{background-color:#7FDBF8;}
		.d2-947802846 .background-color-AB5{background-color:#C3F0FF;}
		.d2-947802846 .color-N1{color:#0A0F25;}
		.d2-947802846 .color-N2{color:#676C7E;}
		.d2-947802846 .color-N3{color:#9499AB;}
		.d2-947802846 .color-N4{color:#CFD2DD;}
		.d2-947802846 .color-N5{color:#DEE1EB;}
		.d2-947802846 .color-N6{color:#EEF1F8;}
		.d2-947802846 .color-N7{color:#FFFFFF;}
		.d2-947802846 .color-B1{color:#000E3D;}
		.d2-947802846 .color-B2{color:#234CDA;}
		.d2-947802846 .color-B3{color:#6B8AFB;}
		.d2-947802846 .color-B4{color:#A6B8F8;}
		.d2-947802846 .color-B5{color:#D2DBFD;}
		.d2-947802846 .color-B6{color:#E7EAFF;}
		.d2-947802846 .color-AA2{color:#5829DC;}
		.d2-947802846 .color-AA4{color:#B4AEF8;}
		.d2-947802846 .color-AA5{color:#E4DBFF;}
		.d2-947802846 .color-AB4{color:#7FDBF8;}
		.d2-947802846 .color-AB5{color:#C3F0FF;}.appendix text.text{fill:#0A0F25}.md{--color-fg-default:#0A0F25;--color-fg-muted:#676C7E;--color-fg-subtle:#9499AB;--color-canvas-default:#FFFFFF;--color-canvas-subtle:#EEF1F8;--color-border-default:#000E3D;--color-border-muted:#234CDA;--color-neutral-muted:#EEF1F8;--color-accent-fg:#234CDA;--color-accent-emphasis:#234CDA;--color-attention-subtle:#676C7E;--color-danger-fg:red;}.sketch-overlay-B1{fill:url(#streaks-darker-d2-947802846);mix-blend-mode:lighten}.sketch-overlay-B2{fill:url(#streaks-dark-d2-947802846);mix-blend-mode:overlay}.sketch-overlay-B3{fill:url(#streaks-normal-d2-947802846);mix-blend-mode:color-burn}.sketch-overlay-B4{fill:url(#streaks-normal-d2-947802846);mix-blend-mode:color-burn}.sketch-overlay-B5{fill:url(#streaks-normal-d2-947802846);mix-blend-mode:color-burn}.sketch-overlay-B6{fill:url(#streaks-bright-d2-947802846);mix-blend-mode:darken}.sketch-overlay-AA2{fill:url(#streaks-darker-d2-947802846);mix-blend-mode:lighten}.sketch-overlay-AA4{fill:url(#streaks-normal-d2-947802846);mix-blend-mode:color-burn}.sketch-overlay-AA5{fill:url(#streaks-bright-d2-947802846);mix-blend-mode:darken}.sketch-overlay-AB4{fill:url(#streaks-normal-d2-947802846);mix-blend-mode:color-burn}.sketch-overlay-AB5{fill:url(#streaks-bright-d2-947802846);mix-blend-mode:darken}.sketch-overlay-N1{fill:url(#streaks-darker-d2-947802846);mix-blend-mode:lighten}.sketch-overlay-N2{fill:url(#streaks-dark-d2-947802846);mix-blend-mode:overlay}.sketch-overlay-N3{fill:url(#streaks-normal-d2-947802846);mix-blend-mode:color-burn}.sketch-overlay-N4{fill:url(#streaks-normal-d2-947802846);mix-blend-mode:color-burn}.sketch-overlay-N5{fill:url(#streaks-bright-d2-947802846);mix-blend-mode:darken}.sketch-overlay-N6{fill:url(#streaks-bright-d2-947802846);mix-blend-mode:darken}.sketch-overlay-N7{fill:url(#streaks-bright-d2-947802846);mix-blend-mode:darken}.light-code{display: block}.dark-code{display: none}]]></style><style type="text/css">.d2-947802846 .md em,
.d2-947802846 .md dfn {
  font-family: "d2-947802846-font-italic";
}

.d2-947802846 .md b,
.d2-947802846 .md strong {
  font-family: "d2-947802846-font-bold";
}

.d2-947802846 .md code,
.d2-947802846 .md kbd,
.d2-947802846 .md pre,
.d2-947802846 .md samp {
  font-family: "d2-947802846-font-mono";
  font-size: 1em;
}

.d2-947802846 .md {
  tab-size: 4;
}

/* variables are provided in d2renderers/d2svg/d2svg.go */

.d2-947802846 .md {
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  margin: 0;
  background-color: transparent; /* we don't want to define the background color */
  font-family: "d2-947802846-font-regular";
  font-size: 16px;
  line-height: 1.5;
  word-wrap: break-word;
}

.d2-947802846 .md details,
.d2-947802846 .md figcaption,
.d2-947802846 .md figure {
  display: block;
}

.d2-947802846 .md summary {
  display: list-item;
}

.d2-947802846 .md [hidden] {
  display: none !important;
}

.d2-947802846 .md a {
  background-color: transparent;
  color: var(--color-accent-fg);
  text-decoration: none;
}

.d2-947802846 .md a:active,
.d2-947802846 .md a:hover {
  outline-width: 0;
}

.d2-947802846 .md abbr[title] {
  border-bottom: none;
  text-decoration: underline dotted;
}

.d2-947802846 .md dfn {
  font-style: italic;
}

.d2-947802846 .md h1 {
  margin: 0.67em 0;
  padding-bottom: 0.3em;
  font-size: 2em;
  border-bottom: 1px solid var(--color-border-muted);
}

.d2-947802846 .md mark {
  background-color: var(--color-attention-subtle);
  color: var(--color-text-primary);
}

.d2-947802846 .md small {
  font-size: 90%;
}

.d2-947802846 .md sub,
.d2-947802846 .md sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}

.d2-947802846 .md sub {
  bottom: -0.25em;
}

.d2-947802846 .md sup {
  top: -0.5em;
}

.d2-947802846 .md img {
  border-style: none;
  max-width: 100%;
  box-sizing: content-box;
  background-color: var(--color-canvas-default);
}

.d2-947802846 .md figure {
  margin: 1em 40px;
}

.d2-947802846 .md hr {
  box-sizing: content-box;
  overflow: hidden;
  background: transparent;
  border-bottom: 1px solid var(--color-border-muted);
  height: 0.25em;
  padding: 0;
  margin: 24px 0;
  background-color: var(--color-border-default);
  border: 0;
}

.d2-947802846 .md input {
  font: inherit;
  margin: 0;
  overflow: visible;
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

.d2-947802846 .md [type="button"],
.d2-947802846 .md [type="reset"],
.d2-947802846 .md [type="submit"] {
  -webkit-appearance: button;
}

.d2-947802846 .md [type="button"]::-moz-focus-inner,
.d2-947802846 .md [type="reset"]::-moz-focus-inner,
.d2-947802846 .md [type="submit"]::-moz-focus-inner {
  border-style: none;
  padding: 0;
}

.d2-947802846 .md [type="button"]:-moz-focusring,
.d2-947802846 .md [type="reset"]:-moz-focusring,
.d2-947802846 .md [type="submit"]:-moz-focusring {
  outline: 1px dotted ButtonText;
}

.d2-947802846 .md [type="checkbox"],
.d2-947802846 .md [type="radio"] {
  box-sizing: border-box;
  padding: 0;
}

.d2-947802846 .md [type="number"]::-webkit-inner-spin-button,
.d2-947802846 .md [type="number"]::-webkit-outer-spin-button {
  height: auto;
}

.d2-947802846 .md [type="search"] {
  -webkit-appearance: textfield;
  outline-offset: -2px;
}

.d2-947802846 .md [type="search"]::-webkit-search-cancel-button,
.d2-947802846 .md [type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}

.d2-947802846 .md ::-webkit-input-placeholder {
  color: inherit;
  opacity: 0.54;
}

.d2-947802846 .md ::-webkit-file-upload-button {
  -webkit-appearance: button;
  font: inherit;
}

.d2-947802846 .md a:hover {
  text-decoration: underline;
}

.d2-947802846 .md hr::before {
  display: table;
  content: "";
}

.d2-947802846 .md hr::after {
  display: table;
  clear: both;
  content: "";
}

.d2-947802846 .md table {
  border-spacing: 0;
  border-collapse: collapse;
  display: block;
  width: max-content;
  max-width: 100%;
  overflow: auto;
}

.d2-947802846 .md td,
.d2-947802846 .md th {
  padding: 0;
}

.d2-947802846 .md details summary {
  cursor: pointer;
}

.d2-947802846 .md details:not([open]) > *:not(summary) {
  display: none !important;
}

.d2-947802846 .md kbd {
  display: inline-block;
  padding: 3px 5px;
  color: var(--color-fg-default);
  vertical-align: middle;
  background-color: var(--color-canvas-subtle);
  border: solid 1px var(--color-neutral-muted);
  border-bottom-color: var(--color-neutral-muted);
  border-radius: 6px;
  box-shadow: inset 0 -1px 0 var(--color-neutral-muted);
}

.d2-947802846 .md h1,
.d2-947802846 .md h2,
.d2-947802846 .md h3,
.d2-947802846 .md h4,
.d2-947802846 .md h5,
.d2-947802846 .md h6 {
  margin-top: 24px;
  margin-bottom: 16px;
  font-weight: 400;
  line-height: 1.25;
  font-family: "d2-947802846-font-semibold";
}

.d2-947802846 .md h2 {
  padding-bottom: 0.3em;
  font-size: 1.5em;
  border-bottom: 1px solid var(--color-border-muted);
}

.d2-947802846 .md h3 {
  font-size: 1.25em;
}

.d2-947802846 .md h4 {
  font-size: 1em;
}

.d2-947802846 .md h5 {
  font-size: 0.875em;
}

.d2-947802846 .md h6 {
  font-size: 0.85em;
  color: var(--color-fg-muted);
}

.d2-947802846 .md p {
  margin-top: 0;
  margin-bottom: 10px;
}

.d2-947802846 .md blockquote {
  margin: 0;
  padding: 0 1em;
  color: var(--color-fg-muted);
  border-left: 0.25em solid var(--color-border-default);
}

.d2-947802846 .md ul,
.d2-947802846 .md ol {
  margin-top: 0;
  margin-bottom: 0;
  padding-left: 2em;
}

.d2-947802846 .md ol ol,
.d2-947802846 .md ul ol {
  list-style-type: lower-roman;
}

.d2-947802846 .md ul ul ol,
.d2-947802846 .md ul ol ol,
.d2-947802846 .md ol ul ol,
.d2-947802846 .md ol ol ol {
  list-style-type: lower-alpha;
}

.d2-947802846 .md dd {
  margin-left: 0;
}

.d2-947802846 .md pre {
  margin-top: 0;
  margin-bottom: 0;
  word-wrap: normal;
}

.d2-947802846 .md ::placeholder {
  color: var(--color-fg-subtle);
  opacity: 1;
}

.d2-947802846 .md input::-webkit-outer-spin-button,
.d2-947802846 .md input::-webkit-inner-spin-button {
  margin: 0;
  -webkit-appearance: none;
  appearance: none;
}

.d2-947802846 .md::before {
  display: table;
  content: "";
}

.d2-947802846 .md::after {
  display: table;
  clear: both;
  content: "";
}

.d2-947802846 .md > *:first-child {
  margin-top: 0 !important;
}

.d2-947802846 .md > *:last-child {
  margin-bottom: 0 !important;
}

.d2-947802846 .md a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.d2-947802846 .md .absent {
  color: var(--color-danger-fg);
}

.d2-947802846 .md .anchor {
  float: left;
  padding-right: 4px;
  margin-left: -20px;
  line-height: 1;
}

.d2-947802846 .md .anchor:focus {
  outline: none;
}

.d2-947802846 .md p,
.d2-947802846 .md blockquote,
.d2-947802846 .md ul,
.d2-947802846 .md ol,
.d2-947802846 .md dl,
.d2-947802846 .md table,
.d2-947802846 .md pre,
.d2-947802846 .md details {
  margin-top: 0;
  margin-bottom: 16px;
}

.d2-947802846 .md blockquote > :first-child {
  margin-top: 0;
}

.d2-947802846 .md blockquote > :last-child {
  margin-bottom: 0;
}

.d2-947802846 .md sup > a::before {
  content: "[";
}

.d2-947802846 .md sup > a::after {
  content: "]";
}

.d2-947802846 .md h1:hover .anchor,
.d2-947802846 .md h2:hover .anchor,
.d2-947802846 .md h3:hover .anchor,
.d2-947802846 .md h4:hover .anchor,
.d2-947802846 .md h5:hover .anchor,
.d2-947802846 .md h6:hover .anchor {
  text-decoration: none;
}

.d2-947802846 .md h1 tt,
.d2-947802846 .md h1 code,
.d2-947802846 .md h2 tt,
.d2-947802846 .md h2 code,
.d2-947802846 .md h3 tt,
.d2-947802846 .md h3 code,
.d2-947802846 .md h4 tt,
.d2-947802846 .md h4 code,
.d2-947802846 .md h5 tt,
.d2-947802846 .md h5 code,
.d2-947802846 .md h6 tt,
.d2-947802846 .md h6 code {
  padding: 0 0.2em;
  font-size: inherit;
}

.d2-947802846 .md ul.no-list,
.d2-947802846 .md ol.no-list {
  padding: 0;
  list-style-type: none;
}

.d2-947802846 .md ol[type="1"] {
  list-style-type: decimal;
}

.d2-947802846 .md ol[type="a"] {
  list-style-type: lower-alpha;
}

.d2-947802846 .md ol[type="i"] {
  list-style-type: lower-roman;
}

.d2-947802846 .md div > ol:not([type]) {
  list-style-type: decimal;
}

.d2-947802846 .md ul ul,
.d2-947802846 .md ul ol,
.d2-947802846 .md ol ol,
.d2-947802846 .md ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.d2-947802846 .md li > p {
  margin-top: 16px;
}

.d2-947802846 .md li + li {
  margin-top: 0.25em;
}

.d2-947802846 .md dl {
  padding: 0;
}

.d2-947802846 .md dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-family: "d2-947802846-font-semibold";
}

.d2-947802846 .md dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.d2-947802846 .md table th {
  font-family: "d2-947802846-font-semibold";
}

.d2-947802846 .md table th,
.d2-947802846 .md table td {
  padding: 6px 13px;
  border: 1px solid var(--color-border-default);
}

.d2-947802846 .md table tr {
  background-color: var(--color-canvas-default);
  border-top: 1px solid var(--color-border-muted);
}

.d2-947802846 .md table tr:nth-child(2n) {
  background-color: var(--color-canvas-subtle);
}

.d2-947802846 .md table img {
  background-color: transparent;
}

.d2-947802846 .md img[align="right"] {
  padding-left: 20px;
}

.d2-947802846 .md img[align="left"] {
  padding-right: 20px;
}

.d2-947802846 .md span.frame {
  display: block;
  overflow: hidden;
}

.d2-947802846 .md span.frame > span {
  display: block;
  float: left;
  width: auto;
  padding: 7px;
  margin: 13px 0 0;
  overflow: hidden;
  border: 1px solid var(--color-border-default);
}

.d2-947802846 .md span.frame span img {
  display: block;
  float: left;
}

.d2-947802846 .md span.frame span span {
  display: block;
  padding: 5px 0 0;
  clear: both;
  color: var(--color-fg-default);
}

.d2-947802846 .md span.align-center {
  display: block;
  overflow: hidden;
  clear: both;
}

.d2-947802846 .md span.align-center > span {
  display: block;
  margin: 13px auto 0;
  overflow: hidden;
  text-align: center;
}

.d2-947802846 .md span.align-center span img {
  margin: 0 auto;
  text-align: center;
}

.d2-947802846 .md span.align-right {
  display: block;
  overflow: hidden;
  clear: both;
}

.d2-947802846 .md span.align-right > span {
  display: block;
  margin: 13px 0 0;
  overflow: hidden;
  text-align: right;
}

.d2-947802846 .md span.align-right span img {
  margin: 0;
  text-align: right;
}

.d2-947802846 .md span.float-left {
  display: block;
  float: left;
  margin-right: 13px;
  overflow: hidden;
}

.d2-947802846 .md span.float-left span {
  margin: 13px 0 0;
}

.d2-947802846 .md span.float-right {
  display: block;
  float: right;
  margin-left: 13px;
  overflow: hidden;
}

.d2-947802846 .md span.float-right > span {
  display: block;
  margin: 13px auto 0;
  overflow: hidden;
  text-align: right;
}

.d2-947802846 .md code,
.d2-947802846 .md tt {
  padding: 0.2em 0.4em;
  margin: 0;
  font-size: 85%;
  background-color: var(--color-neutral-muted);
  border-radius: 6px;
}

.d2-947802846 .md code br,
.d2-947802846 .md tt br {
  display: none;
}

.d2-947802846 .md del code {
  text-decoration: inherit;
}

.d2-947802846 .md pre code {
  font-size: 100%;
}

.d2-947802846 .md pre > code {
  padding: 0;
  margin: 0;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.d2-947802846 .md .highlight {
  margin-bottom: 16px;
}

.d2-947802846 .md .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.d2-947802846 .md .highlight pre,
.d2-947802846 .md pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: var(--color-canvas-subtle);
  border-radius: 6px;
}

.d2-947802846 .md pre code,
.d2-947802846 .md pre tt {
  display: inline;
  max-width: auto;
  padding: 0;
  margin: 0;
  overflow: visible;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.d2-947802846 .md .csv-data td,
.d2-947802846 .md .csv-data th {
  padding: 5px;
  overflow: hidden;
  font-size: 12px;
  line-height: 1;
  text-align: left;
  white-space: nowrap;
}

.d2-947802846 .md .csv-data .blob-num {
  padding: 10px 8px 9px;
  text-align: right;
  background: var(--color-canvas-default);
  border: 0;
}

.d2-947802846 .md .csv-data tr {
  border-top: 0;
}

.d2-947802846 .md .csv-data th {
  font-family: "d2-947802846-font-semibold";
  background: var(--color-canvas-subtle);
  border-top: 0;
}

.d2-947802846 .md .footnotes {
  font-size: 12px;
  color: var(--color-fg-muted);
  border-top: 1px solid var(--color-border-default);
}

.d2-947802846 .md .footnotes ol {
  padding-left: 16px;
}

.d2-947802846 .md .footnotes li {
  position: relative;
}

.d2-947802846 .md .footnotes li:target::before {
  position: absolute;
  top: -8px;
  right: -8px;
  bottom: -8px;
  left: -24px;
  pointer-events: none;
  content: "";
  border: 2px solid var(--color-accent-emphasis);
  border-radius: 6px;
}

.d2-947802846 .md .footnotes li:target {
  color: var(--color-fg-default);
}

.d2-947802846 .md .task-list-item {
  list-style-type: none;
}

.d2-947802846 .md .task-list-item label {
  font-weight: 400;
}

.d2-947802846 .md .task-list-item.enabled label {
  cursor: pointer;
}

.d2-947802846 .md .task-list-item + .task-list-item {
  margin-top: 3px;
}

.d2-947802846 .md .task-list-item .handle {
  display: none;
}

.d2-947802846 .md .task-list-item-checkbox {
  margin: 0 0.2em 0.25em -1.6em;
  vertical-align: middle;
}

.d2-947802846 .md .contains-task-list:dir(rtl) .task-list-item-checkbox {
  margin: 0 -1.6em 0.25em 0.2em;
}
</style><g class="dGl0bGU="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="11835.000000" y="-82.000000" width="897" height="91"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><h1>Event Loop with epoll  Implementation-Ready System Blueprint</h1>
<p><strong>C | Linux | Reactor Pattern | C10K</strong></p>
</div></foreignObject></g></g><g class="aHdfbGF5ZXI="><g class="shape" ><rect x="4458.000000" y="2013.000000" width="1498.000000" height="412.000000" rx="8.000000" stroke="#E65100" fill="#FFF3E0" style="stroke-width:3;" /></g><text x="5207.000000" y="2031.000000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:13px">HARDWARE LAYER  NIC + CPU</text></g><g class="a2VybmVsX2xheWVy"><g class="shape" ><rect x="6267.000000" y="988.000000" width="4013.000000" height="1161.000000" rx="8.000000" stroke="#1B5E20" fill="#E8F5E9" style="stroke-width:3;" /></g><text x="8273.500000" y="1006.000000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:13px">KERNEL LAYER  epoll + TCP Stack</text></g><g class="bTFfbGF5ZXI= milestone"><g class="shape" ><rect x="11865.000000" y="155.000000" width="1877.000000" height="2275.000000" rx="8.000000" stroke="#0D47A1" fill="#E3F2FD" style="stroke-width:3;" /></g><text x="12803.500000" y="173.000000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:13px">M1: epoll Basics  LT vs ET Echo Server</text></g><g class="bTJfbGF5ZXI= milestone"><g class="shape" ><rect x="16553.000000" y="69.000000" width="3760.000000" height="3121.000000" rx="8.000000" stroke="#6A1B9A" fill="#F3E5F5" style="stroke-width:3;" /></g><text x="18433.000000" y="87.000000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:13px">M2: Write Buffering + Timer Management</text></g><g class="bTNfbGF5ZXI= milestone"><g class="shape" ><rect x="20570.000000" y="3746.000000" width="3940.000000" height="2688.000000" rx="8.000000" stroke="#283593" fill="#E8EAF6" style="stroke-width:3;" /></g><text x="22540.000000" y="3764.000000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:13px">M3: Reactor API  Callback Dispatch + Safe Modification</text></g><g class="bTRfbGF5ZXI= milestone"><g class="shape" ><rect x="10619.000000" y="2505.000000" width="5615.000000" height="3145.000000" rx="8.000000" stroke="#004D40" fill="#E0F2F1" style="stroke-width:3;" /></g><text x="13426.500000" y="2523.000000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:13px">M4: HTTP/1.1 Static File Server  C10K</text></g><g class="c2NhbGVfcmVm"><g class="shape" ><rect x="6267.000000" y="2169.000000" width="610.000000" height="694.000000" rx="6.000000" stroke="#757575" fill="#FAFAFA" style="stroke-width:2;" /></g><text x="6572.000000" y="2184.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:10px">Scale Reference Card</text></g><g class="a25vd2xlZGdlX2Nhc2NhZGU="><g class="shape" ><rect x="12.000000" y="1869.000000" width="5949.000000" height="124.000000" rx="6.000000" stroke="#33691E" fill="#F1F8E9" style="stroke-width:2;" /></g><text x="2986.500000" y="1884.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:10px">Knowledge Cascade  Real-World Connections</text></g><g class="aHdfbGF5ZXIubmlj hw_box"><g class="shape" ><rect x="4668.000000" y="2063.000000" width="1238.000000" height="124.000000" rx="4.000000" stroke="#880E4F" fill="#FCE4EC" style="stroke-width:2;" /></g><text x="5287.000000" y="2079.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:11px">NIC (Network Interface Card)</text></g><g class="aHdfbGF5ZXIuY3B1X2NhY2hl hw_box"><g class="shape" ><rect x="4508.000000" y="2207.000000" width="1398.000000" height="124.000000" rx="4.000000" stroke="#880E4F" fill="#FCE4EC" style="stroke-width:2;" /></g><text x="5207.000000" y="2223.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:11px">CPU Cache Hierarchy</text></g><g class="aHdfbGF5ZXIuZG1hX25vdGU="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="4705.000000" y="2351.000000" width="1004" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>DMA</strong>: NIC writes TCP payload
directly to kernel sk_receive_queue
 zero CPU involvement
AVX2 memcpy: 32B/inst, ~64 inst
for 4096B  ~20 ns @ 3 GHz</p>
</div></foreignObject></g></g><g class="a2VybmVsX2xheWVyLmVwb2xsX2luc3RhbmNl kernel_box"><g class="shape" ><rect x="8708.000000" y="1499.000000" width="1522.000000" height="264.000000" rx="4.000000" stroke="#2E7D32" fill="#E8F5E9" style="stroke-width:2;" /></g><text x="9469.000000" y="1515.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:11px">epoll Instance (kernel fd)</text></g><g class="a2VybmVsX2xheWVyLmVwb2xsX2V2ZW50X3N0cnVjdA== struct_box"><g class="shape" ><rect x="7130.000000" y="1038.000000" width="539.000000" height="511.000000" rx="4.000000" stroke="#F57F17" fill="#FFF8E1" style="stroke-width:2;" /></g><text x="7399.500000" y="1054.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">struct epoll_event</text></g><g class="a2VybmVsX2xheWVyLnRjcF9zdGFjaw== kernel_box"><g class="shape" ><rect x="6317.000000" y="1569.000000" width="2166.000000" height="124.000000" rx="4.000000" stroke="#2E7D32" fill="#E8F5E9" style="stroke-width:2;" /></g><text x="7400.000000" y="1585.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:11px">TCP Stack (net/ipv4/tcp_input.c)</text></g><g class="a2VybmVsX2xheWVyLnZkc28= kernel_box"><g class="shape" ><rect x="8961.000000" y="1783.000000" width="1269.000000" height="124.000000" rx="4.000000" stroke="#2E7D32" fill="#E8F5E9" style="stroke-width:2;" /></g><text x="9595.500000" y="1799.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:11px">vDSO  clock_gettime</text></g><g class="a2VybmVsX2xheWVyLnNvY2tldF9jZmc= kernel_box"><g class="shape" ><rect x="7111.000000" y="1713.000000" width="577.000000" height="386.000000" rx="4.000000" stroke="#2E7D32" fill="#E8F5E9" style="stroke-width:2;" /></g><text x="7399.500000" y="1729.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:11px">Socket Configuration Syscalls</text></g><g class="bTFfbGF5ZXIubTFfZmlsZXM="><g class="shape" ><rect x="12664.000000" y="205.000000" width="278.000000" height="58.000000" rx="4.000000" stroke="#1565C0" fill="#BBDEFB" style="stroke-width:2;" /></g><text x="12803.000000" y="237.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:10px">Files: reactor_core.h / reactor_core.c / echo_server.c</text></g><g class="bTFfbGF5ZXIuY29ubl9zdGF0ZV9tMQ== struct_box"><g class="shape" ><rect x="13067.000000" y="283.000000" width="625.000000" height="365.000000" rx="4.000000" stroke="#F57F17" fill="#FFF8E1" style="stroke-width:2;" /></g><text x="13379.500000" y="299.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">conn_state_t  Per-Connection State Array</text></g><g class="bTFfbGF5ZXIubHRfbG9vcA== fn_box"><g class="shape" ><rect x="11915.000000" y="668.000000" width="587.000000" height="594.000000" rx="4.000000" stroke="#7B1FA2" fill="#F3E5F5" style="stroke-width:2;" /></g><text x="12208.500000" y="684.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">Level-Triggered Event Loop</text></g><g class="bTFfbGF5ZXIuZXRfbG9vcA== fn_box"><g class="shape" ><rect x="11915.000000" y="1282.000000" width="596.000000" height="573.000000" rx="4.000000" stroke="#7B1FA2" fill="#F3E5F5" style="stroke-width:2;" /></g><text x="12213.000000" y="1298.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">Edge-Triggered Event Loop</text></g><g class="bTFfbGF5ZXIubHRfdnNfZXQ="><g class="shape" ><rect x="12528.000000" y="1875.000000" width="550.000000" height="361.000000" rx="4.000000" stroke="#01579B" fill="#E1F5FE" style="stroke-width:2;" /></g><text x="12803.000000" y="1890.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:10px">LT vs ET Comparison</text></g><g class="bTFfbGF5ZXIubTFfcGl0ZmFsbHM="><g class="shape" ><rect x="11915.000000" y="2256.000000" width="1777.000000" height="124.000000" rx="4.000000" stroke="#C62828" fill="#FFEBEE" style="stroke-width:2;" /></g><text x="12803.500000" y="2271.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:10px">M1 Critical Pitfalls</text></g><g class="bTJfbGF5ZXIubTJfZmlsZXM="><g class="shape" ><rect x="17836.000000" y="119.000000" width="341.000000" height="58.000000" rx="4.000000" stroke="#4A148C" fill="#E1BEE7" style="stroke-width:2;" /></g><text x="18006.500000" y="151.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:10px">Files: write_buffer.h / write_buffer.c / timer_heap.h / timer_heap.c</text></g><g class="bTJfbGF5ZXIud3JpdGVfYnVmX3N0cnVjdA== struct_box"><g class="shape" ><rect x="17704.000000" y="197.000000" width="606.000000" height="407.000000" rx="4.000000" stroke="#F57F17" fill="#FFF8E1" style="stroke-width:2;" /></g><text x="18007.000000" y="213.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">write_buf_t  Dynamic Output Queue</text></g><g class="bTJfbGF5ZXIuY29ubl9zdGF0ZV9tMg== struct_box"><g class="shape" ><rect x="16603.000000" y="624.000000" width="673.000000" height="386.000000" rx="4.000000" stroke="#F57F17" fill="#FFF8E1" style="stroke-width:2;" /></g><text x="16939.500000" y="640.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">conn_state_t (M2 Extended)</text></g><g class="bTJfbGF5ZXIuY29ubl93cml0ZV9mbg== fn_box"><g class="shape" ><rect x="17699.000000" y="1030.000000" width="615.000000" height="781.000000" rx="4.000000" stroke="#7B1FA2" fill="#F3E5F5" style="stroke-width:2;" /></g><text x="18006.500000" y="1046.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">conn_write()  Buffered Write Path</text></g><g class="bTJfbGF5ZXIuY29ubl9mbHVzaF9mbg== fn_box"><g class="shape" ><rect x="19657.000000" y="1102.000000" width="606.000000" height="636.000000" rx="4.000000" stroke="#7B1FA2" fill="#F3E5F5" style="stroke-width:2;" /></g><text x="19960.000000" y="1118.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">conn_flush()  Drain on EPOLLOUT</text></g><g class="bTJfbGF5ZXIudGltZXJfZW50cnlfc3RydWN0 struct_box"><g class="shape" ><rect x="17704.000000" y="1831.000000" width="606.000000" height="407.000000" rx="4.000000" stroke="#F57F17" fill="#FFF8E1" style="stroke-width:2;" /></g><text x="18007.000000" y="1847.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">timer_entry_t  Min-Heap Node</text></g><g class="bTJfbGF5ZXIudGltZXJfb3Bz fn_box"><g class="shape" ><rect x="17689.000000" y="2258.000000" width="635.000000" height="594.000000" rx="4.000000" stroke="#7B1FA2" fill="#F3E5F5" style="stroke-width:2;" /></g><text x="18006.500000" y="2274.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">Timer Heap Operations</text></g><g class="bTJfbGF5ZXIuZXBvbGxvdXRfY3ljbGU="><g class="shape" ><rect x="16603.000000" y="2872.000000" width="2808.000000" height="124.000000" rx="4.000000" stroke="#4527A0" fill="#EDE7F6" style="stroke-width:2;" /></g><text x="18007.000000" y="2887.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:10px">EPOLLOUT Lifecycle (3-Step Cycle)</text></g><g class="bTJfbGF5ZXIubTJfcGl0ZmFsbHM="><g class="shape" ><rect x="16972.000000" y="3016.000000" width="2069.000000" height="124.000000" rx="4.000000" stroke="#C62828" fill="#FFEBEE" style="stroke-width:2;" /></g><text x="18006.500000" y="3031.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:10px">M2 Critical Pitfalls</text></g><g class="bTNfbGF5ZXIubTNfZmlsZXM="><g class="shape" ><rect x="21571.000000" y="4004.000000" width="249.000000" height="58.000000" rx="4.000000" stroke="#1A237E" fill="#C5CAE9" style="stroke-width:2;" /></g><text x="21695.500000" y="4036.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:10px">Files: reactor.h / reactor_internal.h / reactor.c</text></g><g class="bTNfbGF5ZXIucmVhY3Rvcl9hcGk= fn_box"><g class="shape" ><rect x="22136.000000" y="4082.000000" width="635.000000" height="781.000000" rx="4.000000" stroke="#7B1FA2" fill="#F3E5F5" style="stroke-width:2;" /></g><text x="22453.500000" y="4098.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">reactor.h  Public API (5 Functions)</text></g><g class="bTNfbGF5ZXIuZmRfaGFuZGxlcl9zdHJ1Y3Q= struct_box"><g class="shape" ><rect x="22175.000000" y="5025.000000" width="596.000000" height="407.000000" rx="4.000000" stroke="#F57F17" fill="#FFF8E1" style="stroke-width:2;" /></g><text x="22473.000000" y="5041.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">fd_handler_t  Registration Record</text></g><g class="bTNfbGF5ZXIucmVhY3Rvcl9zdHJ1Y3Q= struct_box"><g class="shape" ><rect x="21392.000000" y="5452.000000" width="606.000000" height="407.000000" rx="4.000000" stroke="#F57F17" fill="#FFF8E1" style="stroke-width:2;" /></g><text x="21695.000000" y="5468.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">reactor_t  Internal State</text></g><g class="bTNfbGF5ZXIucmVhY3Rvcl9ydW5fZm4= fn_box"><g class="shape" ><rect x="23012.000000" y="3796.000000" width="596.000000" height="844.000000" rx="4.000000" stroke="#7B1FA2" fill="#F3E5F5" style="stroke-width:2;" /></g><text x="23310.000000" y="3812.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">reactor_run()  Main Dispatch Loop</text></g><g class="bTNfbGF5ZXIuem9tYmllX21lY2hhbmlzbQ== fn_box"><g class="shape" ><rect x="23006.000000" y="4708.000000" width="615.000000" height="781.000000" rx="4.000000" stroke="#7B1FA2" fill="#F3E5F5" style="stroke-width:2;" /></g><text x="23313.500000" y="4724.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">Zombie + Deferred Mod  Use-After-Free Defense</text></g><g class="bTNfbGF5ZXIuZGVmZXJyZWRfdGFza19mbg== fn_box"><g class="shape" ><rect x="23854.000000" y="4822.000000" width="606.000000" height="553.000000" rx="4.000000" stroke="#7B1FA2" fill="#F3E5F5" style="stroke-width:2;" /></g><text x="24157.000000" y="4838.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">reactor_defer()  Post-Dispatch Tasks</text></g><g class="bTNfbGF5ZXIubTNfdGlja19vcmRlcg=="><g class="shape" ><rect x="21333.000000" y="5879.000000" width="725.000000" height="360.000000" rx="4.000000" stroke="#3949AB" fill="#E8EAF6" style="stroke-width:2;" /></g><text x="21695.500000" y="5894.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:10px">Reactor Tick Ordering (Invariants)</text></g><g class="bTNfbGF5ZXIubTNfcGl0ZmFsbHM="><g class="shape" ><rect x="20620.000000" y="6259.000000" width="2151.000000" height="124.000000" rx="4.000000" stroke="#C62828" fill="#FFEBEE" style="stroke-width:2;" /></g><text x="21695.500000" y="6274.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:10px">M3 Critical Pitfalls</text></g><g class="bTRfbGF5ZXIubTRfZmlsZXM="><g class="shape" ><rect x="12316.000000" y="2555.000000" width="384.000000" height="58.000000" rx="4.000000" stroke="#00695C" fill="#B2DFDB" style="stroke-width:2;" /></g><text x="12508.000000" y="2587.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:10px">Files: http_server.h / http_parser.c / http_core.c / http_connection.c / main.c</text></g><g class="bTRfbGF5ZXIuaHR0cF9zdGF0ZV9lbnVt struct_box"><g class="shape" ><rect x="12196.000000" y="2633.000000" width="625.000000" height="469.000000" rx="4.000000" stroke="#F57F17" fill="#FFF8E1" style="stroke-width:2;" /></g><text x="12508.500000" y="2649.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">conn_http_state  Protocol State Machine</text></g><g class="bTRfbGF5ZXIuaHR0cF9yZXF1ZXN0X3N0cnVjdA== struct_box"><g class="shape" ><rect x="12191.000000" y="3122.000000" width="635.000000" height="282.000000" rx="4.000000" stroke="#F57F17" fill="#FFF8E1" style="stroke-width:2;" /></g><text x="12508.500000" y="3138.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">http_request_t  Parsed Request</text></g><g class="bTRfbGF5ZXIuaHR0cF9jb25uX3N0cnVjdA== struct_box"><g class="shape" ><rect x="12186.000000" y="3424.000000" width="644.000000" height="449.000000" rx="4.000000" stroke="#F57F17" fill="#FFF8E1" style="stroke-width:2;" /></g><text x="12508.000000" y="3440.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">http_conn_t  Connection Context (user_data)</text></g><g class="bTRfbGF5ZXIuaHR0cF9wYXJzZXI= fn_box"><g class="shape" ><rect x="14583.000000" y="4038.000000" width="692.000000" height="906.000000" rx="4.000000" stroke="#7B1FA2" fill="#F3E5F5" style="stroke-width:2;" /></g><text x="14929.000000" y="4054.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">http_parse_incremental()  State Machine Parser</text></g><g class="bTRfbGF5ZXIuaHR0cF9vbl9yZWFkYWJsZQ== fn_box"><g class="shape" ><rect x="12186.000000" y="3893.000000" width="644.000000" height="1197.000000" rx="4.000000" stroke="#7B1FA2" fill="#F3E5F5" style="stroke-width:2;" /></g><text x="12508.000000" y="3909.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">http_on_readable()  Read + Parse Loop</text></g><g class="bTRfbGF5ZXIuaHR0cF9wcm9jZXNzX2Zu fn_box"><g class="shape" ><rect x="15521.000000" y="3976.000000" width="663.000000" height="1031.000000" rx="4.000000" stroke="#7B1FA2" fill="#F3E5F5" style="stroke-width:2;" /></g><text x="15852.500000" y="3992.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">http_process_request()  File Serving</text></g><g class="bTRfbGF5ZXIuaHR0cF9jb25uX2Nsb3Nl fn_box"><g class="shape" ><rect x="15540.000000" y="5027.000000" width="644.000000" height="573.000000" rx="4.000000" stroke="#7B1FA2" fill="#F3E5F5" style="stroke-width:2;" /></g><text x="15862.000000" y="5043.000000" fill="#0A0F25" class="text-mono fill-N1" style="text-anchor:middle;font-size:11px">http_conn_close_deferred()  Cleanup (ONLY valid close path)</text></g><g class="bTRfbGF5ZXIubTRfcGVyZg=="><g class="shape" ><rect x="10669.000000" y="5110.000000" width="3679.000000" height="124.000000" rx="4.000000" stroke="#006064" fill="#E0F7FA" style="stroke-width:2;" /></g><text x="12508.500000" y="5125.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:10px">C10K Performance Targets</text></g><g class="bTRfbGF5ZXIuc2xvd19sb3Jpcw=="><g class="shape" ><rect x="11265.000000" y="5254.000000" width="2486.000000" height="124.000000" rx="4.000000" stroke="#B71C1C" fill="#FFEBEE" style="stroke-width:2;" /></g><text x="12508.000000" y="5269.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:10px">Slow Loris Defense (Dual Timer)</text></g><g class="bTRfbGF5ZXIubTRfcGl0ZmFsbHM="><g class="shape" ><rect x="11269.000000" y="5398.000000" width="2479.000000" height="124.000000" rx="4.000000" stroke="#C62828" fill="#FFEBEE" style="stroke-width:2;" /></g><text x="12508.500000" y="5413.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:10px">M4 Critical Pitfalls</text></g><g class="c2NhbGVfcmVmLnRhYmxl"><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="6317.000000" y="2219.000000" width="510" height="594"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><table>
<thead>
<tr>
<th>Object</th>
<th>Size</th>
<th>Fits In</th>
</tr>
</thead>
<tbody>
<tr>
<td>epoll_event struct</td>
<td>12 bytes</td>
<td>5/cache line</td>
</tr>
<tr>
<td>conn_state_t (M1)</td>
<td>4,112 bytes</td>
<td>64 cache lines</td>
</tr>
<tr>
<td>conn_state_t (M2)</td>
<td>4,152 bytes</td>
<td>65 cache lines</td>
</tr>
<tr>
<td>write_buf_t struct</td>
<td>24 bytes</td>
<td>&lt;1 cache line</td>
</tr>
<tr>
<td>timer_entry_t</td>
<td>16 bytes</td>
<td>4/cache line</td>
</tr>
<tr>
<td>fd_handler_t</td>
<td>24 bytes</td>
<td>2/cache line</td>
</tr>
<tr>
<td>http_conn_t (M4)</td>
<td>~17,500 bytes</td>
<td>~274 cache lines</td>
</tr>
<tr>
<td>handlers[65536] array</td>
<td>1.5 MB</td>
<td>L2/L3 cache</td>
</tr>
<tr>
<td>timer heap[65536]</td>
<td>1 MB (16B65K)</td>
<td>L2 cache</td>
</tr>
<tr>
<td>connections[65536] M1</td>
<td>~256 MB</td>
<td>RAM only</td>
</tr>
<tr>
<td>MAX_EVENTS=1024 events array</td>
<td>12 KB</td>
<td>L1 cache</td>
</tr>
<tr>
<td>TCP recv buffer default</td>
<td>87 KB</td>
<td>kernel</td>
</tr>
<tr>
<td>TCP send buffer default</td>
<td>87 KB</td>
<td>kernel</td>
</tr>
<tr>
<td>10K conns M1 RSS</td>
<td>~40 MB</td>
<td>L3+RAM</td>
</tr>
<tr>
<td>10K conns M4 RSS</td>
<td>~175 MB</td>
<td>RAM</td>
</tr>
</tbody>
</table>
</div></foreignObject></g></g><g class="a25vd2xlZGdlX2Nhc2NhZGUuZGVzYw=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="62.000000" y="1919.000000" width="5849" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>NGINX</strong>: ET mode, drain discipline enforced by module API; ngx_handle_read_event()
<strong>Redis</strong>: ae.c  same EPOLLOUT register-flush-deregister cycle; networking.c:writeToClient()
<strong>Node.js/libuv</strong>: LT mode chosen deliberately; maintenance burden of ET drain too high
<strong>Go runtime</strong>: netpoll_epoll.go  same epoll_wait timeout trick; time.go min-heap timers
<strong>io_uring</strong> (Linux 5.1+): Proactor model; IORING_OP_READ submits op, completion fires when done
<strong>gRPC</strong>: Length-prefix framing (5B header); same incremental parse discipline as HTTP
<strong>JS microtask queue</strong>: reactor_defer  Promise.then queue; runs after current task
<strong>Linux kernel bottom-half</strong>: softirq  reactor_defer; deferred from interrupt context
<strong>Game ECS</strong>: Entity destroy during iteration  zombie flag pattern (Flecs &quot;deferred world&quot;)
<strong>Slow loris (2009)</strong>: Exactly the accumulation window exploit you defend with dual timers</p>
</div></foreignObject></g></g><g class="aHdfbGF5ZXIubmljLmRlc2M="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="4718.000000" y="2113.000000" width="1138" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>RX Ring Buffer</strong>  DMA write, no CPU
<strong>TX Ring Buffer</strong>  DMA read, no CPU
Interrupt  NAPI poll at high pps
Line rate: 1 Gbps = 125 MB/s
Segment size: 1500B MTU (Ethernet)</p>
</div></foreignObject></g></g><g class="aHdfbGF5ZXIuY3B1X2NhY2hlLmRlc2M="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="4558.000000" y="2257.000000" width="1298" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>L1d</strong> 3264 KB  ~4 cycles
<strong>L2</strong>  256 KB2 MB  ~12 cycles
<strong>L3</strong>  832 MB  ~40 cycles
<strong>RAM</strong> DRAM  ~200 cycles
Cache line = <strong>64 bytes</strong>
TLB miss  110 s (page fault)
Branch mispredict  1520 cycles</p>
</div></foreignObject></g></g><g class="a2VybmVsX2xheWVyLmVwb2xsX2luc3RhbmNlLnN5c2NhbGxz"><g class="shape" ></g><g transform="translate(9273.000000 1549.000000)" class="light-code"><rect width="391.000000" height="120.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;syscalls&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#990000" class="text-mono-bold">epoll_create1</tspan>(EPOLL_CLOEXEC)&#160;<tspan fill="#a61717"></tspan>&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;epfd
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#990000" class="text-mono-bold">epoll_ctl</tspan>(epfd,&#160;OP,&#160;fd,&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>ev)&#160;<tspan fill="#a61717"></tspan>&#160;<tspan fill="#009999">0</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;<tspan fill="#990000" class="text-mono-bold">OPS</tspan>:&#160;EPOLL_CTL_ADD&#160;<tspan fill="#000000" class="text-mono-bold">|</tspan>&#160;MOD&#160;<tspan fill="#000000" class="text-mono-bold">|</tspan>&#160;DEL
</text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#990000" class="text-mono-bold">epoll_wait</tspan>(epfd,&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>evs,&#160;max,&#160;ms)&#160;<tspan fill="#a61717"></tspan>&#160;n</text></g></g><g transform="translate(9273.000000 1549.000000)" class="dark-code"><rect width="391.000000" height="120.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;syscalls&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#89b4fa">epoll_create1</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">EPOLL_CLOEXEC</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#89b4fa">epoll_ctl</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">OP</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">ev</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89dceb">OPS</tspan><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">:</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">EPOLL_CTL_ADD</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">MOD</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">DEL</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#89b4fa">epoll_wait</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">evs</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">max</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">ms</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan></text></g></g></g><g class="a2VybmVsX2xheWVyLmVwb2xsX2luc3RhbmNlLmludGVybmFscw=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="8758.000000" y="1689.000000" width="1422" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>interest list</strong>: rb-tree of epitem
<strong>ready list</strong> (rdllist): doubly-linked
LT: fd re-added to rdllist if data remains
ET: fd removed until new data arrives
epitem size  128B each
MAX_EVENTS=1024  12KB stack array (L1-hot)</p>
</div></foreignObject></g></g><g class="a2VybmVsX2xheWVyLmVwb2xsX2V2ZW50X3N0cnVjdC5sYXlvdXQ="><g class="shape" ></g><g transform="translate(7180.000000 1088.000000)" class="light-code"><rect width="439.000000" height="411.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;&lt;sys/epoll.h&gt;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;epoll_event&#160;{
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;&#160;&#160;&#160;&#160;events;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x00&#160;&#160;4B&#160;*/</tspan>
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">epoll_data_t</tspan>&#160;data;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x04&#160;&#160;8B&#160;*/</tspan>
</text><text class="text-mono" x="0" y="6.200000em">};&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;total:&#160;12&#160;bytes&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;events&#160;flags&#160;*/</tspan>
</text><text class="text-mono" x="0" y="8.800000em">EPOLLIN&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0x001</tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;readable&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="10.100000em">EPOLLOUT&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0x004</tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;writable&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="11.400000em">EPOLLERR&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0x008</tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;error&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="12.700000em">EPOLLHUP&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0x010</tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;hangup&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="14.000000em">EPOLLRDHUP<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0x2000</tspan>&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;peer&#160;half-close&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em">EPOLLET&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">1u</tspan><tspan fill="#000000" class="text-mono-bold">&lt;</tspan><tspan fill="#000000" class="text-mono-bold">&lt;</tspan><tspan fill="#009999">31</tspan>&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;edge-triggered&#160;*/</tspan>
</text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;data&#160;union&#160;*/</tspan>
</text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#000000" class="text-mono-bold">union</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">epoll_data_t</tspan>&#160;{
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>ptr;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;&#160;fd_handler_t*&#160;(M3)&#160;*/</tspan>
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;fd;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;fd&#160;int&#160;(M1/M2)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;u32;
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint64_t</tspan>&#160;u64;
</text><text class="text-mono" x="0" y="24.400000em">};</text></g></g><g transform="translate(7180.000000 1088.000000)" class="dark-code"><rect width="439.000000" height="411.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;&lt;sys/epoll.h&gt;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">epoll_event</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x00&#160;&#160;4B&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">epoll_data_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">data</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x04&#160;&#160;8B&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;total:&#160;12&#160;bytes&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;events&#160;flags&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">EPOLLIN</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0x001</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;readable&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">EPOLLOUT</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0x004</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;writable&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">EPOLLERR</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0x008</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;error&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">EPOLLHUP</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0x010</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;hangup&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">EPOLLRDHUP</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0x2000</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;peer&#160;half-close&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">EPOLLET</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">1u</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#fab387">31</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;edge-triggered&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;data&#160;union&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">union</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">epoll_data_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">ptr</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;&#160;fd_handler_t*&#160;(M3)&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;fd&#160;int&#160;(M1/M2)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">u32</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint64_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">u64</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">;</tspan></text></g></g></g><g class="a2VybmVsX2xheWVyLnRjcF9zdGFjay5kZXNj"><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="6367.000000" y="1619.000000" width="2066" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p>sk_receive_queue  recv buffer (87KB default)
sk_send_head  send buffer (87KB default)
sock_def_readable()  wakes epoll
sock_def_write_space()  triggers EPOLLOUT
copy_to_user()  kerneluserspace memcpy
TCP flow control: recv window advertisement
TIME_WAIT: ~60s; bypass with SO_REUSEADDR</p>
</div></foreignObject></g></g><g class="a2VybmVsX2xheWVyLnZkc28uZGVzYw=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="9011.000000" y="1833.000000" width="1169" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p>CLOCK_MONOTONIC via vDSO
Cost: ~30 ns (vs 200 ns real syscall)
Never goes backward (NTP-safe)
Used by timer_next_ms() every tick
Returns: uint64_t ms = sec*1000 + ns/1e6</p>
</div></foreignObject></g></g><g class="a2VybmVsX2xheWVyLnNvY2tldF9jZmcuY2Zn"><g class="shape" ></g><g transform="translate(7161.000000 1763.000000)" class="light-code"><rect width="477.000000" height="286.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#990000" class="text-mono-bold">socket</tspan>(AF_INET,
</text><text class="text-mono" x="0" y="2.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;SOCK_STREAM<tspan fill="#000000" class="text-mono-bold">|</tspan>SOCK_NONBLOCK<tspan fill="#000000" class="text-mono-bold">|</tspan>SOCK_CLOEXEC,
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#009999">0</tspan>)&#160;<tspan fill="#a61717"></tspan>&#160;listen_fd
</text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#990000" class="text-mono-bold">setsockopt</tspan>(fd,&#160;SOL_SOCKET,
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SO_REUSEADDR,&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan><tspan fill="#009999">1</tspan>,&#160;<tspan fill="#009999">4</tspan>)
</text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#990000" class="text-mono-bold">bind</tspan>(fd,&#160;(sockaddr<tspan fill="#000000" class="text-mono-bold">*</tspan>)<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>addr,&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(addr))
</text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#990000" class="text-mono-bold">listen</tspan>(fd,&#160;BACKLOG<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">128</tspan>)
</text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#990000" class="text-mono-bold">accept4</tspan>(listen_fd,&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>addr,&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>len,
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SOCK_NONBLOCK<tspan fill="#000000" class="text-mono-bold">|</tspan>SOCK_CLOEXEC)&#160;<tspan fill="#a61717"></tspan>&#160;client_fd
</text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;non-blocking:&#160;returns&#160;EAGAIN&#160;if&#160;no&#160;pending&#160;*/</tspan>
</text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;set_nonblocking(fd):&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#990000" class="text-mono-bold">fcntl</tspan>(fd,&#160;F_GETFL)&#160;<tspan fill="#a61717"></tspan>&#160;flags
</text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#990000" class="text-mono-bold">fcntl</tspan>(fd,&#160;F_SETFL,&#160;flags<tspan fill="#000000" class="text-mono-bold">|</tspan>O_NONBLOCK)</text></g></g><g transform="translate(7161.000000 1763.000000)" class="dark-code"><rect width="477.000000" height="286.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#89b4fa">socket</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">AF_INET</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">SOCK_STREAM</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">SOCK_NONBLOCK</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">SOCK_CLOEXEC</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">listen_fd</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#89b4fa">setsockopt</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">SOL_SOCKET</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">SO_REUSEADDR</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">4</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#89b4fa">bind</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">sockaddr</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">addr</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">addr</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#89b4fa">listen</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">BACKLOG</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">128</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#89b4fa">accept4</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">listen_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">addr</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">SOCK_NONBLOCK</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">SOCK_CLOEXEC</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;non-blocking:&#160;returns&#160;EAGAIN&#160;if&#160;no&#160;pending&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;set_nonblocking(fd):&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#89b4fa">fcntl</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">F_GETFL</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">flags</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#89b4fa">fcntl</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">F_SETFL</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">flags</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">O_NONBLOCK</tspan><tspan fill="#cdd6f4">)</tspan></text></g></g></g><g class="bTFfbGF5ZXIuY29ubl9zdGF0ZV9tMS5sYXlvdXQ="><g class="shape" ></g><g transform="translate(13117.000000 333.000000)" class="light-code"><rect width="525.000000" height="265.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;reactor_core.h&#160;&#160;indexed&#160;by&#160;fd&#160;value&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;global:&#160;conn_state_t&#160;connections[MAX_FDS=65536]&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;RSS&#160;at&#160;10K&#160;conns:&#160;10000&#160;&#160;4112&#160;&#160;40&#160;MB&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;&#160;&#160;&#160;&#160;read_buf[<tspan fill="#009999">4096</tspan>];&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x0000&#160;4096B&#160;1-page&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;read_len;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x1000&#160;&#160;&#160;&#160;4B&#160;*/</tspan>
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;fd;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x1004&#160;&#160;&#160;&#160;4B&#160;*/</tspan>
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">bool</tspan>&#160;&#160;&#160;&#160;&#160;is_active;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x1008&#160;&#160;&#160;&#160;1B&#160;*/</tspan>
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint8_t</tspan>&#160;&#160;_pad[<tspan fill="#009999">7</tspan>];&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x1009&#160;&#160;&#160;&#160;7B&#160;*/</tspan>
</text><text class="text-mono" x="0" y="12.700000em">}&#160;<tspan fill="#445588" class="text-mono-bold">conn_state_t</tspan>;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;total:&#160;4112&#160;bytes&#160;*/</tspan>
</text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Cache:&#160;read_buf[0..63]&#160;=&#160;1&#160;cache&#160;line&#160;(64B)&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Sequential&#160;fill&#160;&#160;hardware&#160;prefetch&#160;friendly&#160;&#160;&#160;&#160;*/</tspan></text></g></g><g transform="translate(13117.000000 333.000000)" class="dark-code"><rect width="525.000000" height="265.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;reactor_core.h&#160;&#160;indexed&#160;by&#160;fd&#160;value&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;global:&#160;conn_state_t&#160;connections[MAX_FDS=65536]&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;RSS&#160;at&#160;10K&#160;conns:&#160;10000&#160;&#160;4112&#160;&#160;40&#160;MB&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">read_buf</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">4096</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x0000&#160;4096B&#160;1-page&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">read_len</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x1000&#160;&#160;&#160;&#160;4B&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x1004&#160;&#160;&#160;&#160;4B&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">bool</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">is_active</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x1008&#160;&#160;&#160;&#160;1B&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint8_t</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">_pad</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">7</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x1009&#160;&#160;&#160;&#160;7B&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">conn_state_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;total:&#160;4112&#160;bytes&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Cache:&#160;read_buf[0..63]&#160;=&#160;1&#160;cache&#160;line&#160;(64B)&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Sequential&#160;fill&#160;&#160;hardware&#160;prefetch&#160;friendly&#160;&#160;&#160;&#160;*/</tspan></text></g></g></g><g class="bTFfbGF5ZXIubHRfbG9vcC5jb2Rl"><g class="shape" ></g><g transform="translate(11965.000000 718.000000)" class="light-code"><rect width="487.000000" height="494.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;echo_server.c&#160;&#160;run_event_loop_lt()&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;LT&#160;CONTRACT:&#160;re-notified&#160;while&#160;data&#160;remains&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">run_event_loop_lt</tspan>(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;epfd,&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;lfd)&#160;{
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;epoll_event&#160;evs[MAX_EVENTS<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">1024</tspan>];
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;Stack:&#160;102412&#160;=&#160;12KB&#160;&#160;fits&#160;L1&#160;cache&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">for</tspan>(;;)&#160;{
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;n&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">epoll_wait</tspan>(epfd,&#160;evs,
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MAX_EVENTS,&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>);
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;-1&#160;=&#160;block&#160;forever;&#160;EINTR&#160;&#160;continue&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">for</tspan>(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;i<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>;&#160;i<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>n;&#160;i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>)&#160;{
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;fd&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;evs[i].data.fd;
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;ev&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;evs[i].events;
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(fd&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;lfd)
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">handle_new_conn_lt</tspan>(epfd,&#160;lfd);
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">else</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(ev&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>&#160;(EPOLLERR<tspan fill="#000000" class="text-mono-bold">|</tspan>EPOLLHUP))
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">conn_close</tspan>(epfd,&#160;fd);
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">else</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(ev&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>&#160;EPOLLIN)
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">handle_read_lt</tspan>(epfd,&#160;fd);
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="27.000000em">}
</text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Registration:&#160;epoll_add(epfd,&#160;fd,&#160;EPOLLIN)&#160;*/</tspan>
</text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;NO&#160;EPOLLET&#160;flag&#160;&#160;Level-Triggered&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g><g transform="translate(11965.000000 718.000000)" class="dark-code"><rect width="487.000000" height="494.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;echo_server.c&#160;&#160;run_event_loop_lt()&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;LT&#160;CONTRACT:&#160;re-notified&#160;while&#160;data&#160;remains&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">run_event_loop_lt</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">lfd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">epoll_event</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">evs</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">MAX_EVENTS</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">1024</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Stack:&#160;102412&#160;=&#160;12KB&#160;&#160;fits&#160;L1&#160;cache&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">for</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">epoll_wait</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">evs</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">MAX_EVENTS</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;-1&#160;=&#160;block&#160;forever;&#160;EINTR&#160;&#160;continue&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">for</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">evs</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">data</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">ev</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">evs</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">lfd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">handle_new_conn_lt</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">lfd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">ev</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">EPOLLERR</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">EPOLLHUP</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">conn_close</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">ev</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">EPOLLIN</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">handle_read_lt</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Registration:&#160;epoll_add(epfd,&#160;fd,&#160;EPOLLIN)&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;NO&#160;EPOLLET&#160;flag&#160;&#160;Level-Triggered&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g></g><g class="bTFfbGF5ZXIuZXRfbG9vcC5jb2Rl"><g class="shape" ></g><g transform="translate(11965.000000 1332.000000)" class="light-code"><rect width="496.000000" height="473.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;echo_server.c&#160;&#160;run_event_loop_et()&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;ET&#160;CONTRACT:&#160;fire&#160;ONCE&#160;per&#160;state&#160;change&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;MUST&#160;drain&#160;until&#160;EAGAIN&#160;or&#160;data&#160;is&#160;lost!&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;handle_read_et&#160;&#160;DRAIN&#160;LOOP&#160;(mandatory)&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">handle_read_et</tspan>(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;epfd,&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;fd)&#160;{
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">for</tspan>(;;)&#160;{
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;buf[READ_BUF_SIZE<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">4096</tspan>];
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">ssize_t</tspan>&#160;n&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">read</tspan>(fd,&#160;buf,&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(buf));
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(n&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;{
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">write</tspan>(fd,&#160;buf,&#160;n);&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;echo&#160;(M2&#160;buffers)&#160;*/</tspan>
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;continue:&#160;may&#160;be&#160;MORE&#160;data&#160;in&#160;buffer&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;}&#160;<tspan fill="#000000" class="text-mono-bold">else</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(n&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;{
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">conn_close</tspan>(epfd,&#160;fd);&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;EOF&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;}&#160;<tspan fill="#000000" class="text-mono-bold">else</tspan>&#160;{
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(errno<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>EAGAIN<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan>errno<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>EWOULDBLOCK)
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">break</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;DRAINED&#160;&#160;exit&#160;loop&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">conn_close</tspan>(epfd,&#160;fd);&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;error&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="25.700000em">}
</text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Registration:&#160;EPOLLIN&#160;|&#160;EPOLLET&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Accept&#160;loop:&#160;also&#160;drain&#160;until&#160;EAGAIN!&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g><g transform="translate(11965.000000 1332.000000)" class="dark-code"><rect width="496.000000" height="473.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;echo_server.c&#160;&#160;run_event_loop_et()&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;ET&#160;CONTRACT:&#160;fire&#160;ONCE&#160;per&#160;state&#160;change&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;MUST&#160;drain&#160;until&#160;EAGAIN&#160;or&#160;data&#160;is&#160;lost!&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;handle_read_et&#160;&#160;DRAIN&#160;LOOP&#160;(mandatory)&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">handle_read_et</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">for</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">READ_BUF_SIZE</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">4096</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">ssize_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">read</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">write</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;echo&#160;(M2&#160;buffers)&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;continue:&#160;may&#160;be&#160;MORE&#160;data&#160;in&#160;buffer&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">conn_close</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;EOF&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">errno</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">EAGAIN</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">errno</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">EWOULDBLOCK</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">break</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;DRAINED&#160;&#160;exit&#160;loop&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">conn_close</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;error&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Registration:&#160;EPOLLIN&#160;|&#160;EPOLLET&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Accept&#160;loop:&#160;also&#160;drain&#160;until&#160;EAGAIN!&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g></g><g class="bTFfbGF5ZXIubHRfdnNfZXQudGFibGU="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="12578.000000" y="1925.000000" width="450" height="261"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><table>
<thead>
<tr>
<th>Property</th>
<th>LT</th>
<th>ET (EPOLLET)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Read discipline</td>
<td>Single read OK</td>
<td>Drain until EAGAIN</td>
</tr>
<tr>
<td>Accept discipline</td>
<td>One per event</td>
<td>Loop until EAGAIN</td>
</tr>
<tr>
<td>Partial read bug</td>
<td>Re-notified</td>
<td>SILENT DATA LOSS</td>
</tr>
<tr>
<td>Kernel overhead</td>
<td>Slightly higher</td>
<td>Slightly lower</td>
</tr>
<tr>
<td>Used by</td>
<td>Node.js/libuv</td>
<td>NGINX, Redis</td>
</tr>
<tr>
<td>Pitfall</td>
<td>Extra wakeups</td>
<td>Deadlock if not drained</td>
</tr>
</tbody>
</table>
</div></foreignObject></g></g><g class="bTFfbGF5ZXIubTFfcGl0ZmFsbHMucA=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="11965.000000" y="2306.000000" width="1677" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>P1</strong> ET + single read  silent data loss (deadlock)
<strong>P2</strong> ET listen socket, no accept loop  missed connections
<strong>P3</strong> EAGAIN treated as error  spurious close
<strong>P4</strong> Blocking listen socket  stall on RST race
<strong>P5</strong> MAX_EVENTS too small  extra epoll_wait round-trips</p>
</div></foreignObject></g></g><g class="bTJfbGF5ZXIud3JpdGVfYnVmX3N0cnVjdC5sYXlvdXQ="><g class="shape" ></g><g transform="translate(17754.000000 247.000000)" class="light-code"><rect width="506.000000" height="307.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;write_buffer.h&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Invariant:&#160;data[offset..offset+len]&#160;=&#160;unsent&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;{
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>data;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x00&#160;8B&#160;heap-alloc&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;&#160;len;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x08&#160;4B&#160;buffered&#160;bytes&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;&#160;cap;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x0C&#160;4B&#160;total&#160;capacity&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;&#160;offset;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x10&#160;4B&#160;first&#160;unsent&#160;idx*/</tspan>
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint8_t</tspan>&#160;&#160;&#160;_pad[<tspan fill="#009999">4</tspan>];<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x14&#160;4B&#160;alignment&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="11.400000em">}&#160;<tspan fill="#445588" class="text-mono-bold">write_buf_t</tspan>;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;total:&#160;24&#160;bytes&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;WRITE_BUF_INIT&#160;&#160;(4*1024)&#160;&#160;&#160;&#160;</tspan><tspan fill="#999988" class="text-mono-italic">/*&#160;&#160;&#160;4&#160;KB&#160;*/</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#999999"  class="text-mono-bold text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;WRITE_BUF_MAX&#160;(256*1024)&#160;&#160;&#160;&#160;</tspan><tspan fill="#999988" class="text-mono-italic">/*&#160;256&#160;KB&#160;*/</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#999999"  class="text-mono-bold text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">/*&#160;Compaction:&#160;if&#160;offset&#160;&gt;&#160;cap/2&#160;&amp;&amp;&#160;len&gt;0:&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;&#160;&#160;memmove(data,&#160;data+offset,&#160;len);&#160;offset=0&#160;*/</tspan>
</text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Growth:&#160;doubling&#160;strategy&#160;&#160;O(log&#160;N)&#160;realloc*/</tspan></text></g></g><g transform="translate(17754.000000 247.000000)" class="dark-code"><rect width="506.000000" height="307.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;write_buffer.h&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Invariant:&#160;data[offset..offset+len]&#160;=&#160;unsent&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">data</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x00&#160;8B&#160;heap-alloc&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x08&#160;4B&#160;buffered&#160;bytes&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">cap</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x0C&#160;4B&#160;total&#160;capacity&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">offset</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x10&#160;4B&#160;first&#160;unsent&#160;idx*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint8_t</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">_pad</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">4</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x14&#160;4B&#160;alignment&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">write_buf_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;total:&#160;24&#160;bytes&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;WRITE_BUF_INIT&#160;&#160;(4*1024)&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;&#160;&#160;4&#160;KB&#160;*/</tspan><tspan fill="#6c7086" class="text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;WRITE_BUF_MAX&#160;(256*1024)&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;256&#160;KB&#160;*/</tspan><tspan fill="#6c7086" class="text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Compaction:&#160;if&#160;offset&#160;&gt;&#160;cap/2&#160;&amp;&amp;&#160;len&gt;0:&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;&#160;&#160;memmove(data,&#160;data+offset,&#160;len);&#160;offset=0&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Growth:&#160;doubling&#160;strategy&#160;&#160;O(log&#160;N)&#160;realloc*/</tspan></text></g></g></g><g class="bTJfbGF5ZXIuY29ubl9zdGF0ZV9tMi5sYXlvdXQ="><g class="shape" ></g><g transform="translate(16653.000000 674.000000)" class="light-code"><rect width="573.000000" height="286.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;{
</text><text class="text-mono" x="0" y="2.300000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;&#160;&#160;&#160;&#160;&#160;read_buf[<tspan fill="#009999">4096</tspan>];&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x0000&#160;4096B&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">write_buf_t</tspan>&#160;wbuf;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x1000&#160;&#160;&#160;24B&#160;*/</tspan>
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;&#160;read_len;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x1018&#160;&#160;&#160;&#160;4B&#160;*/</tspan>
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;fd;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x101C&#160;&#160;&#160;&#160;4B&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">bool</tspan>&#160;&#160;&#160;&#160;&#160;&#160;is_active;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x1020&#160;&#160;&#160;&#160;1B&#160;*/</tspan>
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">bool</tspan>&#160;&#160;&#160;&#160;&#160;&#160;epollout_armed;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x1021&#160;&#160;&#160;&#160;1B&#160;*/</tspan>
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint8_t</tspan>&#160;&#160;&#160;_pad[<tspan fill="#009999">2</tspan>];&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x1022&#160;&#160;&#160;&#160;2B&#160;*/</tspan>
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;timer_idx;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x1024&#160;&#160;&#160;&#160;4B&#160;(-1=none)&#160;*/</tspan>
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint64_t</tspan>&#160;&#160;timer_expiry;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x1028&#160;&#160;&#160;&#160;8B&#160;abs&#160;ms&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="14.000000em">}&#160;<tspan fill="#445588" class="text-mono-bold">conn_state_t</tspan>;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;total:&#160;4152&#160;bytes&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;10K&#160;conns&#160;&#160;4152B&#160;&#160;40.5&#160;MB&#160;RSS&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;wbuf.data:&#160;separate&#160;heap&#160;alloc&#160;(on-demand)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g><g transform="translate(16653.000000 674.000000)" class="dark-code"><rect width="573.000000" height="286.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">read_buf</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">4096</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x0000&#160;4096B&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">write_buf_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">wbuf</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x1000&#160;&#160;&#160;24B&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">read_len</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x1018&#160;&#160;&#160;&#160;4B&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x101C&#160;&#160;&#160;&#160;4B&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">bool</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">is_active</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x1020&#160;&#160;&#160;&#160;1B&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">bool</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">epollout_armed</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x1021&#160;&#160;&#160;&#160;1B&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint8_t</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">_pad</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">2</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x1022&#160;&#160;&#160;&#160;2B&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">timer_idx</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x1024&#160;&#160;&#160;&#160;4B&#160;(-1=none)&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint64_t</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">timer_expiry</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x1028&#160;&#160;&#160;&#160;8B&#160;abs&#160;ms&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">conn_state_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;total:&#160;4152&#160;bytes&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;10K&#160;conns&#160;&#160;4152B&#160;&#160;40.5&#160;MB&#160;RSS&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;wbuf.data:&#160;separate&#160;heap&#160;alloc&#160;(on-demand)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g></g><g class="bTJfbGF5ZXIuY29ubl93cml0ZV9mbi5jb2Rl"><g class="shape" ></g><g transform="translate(17749.000000 1080.000000)" class="light-code"><rect width="515.000000" height="681.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;write_buffer.c&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Returns&#160;0=queued/sent,&#160;-1=overflow(close&#160;conn)&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">conn_write</tspan>(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;epfd,&#160;<tspan fill="#445588" class="text-mono-bold">conn_state_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>c,
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>data,&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;n)&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;If&#160;buffer&#160;non-empty,&#160;maintain&#160;order:&#160;append&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(<tspan fill="#000000" class="text-mono-bold">!</tspan><tspan fill="#990000" class="text-mono-bold">wbuf_is_empty</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>wbuf))&#160;{
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(<tspan fill="#990000" class="text-mono-bold">wbuf_append</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>wbuf,data,n)&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>&#160;<tspan fill="#009999">0</tspan>)
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;WRITE_BUF_MAX&#160;exceeded&#160;*/</tspan>
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">conn_flush</tspan>(epfd,&#160;c);
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;Fast&#160;path:&#160;direct&#160;write&#160;(no&#160;buffer&#160;copy)&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">ssize_t</tspan>&#160;sent&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">while</tspan>((<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>)sent&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>&#160;n)&#160;{
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">ssize_t</tspan>&#160;w&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">write</tspan>(c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>fd,&#160;data<tspan fill="#000000" class="text-mono-bold">+</tspan>sent,&#160;n<tspan fill="#000000" class="text-mono-bold">-</tspan>sent);
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(w&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;{&#160;sent&#160;<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;w;&#160;<tspan fill="#000000" class="text-mono-bold">continue</tspan>;&#160;}
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(errno<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>EAGAIN<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan>errno<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>EWOULDBLOCK)&#160;{
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;Buffer&#160;full&#160;&#160;queue&#160;remainder&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">wbuf_append</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>wbuf,data<tspan fill="#000000" class="text-mono-bold">+</tspan>sent,n<tspan fill="#000000" class="text-mono-bold">-</tspan>sent);
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(<tspan fill="#000000" class="text-mono-bold">!</tspan>c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>epollout_armed)&#160;{
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;ARM&#160;EPOLLOUT&#160;&#160;critical&#160;step&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;epoll_event&#160;ev;
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ev.events&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;EPOLLIN<tspan fill="#000000" class="text-mono-bold">|</tspan>EPOLLOUT;
</text><text class="text-mono" x="0" y="29.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ev.data.fd&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>fd;
</text><text class="text-mono" x="0" y="30.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">epoll_ctl</tspan>(epfd,EPOLL_CTL_MOD,c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>fd,<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>ev);
</text><text class="text-mono" x="0" y="32.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>epollout_armed&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#0086b3">true</tspan>;
</text><text class="text-mono" x="0" y="33.500000em">&#160;&#160;&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="34.800000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="36.100000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="37.400000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;EPIPE,&#160;ECONNRESET&#160;etc&#160;*/</tspan>
</text><text class="text-mono" x="0" y="38.700000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="40.000000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;fully&#160;sent&#160;on&#160;fast&#160;path&#160;*/</tspan>
</text><text class="text-mono" x="0" y="41.300000em">}</text></g></g><g transform="translate(17749.000000 1080.000000)" class="dark-code"><rect width="515.000000" height="681.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;write_buffer.c&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Returns&#160;0=queued/sent,&#160;-1=overflow(close&#160;conn)&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">conn_write</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">conn_state_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">data</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;If&#160;buffer&#160;non-empty,&#160;maintain&#160;order:&#160;append&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#89b4fa">wbuf_is_empty</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">wbuf</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89b4fa">wbuf_append</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">wbuf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">data</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;WRITE_BUF_MAX&#160;exceeded&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">conn_flush</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Fast&#160;path:&#160;direct&#160;write&#160;(no&#160;buffer&#160;copy)&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">ssize_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">sent</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">while</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">sent</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">ssize_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">w</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">write</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">data</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">sent</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">sent</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">w</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">sent</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">w</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">continue</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">errno</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">EAGAIN</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">errno</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">EWOULDBLOCK</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Buffer&#160;full&#160;&#160;queue&#160;remainder&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">wbuf_append</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">wbuf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">data</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">sent</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">sent</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">epollout_armed</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;ARM&#160;EPOLLOUT&#160;&#160;critical&#160;step&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">epoll_event</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">ev</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">ev</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">EPOLLIN</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">EPOLLOUT</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">ev</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">data</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">epoll_ctl</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">EPOLL_CTL_MOD</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">ev</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">epollout_armed</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">true</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="33.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="34.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="36.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="37.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;EPIPE,&#160;ECONNRESET&#160;etc&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="38.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="40.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;fully&#160;sent&#160;on&#160;fast&#160;path&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="41.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="bTJfbGF5ZXIuY29ubl9mbHVzaF9mbi5jb2Rl"><g class="shape" ></g><g transform="translate(19707.000000 1152.000000)" class="light-code"><rect width="506.000000" height="536.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;CALLED&#160;WHEN:&#160;EPOLLOUT&#160;fires&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;CRITICAL:&#160;deregister&#160;EPOLLOUT&#160;when&#160;empty!&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Without&#160;deregister&#160;&#160;100%&#160;CPU&#160;busy-loop&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">conn_flush</tspan>(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;epfd,&#160;<tspan fill="#445588" class="text-mono-bold">conn_state_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>c)&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">while</tspan>(<tspan fill="#000000" class="text-mono-bold">!</tspan><tspan fill="#990000" class="text-mono-bold">wbuf_is_empty</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>wbuf))&#160;{
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>p&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>wbuf.data<tspan fill="#000000" class="text-mono-bold">+</tspan>c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>wbuf.offset;
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">ssize_t</tspan>&#160;w&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">write</tspan>(c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>fd,&#160;p,&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>wbuf.len);
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(w&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;{
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">wbuf_consume</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>wbuf,&#160;(<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>)w);
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">continue</tspan>;
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(errno<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>EAGAIN<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan>errno<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>EWOULDBLOCK)
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;still&#160;full,&#160;stay&#160;armed&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;real&#160;error&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;Buffer&#160;empty&#160;&#160;DEREGISTER&#160;EPOLLOUT&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>epollout_armed)&#160;{
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;epoll_event&#160;ev;
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;&#160;&#160;ev.events&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;EPOLLIN;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;read&#160;only&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;&#160;&#160;ev.data.fd&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>fd;
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">epoll_ctl</tspan>(epfd,EPOLL_CTL_MOD,c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>fd,<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>ev);
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;&#160;&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>epollout_armed&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#0086b3">false</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;RESET&#160;FLAG&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="29.600000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="30.900000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="32.200000em">}</text></g></g><g transform="translate(19707.000000 1152.000000)" class="dark-code"><rect width="506.000000" height="536.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;CALLED&#160;WHEN:&#160;EPOLLOUT&#160;fires&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;CRITICAL:&#160;deregister&#160;EPOLLOUT&#160;when&#160;empty!&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Without&#160;deregister&#160;&#160;100%&#160;CPU&#160;busy-loop&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">conn_flush</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">conn_state_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">while</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#89b4fa">wbuf_is_empty</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">wbuf</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">p</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">wbuf</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">data</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">wbuf</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">offset</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">ssize_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">w</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">write</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">p</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">wbuf</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">w</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">wbuf_consume</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">wbuf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">w</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">continue</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">errno</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">EAGAIN</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">errno</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">EWOULDBLOCK</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;still&#160;full,&#160;stay&#160;armed&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;real&#160;error&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Buffer&#160;empty&#160;&#160;DEREGISTER&#160;EPOLLOUT&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">epollout_armed</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">epoll_event</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">ev</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">ev</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">EPOLLIN</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;read&#160;only&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">ev</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">data</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">epoll_ctl</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">epfd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">EPOLL_CTL_MOD</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">ev</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">epollout_armed</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">false</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;RESET&#160;FLAG&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="bTJfbGF5ZXIudGltZXJfZW50cnlfc3RydWN0LmxheW91dA=="><g class="shape" ></g><g transform="translate(17754.000000 1881.000000)" class="light-code"><rect width="506.000000" height="307.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;timer_heap.h&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;{
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint64_t</tspan>&#160;expiry_ms;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x00&#160;8B&#160;abs&#160;monotonic&#160;*/</tspan>
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;fd;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x08&#160;4B&#160;owning&#160;conn&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint8_t</tspan>&#160;&#160;_pad[<tspan fill="#009999">4</tspan>];&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x0C&#160;4B&#160;alignment&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em">}&#160;<tspan fill="#445588" class="text-mono-bold">timer_entry_t</tspan>;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;total:&#160;16&#160;bytes&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Heap&#160;storage:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#000000" class="text-mono-bold">static</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">timer_entry_t</tspan>&#160;timer_heap[<tspan fill="#009999">65536</tspan>];
</text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#000000" class="text-mono-bold">static</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;timer_heap_size&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Full&#160;heap:&#160;6553616&#160;=&#160;1MB&#160;&#160;fits&#160;L2&#160;cache&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Parent&#160;of&#160;i:&#160;(i-1)/2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Left&#160;child:&#160;&#160;2i+1&#160;&#160;&#160;Right&#160;child:&#160;2i+2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Top&#160;3&#160;levels&#160;(15&#160;nodes=240B)&#160;&#160;4&#160;cache&#160;lines&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;IDLE_TIMEOUT_MS&#160;30000&#160;&#160;</tspan><tspan fill="#999988" class="text-mono-italic">/*&#160;30&#160;seconds&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g><g transform="translate(17754.000000 1881.000000)" class="dark-code"><rect width="506.000000" height="307.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;timer_heap.h&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint64_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">expiry_ms</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x00&#160;8B&#160;abs&#160;monotonic&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x08&#160;4B&#160;owning&#160;conn&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint8_t</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">_pad</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">4</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x0C&#160;4B&#160;alignment&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">timer_entry_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;total:&#160;16&#160;bytes&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Heap&#160;storage:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">static</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">timer_entry_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">timer_heap</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">65536</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">static</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">timer_heap_size</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Full&#160;heap:&#160;6553616&#160;=&#160;1MB&#160;&#160;fits&#160;L2&#160;cache&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Parent&#160;of&#160;i:&#160;(i-1)/2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Left&#160;child:&#160;&#160;2i+1&#160;&#160;&#160;Right&#160;child:&#160;2i+2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Top&#160;3&#160;levels&#160;(15&#160;nodes=240B)&#160;&#160;4&#160;cache&#160;lines&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;IDLE_TIMEOUT_MS&#160;30000&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;30&#160;seconds&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g></g><g class="bTJfbGF5ZXIudGltZXJfb3BzLmNvZGU="><g class="shape" ></g><g transform="translate(17739.000000 2308.000000)" class="light-code"><rect width="535.000000" height="494.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;timer_heap.c&#160;&#160;O(log&#160;N)&#160;all&#160;operations&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;heap_swap:&#160;MUST&#160;update&#160;connections[fd].timer_idx&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#000000" class="text-mono-bold">static</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">heap_swap</tspan>(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;i,&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;j)&#160;{
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">timer_entry_t</tspan>&#160;tmp&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;timer_heap[i];
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;timer_heap[i]&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;timer_heap[j];
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;timer_heap[j]&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;tmp;
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;connections[timer_heap[i].fd].timer_idx&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;i;
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;connections[timer_heap[j].fd].timer_idx&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;j;
</text><text class="text-mono" x="0" y="11.400000em">}
</text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;timer_set(fd,&#160;expiry_ms):&#160;insert/reset&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;timer_cancel(fd):&#160;O(1)&#160;lookup&#160;via&#160;timer_idx&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;&#160;&#160;swap&#160;with&#160;last,&#160;sift_up+sift_down&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;timer_next_ms()&#160;&#160;int&#160;(for&#160;epoll_wait&#160;arg):&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">timer_next_ms</tspan>(<tspan fill="#445588" class="text-mono-bold">void</tspan>)&#160;{
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(timer_heap_size&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint64_t</tspan>&#160;now&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">now_ms</tspan>();&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;vDSO&#160;~30ns&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint64_t</tspan>&#160;exp&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;timer_heap[<tspan fill="#009999">0</tspan>].expiry_ms;
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(exp&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;now)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint64_t</tspan>&#160;d&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;exp&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan>&#160;now;
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;(d<tspan fill="#000000" class="text-mono-bold">&gt;</tspan>INT_MAX)&#160;<tspan fill="#000000" class="text-mono-bold">?</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">INT_MAX</tspan>&#160;:&#160;(<tspan fill="#445588" class="text-mono-bold">int</tspan>)d;
</text><text class="text-mono" x="0" y="27.000000em">}
</text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;timer_process_expired(epfd):&#160;while&#160;heap[0]&lt;=now
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#999988" class="text-mono-italic">&#160;&#160;&#160;close&#160;connection,&#160;timer_cancel&#160;auto-called&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g><g transform="translate(17739.000000 2308.000000)" class="dark-code"><rect width="535.000000" height="494.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;timer_heap.c&#160;&#160;O(log&#160;N)&#160;all&#160;operations&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;heap_swap:&#160;MUST&#160;update&#160;connections[fd].timer_idx&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">static</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">heap_swap</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">timer_entry_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">tmp</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">timer_heap</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">timer_heap</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">timer_heap</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">timer_heap</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">tmp</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">connections</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">timer_heap</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">timer_idx</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">connections</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">timer_heap</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">timer_idx</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;timer_set(fd,&#160;expiry_ms):&#160;insert/reset&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;timer_cancel(fd):&#160;O(1)&#160;lookup&#160;via&#160;timer_idx&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;&#160;&#160;swap&#160;with&#160;last,&#160;sift_up+sift_down&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;timer_next_ms()&#160;&#160;int&#160;(for&#160;epoll_wait&#160;arg):&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">timer_next_ms</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">timer_heap_size</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint64_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">now</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">now_ms</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;vDSO&#160;~30ns&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint64_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">exp</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">timer_heap</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">expiry_ms</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">exp</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">now</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint64_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">d</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">exp</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">now</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">d</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">INT_MAX</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">?</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">INT_MAX</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">:</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">d</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;timer_process_expired(epfd):&#160;while&#160;heap[0]&lt;=now
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#6c7086" class="text-mono-italic">&#160;&#160;&#160;close&#160;connection,&#160;timer_cancel&#160;auto-called&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g></g><g class="bTJfbGF5ZXIuZXBvbGxvdXRfY3ljbGUuZGVzYw=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="16653.000000" y="2922.000000" width="2708" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Step 1  Normal</strong>: Only EPOLLIN registered. EPOLLOUT OFF.
<strong>Step 2  write() EAGAIN</strong>: Buffer remainder. epoll_ctl MOD  add EPOLLOUT. epollout_armed=true.
<strong>Step 3  EPOLLOUT fires</strong>: conn_flush(). If empty: epoll_ctl MOD  remove EPOLLOUT. epollout_armed=false.
 NEVER leave EPOLLOUT armed when buffer empty  100% CPU spin
 write buffer overflow  close connection (slow loris defense)</p>
</div></foreignObject></g></g><g class="bTJfbGF5ZXIubTJfcGl0ZmFsbHMucA=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="17022.000000" y="3066.000000" width="1969" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>P1</strong> EPOLLOUT armed when wbuf empty  CPU busy-loop
<strong>P2</strong> Not processing all expired timers per tick  heap grows
<strong>P3</strong> Missing timer_cancel in conn_close  use-after-free
<strong>P4</strong> Closing conn without wbuf_free  memory leak (~4KB/conn)
<strong>P5</strong> CLOCK_REALTIME for timers  NTP jump corrupts expiry</p>
</div></foreignObject></g></g><g class="bTNfbGF5ZXIucmVhY3Rvcl9hcGkuY29kZQ=="><g class="shape" ></g><g transform="translate(22186.000000 4132.000000)" class="light-code"><rect width="535.000000" height="681.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;reactor.h&#160;&#160;users&#160;NEVER&#160;touch&#160;epoll&#160;directly&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;reactor&#160;<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>;
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Event&#160;flags&#160;(bitmask)&#160;*/</tspan>
</text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;REACTOR_READABLE&#160;&#160;(1u&lt;&lt;0)</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#999999"  class="text-mono-bold text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;REACTOR_WRITABLE&#160;&#160;(1u&lt;&lt;1)</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#999999"  class="text-mono-bold text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;REACTOR_ERROR&#160;&#160;&#160;&#160;&#160;(1u&lt;&lt;2)</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#999999"  class="text-mono-bold text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;REACTOR_HANGUP&#160;&#160;&#160;&#160;(1u&lt;&lt;3)</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#999999"  class="text-mono-bold text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">/*&#160;Callback&#160;signatures&#160;*/</tspan>
</text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">void</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">*</tspan>io_cb_fn)(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;fd,
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;events,&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>user_data);
</text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">void</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">*</tspan>timer_cb_fn)(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r,
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>user_data);
</text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">void</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">*</tspan>task_fn)(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r,
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>user_data);
</text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Lifecycle&#160;*/</tspan>
</text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan><tspan fill="#990000" class="text-mono-bold">reactor_create</tspan>(<tspan fill="#445588" class="text-mono-bold">void</tspan>);&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;calloc&#160;*/</tspan>
</text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_destroy</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r);
</text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_run</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r);&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;blocks&#160;*/</tspan>
</text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_stop</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r);&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;sets&#160;flag&#160;*/</tspan>
</text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;I/O&#160;registration&#160;*/</tspan>
</text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_register</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r,&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;fd,
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;events,&#160;io_cb_fn&#160;cb,&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>ud);
</text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">reactor_deregister</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r,&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;fd);
</text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Timers&#160;*/</tspan>
</text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_set_timeout</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r,&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;ms,
</text><text class="text-mono" x="0" y="33.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;timer_cb_fn&#160;cb,&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>ud);
</text><text class="text-mono" x="0" y="34.800000em"><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_set_interval</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r,&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;ms,
</text><text class="text-mono" x="0" y="36.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;timer_cb_fn&#160;cb,&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>ud);
</text><text class="text-mono" x="0" y="37.400000em"><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">reactor_cancel_timer</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r,&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;timer_id);
</text><text class="text-mono" x="0" y="38.700000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Deferred&#160;tasks&#160;*/</tspan>
</text><text class="text-mono" x="0" y="40.000000em"><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">reactor_defer</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r,
</text><text class="text-mono" x="0" y="41.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;task_fn&#160;fn,&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>ud);</text></g></g><g transform="translate(22186.000000 4132.000000)" class="dark-code"><rect width="535.000000" height="681.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;reactor.h&#160;&#160;users&#160;NEVER&#160;touch&#160;epoll&#160;directly&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">reactor</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Event&#160;flags&#160;(bitmask)&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;REACTOR_READABLE&#160;&#160;(1u&lt;&lt;0)</tspan><tspan fill="#6c7086" class="text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;REACTOR_WRITABLE&#160;&#160;(1u&lt;&lt;1)</tspan><tspan fill="#6c7086" class="text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;REACTOR_ERROR&#160;&#160;&#160;&#160;&#160;(1u&lt;&lt;2)</tspan><tspan fill="#6c7086" class="text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;REACTOR_HANGUP&#160;&#160;&#160;&#160;(1u&lt;&lt;3)</tspan><tspan fill="#6c7086" class="text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Callback&#160;signatures&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">io_cb_fn</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">user_data</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">timer_cb_fn</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">user_data</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">task_fn</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">user_data</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Lifecycle&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#89b4fa">reactor_create</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;calloc&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_destroy</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_run</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;blocks&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_stop</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;sets&#160;flag&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;I/O&#160;registration&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_register</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">io_cb_fn</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">cb</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">ud</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">reactor_deregister</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Timers&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_set_timeout</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">ms</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="33.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">timer_cb_fn</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">cb</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">ud</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="34.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_set_interval</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">ms</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="36.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">timer_cb_fn</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">cb</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">ud</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="37.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">reactor_cancel_timer</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">timer_id</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="38.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Deferred&#160;tasks&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="40.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">reactor_defer</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="41.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">task_fn</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fn</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">ud</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan></text></g></g></g><g class="bTNfbGF5ZXIuZmRfaGFuZGxlcl9zdHJ1Y3QubGF5b3V0"><g class="shape" ></g><g transform="translate(22225.000000 5075.000000)" class="light-code"><rect width="496.000000" height="307.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;reactor_internal.h&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Array:&#160;fd_handler_t&#160;handlers[MAX_FDS=65536]&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Size:&#160;65536&#160;&#160;24&#160;=&#160;1.5&#160;MB&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;io_cb_fn&#160;callback;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x00&#160;8B&#160;fn&#160;ptr&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>user_data;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x08&#160;8B&#160;context&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;events;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x10&#160;4B&#160;flags&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">bool</tspan>&#160;&#160;&#160;&#160;&#160;is_registered;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x14&#160;1B&#160;liveness&#160;*/</tspan>
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">bool</tspan>&#160;&#160;&#160;&#160;&#160;is_zombie;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x15&#160;1B&#160;deferred-del*/</tspan>
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint8_t</tspan>&#160;&#160;_pad[<tspan fill="#009999">2</tspan>];&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x16&#160;2B&#160;alignment&#160;*/</tspan>
</text><text class="text-mono" x="0" y="14.000000em">}&#160;<tspan fill="#445588" class="text-mono-bold">fd_handler_t</tspan>;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;total:&#160;24&#160;bytes&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;data.ptr&#160;=&#160;&amp;handlers[fd]&#160;in&#160;epoll_event&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Saves&#160;shl+add&#160;vs&#160;data.fd&#160;array&#160;lookup&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;fd&#160;recovery:&#160;int&#160;fd&#160;=&#160;h&#160;-&#160;r-&gt;handlers;&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g><g transform="translate(22225.000000 5075.000000)" class="dark-code"><rect width="496.000000" height="307.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;reactor_internal.h&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Array:&#160;fd_handler_t&#160;handlers[MAX_FDS=65536]&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Size:&#160;65536&#160;&#160;24&#160;=&#160;1.5&#160;MB&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">io_cb_fn</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">callback</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x00&#160;8B&#160;fn&#160;ptr&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">user_data</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x08&#160;8B&#160;context&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x10&#160;4B&#160;flags&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">bool</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">is_registered</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x14&#160;1B&#160;liveness&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">bool</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">is_zombie</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x15&#160;1B&#160;deferred-del*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint8_t</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">_pad</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">2</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x16&#160;2B&#160;alignment&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">fd_handler_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;total:&#160;24&#160;bytes&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;data.ptr&#160;=&#160;&amp;handlers[fd]&#160;in&#160;epoll_event&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Saves&#160;shl+add&#160;vs&#160;data.fd&#160;array&#160;lookup&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;fd&#160;recovery:&#160;int&#160;fd&#160;=&#160;h&#160;-&#160;r-&gt;handlers;&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g></g><g class="bTNfbGF5ZXIucmVhY3Rvcl9zdHJ1Y3QubGF5b3V0"><g class="shape" ></g><g transform="translate(21442.000000 5502.000000)" class="light-code"><rect width="506.000000" height="307.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;reactor&#160;{
</text><text class="text-mono" x="0" y="2.300000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;epoll_fd;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;kernel&#160;instance&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">bool</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;is_running;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;loop&#160;control&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">bool</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;is_dispatching;<tspan fill="#999988" class="text-mono-italic">/*&#160;guard&#160;flag&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint8_t</tspan>&#160;&#160;&#160;&#160;_pad[<tspan fill="#009999">2</tspan>];
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">fd_handler_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>handlers;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;[65536]&#160;=&#160;1.5MB&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">timer_node_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>timer_heap;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;min-heap&#160;array&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">deferred_mod_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>mod_queue;<tspan fill="#999988" class="text-mono-italic">/*&#160;epoll_ctl&#160;queue&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">deferred_task_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>task_queue;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;post-dispatch&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;timer_count;
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;mod_count;
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;task_count;
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;next_timer_id;
</text><text class="text-mono" x="0" y="17.900000em">};</text></g></g><g transform="translate(21442.000000 5502.000000)" class="dark-code"><rect width="506.000000" height="307.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">reactor</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">epoll_fd</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;kernel&#160;instance&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">bool</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">is_running</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;loop&#160;control&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">bool</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">is_dispatching</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;guard&#160;flag&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint8_t</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">_pad</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">2</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">fd_handler_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">handlers</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;[65536]&#160;=&#160;1.5MB&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">timer_node_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">timer_heap</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;min-heap&#160;array&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">deferred_mod_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">mod_queue</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;epoll_ctl&#160;queue&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">deferred_task_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">task_queue</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;post-dispatch&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">timer_count</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">mod_count</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">task_count</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">next_timer_id</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">;</tspan></text></g></g></g><g class="bTNfbGF5ZXIucmVhY3Rvcl9ydW5fZm4uY29kZQ=="><g class="shape" ></g><g transform="translate(23062.000000 3846.000000)" class="light-code"><rect width="496.000000" height="744.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">reactor_run</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r)&#160;{
</text><text class="text-mono" x="0" y="2.300000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;epoll_event&#160;evs[MAX_EVENTS];
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_running&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#0086b3">true</tspan>;
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">while</tspan>(r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_running)&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;1.&#160;Compute&#160;timeout&#160;from&#160;timer&#160;heap&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;timeout&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">reactor_next_timeout</tspan>(r);
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;2.&#160;Wait&#160;for&#160;I/O&#160;(blocks&#160;CPU&#160;efficiently)&#160;*/</tspan>
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;n&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">epoll_wait</tspan>(r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>epoll_fd,&#160;evs,
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MAX_EVENTS,&#160;timeout);
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(n&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;{
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(errno<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>EINTR)&#160;<tspan fill="#000000" class="text-mono-bold">continue</tspan>;
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">break</tspan>;
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;3.&#160;TIMERS&#160;FIRST&#160;(time-sensitive)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_process_timers</tspan>(r);
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;4.&#160;I/O&#160;DISPATCH&#160;&#160;set&#160;guard&#160;flag&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_dispatching&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#0086b3">true</tspan>;
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">for</tspan>(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;i<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>;&#160;i<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>n;&#160;i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>)&#160;{
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">fd_handler_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>h&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(<tspan fill="#445588" class="text-mono-bold">fd_handler_t</tspan><tspan fill="#000000" class="text-mono-bold">*</tspan>)evs[i].data.ptr;
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;ZOMBIE&#160;CHECK&#160;&#160;skip&#160;deregistered&#160;fds&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_zombie&#160;<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">!</tspan>h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_registered)
</text><text class="text-mono" x="0" y="29.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">continue</tspan>;
</text><text class="text-mono" x="0" y="30.900000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;rv&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">map_epoll_to_reactor</tspan>(
</text><text class="text-mono" x="0" y="32.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;evs[i].events);
</text><text class="text-mono" x="0" y="33.500000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;fd&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">int</tspan>)(h&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan>&#160;r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>handlers);
</text><text class="text-mono" x="0" y="34.800000em">&#160;&#160;&#160;&#160;&#160;&#160;h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan><tspan fill="#990000" class="text-mono-bold">callback</tspan>(fd,&#160;rv,&#160;h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>user_data);
</text><text class="text-mono" x="0" y="36.100000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="37.400000em">&#160;&#160;&#160;&#160;r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_dispatching&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#0086b3">false</tspan>;
</text><text class="text-mono" x="0" y="38.700000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;5.&#160;Apply&#160;deferred&#160;epoll_ctl&#160;ops&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="40.000000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">process_mod_queue</tspan>(r);
</text><text class="text-mono" x="0" y="41.300000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;6.&#160;Run&#160;deferred&#160;tasks&#160;(snapshot)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="42.600000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_run_deferred</tspan>(r);
</text><text class="text-mono" x="0" y="43.900000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="45.200000em">}</text></g></g><g transform="translate(23062.000000 3846.000000)" class="dark-code"><rect width="496.000000" height="744.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">reactor_run</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">epoll_event</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">evs</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">MAX_EVENTS</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_running</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">true</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">while</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_running</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;1.&#160;Compute&#160;timeout&#160;from&#160;timer&#160;heap&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">timeout</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">reactor_next_timeout</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;2.&#160;Wait&#160;for&#160;I/O&#160;(blocks&#160;CPU&#160;efficiently)&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">epoll_wait</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">epoll_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">evs</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">MAX_EVENTS</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">timeout</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">errno</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">EINTR</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">continue</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">break</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;3.&#160;TIMERS&#160;FIRST&#160;(time-sensitive)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_process_timers</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;4.&#160;I/O&#160;DISPATCH&#160;&#160;set&#160;guard&#160;flag&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_dispatching</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">true</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">for</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">fd_handler_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">fd_handler_t</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">evs</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">data</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">ptr</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;ZOMBIE&#160;CHECK&#160;&#160;skip&#160;deregistered&#160;fds&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_zombie</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_registered</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">continue</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">rv</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">map_epoll_to_reactor</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">evs</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="33.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">handlers</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="34.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#89b4fa">callback</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">rv</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">user_data</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="36.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="37.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_dispatching</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">false</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="38.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;5.&#160;Apply&#160;deferred&#160;epoll_ctl&#160;ops&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="40.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">process_mod_queue</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="41.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;6.&#160;Run&#160;deferred&#160;tasks&#160;(snapshot)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="42.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_run_deferred</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="43.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="45.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="bTNfbGF5ZXIuem9tYmllX21lY2hhbmlzbS5jb2Rl"><g class="shape" ></g><g transform="translate(23056.000000 4758.000000)" class="light-code"><rect width="515.000000" height="681.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;THE&#160;BUG:&#160;fd&#160;closed&#160;mid-dispatch&#160;&#160;fd&#160;reused&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;epoll_wait&#160;returned&#160;8&#160;events,&#160;processing&#160;[2]&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;callback&#160;closes&#160;fd=7,&#160;kernel&#160;reuses&#160;fd=7&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;event&#160;[5]&#160;dispatches&#160;to&#160;NEW&#160;connection&#160;&#160;UB&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">reactor_deregister</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r,&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;fd)&#160;{
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">fd_handler_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>h&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>handlers[fd];
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(<tspan fill="#000000" class="text-mono-bold">!</tspan>h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_registered)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>;
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_dispatching)&#160;{
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;CANNOT&#160;call&#160;epoll_ctl&#160;now&#160;safely&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_zombie&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#0086b3">true</tspan>;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;skip&#160;in&#160;loop&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">enqueue_mod</tspan>(r,&#160;MOD_DEL,&#160;fd,&#160;<tspan fill="#009999">0</tspan>);&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;deferred&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;}&#160;<tspan fill="#000000" class="text-mono-bold">else</tspan>&#160;{
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_registered&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#0086b3">false</tspan>;
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_zombie&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#0086b3">false</tspan>;
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">epoll_ctl</tspan>(r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>epoll_fd,
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;EPOLL_CTL_DEL,&#160;fd,&#160;<tspan fill="#0086b3">NULL</tspan>);
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="23.100000em">}
</text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">reactor_register</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r,&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;fd,
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;events,&#160;io_cb_fn&#160;cb,&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>ud)&#160;{
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">fd_handler_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>h&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>handlers[fd];
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>callback&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;cb;
</text><text class="text-mono" x="0" y="29.600000em">&#160;&#160;h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>user_data&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;ud;
</text><text class="text-mono" x="0" y="30.900000em">&#160;&#160;h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>events&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;events;
</text><text class="text-mono" x="0" y="32.200000em">&#160;&#160;h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_registered&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#0086b3">true</tspan>;
</text><text class="text-mono" x="0" y="33.500000em">&#160;&#160;h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_zombie&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#0086b3">false</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;CLEAR&#160;zombie&#160;on&#160;re-reg&#160;*/</tspan>
</text><text class="text-mono" x="0" y="34.800000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>is_dispatching)
</text><text class="text-mono" x="0" y="36.100000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">enqueue_mod</tspan>(r,&#160;was_reg<tspan fill="#000000" class="text-mono-bold">?</tspan><tspan fill="#990000" class="text-mono-bold">MOD_MOD</tspan>:MOD_ADD,&#160;fd,
</text><text class="text-mono" x="0" y="37.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">map_to_epoll</tspan>(events));
</text><text class="text-mono" x="0" y="38.700000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">else</tspan>
</text><text class="text-mono" x="0" y="40.000000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;direct&#160;epoll_ctl&#160;*/</tspan>;
</text><text class="text-mono" x="0" y="41.300000em">}</text></g></g><g transform="translate(23056.000000 4758.000000)" class="dark-code"><rect width="515.000000" height="681.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;THE&#160;BUG:&#160;fd&#160;closed&#160;mid-dispatch&#160;&#160;fd&#160;reused&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;epoll_wait&#160;returned&#160;8&#160;events,&#160;processing&#160;[2]&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;callback&#160;closes&#160;fd=7,&#160;kernel&#160;reuses&#160;fd=7&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;event&#160;[5]&#160;dispatches&#160;to&#160;NEW&#160;connection&#160;&#160;UB&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">reactor_deregister</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">fd_handler_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">handlers</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_registered</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_dispatching</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;CANNOT&#160;call&#160;epoll_ctl&#160;now&#160;safely&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_zombie</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">true</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;skip&#160;in&#160;loop&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">enqueue_mod</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">MOD_DEL</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;deferred&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_registered</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">false</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_zombie</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">false</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">epoll_ctl</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">epoll_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">EPOLL_CTL_DEL</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">NULL</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">reactor_register</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">io_cb_fn</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">cb</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">ud</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">fd_handler_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">handlers</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">callback</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">cb</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">user_data</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">ud</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_registered</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">true</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="33.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_zombie</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">false</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;CLEAR&#160;zombie&#160;on&#160;re-reg&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="34.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">is_dispatching</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="36.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">enqueue_mod</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">was_reg</tspan><tspan fill="#89dceb" class="text-mono-bold">?</tspan><tspan fill="#89dceb">MOD_MOD</tspan><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">:</tspan><tspan fill="#cdd6f4">MOD_ADD</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="37.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">map_to_epoll</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="38.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="40.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;direct&#160;epoll_ctl&#160;*/</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="41.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="bTNfbGF5ZXIuZGVmZXJyZWRfdGFza19mbi5jb2Rl"><g class="shape" ></g><g transform="translate(23904.000000 4872.000000)" class="light-code"><rect width="506.000000" height="453.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Appends&#160;to&#160;task_queue.&#160;Runs&#160;AFTER&#160;all&#160;I/O&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;in&#160;current&#160;batch.&#160;Before&#160;next&#160;epoll_wait.&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">reactor_defer</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r,
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;task_fn&#160;fn,&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>ud)&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;grow&#160;task_queue&#160;if&#160;needed&#160;(doubling)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>task_queue[r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>task_count<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>]&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;(<tspan fill="#445588" class="text-mono-bold">deferred_task_t</tspan>){fn,&#160;ud};
</text><text class="text-mono" x="0" y="10.100000em">}
</text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Execution&#160;(snapshot&#160;prevents&#160;infinite&#160;loop):&#160;*/</tspan>
</text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#000000" class="text-mono-bold">static</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">reactor_run_deferred</tspan>(<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r)&#160;{
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;count&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>task_count;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;snapshot&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>task_count&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">deferred_task_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>tasks&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>task_queue;
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;swap&#160;to&#160;new&#160;buf&#160;so&#160;re-entrant&#160;defers&#160;work&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;r<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>task_queue&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">malloc</tspan>(...);
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">for</tspan>(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;i<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>;&#160;i<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>count;&#160;i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>)
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;tasks[i].<tspan fill="#990000" class="text-mono-bold">fn</tspan>(r,&#160;tasks[i].user_data);
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;<tspan fill="#990000" class="text-mono-bold">free</tspan>(tasks);
</text><text class="text-mono" x="0" y="24.400000em">}
</text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;USE&#160;CASE:&#160;close&#160;conn&#160;safely&#160;from&#160;callback&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;reactor_defer(r,&#160;conn_close_deferred,&#160;conn);&#160;&#160;*/</tspan></text></g></g><g transform="translate(23904.000000 4872.000000)" class="dark-code"><rect width="506.000000" height="453.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Appends&#160;to&#160;task_queue.&#160;Runs&#160;AFTER&#160;all&#160;I/O&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;in&#160;current&#160;batch.&#160;Before&#160;next&#160;epoll_wait.&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">reactor_defer</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">task_fn</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fn</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">ud</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;grow&#160;task_queue&#160;if&#160;needed&#160;(doubling)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">task_queue</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">task_count</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">deferred_task_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">fn</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">ud</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Execution&#160;(snapshot&#160;prevents&#160;infinite&#160;loop):&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">static</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">reactor_run_deferred</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">count</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">task_count</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;snapshot&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">task_count</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">deferred_task_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">tasks</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">task_queue</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;swap&#160;to&#160;new&#160;buf&#160;so&#160;re-entrant&#160;defers&#160;work&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">task_queue</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">malloc</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">for</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">count</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">tasks</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#89b4fa">fn</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">tasks</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">user_data</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">free</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">tasks</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;USE&#160;CASE:&#160;close&#160;conn&#160;safely&#160;from&#160;callback&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;reactor_defer(r,&#160;conn_close_deferred,&#160;conn);&#160;&#160;*/</tspan></text></g></g></g><g class="bTNfbGF5ZXIubTNfdGlja19vcmRlci5kZXNj"><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="21383.000000" y="5929.000000" width="625" height="260"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Tick Order (MANDATORY)</strong>:</p>
<ol>
<li><code>timer_next_ms()</code>  epoll_wait timeout</li>
<li><code>epoll_wait()</code> returns</li>
<li><code>reactor_process_timers()</code>  fires expired callbacks</li>
<li><code>is_dispatching = true</code>  iterate events, skip zombies</li>
<li><code>is_dispatching = false</code></li>
<li><code>process_mod_queue()</code>  apply deferred epoll_ctl ops</li>
<li><code>reactor_run_deferred()</code>  run post-dispatch tasks</li>
<li>Loop  next epoll_wait
<strong>Guarantees</strong>: No fd reuse bugs | Deferred tasks see full event state</li>
</ol>
</div></foreignObject></g></g><g class="bTNfbGF5ZXIubTNfcGl0ZmFsbHMucA=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="20670.000000" y="6309.000000" width="2051" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>P1</strong> Modifying handler table during dispatch  UB, wrong callbacks
<strong>P2</strong> Deferred tasks running inside I/O loop  sees partial state
<strong>P3</strong> Interval timer cancels itself  heap corruption
<strong>P4</strong> Not clearing zombie on re-registration  callback never fires
<strong>P5</strong> EPOLLHUP without reading remaining data  dropped requests</p>
</div></foreignObject></g></g><g class="bTRfbGF5ZXIuaHR0cF9zdGF0ZV9lbnVtLmxheW91dA=="><g class="shape" ></g><g transform="translate(12246.000000 2683.000000)" class="light-code"><rect width="525.000000" height="369.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;http_server.h&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">enum</tspan>&#160;{
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;HTTP_READING_HEADERS&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>,&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;scan&#160;for&#160;\r\n\r\n&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;HTTP_READING_BODY&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">1</tspan>,&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;accumulate&#160;body&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;HTTP_PROCESSING&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">2</tspan>,&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;generate&#160;response&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;HTTP_WRITING_RESPONSE&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">3</tspan>,&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;flush&#160;to&#160;wbuf&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;HTTP_CLOSING&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">4</tspan>,&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;close&#160;after&#160;flush&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="10.100000em">}&#160;conn_http_state;
</text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;VALID&#160;TRANSITIONS:
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#999988" class="text-mono-italic">&#160;*&#160;READING_HEADERS&#160;&#160;READING_BODY&#160;(if&#160;body)
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#999988" class="text-mono-italic">&#160;*&#160;READING_HEADERS&#160;&#160;PROCESSING&#160;&#160;&#160;(GET)
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#999988" class="text-mono-italic">&#160;*&#160;READING_BODY&#160;&#160;&#160;&#160;&#160;PROCESSING
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#999988" class="text-mono-italic">&#160;*&#160;PROCESSING&#160;&#160;&#160;&#160;&#160;&#160;&#160;WRITING_RESPONSE
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#999988" class="text-mono-italic">&#160;*&#160;WRITING_RESPONSE&#160;READING_HEADERS&#160;(keep-alive)
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#999988" class="text-mono-italic">&#160;*&#160;WRITING_RESPONSE&#160;CLOSING&#160;(Connection:&#160;close)
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#999988" class="text-mono-italic">&#160;*&#160;ANY&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;CLOSING&#160;(error)
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#999988" class="text-mono-italic">&#160;*/</tspan></text></g></g><g transform="translate(12246.000000 2683.000000)" class="dark-code"><rect width="525.000000" height="369.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;http_server.h&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">enum</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">HTTP_READING_HEADERS</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;scan&#160;for&#160;\r\n\r\n&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">HTTP_READING_BODY</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;accumulate&#160;body&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">HTTP_PROCESSING</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">2</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;generate&#160;response&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">HTTP_WRITING_RESPONSE</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">3</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;flush&#160;to&#160;wbuf&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">HTTP_CLOSING</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">4</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;close&#160;after&#160;flush&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">conn_http_state</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;VALID&#160;TRANSITIONS:
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#6c7086" class="text-mono-italic">&#160;*&#160;READING_HEADERS&#160;&#160;READING_BODY&#160;(if&#160;body)
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#6c7086" class="text-mono-italic">&#160;*&#160;READING_HEADERS&#160;&#160;PROCESSING&#160;&#160;&#160;(GET)
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#6c7086" class="text-mono-italic">&#160;*&#160;READING_BODY&#160;&#160;&#160;&#160;&#160;PROCESSING
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#6c7086" class="text-mono-italic">&#160;*&#160;PROCESSING&#160;&#160;&#160;&#160;&#160;&#160;&#160;WRITING_RESPONSE
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#6c7086" class="text-mono-italic">&#160;*&#160;WRITING_RESPONSE&#160;READING_HEADERS&#160;(keep-alive)
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#6c7086" class="text-mono-italic">&#160;*&#160;WRITING_RESPONSE&#160;CLOSING&#160;(Connection:&#160;close)
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#6c7086" class="text-mono-italic">&#160;*&#160;ANY&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;CLOSING&#160;(error)
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#6c7086" class="text-mono-italic">&#160;*/</tspan></text></g></g></g><g class="bTRfbGF5ZXIuaHR0cF9yZXF1ZXN0X3N0cnVjdC5sYXlvdXQ="><g class="shape" ></g><g transform="translate(12241.000000 3172.000000)" class="light-code"><rect width="535.000000" height="182.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;{
</text><text class="text-mono" x="0" y="2.300000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;&#160;&#160;&#160;&#160;method[<tspan fill="#009999">10</tspan>];&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x000&#160;10B&#160;&quot;GET&quot;,&quot;HEAD&quot;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;&#160;&#160;&#160;&#160;path[<tspan fill="#009999">1024</tspan>];&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x00A&#160;1024B&#160;URL&#160;path&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint64_t</tspan>&#160;content_length;<tspan fill="#999988" class="text-mono-italic">/*+0x40A&#160;&#160;8B&#160;body&#160;size&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint64_t</tspan>&#160;body_received;&#160;<tspan fill="#999988" class="text-mono-italic">/*+0x412&#160;&#160;8B&#160;bytes&#160;rcvd&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">bool</tspan>&#160;&#160;&#160;&#160;&#160;keep_alive;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x41A&#160;&#160;1B&#160;HTTP/1.1&#160;dflt*/</tspan>
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">bool</tspan>&#160;&#160;&#160;&#160;&#160;is_complete;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;+0x41B&#160;&#160;1B&#160;parser&#160;flag&#160;*/</tspan>
</text><text class="text-mono" x="0" y="10.100000em">}&#160;<tspan fill="#445588" class="text-mono-bold">http_request_t</tspan>;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;&#160;1056&#160;bytes&#160;total&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g><g transform="translate(12241.000000 3172.000000)" class="dark-code"><rect width="535.000000" height="182.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">method</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">10</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x000&#160;10B&#160;&quot;GET&quot;,&quot;HEAD&quot;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">path</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">1024</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x00A&#160;1024B&#160;URL&#160;path&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint64_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">content_length</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*+0x40A&#160;&#160;8B&#160;body&#160;size&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint64_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">body_received</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*+0x412&#160;&#160;8B&#160;bytes&#160;rcvd&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">bool</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">keep_alive</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x41A&#160;&#160;1B&#160;HTTP/1.1&#160;dflt*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">bool</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">is_complete</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;+0x41B&#160;&#160;1B&#160;parser&#160;flag&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">http_request_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;&#160;1056&#160;bytes&#160;total&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g></g><g class="bTRfbGF5ZXIuaHR0cF9jb25uX3N0cnVjdC5sYXlvdXQ="><g class="shape" ></g><g transform="translate(12236.000000 3474.000000)" class="light-code"><rect width="544.000000" height="349.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;http_connection.c&#160;&#160;passed&#160;as&#160;void*&#160;user_data&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;calloc(1,&#160;sizeof(http_conn_t))&#160;per&#160;connection&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;{
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;read_buf[<tspan fill="#009999">16384</tspan>];&#160;<tspan fill="#999988" class="text-mono-italic">/*+0x0000&#160;16KB&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">write_buf_t</tspan>&#160;&#160;&#160;wbuf;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*+0x4000&#160;24B&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">http_request_t</tspan>&#160;req;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*+0x4018&#160;1056B&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;&#160;&#160;&#160;&#160;&#160;read_pos;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*+0x4438&#160;4B&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;fd;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*+0x443C&#160;4B&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;conn_http_state&#160;state;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*+0x4440&#160;4B&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;timer_id;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*+0x4444&#160;4B&#160;-1=none*/</tspan>
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint8_t</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;_pad[<tspan fill="#009999">4</tspan>];&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*+0x4448&#160;4B&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>reactor_ref;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*+0x4450&#160;8B&#160;ptr&#160;*/</tspan>
</text><text class="text-mono" x="0" y="16.600000em">}&#160;<tspan fill="#445588" class="text-mono-bold">http_conn_t</tspan>;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;&#160;17.5&#160;KB&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;10K&#160;conns&#160;&#160;17.5KB&#160;&#160;175&#160;MB&#160;RSS&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;read_buf=16KB&#160;covers&#160;typical&#160;HTTP&#160;headers&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;(RFC&#160;7230&#160;allows&#160;servers&#160;to&#160;reject&#160;&gt;16KB)&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g><g transform="translate(12236.000000 3474.000000)" class="dark-code"><rect width="544.000000" height="349.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;http_connection.c&#160;&#160;passed&#160;as&#160;void*&#160;user_data&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;calloc(1,&#160;sizeof(http_conn_t))&#160;per&#160;connection&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">read_buf</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">16384</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*+0x0000&#160;16KB&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">write_buf_t</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">wbuf</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*+0x4000&#160;24B&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">http_request_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*+0x4018&#160;1056B&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">read_pos</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*+0x4438&#160;4B&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*+0x443C&#160;4B&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">conn_http_state</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">state</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*+0x4440&#160;4B&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">timer_id</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*+0x4444&#160;4B&#160;-1=none*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint8_t</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">_pad</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">4</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*+0x4448&#160;4B&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">reactor_ref</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*+0x4450&#160;8B&#160;ptr&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">http_conn_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;&#160;17.5&#160;KB&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;10K&#160;conns&#160;&#160;17.5KB&#160;&#160;175&#160;MB&#160;RSS&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;read_buf=16KB&#160;covers&#160;typical&#160;HTTP&#160;headers&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;(RFC&#160;7230&#160;allows&#160;servers&#160;to&#160;reject&#160;&gt;16KB)&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan></text></g></g></g><g class="bTRfbGF5ZXIuaHR0cF9wYXJzZXIuY29kZQ=="><g class="shape" ></g><g transform="translate(14633.000000 4088.000000)" class="light-code"><rect width="592.000000" height="806.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;http_parser.c&#160;&#160;INCREMENTAL:&#160;call&#160;after&#160;each&#160;read()&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;TCP&#160;delivers:&#160;partial&#160;headers&#160;across&#160;N&#160;reads&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;&#160;&#160;read1:&#160;&quot;GET&#160;/index.html&#160;HTTP/1.1\r\nHost:&#160;exa&quot;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;&#160;&#160;read2:&#160;&quot;mple.com\r\nConnection:&#160;keep-alive\r\n&quot;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;&#160;&#160;read3:&#160;&quot;\r\n&quot;&#160;&#160;&#160;&#160;find_header_end&#160;fires&#160;here&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">enum</tspan>&#160;{
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;PARSE_OK<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>,&#160;PARSE_AGAIN<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>,&#160;PARSE_ERROR<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">2</tspan>
</text><text class="text-mono" x="0" y="10.100000em">}&#160;<tspan fill="#445588" class="text-mono-bold">parse_result_t</tspan>;
</text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;find_header_end:&#160;linear&#160;scan&#160;for&#160;\r\n\r\n&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Hardware&#160;prefetcher&#160;loads&#160;upcoming&#160;cache&#160;lines&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;Production:&#160;SIMD&#160;_mm_cmpeq_epi8&#160;scans&#160;16B/2&#160;cycles&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#000000" class="text-mono-bold">static</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">find_header_end</tspan>(<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>buf,&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;n){
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(n&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>&#160;<tspan fill="#009999">4</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">for</tspan>(<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;i<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>;&#160;i<tspan fill="#000000" class="text-mono-bold">&lt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>n<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">4</tspan>;&#160;i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>)
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(buf[i]<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">'</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan>buf[i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">1</tspan>]<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">'</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan>
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;buf[i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">2</tspan>]<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">'</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan>buf[i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">3</tspan>]<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">'</tspan>)
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">int</tspan>)(i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">4</tspan>);
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="24.400000em">}
</text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#445588" class="text-mono-bold">parse_result_t</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">http_parse_incremental</tspan>(
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">http_conn_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>conn)&#160;{
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;end&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">find_header_end</tspan>(conn<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>read_buf,
</text><text class="text-mono" x="0" y="29.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;conn<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>read_pos);
</text><text class="text-mono" x="0" y="30.900000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(end&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;{
</text><text class="text-mono" x="0" y="32.200000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(conn<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>read_pos&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(conn<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>read_buf))
</text><text class="text-mono" x="0" y="33.500000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;PARSE_ERROR;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;413&#160;Too&#160;Large&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="34.800000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;PARSE_AGAIN;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;need&#160;more&#160;bytes&#160;*/</tspan>
</text><text class="text-mono" x="0" y="36.100000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="37.400000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;Parse&#160;request&#160;line&#160;+&#160;header&#160;fields&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="38.700000em">&#160;&#160;<tspan fill="#990000" class="text-mono-bold">parse_request_line</tspan>(...);
</text><text class="text-mono" x="0" y="40.000000em">&#160;&#160;<tspan fill="#990000" class="text-mono-bold">parse_header_fields</tspan>(...);&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;Content-Length,&#160;Connection&#160;*/</tspan>
</text><text class="text-mono" x="0" y="41.300000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;memmove&#160;body&#160;bytes&#160;to&#160;front&#160;of&#160;read_buf&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="42.600000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;rem&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;conn<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>read_pos&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>)end;
</text><text class="text-mono" x="0" y="43.900000em">&#160;&#160;<tspan fill="#990000" class="text-mono-bold">memmove</tspan>(conn<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>read_buf,
</text><text class="text-mono" x="0" y="45.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;conn<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>read_buf<tspan fill="#000000" class="text-mono-bold">+</tspan>end,&#160;rem);
</text><text class="text-mono" x="0" y="46.500000em">&#160;&#160;conn<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>read_pos&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;rem;
</text><text class="text-mono" x="0" y="47.800000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;PARSE_OK;
</text><text class="text-mono" x="0" y="49.100000em">}</text></g></g><g transform="translate(14633.000000 4088.000000)" class="dark-code"><rect width="592.000000" height="806.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;http_parser.c&#160;&#160;INCREMENTAL:&#160;call&#160;after&#160;each&#160;read()&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;TCP&#160;delivers:&#160;partial&#160;headers&#160;across&#160;N&#160;reads&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;&#160;&#160;read1:&#160;&quot;GET&#160;/index.html&#160;HTTP/1.1\r\nHost:&#160;exa&quot;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;&#160;&#160;read2:&#160;&quot;mple.com\r\nConnection:&#160;keep-alive\r\n&quot;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;&#160;&#160;read3:&#160;&quot;\r\n&quot;&#160;&#160;&#160;&#160;find_header_end&#160;fires&#160;here&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">enum</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">PARSE_OK</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">PARSE_AGAIN</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">PARSE_ERROR</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">2</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">parse_result_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;find_header_end:&#160;linear&#160;scan&#160;for&#160;\r\n\r\n&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Hardware&#160;prefetcher&#160;loads&#160;upcoming&#160;cache&#160;lines&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Production:&#160;SIMD&#160;_mm_cmpeq_epi8&#160;scans&#160;16B/2&#160;cycles&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">static</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">find_header_end</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">4</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">for</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">4</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\r</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\n</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">2</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\r</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">3</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\n</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">4</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#f38ba8">parse_result_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">http_parse_incremental</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">http_conn_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">end</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">find_header_end</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">read_buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">read_pos</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">end</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">read_pos</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">read_buf</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="33.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">PARSE_ERROR</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;413&#160;Too&#160;Large&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="34.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">PARSE_AGAIN</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;need&#160;more&#160;bytes&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="36.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="37.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Parse&#160;request&#160;line&#160;+&#160;header&#160;fields&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="38.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">parse_request_line</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="40.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">parse_header_fields</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Content-Length,&#160;Connection&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="41.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;memmove&#160;body&#160;bytes&#160;to&#160;front&#160;of&#160;read_buf&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="42.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">rem</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">read_pos</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">end</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="43.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">memmove</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">read_buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="45.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">read_buf</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">end</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">rem</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="46.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">read_pos</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">rem</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="47.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">PARSE_OK</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="49.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="bTRfbGF5ZXIuaHR0cF9vbl9yZWFkYWJsZS5jb2Rl"><g class="shape" ></g><g transform="translate(12236.000000 3943.000000)" class="light-code"><rect width="544.000000" height="1097.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;http_core.c&#160;&#160;registered&#160;with&#160;reactor&#160;as&#160;io_cb_fn&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#000000" class="text-mono-bold">static</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">http_on_readable</tspan>(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;fd,
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;events,&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>user_data)&#160;{
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">http_conn_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>c&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">http_conn_t</tspan><tspan fill="#000000" class="text-mono-bold">*</tspan>)user_data;
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>reactor_ref;
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(events&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>&#160;(REACTOR_ERROR<tspan fill="#000000" class="text-mono-bold">|</tspan>REACTOR_HANGUP))&#160;{
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_defer</tspan>(r,&#160;http_conn_close_deferred,&#160;c);
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>;
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;ET&#160;mode:&#160;drain&#160;until&#160;EAGAIN&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">for</tspan>(;;)&#160;{
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>&#160;space&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>read_buf)
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan>&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>read_pos;
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(<tspan fill="#000000" class="text-mono-bold">!</tspan>space)&#160;{
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">http_send_error</tspan>(c,&#160;<tspan fill="#009999">413</tspan>,&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Too&#160;Large</tspan><tspan fill="#dd1144">&quot;</tspan>);
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>;
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">ssize_t</tspan>&#160;n&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">read</tspan>(fd,
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>read_buf<tspan fill="#000000" class="text-mono-bold">+</tspan>c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>read_pos,&#160;space);
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(n&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;{
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;&#160;&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>read_pos&#160;<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>)n;
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;Reset&#160;idle&#160;timer&#160;on&#160;each&#160;byte&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="29.600000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_cancel_timer</tspan>(r,&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>timer_id);
</text><text class="text-mono" x="0" y="30.900000em">&#160;&#160;&#160;&#160;&#160;&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>timer_id&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">reactor_set_timeout</tspan>(r,
</text><text class="text-mono" x="0" y="32.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;IDLE_TIMEOUT_MS,
</text><text class="text-mono" x="0" y="33.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;http_idle_timeout_cb,&#160;c);
</text><text class="text-mono" x="0" y="34.800000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;TRY&#160;PARSE&#160;immediately&#160;(not&#160;at&#160;EAGAIN)&#160;*/</tspan>
</text><text class="text-mono" x="0" y="36.100000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>state&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;HTTP_READING_HEADERS)&#160;{
</text><text class="text-mono" x="0" y="37.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">parse_result_t</tspan>&#160;pr&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>
</text><text class="text-mono" x="0" y="38.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">http_parse_incremental</tspan>(c);
</text><text class="text-mono" x="0" y="40.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(pr&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;PARSE_ERROR)&#160;{
</text><text class="text-mono" x="0" y="41.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">http_send_error</tspan>(c,&#160;<tspan fill="#009999">400</tspan>,&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Bad&#160;Request</tspan><tspan fill="#dd1144">&quot;</tspan>);
</text><text class="text-mono" x="0" y="42.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>;
</text><text class="text-mono" x="0" y="43.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="45.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(pr&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;PARSE_OK)&#160;{
</text><text class="text-mono" x="0" y="46.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>state&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;HTTP_PROCESSING;
</text><text class="text-mono" x="0" y="47.800000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">http_process_request</tspan>(c);
</text><text class="text-mono" x="0" y="49.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="50.400000em">&#160;&#160;&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="51.700000em">&#160;&#160;&#160;&#160;}&#160;<tspan fill="#000000" class="text-mono-bold">else</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(n&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;{
</text><text class="text-mono" x="0" y="53.000000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_defer</tspan>(r,
</text><text class="text-mono" x="0" y="54.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;http_conn_close_deferred,&#160;c);
</text><text class="text-mono" x="0" y="55.600000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>;
</text><text class="text-mono" x="0" y="56.900000em">&#160;&#160;&#160;&#160;}&#160;<tspan fill="#000000" class="text-mono-bold">else</tspan>&#160;{
</text><text class="text-mono" x="0" y="58.200000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(errno<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>EAGAIN<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan>errno<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>EWOULDBLOCK)
</text><text class="text-mono" x="0" y="59.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">break</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;ET&#160;drain&#160;complete&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="60.800000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_defer</tspan>(r,
</text><text class="text-mono" x="0" y="62.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;http_conn_close_deferred,&#160;c);
</text><text class="text-mono" x="0" y="63.400000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>;
</text><text class="text-mono" x="0" y="64.700000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="66.000000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="67.300000em">}</text></g></g><g transform="translate(12236.000000 3943.000000)" class="dark-code"><rect width="544.000000" height="1097.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;http_core.c&#160;&#160;registered&#160;with&#160;reactor&#160;as&#160;io_cb_fn&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">static</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">http_on_readable</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">user_data</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">http_conn_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">http_conn_t</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">user_data</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">reactor_ref</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">events</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">REACTOR_ERROR</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">REACTOR_HANGUP</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_defer</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">http_conn_close_deferred</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;ET&#160;mode:&#160;drain&#160;until&#160;EAGAIN&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">for</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">space</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">read_buf</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">read_pos</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">space</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">http_send_error</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">413</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Too&#160;Large</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">ssize_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">read</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">read_buf</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">read_pos</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">space</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">read_pos</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Reset&#160;idle&#160;timer&#160;on&#160;each&#160;byte&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_cancel_timer</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">timer_id</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">timer_id</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">reactor_set_timeout</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">IDLE_TIMEOUT_MS</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="33.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">http_idle_timeout_cb</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="34.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;TRY&#160;PARSE&#160;immediately&#160;(not&#160;at&#160;EAGAIN)&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="36.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">state</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">HTTP_READING_HEADERS</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="37.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">parse_result_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">pr</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="38.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">http_parse_incremental</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="40.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">pr</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">PARSE_ERROR</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="41.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">http_send_error</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">400</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Bad&#160;Request</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="42.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="43.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="45.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">pr</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">PARSE_OK</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="46.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">state</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">HTTP_PROCESSING</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="47.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">http_process_request</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="49.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="50.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="51.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="53.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_defer</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="54.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">http_conn_close_deferred</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="55.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="56.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="58.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">errno</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">EAGAIN</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">errno</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">EWOULDBLOCK</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="59.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">break</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;ET&#160;drain&#160;complete&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="60.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_defer</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="62.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">http_conn_close_deferred</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="63.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="64.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="66.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="67.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="bTRfbGF5ZXIuaHR0cF9wcm9jZXNzX2ZuLmNvZGU="><g class="shape" ></g><g transform="translate(15571.000000 4026.000000)" class="light-code"><rect width="563.000000" height="931.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;http_core.c&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#000000" class="text-mono-bold">static</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">http_process_request</tspan>(<tspan fill="#445588" class="text-mono-bold">http_conn_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>c){
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>state&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;HTTP_WRITING_RESPONSE;
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;Path&#160;sanitization&#160;(security-critical)&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;fpath[MAX_PATH<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(STATIC_DIR)<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">16</tspan>];
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(<tspan fill="#990000" class="text-mono-bold">build_safe_path</tspan>(c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>req.path,
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;fpath,&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(fpath))<tspan fill="#000000" class="text-mono-bold">!</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>){
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">http_send_error</tspan>(c,&#160;<tspan fill="#009999">400</tspan>,&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Bad&#160;Request</tspan><tspan fill="#dd1144">&quot;</tspan>);
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>;
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;REJECT&#160;any&#160;path&#160;containing&#160;&quot;..&quot;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;Never&#160;skip&#160;this&#160;&#160;directory&#160;traversal&#160;vuln&#160;*/</tspan>
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;stat&#160;st;
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(<tspan fill="#990000" class="text-mono-bold">stat</tspan>(fpath,<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>st)<tspan fill="#000000" class="text-mono-bold">!</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">!</tspan><tspan fill="#990000" class="text-mono-bold">S_ISREG</tspan>(st.st_mode)){
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">http_send_error</tspan>(c,&#160;<tspan fill="#009999">404</tspan>,&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Not&#160;Found</tspan><tspan fill="#dd1144">&quot;</tspan>);
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>;
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;Build&#160;response&#160;headers&#160;&#160;conn_write_buffered&#160;*/</tspan>
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;hdr[<tspan fill="#009999">512</tspan>];
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;<tspan fill="#990000" class="text-mono-bold">snprintf</tspan>(hdr,<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(hdr),
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">HTTP/1.1&#160;200&#160;OK</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Content-Type:&#160;%s</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>
</text><text class="text-mono" x="0" y="29.600000em">&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Content-Length:&#160;%lld</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>
</text><text class="text-mono" x="0" y="30.900000em">&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Connection:&#160;%s</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>,
</text><text class="text-mono" x="0" y="32.200000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">get_content_type</tspan>(fpath),
</text><text class="text-mono" x="0" y="33.500000em">&#160;&#160;&#160;&#160;(<tspan fill="#445588" class="text-mono-bold">long</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">long</tspan>)st.st_size,
</text><text class="text-mono" x="0" y="34.800000em">&#160;&#160;&#160;&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>req.keep_alive<tspan fill="#000000" class="text-mono-bold">?</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">keep-alive</tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#000000" class="text-mono-bold">:</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">close</tspan><tspan fill="#dd1144">&quot;</tspan>);
</text><text class="text-mono" x="0" y="36.100000em">&#160;&#160;<tspan fill="#990000" class="text-mono-bold">conn_write_buffered</tspan>(c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>reactor_ref,&#160;c,
</text><text class="text-mono" x="0" y="37.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;hdr,&#160;<tspan fill="#990000" class="text-mono-bold">strlen</tspan>(hdr));
</text><text class="text-mono" x="0" y="38.700000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;Read&#160;file&#160;in&#160;64KB&#160;chunks&#160;&#160;wbuf&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="40.000000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;Zero-copy&#160;opt:&#160;sendfile(2)&#160;&#160;see&#160;KnowledgeCascade&#160;*/</tspan>
</text><text class="text-mono" x="0" y="41.300000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;ffd&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">open</tspan>(fpath,&#160;O_RDONLY<tspan fill="#000000" class="text-mono-bold">|</tspan>O_CLOEXEC);
</text><text class="text-mono" x="0" y="42.600000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;fbuf[<tspan fill="#009999">65536</tspan>];&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;64KB&#160;chunks&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="43.900000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">ssize_t</tspan>&#160;nr;
</text><text class="text-mono" x="0" y="45.200000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">while</tspan>((nr<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#990000" class="text-mono-bold">read</tspan>(ffd,fbuf,<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(fbuf)))<tspan fill="#000000" class="text-mono-bold">&gt;</tspan><tspan fill="#009999">0</tspan>)
</text><text class="text-mono" x="0" y="46.500000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">conn_write_buffered</tspan>(c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>reactor_ref,&#160;c,
</text><text class="text-mono" x="0" y="47.800000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;fbuf,&#160;(<tspan fill="#445588" class="text-mono-bold">uint32_t</tspan>)nr);
</text><text class="text-mono" x="0" y="49.100000em">&#160;&#160;<tspan fill="#990000" class="text-mono-bold">close</tspan>(ffd);
</text><text class="text-mono" x="0" y="50.400000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;Keep-alive:&#160;reset&#160;state&#160;machine&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="51.700000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>req.keep_alive)
</text><text class="text-mono" x="0" y="53.000000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">http_conn_reset_for_keepalive</tspan>(c);
</text><text class="text-mono" x="0" y="54.300000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">else</tspan>
</text><text class="text-mono" x="0" y="55.600000em">&#160;&#160;&#160;&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>state&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;HTTP_CLOSING;
</text><text class="text-mono" x="0" y="56.900000em">}</text></g></g><g transform="translate(15571.000000 4026.000000)" class="dark-code"><rect width="563.000000" height="931.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;http_core.c&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">static</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">http_process_request</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">http_conn_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">state</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">HTTP_WRITING_RESPONSE</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Path&#160;sanitization&#160;(security-critical)&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fpath</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">MAX_PATH</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">STATIC_DIR</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">16</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89b4fa">build_safe_path</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">path</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">fpath</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fpath</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">http_send_error</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">400</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Bad&#160;Request</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;REJECT&#160;any&#160;path&#160;containing&#160;&quot;..&quot;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Never&#160;skip&#160;this&#160;&#160;directory&#160;traversal&#160;vuln&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">stat</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">st</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89b4fa">stat</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fpath</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">st</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#89b4fa">S_ISREG</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">st</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">st_mode</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">http_send_error</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">404</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Not&#160;Found</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Build&#160;response&#160;headers&#160;&#160;conn_write_buffered&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">hdr</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">512</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">snprintf</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">hdr</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">hdr</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">HTTP/1.1&#160;200&#160;OK</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Content-Type:&#160;%s</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Content-Length:&#160;%lld</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Connection:&#160;%s</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">get_content_type</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fpath</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="33.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">long</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">long</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">st</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">st_size</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="34.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">keep_alive</tspan><tspan fill="#89dceb" class="text-mono-bold">?</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">keep-alive</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#89dceb" class="text-mono-bold">:</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">close</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="36.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">conn_write_buffered</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">reactor_ref</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="37.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">hdr</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">strlen</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">hdr</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="38.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Read&#160;file&#160;in&#160;64KB&#160;chunks&#160;&#160;wbuf&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="40.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Zero-copy&#160;opt:&#160;sendfile(2)&#160;&#160;see&#160;KnowledgeCascade&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="41.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">ffd</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">open</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fpath</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">O_RDONLY</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">O_CLOEXEC</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="42.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fbuf</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">65536</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;64KB&#160;chunks&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="43.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">ssize_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">nr</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="45.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">while</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">nr</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89b4fa">read</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">ffd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">fbuf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fbuf</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="46.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">conn_write_buffered</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">reactor_ref</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="47.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">fbuf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">uint32_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">nr</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="49.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">close</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">ffd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="50.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;Keep-alive:&#160;reset&#160;state&#160;machine&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="51.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">keep_alive</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="53.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">http_conn_reset_for_keepalive</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="54.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="55.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">state</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">HTTP_CLOSING</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="56.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="bTRfbGF5ZXIuaHR0cF9jb25uX2Nsb3NlLmNvZGU="><g class="shape" ></g><g transform="translate(15590.000000 5077.000000)" class="light-code"><rect width="544.000000" height="473.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;http_connection.c&#160;&#160;ALWAYS&#160;call&#160;via&#160;reactor_defer&#160;*/</tspan>
</text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic">/*&#160;NEVER&#160;call&#160;close(fd)&#160;directly&#160;from&#160;I/O&#160;callback&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#000000" class="text-mono-bold">static</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">http_conn_close_deferred</tspan>(
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">reactor_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>r,&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>arg)&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">http_conn_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>c&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">http_conn_t</tspan><tspan fill="#000000" class="text-mono-bold">*</tspan>)arg;
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>fd&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;guard:&#160;double-close&#160;*/</tspan>
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;MANDATORY&#160;ORDER:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;1.&#160;Cancel&#160;timer&#160;(prevents&#160;timer-after-free)&#160;*/</tspan>
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>(c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>timer_id&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;{
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_cancel_timer</tspan>(r,&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>timer_id);
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>timer_id&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;}
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;2.&#160;Deregister&#160;(epoll_ctl&#160;DEL)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;<tspan fill="#990000" class="text-mono-bold">reactor_deregister</tspan>(r,&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>fd);
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;3.&#160;Free&#160;write&#160;buffer&#160;heap&#160;memory&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;<tspan fill="#990000" class="text-mono-bold">wbuf_free</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>wbuf);
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;4.&#160;Close&#160;fd&#160;(kernel&#160;releases&#160;TCP&#160;state)&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;<tspan fill="#990000" class="text-mono-bold">close</tspan>(c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>fd);
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;c<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>fd&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">/*&#160;5.&#160;Free&#160;struct&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan>
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;<tspan fill="#990000" class="text-mono-bold">free</tspan>(c);
</text><text class="text-mono" x="0" y="28.300000em">}</text></g></g><g transform="translate(15590.000000 5077.000000)" class="dark-code"><rect width="544.000000" height="473.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">/*&#160;http_connection.c&#160;&#160;ALWAYS&#160;call&#160;via&#160;reactor_defer&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;NEVER&#160;call&#160;close(fd)&#160;directly&#160;from&#160;I/O&#160;callback&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">static</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">http_conn_close_deferred</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">reactor_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">arg</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">http_conn_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">http_conn_t</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">arg</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;guard:&#160;double-close&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;MANDATORY&#160;ORDER:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;1.&#160;Cancel&#160;timer&#160;(prevents&#160;timer-after-free)&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">timer_id</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_cancel_timer</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">timer_id</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">timer_id</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;2.&#160;Deregister&#160;(epoll_ctl&#160;DEL)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">reactor_deregister</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">r</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;3.&#160;Free&#160;write&#160;buffer&#160;heap&#160;memory&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">wbuf_free</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">wbuf</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;4.&#160;Close&#160;fd&#160;(kernel&#160;releases&#160;TCP&#160;state)&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">close</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">/*&#160;5.&#160;Free&#160;struct&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;*/</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89b4fa">free</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">c</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="bTRfbGF5ZXIubTRfcGVyZi50YXJnZXRz"><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="10719.000000" y="5160.000000" width="3579" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Throughput</strong>: 50,00080,000 RPS @ 10K connections
<strong>p99 Latency</strong>: &lt; 100ms under wrk -c10000
<strong>Memory</strong>: ~175 MB RSS @ 10K connections (17.5KB/conn)
<strong>CPU</strong>: Single-threaded, should not exceed 1 core
<strong>Syscall</strong>: epoll_wait + read + stat + open + write per request
<strong>Syscall cost</strong>: ~200ns each  ~1ms total per request overhead
<strong>sendfile() opt</strong>: eliminates 2 memcpy, saves ~30% CPU for files
<code>ulimit -n 65536</code> REQUIRED before testing C10K
<code>net.core.somaxconn=65535</code> for listen backlog
<code>net.ipv4.tcp_tw_reuse=1</code> for TIME_WAIT reuse</p>
</div></foreignObject></g></g><g class="bTRfbGF5ZXIuc2xvd19sb3Jpcy5kZXNj"><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="11315.000000" y="5304.000000" width="2386" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Attack</strong>: Client sends 1 byte/25s  parser never completes
 holds 17.5KB + fd indefinitely  fd exhaustion
<strong>Defense 1</strong>: IDLE_TIMEOUT_MS=30000 (reset on each read)
<strong>Defense 2</strong>: MAX_HEADER_TIME_MS=60000 (absolute header deadline)
<strong>Defense 3</strong>: WRITE_BUF_MAX=256KB (slow reader  close)
conn_write returns -1 on overflow  caller must close connection</p>
</div></foreignObject></g></g><g class="bTRfbGF5ZXIubTRfcGl0ZmFsbHMucA=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="11319.000000" y="5448.000000" width="2379" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>P1</strong> Expecting complete headers in 1 read()  fails at MTU boundary
<strong>P2</strong> Write buffer growing unbounded for slow clients  OOM
<strong>P3</strong> Keep-alive without resetting read_buf/req  stale data
<strong>P4</strong> Path traversal (..) not rejected  /etc/passwd served
<strong>P5</strong> Closing fd directly from callback  use-after-free
<strong>P6</strong> Benchmarking without ulimit -n 65536  EMFILE at conn 1025</p>
</div></foreignObject></g></g><g class="KGh3X2xheWVyLm5pYyAtJmd0OyBrZXJuZWxfbGF5ZXIudGNwX3N0YWNrKVswXQ=="><marker id="mk-d2-947802846-827361347" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#880E4F" class="connection" stroke-width="2" /> </marker><path d="M 5908.000000 2125.083008 L 5991.000000 2125.083008 S 6001.000000 2125.083008 6001.000000 2115.083008 L 6001.000000 1661.666016 S 6001.000000 1651.666016 6011.000000 1651.666016 L 6313.000000 1651.666016" stroke="#880E4F" fill="none" class="connection animated-connection" style="stroke-width:2;stroke-dasharray:10.000000,9.865639;stroke-dashoffset:-198.656393;animation: dashdraw 4.932820s linear infinite;" marker-end="url(#mk-d2-947802846-827361347)" mask="url(#d2-947802846)" /><text x="6001.500000" y="1776.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="6001.500000" dy="0.000000">TCP segment | 1-1500B | DMA write</tspan><tspan x="6001.500000" dy="11.500000">no CPU | NIC interrupt  NAPI</tspan></text></g><g class="a2VybmVsX2xheWVyLih0Y3Bfc3RhY2sgLSZndDsgZXBvbGxfaW5zdGFuY2UpWzBd"><marker id="mk-d2-947802846-1941581261" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#1B5E20" class="connection" stroke-width="2" /> </marker><path d="M 8485.000000 1631.000000 L 8704.000000 1631.000000" stroke="#1B5E20" fill="none" class="connection" style="stroke-width:2;" marker-end="url(#mk-d2-947802846-1941581261)" mask="url(#d2-947802846)" /><text x="8595.500000" y="1625.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="8595.500000" dy="0.000000">sock_def_readable()</tspan><tspan x="8595.500000" dy="11.000000"> epitem to rdllist</tspan><tspan x="8595.500000" dy="11.000000">O(1) insertion</tspan></text></g><g class="KGtlcm5lbF9sYXllci5lcG9sbF9pbnN0YW5jZSAtJmd0OyBtMV9sYXllci5sdF9sb29wKVswXQ=="><marker id="mk-d2-947802846-2621907285" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#0D47A1" class="connection" stroke-width="2" /> </marker><path d="M 10232.000000 1587.000000 L 10315.000000 1587.000000 S 10325.000000 1587.000000 10325.000000 1577.000000 L 10325.000000 1237.083008 S 10325.000000 1227.083008 10335.000000 1227.083008 L 11911.000000 1227.083008" stroke="#0D47A1" fill="none" class="connection animated-connection" style="stroke-width:2;stroke-dasharray:10.000000,9.865639;stroke-dashoffset:-198.656393;animation: dashdraw 4.932820s linear infinite;" marker-end="url(#mk-d2-947802846-2621907285)" mask="url(#d2-947802846)" /><text x="10893.000000" y="1221.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="10893.000000" dy="0.000000">copy_to_user()</tspan><tspan x="10893.000000" dy="11.000000">events[0..n-1]</tspan><tspan x="10893.000000" dy="11.000000">12KB array (L1-hot)</tspan></text></g><g class="KGtlcm5lbF9sYXllci5lcG9sbF9pbnN0YW5jZSAtJmd0OyBtMV9sYXllci5ldF9sb29wKVswXQ=="><path d="M 10232.000000 1675.000000 L 10365.000000 1675.000000 S 10375.000000 1675.000000 10375.000000 1665.000000 L 10375.000000 1320.750000 S 10375.000000 1310.750000 10385.000000 1310.750000 L 11911.000000 1310.750000" stroke="#0D47A1" fill="none" class="connection animated-connection" style="stroke-width:2;stroke-dasharray:8.000000,7.892511;stroke-dashoffset:-158.925114;animation: dashdraw 3.946256s linear infinite;" marker-end="url(#mk-d2-947802846-2621907285)" mask="url(#d2-947802846)" /><text x="10890.500000" y="1304.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="10890.500000" dy="0.000000">copy_to_user()</tspan><tspan x="10890.500000" dy="11.000000">events[0..n-1]</tspan><tspan x="10890.500000" dy="11.000000">FIRES ONCE per state change</tspan></text></g><g class="KGtlcm5lbF9sYXllci52ZHNvIC0mZ3Q7IG0yX2xheWVyLnRpbWVyX29wcylbMF0="><marker id="mk-d2-947802846-3943899440" markerWidth="10.000000" markerHeight="12.000000" refX="8.500000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#4527A0" class="connection" stroke-width="1" /> </marker><path d="M 10231.500000 1845.000000 L 10315.000000 1845.000000 S 10325.000000 1845.000000 10325.000000 1855.000000 L 10325.000000 2457.000000 S 10325.000000 2467.000000 10335.000000 2467.000000 L 16319.000000 2467.000000 S 16329.000000 2467.000000 16329.000000 2477.000000 L 16329.000000 2676.750000 S 16329.000000 2686.750000 16339.000000 2686.750000 L 17687.500000 2686.750000" stroke="#4527A0" fill="none" class="connection" style="stroke-width:1;" marker-end="url(#mk-d2-947802846-3943899440)" mask="url(#d2-947802846)" /><text x="13758.500000" y="2461.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="13758.500000" dy="0.000000">now_ms()</tspan><tspan x="13758.500000" dy="11.000000">~30ns vDSO</tspan><tspan x="13758.500000" dy="11.000000">CLOCK_MONOTONIC</tspan></text></g><g class="KG0xX2xheWVyLmNvbm5fc3RhdGVfbTEgLSZndDsgbTJfbGF5ZXIuY29ubl9zdGF0ZV9tMilbMF0="><marker id="mk-d2-947802846-692917252" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#F57F17" class="connection" stroke-width="2" /> </marker><path d="M 13694.000000 465.500000 L 16498.000000 465.500000 S 16508.000000 465.500000 16508.000000 475.500000 L 16508.000000 807.000000 S 16508.000000 817.000000 16518.000000 817.000000 L 16599.000000 817.000000" stroke="#F57F17" fill="none" class="connection" style="stroke-width:2;" marker-end="url(#mk-d2-947802846-692917252)" mask="url(#d2-947802846)" /><text x="15323.500000" y="454.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="15323.500000" dy="0.000000">M1M2: adds wbuf(24B)</tspan><tspan x="15323.500000" dy="10.750000">epollout_armed(1B)</tspan><tspan x="15323.500000" dy="10.750000">timer_idx(4B)</tspan><tspan x="15323.500000" dy="10.750000">timer_expiry(8B)</tspan></text></g><g class="bTJfbGF5ZXIuKGNvbm5fd3JpdGVfZm4gLSZndDsgY29ubl9mbHVzaF9mbilbMF0="><marker id="mk-d2-947802846-1863234019" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#7B1FA2" class="connection" stroke-width="2" /> </marker><path d="M 18316.000000 1420.500000 L 19653.000000 1420.500000" stroke="#7B1FA2" fill="none" class="connection animated-connection" style="stroke-width:2;stroke-dasharray:10.000000,9.865639;stroke-dashoffset:-198.656393;animation: dashdraw 4.932820s linear infinite;" marker-end="url(#mk-d2-947802846-1863234019)" mask="url(#d2-947802846)" /><text x="18985.000000" y="1414.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="18985.000000" dy="0.000000">EAGAIN path:</tspan><tspan x="18985.000000" dy="11.000000">wbuf_append(remaining)</tspan><tspan x="18985.000000" dy="11.000000">epoll_ctl MOD+EPOLLOUT</tspan></text></g><g class="KG0yX2xheWVyLmNvbm5fZmx1c2hfZm4gLSZndDsga2VybmVsX2xheWVyLnRjcF9zdGFjaylbMF0="><path d="M 20265.000000 1420.500000 L 20348.000000 1420.500000 S 20358.000000 1420.500000 20358.000000 1410.500000 L 20358.000000 39.000000 S 20358.000000 29.000000 20348.000000 29.000000 L 6232.000000 29.000000 S 6222.000000 29.000000 6222.000000 39.000000 L 6222.000000 1600.333008 S 6222.000000 1610.333008 6232.000000 1610.333008 L 6313.000000 1610.333008" stroke="#1B5E20" fill="none" class="connection" style="stroke-width:2;" marker-end="url(#mk-d2-947802846-1941581261)" mask="url(#d2-947802846)" /><text x="13195.500000" y="23.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="13195.500000" dy="0.000000">write(fd, ptr, n)</tspan><tspan x="13195.500000" dy="11.000000">kernel copies to</tspan><tspan x="13195.500000" dy="11.000000">sk_send_head  NIC DMA</tspan></text></g><g class="KG0yX2xheWVyLnRpbWVyX29wcyAtJmd0OyBtM19sYXllci5yZWFjdG9yX3J1bl9mbilbMF0="><marker id="mk-d2-947802846-3212828825" markerWidth="10.000000" markerHeight="12.000000" refX="8.500000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#283593" class="connection" stroke-width="1" /> </marker><path d="M 18325.500000 2555.000000 L 20515.000000 2555.000000 S 20525.000000 2555.000000 20525.000000 2565.000000 L 20525.000000 3953.499023 S 20525.000000 3963.499023 20535.000000 3963.499027 L 23009.500000 3963.499999" stroke="#283593" fill="none" class="connection" style="stroke-width:1;" marker-end="url(#mk-d2-947802846-3212828825)" mask="url(#d2-947802846)" /><text x="20525.500000" y="3396.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="20525.500000" dy="0.000000">timer_next_ms()</tspan><tspan x="20525.500000" dy="11.000000"> epoll_wait timeout</tspan><tspan x="20525.500000" dy="11.000000">tick-less sleeping</tspan></text></g><g class="bTNfbGF5ZXIuKHJlYWN0b3JfYXBpIC0mZ3Q7IHJlYWN0b3JfcnVuX2ZuKVswXQ=="><marker id="mk-d2-947802846-2255191598" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#283593" class="connection" stroke-width="2" /> </marker><path d="M 22773.000000 4358.916016 L 23008.000000 4358.916016" stroke="#283593" fill="none" class="connection" style="stroke-width:2;" marker-end="url(#mk-d2-947802846-2255191598)" mask="url(#d2-947802846)" /><text x="22891.500000" y="4352.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="22891.500000" dy="0.000000">reactor_run() blocks</tspan><tspan x="22891.500000" dy="11.000000">calls epoll_wait</tspan><tspan x="22891.500000" dy="11.000000">dispatches callbacks</tspan></text></g><g class="bTNfbGF5ZXIuKGZkX2hhbmRsZXJfc3RydWN0IC0mZ3Q7IHpvbWJpZV9tZWNoYW5pc20pWzBd"><path d="M 22773.000000 5229.416016 L 23002.000000 5229.416016" stroke="#283593" fill="none" class="connection" style="stroke-width:2;stroke-dasharray:10.000000,9.865639;" marker-end="url(#mk-d2-947802846-2255191598)" mask="url(#d2-947802846)" /><text x="22888.500000" y="5223.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="22888.500000" dy="0.000000">is_zombie=true</tspan><tspan x="22888.500000" dy="11.000000">during dispatch</tspan><tspan x="22888.500000" dy="11.000000">clears on re-register</tspan></text></g><g class="bTNfbGF5ZXIuKHpvbWJpZV9tZWNoYW5pc20gLSZndDsgZGVmZXJyZWRfdGFza19mbilbMF0="><path d="M 23623.000000 5099.250000 L 23850.000000 5099.250000" stroke="#283593" fill="none" class="connection" style="stroke-width:2;" marker-end="url(#mk-d2-947802846-2255191598)" mask="url(#d2-947802846)" /><text x="23737.500000" y="5093.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="23737.500000" dy="0.000000">MOD_DEL queued</tspan><tspan x="23737.500000" dy="11.000000">applied after loop</tspan><tspan x="23737.500000" dy="11.000000">reactor_defer for close</tspan></text></g><g class="KG0zX2xheWVyLnJlYWN0b3JfcnVuX2ZuIC0mZ3Q7IG00X2xheWVyLmh0dHBfb25fcmVhZGFibGUpWzBd"><marker id="mk-d2-947802846-4235725476" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#004D40" class="connection" stroke-width="2" /> </marker><path d="M 23610.000000 4218.250000 L 24545.000000 4218.250000 S 24555.000000 4218.250000 24555.000000 4228.250000 L 24555.000000 6463.916016 S 24555.000000 6473.916016 24545.000000 6473.916016 L 10584.000000 6473.916016 S 10574.000000 6473.916016 10574.000000 6463.916016 L 10574.000000 4501.500000 S 10574.000000 4491.500000 10584.000000 4491.500000 L 12183.000000 4491.500000" stroke="#004D40" fill="none" class="connection animated-connection" style="stroke-width:2;stroke-dasharray:10.000000,9.865639;stroke-dashoffset:-198.656393;animation: dashdraw 4.932820s linear infinite;" marker-end="url(#mk-d2-947802846-4235725476)" mask="url(#d2-947802846)" /><text x="17368.500000" y="6467.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="17368.500000" dy="0.000000">callback dispatch:</tspan><tspan x="17368.500000" dy="11.000000">fd_handler.callback(fd,</tspan><tspan x="17368.500000" dy="11.000000">events, user_data)</tspan></text></g><g class="bTRfbGF5ZXIuKGh0dHBfb25fcmVhZGFibGUgLSZndDsgaHR0cF9wYXJzZXIpWzBd"><path d="M 12832.000000 4491.500000 L 14579.000000 4491.500000" stroke="#004D40" fill="none" class="connection" style="stroke-width:2;" marker-end="url(#mk-d2-947802846-4235725476)" mask="url(#d2-947802846)" /><text x="13706.500000" y="4485.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="13706.500000" dy="0.000000">read_buf[read_pos]</tspan><tspan x="13706.500000" dy="11.000000">read_pos += n</tspan><tspan x="13706.500000" dy="11.000000">parse after each read()</tspan></text></g><g class="bTRfbGF5ZXIuKGh0dHBfcGFyc2VyIC0mZ3Q7IGh0dHBfcHJvY2Vzc19mbilbMF0="><path d="M 15277.000000 4491.500000 L 15517.000000 4491.500000" stroke="#004D40" fill="none" class="connection" style="stroke-width:2;" marker-end="url(#mk-d2-947802846-4235725476)" mask="url(#d2-947802846)" /><text x="15398.000000" y="4485.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="15398.000000" dy="0.000000">PARSE_OK</tspan><tspan x="15398.000000" dy="11.000000">state=HTTP_PROCESSING</tspan><tspan x="15398.000000" dy="11.000000">req.method/path ready</tspan></text></g><g class="KG00X2xheWVyLmh0dHBfcHJvY2Vzc19mbiAtJmd0OyBtMl9sYXllci5jb25uX3dyaXRlX2ZuKVswXQ=="><path d="M 16186.000000 4491.500000 L 16269.000000 4491.500000 S 16279.000000 4491.500000 16279.000000 4481.500000 L 16279.000000 1430.500000 S 16279.000000 1420.500000 16289.000000 1420.500000 L 17696.000000 1420.500000" stroke="#004D40" fill="none" class="connection animated-connection" style="stroke-width:2;stroke-dasharray:10.000000,9.865639;stroke-dashoffset:-198.656393;animation: dashdraw 4.932820s linear infinite;" marker-end="url(#mk-d2-947802846-4235725476)" mask="url(#d2-947802846)" /><text x="16279.000000" y="2287.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="16279.000000" dy="0.000000">conn_write_buffered()</tspan><tspan x="16279.000000" dy="11.000000">headers: ~512B</tspan><tspan x="16279.000000" dy="11.000000">body: file content</tspan></text></g><g class="KG00X2xheWVyLmh0dHBfY29ubl9jbG9zZSAtJmd0OyBtM19sYXllci56b21iaWVfbWVjaGFuaXNtKVswXQ=="><marker id="mk-d2-947802846-1557190539" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#C62828" class="connection" stroke-width="2" /> </marker><path d="M 16186.000000 5533.250000 L 20515.000000 5533.250000 S 20525.000000 5533.250000 20525.000000 5523.250000 L 20525.000000 4979.083008 S 20525.000000 4969.083008 20535.000000 4969.083008 L 23002.000000 4969.083008" stroke="#C62828" fill="none" class="connection" style="stroke-width:2;stroke-dasharray:10.000000,9.865639;" marker-end="url(#mk-d2-947802846-1557190539)" mask="url(#d2-947802846)" /><text x="19877.000000" y="5527.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:10px"><tspan x="19877.000000" dy="0.000000">reactor_defer()</tspan><tspan x="19877.000000" dy="11.000000"> deferred close</tspan><tspan x="19877.000000" dy="11.000000">never direct close(fd)</tspan></text></g><g class="KGh3X2xheWVyLmNwdV9jYWNoZSAtJmd0OyBzY2FsZV9yZWYpWzBd"><marker id="mk-d2-947802846-2506270940" markerWidth="10.000000" markerHeight="12.000000" refX="8.500000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#880E4F" class="connection" stroke-width="1" /> </marker><path d="M 5907.500000 2269.083008 L 6264.500000 2269.083008" stroke="#880E4F" fill="none" class="connection" style="stroke-width:1;" marker-end="url(#mk-d2-947802846-2506270940)" mask="url(#d2-947802846)" /><text x="6087.000000" y="2259.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:9px"><tspan x="6087.000000" dy="0.000000">Cache line=64B</tspan><tspan x="6087.000000" dy="9.750000">L1=32KB</tspan><tspan x="6087.000000" dy="9.750000">L2=256KB</tspan><tspan x="6087.000000" dy="9.750000">L3=8-32MB</tspan></text></g><mask id="d2-947802846" maskUnits="userSpaceOnUse" x="-89" y="-183" width="24745" height="6773">
<rect x="-89" y="-183" width="24745" height="6773" fill="white"></rect>
<rect x="5929.000000" y="1766.000000" width="145" height="23" fill="black"></rect>
<rect x="8551.000000" y="1615.000000" width="89" height="33" fill="black"></rect>
<rect x="10851.000000" y="1211.000000" width="84" height="33" fill="black"></rect>
<rect x="10829.000000" y="1294.000000" width="123" height="33" fill="black"></rect>
<rect x="13714.000000" y="2451.000000" width="89" height="33" fill="black"></rect>
<rect x="15272.000000" y="444.000000" width="103" height="43" fill="black"></rect>
<rect x="18930.000000" y="1404.000000" width="110" height="33" fill="black"></rect>
<rect x="13141.000000" y="13.000000" width="109" height="33" fill="black"></rect>
<rect x="20480.000000" y="3386.000000" width="91" height="33" fill="black"></rect>
<rect x="22847.000000" y="4342.000000" width="89" height="33" fill="black"></rect>
<rect x="22845.000000" y="5213.000000" width="87" height="33" fill="black"></rect>
<rect x="23689.000000" y="5083.000000" width="97" height="33" fill="black"></rect>
<rect x="17319.000000" y="6457.000000" width="99" height="33" fill="black"></rect>
<rect x="13657.000000" y="4475.000000" width="99" height="33" fill="black"></rect>
<rect x="15343.000000" y="4475.000000" width="110" height="33" fill="black"></rect>
<rect x="16231.000000" y="2277.000000" width="96" height="33" fill="black"></rect>
<rect x="19832.000000" y="5517.000000" width="90" height="33" fill="black"></rect>
<rect x="6057.000000" y="2250.000000" width="60" height="39" fill="black"></rect>
</mask></svg></svg>
