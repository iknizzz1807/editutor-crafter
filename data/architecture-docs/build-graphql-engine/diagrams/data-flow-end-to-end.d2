title: End-to-End Data Flow Diagram

direction: right

dark_theme: {
  style: {
    font-color: "#e6edf3"
  }
}

flow: {
  graphql_string: "GraphQL Query String" {
    shape: rectangle
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.bold: true
    data_format: "String\n`query { user(id: 1) { name } }`"
  }

  tokens: "Tokenization" {
    shape: diamond
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    data_format: "Token Stream\n[{type: NAME, value: 'query'}, ...]"
  }

  ast: "Abstract Syntax Tree" {
    shape: rectangle
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    data_format: "AST Node Tree\nOperationDefinitionNode\n  SelectionSetNode\n    FieldNode"
  }

  validated: "Validated Query" {
    shape: rectangle
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    data_format: "Validated AST\n+ Type Information\n+ Schema Validation"
  }

  plan: "Execution Plan" {
    shape: rectangle
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    data_format: "Resolve Tree\n+ Field Resolvers\n+ Data Dependencies"
  }

  sql: "SQL Generation" {
    shape: diamond
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    data_format: "SQL Query\n`SELECT name FROM users WHERE id = 1`"
  }

  db: "Database" {
    shape: cylinder
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    data_format: "Query Results\nRows: [{name: 'John'}]"
  }

  json: "JSON Response" {
    shape: rectangle
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.bold: true
    data_format: "JSON Object\n`{\"data\": {\"user\": {\"name\": \"John\"}}}`"
  }

  client: "Client" {
    shape: rectangle
    style.fill: "#16213e"
    style.stroke: "#8b949e"
  }
}

graphql_string -> tokens: "Lexical Analysis"
tokens -> ast: "Syntax Parsing"
ast -> validated: "Type Checking\nSchema Validation"
validated -> plan: "Query Planning\nResolver Mapping"
plan -> sql: "SQL Compilation\nQuery Optimization"
sql -> db: "Execute Query"
db -> json: "Result Transformation\nJSON Serialization"
json -> client: "HTTP Response"
client -> graphql_string: "HTTP Request" {
  style.stroke-dash: 3
}