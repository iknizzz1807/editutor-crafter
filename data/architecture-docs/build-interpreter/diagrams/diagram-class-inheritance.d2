title: Class and Instance Relationships

LoxClass: {
  shape: sql_table
  style: {
    stroke: "#3fb950"
    fill: "#0f3460"
    font-color: "#e6edf3"
  }
  name: string
  superclass: "LoxClass?"
  methods: "Map<String, LoxFunction>"
}

LoxInstance: {
  shape: sql_table
  style: {
    stroke: "#3fb950"
    fill: "#0f3460"
    font-color: "#e6edf3"
  }
  klass: LoxClass
  fields: "Map<String, Any>"
}

Environment: {
  shape: sql_table
  style: {
    stroke: "#8b949e"
    fill: "#1a1a2e"
    font-color: "#e6edf3"
  }
  values: "Map<String, Any>"
  enclosing: "Environment?"
}

MethodEnvironment: {
  shape: sql_table
  style: {
    stroke: "#3fb950"
    fill: "#1a1a2e"
    font-color: "#e6edf3"
    bold: true
  }
  this: LoxInstance
  values: "Map<String, Any>"
  enclosing: Environment
}

note: |md
  **Special binding:**
  `this` â†’ LoxInstance
| {
  shape: page
  style: {
    fill: "#1a1a2e"
    font-color: "#e6edf3"
  }
}

# Relationships
LoxClass -> LoxClass: extends (superclass) {
  style.stroke-dash: 3
  style.stroke: "#8b949e"
}
LoxInstance -> LoxClass: instance of

# Method lookup flow
LoxInstance -> LoxClass: "1. lookup method" {
  style.stroke: "#3fb950"
}

# Environment binding
LoxInstance -> MethodEnvironment: "2. binds as 'this'" {
  style.stroke: "#58a6ff"
}
MethodEnvironment -> Environment: inherits scope {
  style.stroke-dash: 2
  style.stroke: "#8b949e"
}
