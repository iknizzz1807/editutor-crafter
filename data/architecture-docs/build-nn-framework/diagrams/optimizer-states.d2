title: Optimizer State Transitions

direction: right

# Initial state
start: {
  shape: circle
  style.fill: "#000000"
  style.stroke: "#3fb950"
  width: 20
  height: 20
}

# States
initialized: Initialized {
  shape: oval
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

forward_complete: Forward Pass\nComplete {
  shape: oval
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

gradients_computed: Gradients\nComputed {
  shape: oval
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

parameters_updated: Parameters\nUpdated {
  shape: oval
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

converged: Converged {
  shape: oval
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.stroke-width: 3
  style.font-color: "#e6edf3"
  style.bold: true
}

# Transitions
start -> initialized: create optimizer

initialized -> forward_complete: forward()\ncalled

forward_complete -> gradients_computed: loss.backward()\ncalled

gradients_computed -> parameters_updated: optimizer.step()\ncalled

parameters_updated -> initialized: optimizer.zero_grad()\ncalled

parameters_updated -> converged: convergence\ncriteria met

converged -> initialized: reset/restart\ntraining

# Self-loops for edge cases
initialized -> initialized: zero_grad()\ncalled

gradients_computed -> gradients_computed: multiple backward()\ncalls

# Arrow styling
start -> initialized: {
  style.stroke: "#8b949e"
}

initialized -> forward_complete: {
  style.stroke: "#8b949e"
}

forward_complete -> gradients_computed: {
  style.stroke: "#8b949e"
}

gradients_computed -> parameters_updated: {
  style.stroke: "#8b949e"
}

parameters_updated -> initialized: {
  style.stroke: "#8b949e"
}

parameters_updated -> converged: {
  style.stroke: "#8b949e"
}

converged -> initialized: {
  style.stroke: "#8b949e"
}

initialized -> initialized: {
  style.stroke: "#8b949e"
}

gradients_computed -> gradients_computed: {
  style.stroke: "#8b949e"
}