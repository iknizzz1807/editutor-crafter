vars: {
  d2-config: {
    layout-engine: elk
    theme-id: 200
  }
}
title: |md
  # Serial Port Register Map
  **COM1 Base Address: 0x3F8**
| {
  near: top-center
}
direction: right
registers: {
  grid-columns: 1
  grid-gap: 0
  style.fill: white
  style.stroke: "#CBD6E0"
  style.stroke-width: 2
  header_row: |md
    | Offset | I/O Port | R/W | Register | Function |
    | ------ | -------- | --- | -------- | -------- |
  |
  reg_00: "0x00 | 0x3F8 | R/W | THR/RBR | Transmit/Receive Buffer"
  reg_01: "0x01 | 0x3F9 | R/W | IER | Interrupt Enable Register"
  reg_02: "0x02 | 0x3FA | R | IIR | Interrupt ID Register"
  reg_02w: "0x02 | 0x3FA | W | FCR | FIFO Control Register"
  reg_03: "0x03 | 0x3FB | R/W | LCR | Line Control Register"
  reg_04: "0x03 | 0x3FC | R/W | MCR | Modem Control Register"
  reg_05: "0x03 | 0x3FD | R | LSR | Line Status Register"
  reg_06: "0x03 | 0x3FE | R/W | MSR | Modem Status Register"
  reg_07: "0x03 | 0x3FF | R/W | SCR | Scratch Register"
  reg_00.style.fill: "#E3F2FD"
  reg_01.style.fill: "#FFF3E0"
  reg_02.style.fill: "#F3E5F5"
  reg_02w.style.fill: "#F3E5F5"
  reg_03.style.fill: "#E8F5E9"
  reg_04.style.fill: "#E8F5E9"
  reg_05.style.fill: "#FFEBEE"
  reg_06.style.fill: "#FFF8E1"
  reg_07.style.fill: "#ECEFF1"
  reg_00.style.stroke: "#1976D2"
  reg_01.style.stroke: "#F57C00"
  reg_02.style.stroke: "#7B1FA2"
  reg_02w.style.stroke: "#7B1FA2"
  reg_03.style.stroke: "#388E3C"
  reg_04.style.stroke: "#388E3C"
  reg_05.style.stroke: "#D32F2F"
  reg_06.style.stroke: "#FFA000"
  reg_07.style.stroke: "#607D8B"
  *.style.stroke-width: 1
}
functions: {
  label: "Register Functions"
  thr_rbr: "THR/RBR (0x3F8)\n─────────────────\nWrite: Transmit Holding Register\nRead: Receive Buffer Register\n─────────────────\n• Write byte to transmit\n• Read received byte"
  ier: "IER (0x3F9)\n─────────────────\nInterrupt Enable Register\n─────────────────\nBit 0: RDA Enable\nBit 1: THRE Enable\nBit 2: RLSI Enable\nBit 3: MSI Enable"
  fcr: "FCR (0x3FA)\n─────────────────\nFIFO Control (Write Only)\n─────────────────\nBit 0: Enable FIFO\nBit 1: Clear RCVR FIFO\nBit 2: Clear XMIT FIFO\nBits 6-7: Trigger Level"
  lcr: "LCR (0x3FB)\n─────────────────\nLine Control Register\n─────────────────\nBits 0-1: Word Length\nBit 2: Stop Bits\nBits 3-5: Parity\nBit 7: DLAB (Divisor Latch)"
  lsr: "LSR (0x3FD)\n─────────────────\nLine Status Register\n─────────────────\nBit 0: Data Ready (DR)\nBit 5: THRE (Transmit Empty)\nBit 6: TEMT (Transmitter Empty)\nBit 7: Error in RCVR FIFO"
  thr_rbr.style.fill: "#E3F2FD"
  ier.style.fill: "#FFF3E0"
  fcr.style.fill: "#F3E5F5"
  lcr.style.fill: "#E8F5E9"
  lsr.style.fill: "#FFEBEE"
}
dlab_note: |md
  **DLAB Mode (LCR Bit 7 = 1):**
  - 0x3F8 + 0x3F9 become Divisor Latch
  - Used to set baud rate divisor
  - 115200 baud: divisor = 1 (0x0001)
|
registers -- functions
dlab_note.near: bottom-center