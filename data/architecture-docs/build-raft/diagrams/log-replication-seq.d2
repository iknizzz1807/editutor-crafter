shape: sequence_diagram

Client: {
  shape: oval
  style: {
    fill: "#16213e"
    stroke: "#3fb950"
  }
}

Leader: {
  shape: rectangle
  style: {
    fill: "#16213e"
    stroke: "#3fb950"
    bold: true
  }
}

Follower1: {
  shape: rectangle
  style: {
    fill: "#16213e"
    stroke: "#8b949e"
  }
}

Follower2: {
  shape: rectangle
  style: {
    fill: "#16213e"
    stroke: "#8b949e"
  }
}

Client -> Leader: 1. ClientRequest(command)

Leader -> Leader: "2. Append to log[]"
Leader -> Follower1: 3. AppendEntries RPC
Leader -> Follower2: 3. AppendEntries RPC

Follower1 -> Follower1: Append if log matches
Follower1 -> Leader: 4. Success (matchIndex updated)

Follower2 -> Follower2: Append if log matches (slow)

Leader -> Follower2: AppendEntries RPC (retry)
Follower2 -> Follower2: Append if log matches
Follower2 -> Leader: 4. Success (matchIndex updated)

Leader -> Leader: "5. Update commitIndex, Apply to state machine"
Leader -> Client: 6. Response(success)
