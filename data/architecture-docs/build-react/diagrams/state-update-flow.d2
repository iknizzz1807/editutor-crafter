title: State Update Data Flow {
  style {
    font-size: 24
    bold: true
    font-color: "#e6edf3"
  }
}

# Flowchart nodes
setState_call: setState() Called {
  style {
    fill: "#0f3460"
    stroke: "#3fb950"
    font-color: "#e6edf3"
    bold: true
  }
}

triggers_update: Triggers Update {
  style.fill: "#1a1a2e"
}

added_to_hook_queue: Added to Hook Queue {
  style.fill: "#1a1a2e"
}

marks_fiber_dirty: Marks Fiber as Dirty {
  style.fill: "#1a1a2e"
}

scheduler_picks_up: Scheduler Picks Up Work {
  style.fill: "#1a1a2e"
}

work_loop_processes: Work Loop Processes {
  style.fill: "#1a1a2e"
}

reconciliation: Reconciliation (Diffing) {
  shape: diamond
  style {
    fill: "#1a1a2e"
    stroke: "#3fb950"
    font-color: "#e6edf3"
  }
}

commit: Commit Phase {
  style.fill: "#1a1a2e"
}

dom_update: DOM Update {
  style {
    fill: "#0f3460"
    stroke: "#3fb950"
    font-color: "#e6edf3"
    bold: true
  }
}

# Flowchart connections
setState_call -> triggers_update: 1.
triggers_update -> added_to_hook_queue: 2.
added_to_hook_queue -> marks_fiber_dirty: 3.
marks_fiber_dirty -> scheduler_picks_up: 4.
scheduler_picks_up -> work_loop_processes: 5.
work_loop_processes -> reconciliation: 6.
reconciliation -> commit: Diff computed {
  style.stroke-dash: 2
}
commit -> dom_update: 8.

# Additional annotation
note: |md
  **Fiber Architecture** enables:
  - Interruptible rendering
  - Priority-based scheduling
  - Incremental updates
| {
  shape: page
  style {
    fill: "#16213e"
    stroke: "#8b949e"
    font-color: "#e6edf3"
  }
}

# Styling for all nodes
* {
  style {
    stroke: "#8b949e"
    font-color: "#e6edf3"
  }
}
