title: Core Data Model Relationships {
  style.font-size: 20
  style.bold: true
  style.font-color: "#e6edf3"
}

# Core Storage Structures
storage: Storage Layer {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  database: Database {
    shape: cylinder
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  entry: DatabaseEntry {
    shape: class
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    
    key: string
    value: RedisValue
    expiry: time.Time
    valueType: ValueType
  }
}

# RedisValue Hierarchy
redis_values: RedisValue Types {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  base: RedisValue {
    shape: class
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    
    Type: ValueType
    String: string
    Size: int64
  }
  
  string_val: StringValue {
    shape: class
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
    
    data: string
    Get: string
    Set: string
  }
  
  list_val: ListValue {
    shape: class
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
    
    items: string array
    Push: string
    Pop: string
    Index: int string
  }
  
  set_val: SetValue {
    shape: class
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
    
    members: map string bool
    Add: string bool
    Remove: string bool
    Contains: string bool
  }
  
  hash_val: HashValue {
    shape: class
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
    
    fields: map string string
    Set: field value
    Get: field string
    Delete: field bool
  }
}

# Connection Management
connection: Connection {
  shape: class
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
  
  conn: net.Conn
  db: Database
  subscriptions: map string bool
  selectedDB: int
  
  ReadCommand: Command
  WriteResponse: Response
  Subscribe: channel
}

# Value Type Enum
value_type: ValueType {
  shape: class
  style.fill: "#0f3460"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
  
  STRING
  LIST
  SET
  HASH
}

# Relationships
storage.database -> storage.entry: contains {style.stroke: "#8b949e"}
storage.entry -> redis_values.base: holds {style.stroke: "#8b949e"}
storage.entry -> value_type: type {style.stroke: "#8b949e"}

# Inheritance relationships
redis_values.base -> redis_values.string_val: implements {
  style.stroke: "#3fb950"
  style.stroke-dash: 5
}
redis_values.base -> redis_values.list_val: implements {
  style.stroke: "#3fb950"
  style.stroke-dash: 5
}
redis_values.base -> redis_values.set_val: implements {
  style.stroke: "#3fb950"
  style.stroke-dash: 5
}
redis_values.base -> redis_values.hash_val: implements {
  style.stroke: "#3fb950"
  style.stroke-dash: 5
}

# Connection relationships
connection -> storage.database: accesses {style.stroke: "#8b949e"}
connection -> storage.entry: reads writes {style.stroke: "#8b949e"}