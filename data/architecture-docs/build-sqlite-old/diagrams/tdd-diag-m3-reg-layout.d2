direction: down
vars: {
  d2-config: {
    theme-id: 200
    layout-engine: elk
  }
}

header: |md
  ### Register Memory Specification
  - **Architecture**: 64-bit (x86_64 alignment)
  - **Total Size**: 64 Bytes (1 Cache Line)
  - **Growth**: Linear Array `aReg[N]`
| {
  near: top-center
}

register_file: "VDBE Register File Layout" {
  style.stroke-width: 4

  cache_line_0: "Cache Line 0 (64 Bytes)" {
    style.stroke-dash: 5

    reg_0: "Register[0] (32 Bytes)" {
      grid-columns: 3
      grid-gap: 0

      # Offset | Field | Size
      o00: "00h" { shape: text }
      f00: "ValueType (enum)" { style.fill: "#A020F0"; style.font-color: white }
      s00: "4B" { shape: text }

      o04: "04h" { shape: text }
      f04: "Flags/Alignment" { style.fill: "#808080"; style.font-color: white }
      s04: "4B" { shape: text }

      o08: "08h" { shape: text }
      f08: "Numeric Data (i64 / f64)" { style.fill: "#0000FF"; style.font-color: white }
      s08: "8B" { shape: text }

      o10: "10h" { shape: text }
      f10: "Pointer *z (Heap Address)" { style.fill: "#FFA500"; style.font-color: white }
      s10: "8B" { shape: text }

      o18: "18h" { shape: text }
      f18: "Length n (Bytes)" { style.fill: "#0000FF"; style.font-color: white }
      s18: "4B" { shape: text }

      o1C: "1Ch" { shape: text }
      f1C: "Internal Padding" { style.fill: "#808080"; style.font-color: white }
      s1C: "4B" { shape: text }
    }

    reg_1: "Register[1] (32 Bytes)" {
      grid-columns: 3
      grid-gap: 0

      o20: "20h" { shape: text }
      f20: "ValueType (enum)" { style.fill: "#A020F0"; style.font-color: white }
      s20: "4B" { shape: text }

      o24: "24h" { shape: text }
      f24: "Flags/Alignment" { style.fill: "#808080"; style.font-color: white }
      s24: "4B" { shape: text }

      o28: "28h" { shape: text }
      f28: "Numeric Data (i64 / f64)" { style.fill: "#0000FF"; style.font-color: white }
      s28: "8B" { shape: text }

      o30: "30h" { shape: text }
      f30: "Pointer *z (Heap Address)" { style.fill: "#FFA500"; style.font-color: white }
      s30: "8B" { shape: text }

      o38: "38h" { shape: text }
      f38: "Length n (Bytes)" { style.fill: "#0000FF"; style.font-color: white }
      s38: "4B" { shape: text }

      o3C: "3Ch" { shape: text }
      f3C: "Internal Padding" { style.fill: "#808080"; style.font-color: white }
      s3C: "4B" { shape: text }
    }
  }
}

footer: |md
  **sizeof(Mem) = 32 bytes**
  *Align(8)*
| {
  near: bottom-right
}

legend: "Legend" {
  near: bottom-left
  
  h: "Header (Metadata)" { style.fill: "#A020F0"; style.font-color: white }
  d: "Data (Literals)" { style.fill: "#0000FF"; style.font-color: white }
  p: "Pointers (Heap)" { style.fill: "#FFA500"; style.font-color: white }
  pad: "Padding / Alignment" { style.fill: "#808080"; style.font-color: white }
}