sqlite_engine: {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.bold: false
  style.font-color: "#e6edf3"

  front_desk: {
    label: "Front Desk (Parser Layer)"
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.bold: false
    style.font-color: "#e6edf3"

    sql_parser: SQL Parser {
      style.bold: true
      style.stroke: "#3fb950"
    }
    sql_parser -> tokenization: produces
    tokenization: Tokenization
    sql_parser -> syntax_validation: performs
    syntax_validation: Syntax Validation
    sql_parser -> ast: builds
    ast: AST
    ast.shape: cylinder
  }

  office_manager: {
    label: "Office Manager (Execution Layer)"
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.bold: false
    style.font-color: "#e6edf3"

    query_engine: Query Engine {
      style.bold: true
      style.stroke: "#3fb950"
    }
    query_engine -> query_planning: performs
    query_planning: Query Planning
    query_engine -> operator_execution: executes
    operator_execution: Operator Execution
    query_engine -> constraint_checking: enforces
    constraint_checking: Constraint Checking
    query_engine -> transaction_state: manages
    transaction_state: Transaction State
  }

  filing_room: {
    label: "Filing Room (Storage Layer)"
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.bold: false
    style.font-color: "#e6edf3"

    btree_storage: B-tree Storage {
      style.bold: true
      style.stroke: "#3fb950"
    }
    btree_storage -> cursors: provides
    cursors: Cursors
    btree_storage -> page_management: manages
    page_management: Page Management
    btree_storage -> btree_operations: performs
    btree_operations: B-tree Operations
  }

  front_desk.sql_parser -> office_manager.query_engine: AST
  office_manager.query_engine -> filing_room.btree_storage: Query Operations
}

storage: {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.bold: false
  style.font-color: "#e6edf3"

  database_file: Database File {
    shape: cylinder
    style.bold: true
  }
  wal_file: WAL (Write-Ahead Log) {
    shape: page
  }
}

sqlite_engine.filing_room.btree_storage -> storage.database_file: Reads/Writes Pages
sqlite_engine.filing_room.btree_storage -> storage.wal_file: Logs Changes {
  style.stroke-dash: 3
}
sqlite_engine.office_manager.query_engine -> storage.wal_file: Manages Transactions {
  style.stroke-dash: 3
}