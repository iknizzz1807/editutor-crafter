direction: right
FetchPage Hit vs Miss Paths: {
  shape: sequence_diagram
  
  Client: "B-tree\nLayer"
  
  BufferPool: "Buffer\nPool"
  
  PageTable: "Page\nTable"
  
  EvictionMgr: "Eviction\nManager"
  
  DiskIO: "Disk\nI/O"
  
  Client -> BufferPool: FetchPage(pageNum)
  
  BufferPool -> PageTable: lookup(pageNum)
  PageTable -> BufferPool: "frameID | null"
  
  # HIT PATH
  BufferPool -> BufferPool: frameID found?
  
  BufferPool -> BufferPool: PinCount++
  
  BufferPool -> BufferPool: "LastAccess = now()"
  
  BufferPool -> Client: "return frame[frameID].page"
  
  # MISS PATH
  BufferPool -> EvictionMgr: findVictimFrame()
  
  EvictionMgr -> BufferPool: victimFrameID
  
  BufferPool -> BufferPool: victimFrame.dirty?
  
  BufferPool -> DiskIO: writePage(oldPageNum, data)
  
  DiskIO -> BufferPool: OK
  
  BufferPool -> DiskIO: readPage(pageNum)
  
  DiskIO -> BufferPool: pageData
  
  BufferPool -> BufferPool: initMetadata(pageNum)
  
  BufferPool -> BufferPool: "PinCount = 1"
  BufferPool -> PageTable: insert(pageNum, frameID)
  
  BufferPool -> Client: "return frame[frameID].page"
}