direction: down

title: String Escape Algorithm Steps

start: {
  shape: oval
  label: "Start\n(at quote char)"
}

read_quote: {
  shape: diamond
  label: "Current char\nis ' (quote)?"
}

peek_next: {
  shape: parallelogram
  label: "Peek next character"
}

check_escaped: {
  shape: diamond
  label: "Next char\nis also '?"
}

append_escape: {
  shape: rectangle
  label: "Append ' to value\nAdvance 2 chars"
}

end_string: {
  shape: rectangle
  label: "Advance 1 char\nEnd string literal"
}

continue_loop: {
  shape: rectangle
  label: "Continue reading\ncharacters"
}

return_token: {
  shape: oval
  label: "Return\nSTRING token"
}

start -> read_quote: {
  label: "Begin parsing"
}

read_quote -> peek_next: {
  label: "Yes"
}

read_quote -> return_token: {
  label: "No (error/end)"
}

peek_next -> check_escaped

check_escaped -> append_escape: {
  label: "Yes\n(escaped quote)"
}

check_escaped -> end_string: {
  label: "No\n(closing quote)"
}

append_escape -> continue_loop

continue_loop -> read_quote: {
  label: "Next iteration"
}

end_string -> return_token