direction: right

INSERT: {
  style.fill: "#e1f5e1"
  style.stroke: "#4caf50"
  label: INSERT Operation

  table_insert: "Insert row into table" {
    shape: rectangle
    style.fill: white
  }
  
  index_updates: "For each index:\nInsert (value, rowid)" {
    shape: rectangle
    style.fill: white
  }
  
  table_insert -> index_updates: "Then update indexes"
}

UPDATE: {
  style.fill: "#fff4e1"
  style.stroke: "#ff9800"
  label: UPDATE Operation

  check_column: "Indexed column\nchanged?" {
    shape: diamond
    style.fill: white
  }
  
  delete_old: "Delete old index entry\n(value_old, rowid)" {
    shape: rectangle
    style.fill: white
  }
  
  insert_new: "Insert new index entry\n(value_new, rowid)" {
    shape: rectangle
    style.fill: white
  }
  
  check_column -> delete_old: "Yes"
  delete_old -> insert_new
}

DELETE: {
  style.fill: "#ffe1e1"
  style.stroke: "#f44336"
  label: DELETE Operation

  table_delete: "Delete row from table" {
    shape: rectangle
    style.fill: white
  }
  
  index_delete: "For each index:\nDelete entry (value, rowid)" {
    shape: rectangle
    style.fill: white
  }
  
  table_delete -> index_delete: "Then update indexes"
}

INSERT -> UPDATE: "Next operation"
UPDATE -> DELETE: "Next operation"