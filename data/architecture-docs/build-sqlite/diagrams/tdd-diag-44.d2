vars: {
  d2-config: {
    layout-engine: elk
    theme-id: 200
  }
}

direction: down

AggregateState: {
  shape: class
  style: {
    fill: "#E3F2FD"
    stroke: "#1976D2"
  }
  Update(value Value)
  Finalize(): Value
}

CountStarState: {
  shape: class
  style: {
    fill: "#E8F5E9"
    stroke: "#388E3C"
  }
  count: int64
}

CountColumnState: {
  shape: class
  style: {
    fill: "#E8F5E9"
    stroke: "#388E3C"
  }
  count: int64
}

SumState: {
  shape: class
  style: {
    fill: "#E8F5E9"
    stroke: "#388E3C"
  }
  sum: float64
  valid: bool
}

AvgState: {
  shape: class
  style: {
    fill: "#E8F5E9"
    stroke: "#388E3C"
  }
  sum: float64
  count: int64
}

MinState: {
  shape: class
  style: {
    fill: "#E8F5E9"
    stroke: "#388E3C"
  }
  min: Value
  valid: bool
}

MaxState: {
  shape: class
  style: {
    fill: "#E8F5E9"
    stroke: "#388E3C"
  }
  max: Value
  valid: bool
}

CountStarState -> AggregateState: implements {
  target-arrowhead.shape: triangle
  target-arrowhead.style.filled: false
}
CountColumnState -> AggregateState: implements {
  target-arrowhead.shape: triangle
  target-arrowhead.style.filled: false
}
SumState -> AggregateState: implements {
  target-arrowhead.shape: triangle
  target-arrowhead.style.filled: false
}
AvgState -> AggregateState: implements {
  target-arrowhead.shape: triangle
  target-arrowhead.style.filled: false
}
MinState -> AggregateState: implements {
  target-arrowhead.shape: triangle
  target-arrowhead.style.filled: false
}
MaxState -> AggregateState: implements {
  target-arrowhead.shape: triangle
  target-arrowhead.style.filled: false
}