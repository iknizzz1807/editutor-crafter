direction: down

title: Nested Loop Join Algorithm {
  shape: text
  near: top-center
}

complexity: {
  shape: text
  near: top-right
  label: "Complexity: O(n×m)"
}

start: {
  shape: oval
  label: Start
}

left_table: {
  shape: cylinder
  label: "Left Table\n(Outer)"
  style.fill: "#E3F2FD"
}

right_table: {
  shape: cylinder
  label: "Right Table\n(Inner)"
  style.fill: "#FFF3E0"
}

outer_loop: {
  shape: rectangle
  label: "For each row L\nin Left Table"
  style.fill: "#BBDEFB"
}

inner_loop: {
  shape: rectangle
  label: "For each row R\nin Right Table"
  style.fill: "#FFE0B2"
}

evaluate: {
  shape: diamond
  label: "Evaluate\nJoin Condition\nL.key = R.key?"
  style.fill: "#F3E5F5"
}

emit: {
  shape: parallelogram
  label: "Emit combined\nrow (L, R)"
  style.fill: "#C8E6C9"
}

advance_inner: {
  shape: rectangle
  label: "Advance R\n(next row)"
  style.fill: "#FFE0B2"
}

advance_outer: {
  shape: rectangle
  label: "Advance L\n(next row)"
  style.fill: "#BBDEFB"
}

check_outer: {
  shape: diamond
  label: "More rows\nin Left?"
}

check_inner: {
  shape: diamond
  label: "More rows\nin Right?"
}

reset_inner: {
  shape: rectangle
  label: "Reset R\nto first row"
  style.fill: "#FFE0B2"
}

end: {
  shape: oval
  label: End
}

start -> left_table: "Input tables"
left_table -> outer_loop
right_table -> inner_loop
outer_loop -> inner_loop: "L = current row"
inner_loop -> evaluate: "R = current row"

evaluate -> emit: "Yes (match)"
evaluate -> advance_inner: "No (no match)"

emit -> advance_inner

advance_inner -> check_inner
check_inner -> inner_loop: "Yes"
check_inner -> reset_inner: "No"

reset_inner -> advance_outer
advance_outer -> check_outer
check_outer -> outer_loop: "Yes"
check_outer -> end: "No"

legend: {
  shape: rectangle
  label: "Legend:\n• n = rows in Left Table\n• m = rows in Right Table\n• Total comparisons: n × m"
  style.fill: "#FAFAFA"
  style.stroke: "#9E9E9E"
  near: bottom-right
}