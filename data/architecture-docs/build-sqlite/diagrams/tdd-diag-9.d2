direction: right

title: {
  label: "Bytecode Instruction Format\n(Instruction struct - 44 bytes)"
  shape: text
  near: top-center
}

memory_layout: {
  opcode: {
    label: "Opcode\n(string header)\n8 bytes"
    width: 120
    height: 60
    style: {
      fill: "#E3F2FD"
      stroke: "#1976D2"
    }
  }
  
  p1: {
    label: "P1\n(int32)\n4 bytes"
    width: 60
    height: 60
    style: {
      fill: "#FFF3E0"
      stroke: "#F57C00"
    }
  }
  
  p2: {
    label: "P2\n(int32)\n4 bytes"
    width: 60
    height: 60
    style: {
      fill: "#FFF3E0"
      stroke: "#F57C00"
    }
  }
  
  p3: {
    label: "P3\n(int32)\n4 bytes"
    width: 60
    height: 60
    style: {
      fill: "#FFF3E0"
      stroke: "#F57C00"
    }
  }
  
  p4: {
    label: "P4\n(interface{})\n16 bytes"
    width: 180
    height: 60
    style: {
      fill: "#E8F5E9"
      stroke: "#388E3C"
    }
  }
  
  comment: {
    label: "Comment\n(string ptr)\n8 bytes"
    width: 120
    height: 60
    style: {
      fill: "#F3E5F5"
      stroke: "#7B1FA2"
    }
  }
  
  opcode -> p1 -> p2 -> p3 -> p4 -> comment: {
    style.stroke-width: 0
  }
}

byte_offsets: {
  shape: sequence_diagram
  span: []
  
  offset_0: {
    label: "0x00"
    shape: text
  }
  
  offset_8: {
    label: "0x08"
    shape: text
  }
  
  offset_12: {
    label: "0x0C"
    shape: text
  }
  
  offset_16: {
    label: "0x10"
    shape: text
  }
  
  offset_20: {
    label: "0x14"
    shape: text
  }
  
  offset_36: {
    label: "0x24"
    shape: text
  }
}

legend: {
  label: "Field Legend:\n• Opcode: Operation type (string header: ptr + len)\n• P1-P3: Integer operands (register IDs, jump targets)\n• P4: Variable operand (context-dependent)\n• Comment: Human-readable description pointer"
  shape: rectangle
  style: {
    fill: "#FAFAFA"
    stroke: "#BDBDBD"
  }
  near: bottom-center
}

total_size: {
  label: "Total: 44 bytes per instruction"
  shape: text
  style: {
    font-size: 16
    bold: true
  }
  near: bottom-center
}