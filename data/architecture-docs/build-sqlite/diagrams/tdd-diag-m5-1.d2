direction: down
title: Slotted Page Layout (4096 bytes)
vars: {
  header-color: "#3B82F6"
  pointer-color: "#10B981"
  freespace-color: "#F3F4F6"
  cell-color: "#F59E0B"
  text-color: "#1F2937"
  dim-color: "#6B7280"
}
page_container: {
  shape: rectangle
  style.stroke: "#1F2937"
  style.stroke-width: 3
  width: 600
  height: 900
  # Offset labels on left
  offset_0: "Offset 0" {
    shape: text
    style.font-color: ${dim-color}
    style.font-size: 11
  }
  offset_8: "Offset 8-12" {
    shape: text
    style.font-color: ${dim-color}
    style.font-size: 11
  }
  offset_variable: "Varies" {
    shape: text
    style.font-color: ${dim-color}
    style.font-size: 11
  }
  offset_4096: "Offset 4095" {
    shape: text
    style.font-color: ${dim-color}
    style.font-size: 11
  }
  # Header section
  header: {
    shape: rectangle
    label: "Page Header\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nâ€¢ page_type (1 byte)\nâ€¢ first_freeblock (2 bytes)\nâ€¢ cell_count (2 bytes)\nâ€¢ cell_content_start (2 bytes)\nâ€¢ fragmented_bytes (1 byte)\n\nTotal: 8 bytes (leaf) or 12 bytes (interior)"
    width: 400
    height: 180
    style.fill: ${header-color}
    style.stroke: "#1E40AF"
    style.font-color: "#FFFFFF"
    style.font-size: 12
  }
  # Cell pointer array
  pointers: {
    shape: rectangle
    label: "Cell Pointer Array\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ ptr[0]: 2 bytes â”‚ â†’ offset to cell 0\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ ptr[1]: 2 bytes â”‚ â†’ offset to cell 1\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ ptr[2]: 2 bytes â”‚ â†’ offset to cell 2\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚      ...        â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nEach pointer: 2 bytes (uint16)"
    width: 400
    height: 220
    style.fill: ${pointer-color}
    style.stroke: "#047857"
    style.font-color: "#FFFFFF"
    style.font-size: 12
  }
  # Free space
  freespace: {
    shape: rectangle
    label: "FREE SPACE\n\n\n(Grows as cells are deleted,\n shrinks as cells/pointers added)\n\n\nâ† Grows toward middle â†’"
    width: 400
    height: 180
    style.fill: ${freespace-color}
    style.stroke: "#9CA3AF"
    style.font-color: ${text-color}
    style.font-size: 12
    style.stroke-dash: 5
  }
  # Cell content area
  cellcontent: {
    shape: rectangle
    label: "Cell Content Area\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Cell N (varlen)        â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Cell N-1 (varlen)      â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚      ...               â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Cell 0 (varlen)        â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nâ† Grows toward start"
    width: 400
    height: 200
    style.fill: ${cell-color}
    style.stroke: "#B45309"
    style.font-color: "#FFFFFF"
    style.font-size: 12
  }
  # Growth arrows on right side
  arrow_down: {
    shape: text
    label: "â†“ Pointers grow down"
    style.font-color: ${pointer-color}
    style.font-size: 11
    style.bold: true
  }
  arrow_up: {
    shape: text
    label: "â†‘ Content grows up"
    style.font-color: ${cell-color}
    style.font-size: 11
    style.bold: true
  }
  # Layout connections
  offset_0 -> header
  offset_8 -> pointers
  offset_variable -> freespace
  offset_4096 -> cellcontent
  header -> pointers
  pointers -> freespace
  freespace -> cellcontent
  pointers -> arrow_down
  cellcontent -> arrow_up
}
# Boundary marker
boundary_marker: {
  shape: rectangle
  label: "cell_content_start\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nPointer in header\nmarks this boundary"
  width: 160
  height: 80
  style.fill: "#EDE9FE"
  style.stroke: "#7C3AED"
  style.font-color: "#5B21B6"
  style.font-size: 11
}
# Legend
legend: {
  shape: rectangle
  label: "LEGEND\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nðŸŸ¦ Header: Fixed 8-12 bytes at start\nðŸŸ© Pointers: 2 bytes each, grows â†“\nâ¬œ Free space: Unallocated middle\nðŸŸ§ Content: Variable cells, grows â†‘\n\nTotal page size: 4096 bytes"
  width: 280
  height: 180
  style.fill: "#FAFAFA"
  style.stroke: "#D1D5DB"
  style.font-color: ${text-color}
  style.font-size: 12
}
# Cell format detail
cell_format: {
  shape: rectangle
  label: "Cell Format (Table B-Tree Leaf)\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Payload length (varint)    â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Row ID (varint)            â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Payload (serialized row):  â”‚\nâ”‚   â€¢ Header: type codes     â”‚\nâ”‚   â€¢ Body: column values    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
  width: 300
  height: 180
  style.fill: "#FEF3C7"
  style.stroke: ${cell-color}
  style.font-color: ${text-color}
  style.font-size: 11
}
page_container.boundary_marker -> page_container.freespace {
  style.stroke: "#7C3AED"
  style.stroke-dash: 3
  label: "marks"
  style.font-color: "#7C3AED"
}
page_container.legend -> page_container.cell_format