direction: right
shape: sequence_diagram
VDBE
Bytecode_Program
Index_BTree
Table_BTree
Result
VDBE.style.fill: "#E3F2FD"
Bytecode_Program.style.fill: "#FFF3E0"
Index_BTree.style.fill: "#E8F5E9"
Table_BTree.style.fill: "#FCE4EC"
Result.style.fill: "#F3E5F5"
VDBE -> Index_BTree: "OpenRead cursor=1\n(index=idx_email)" {
  style.stroke: "#1976D2"
}
VDBE -> Index_BTree: "SeekGE cursor=1\nkey='a'" {
  style.stroke: "#1976D2"
}
Index_BTree -> VDBE: "Positioned at\nfirst key >= 'a'" {
  style.stroke: "#4CAF50"
  style.stroke-dash: 3
}
loop1: {
  VDBE -> Index_BTree: "Column cursor=1 col=0\n→ r3 (key='apple')" {
    style.stroke: "#1976D2"
  }
  VDBE -> Bytecode_Program: "Gt r3('apple') r2('m')?\n→ FALSE (in range)" {
    style.stroke: "#FF9800"
  }
  VDBE -> Index_BTree: "Column cursor=1 col=1\n→ r4 (rowid=42)" {
    style.stroke: "#1976D2"
  }
  VDBE -> Table_BTree: "SeekRowid cursor=0\nrowid=42" {
    style.stroke: "#1976D2"
  }
  VDBE -> Table_BTree: "Column cursor=0\n→ r5, r6, r7" {
    style.stroke: "#1976D2"
  }
  VDBE -> Result: "ResultRow r5 3" {
    style.stroke: "#9C27B0"
  }
  VDBE -> Index_BTree: "Next cursor=1\n(follow right_sibling)" {
    style.stroke: "#1976D2"
  }
  Index_BTree -> VDBE: "Advanced to\nnext leaf entry" {
    style.stroke: "#4CAF50"
    style.stroke-dash: 3
  }
  VDBE -> Bytecode_Program: "Jump to RANGE_LOOP" {
    style.stroke: "#FF9800"
  }
}
loop2: {
  VDBE -> Index_BTree: "Column cursor=1 col=0\n→ r3 (key='banana')" {
    style.stroke: "#1976D2"
  }
  VDBE -> Bytecode_Program: "Gt r3('banana') r2('m')?\n→ FALSE (in range)" {
    style.stroke: "#FF9800"
  }
  VDBE -> Index_BTree: "Column cursor=1 col=1\n→ r4 (rowid=17)" {
    style.stroke: "#1976D2"
  }
  VDBE -> Table_BTree: "SeekRowid cursor=0\nrowid=17" {
    style.stroke: "#1976D2"
  }
  VDBE -> Result: "ResultRow..." {
    style.stroke: "#9C27B0"
  }
  VDBE -> Index_BTree: "Next cursor=1" {
    style.stroke: "#1976D2"
  }
}
loop3: {
  VDBE -> Index_BTree: "Column cursor=1 col=0\n→ r3 (key='zebra')" {
    style.stroke: "#1976D2"
  }
  VDBE -> Bytecode_Program: "Gt r3('zebra') r2('m')?\n→ TRUE (out of range!)" {
    style.stroke: "#F44336"
  }
  VDBE -> Bytecode_Program: "Jump to END" {
    style.stroke: "#F44336"
  }
  VDBE -> Bytecode_Program: "Halt" {
    style.stroke: "#607D8B"
  }
}
VDBE."|md\n**RANGE_LOOP:**\nIterate via right_sibling\nuntil bounds exceeded\n|"
VDBE."|md\n**Double Lookup:**\nIndex → rowid → Table\n(Non-covering index)\n|"