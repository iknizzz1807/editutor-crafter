direction: right
title: Join Order Impact | Query Planner Optimization
vars: {
  optimal_color: "#4CAF50"
  suboptimal_color: "#F44336"
  neutral_color: "#2196F3"
  highlight_color: "#FFC107"
}
# Input Query
query_input: {
  shape: rectangle
  label: "Query: SELECT * FROM orders o JOIN customers c ON o.customer_id = c.id"
  style.fill: "#E3F2FD"
  style.stroke: "#1976D2"
}
# Table Statistics
table_stats: {
  shape: rectangle
  label: "Table Statistics\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\ncustomers: 1,000 rows\norders: 100,000 rows\nSelectivity: 10%"
  style.fill: "#FFF3E0"
  style.stroke: "#F57C00"
}
# =====================
# OPTIMAL PATH (Small â‹ˆ Large)
# =====================
optimal_title: {
  label: "âœ“ OPTIMAL: Small â†’ Large"
  shape: text
  style.bold: true
  style.fill: ${optimal_color}
}
step_o1: {
  label: "Step 1: Scan customers\n(Small Table Outer)"
  shape: rectangle
  style.fill: ${optimal_color}
  style.bold: true
  width: 180
  stats_o1: {
    label: "ðŸ“Š 1,000 rows read\nðŸ“Š 1,000 I/O ops"
    shape: text
  }
}
step_o2: {
  label: "Step 2: For each customer\nfind matching orders\n(Index Lookup)"
  shape: rectangle
  style.fill: ${optimal_color}
  style.bold: true
  width: 180
  stats_o2: {
    label: "ðŸ“Š 100 matches/customer\nðŸ“Š 1,000 index probes"
    shape: text
  }
}
step_o3: {
  label: "Step 3: Build\nIntermediate Result"
  shape: rectangle
  style.fill: ${optimal_color}
  style.bold: true
  width: 180
  stats_o3: {
    label: "ðŸ“Š 100,000 result rows\nðŸ“Š ~10,000 I/O ops"
    shape: text
  }
}
optimal_total: {
  label: "TOTAL I/O\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n~11,000 operations"
  shape: rectangle
  style.fill: ${optimal_color}
  style.stroke: "#2E7D32"
  style.stroke-width: 4
  width: 160
}
# =====================
# SUBOPTIMAL PATH (Large â‹ˆ Small)
# =====================
suboptimal_title: {
  label: "âœ— SUBOPTIMAL: Large â†’ Small"
  shape: text
  style.bold: true
  style.fill: ${suboptimal_color}
}
step_s1: {
  label: "Step 1: Scan orders\n(Large Table Outer)"
  shape: rectangle
  style.fill: ${suboptimal_color}
  style.bold: true
  width: 180
  stats_s1: {
    label: "ðŸ“Š 100,000 rows read\nðŸ“Š 100,000 I/O ops"
    shape: text
  }
}
step_s2: {
  label: "Step 2: For each order\nfind matching customer\n(Index Lookup)"
  shape: rectangle
  style.fill: ${suboptimal_color}
  style.bold: true
  width: 180
  stats_s2: {
    label: "ðŸ“Š 1 match/order\nðŸ“Š 100,000 index probes"
    shape: text
  }
}
step_s3: {
  label: "Step 3: Build\nIntermediate Result"
  shape: rectangle
  style.fill: ${suboptimal_color}
  style.bold: true
  width: 180
  stats_s3: {
    label: "ðŸ“Š 100,000 result rows\nðŸ“Š ~100,000 I/O ops"
    shape: text
  }
}
suboptimal_total: {
  label: "TOTAL I/O\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n~200,000 operations"
  shape: rectangle
  style.fill: ${suboptimal_color}
  style.stroke: "#C62828"
  style.stroke-width: 4
  width: 160
}
# =====================
# COMPARISON SUMMARY
# =====================
comparison: {
  label: "Performance Impact\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nâš¡ Ratio: 18x slower!\n\nâŒ Wrong order: ~200K I/O\nâœ… Right order: ~11K I/O\n\nðŸ’¡ Heuristic:\nSmallest table first\nminimizes outer loop"
  shape: rectangle
  style.fill: ${highlight_color}
  style.stroke: "#FF8F00"
  style.stroke-width: 3
  width: 220
}
# =====================
# CONNECTIONS
# =====================
query_input -> table_stats
table_stats -> step_o1
table_stats -> step_s1
step_o1 -> step_o2 -> step_o3 -> optimal_total
step_s1 -> step_s2 -> step_s3 -> suboptimal_total
optimal_total -> comparison
suboptimal_total -> comparison
# Visual groupings
optimal_group: {
  label: ""
  style.fill: "#E8F5E9"
  style.stroke: ${optimal_color}
  style.stroke-dash: 4
}
suboptimal_group: {
  label: ""
  style.fill: "#FFEBEE"
  style.stroke: ${suboptimal_color}
  style.stroke-dash: 4
}
# Legend
legend: {
  label: "Join Order Heuristic\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nâ€¢ Place smallest table\n  as outer loop\nâ€¢ Reduces index probes\nâ€¢ Minimizes intermediate\n  result size\nâ€¢ Query planner uses\n  table statistics"
  shape: rectangle
  style.fill: "#F5F5F5"
  style.stroke: "#9E9E9E"
}