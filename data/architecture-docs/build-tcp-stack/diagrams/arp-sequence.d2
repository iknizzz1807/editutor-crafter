shape: sequence_diagram

title: ARP Request/Reply Sequence
description: A host sends an ARP broadcast request, the target host replies with a unicast, and the original host caches the mapping.

# Actors
host_a: Host A (Requester) {
  style: {
    fill: "#0f3460"
    stroke: "#3fb950"
    font-color: "#e6edf3"
    bold: true
  }
}
network: Network (Broadcast Domain) {
  style: {
    fill: "#1a1a2e"
    stroke: "#8b949e"
    font-color: "#e6edf3"
  }
}
host_b: Host B (Target) {
  style: {
    fill: "#0f3460"
    stroke: "#3fb950"
    font-color: "#e6edf3"
    bold: true
  }
}
arp_cache: ARP Cache (Host A) {
  style: {
    fill: "#16213e"
    stroke: "#8b949e"
    font-color: "#e6edf3"
  }
}

# Sequence
host_a -> network: ARP Request (Broadcast)
note: |md
  **"Who has IP_B? Tell MAC_A"**
  - Sender MAC: MAC_A
  - Sender IP: IP_A
  - Target IP: IP_B
  - Target MAC: 00:00:00:00:00:00 (Broadcast)
| {
  style: {
    fill: "#1a1a2e"
    stroke: "#8b949e"
    font-color: "#e6edf3"
  }
}

network -> host_b: ARP Request (Forwarded)
host_b -> network: ARP Reply (Unicast)
note: |md
  **"IP_B is at MAC_B"**
  - Sender MAC: MAC_B
  - Sender IP: IP_B
  - Target MAC: MAC_A
  - Target IP: IP_A
| {
  style: {
    fill: "#1a1a2e"
    stroke: "#8b949e"
    font-color: "#e6edf3"
  }
}

network -> host_a: ARP Reply (Delivered)
host_a -> arp_cache: Cache Entry
note: |md
  **ARP Table Update**
  IP_B -> MAC_B
  (with TTL)
| {
  style: {
    fill: "#1a1a2e"
    stroke: "#8b949e"
    font-color: "#e6edf3"
  }
}