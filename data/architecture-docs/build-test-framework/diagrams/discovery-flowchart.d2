title: Test Discovery Flowchart
desc: Flowchart for the Discoverer's algorithm. Start at a directory path. Steps: collect .py files, import module, inspect members, filter by naming convention ('test_'), recursively inspect classes, yield TestCase objects.

# Define styles
classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: false
  }
  decision: {
    shape: diamond
    style.fill: "#1a1a2e"
    style.stroke: "#ff7b72"
    style.font-color: "#e6edf3"
    style.bold: false
  }
  start_end: {
    shape: oval
    style.fill: "#1a1a2e"
    style.stroke: "#79c0ff"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  output: {
    style.fill: "#1a1a2e"
    style.stroke: "#d2a8ff"
    style.font-color: "#e6edf3"
    style.bold: false
  }
  container: {
    style.fill: "#0d1117"
    style.stroke: "#30363d"
    style.stroke-width: 2
    style.double-border: false
  }
}

# Main flow
start: "Start: Directory Path" {
  class: start_end
}

collect_files: "Collect all .py files" {
  class: process
}

import_module: "Import module" {
  class: process
}

inspect_members: "Inspect module members" {
  class: process
}

is_callable: "Is callable?" {
  class: decision
}

starts_with_test: "Name starts with 'test_'?" {
  class: decision
}

inspect_classes: "Recursively inspect classes" {
  class: process
}

yield_testcase: "Yield TestCase object" {
  class: output
}

end: "End of discovery" {
  class: start_end
}

# Connections
start -> collect_files
collect_files -> import_module
import_module -> inspect_members
inspect_members -> is_callable

is_callable.no -> inspect_classes
is_callable.yes -> starts_with_test

starts_with_test.no -> inspect_classes
starts_with_test.yes -> yield_testcase

inspect_classes -> yield_testcase

# Loop connections
yield_testcase -> inspect_members: Next member {style.stroke-dash: 3}

# Containers for organization
discovery_flow: {
  style: {
    fill: "#0d1117"
    stroke: "#30363d"
    stroke-width: 2
  }
  label: "Test Discovery Algorithm Flow"
  
  # Add nodes to container
  collect_files
  import_module
  inspect_members
  is_callable
  starts_with_test
  inspect_classes
  yield_testcase
}

# Add notes
note1: |md
  **Algorithm Steps:**
  1. Start with directory path
  2. Find all .py files
  3. Import each module
  4. Inspect all members
  5. Filter by naming convention
  6. Recursively handle classes
  7. Yield TestCase objects
| {
  shape: page
  style.fill: "#1a1a2e"
  style.stroke: "#79c0ff"
  style.font-color: "#e6edf3"
  near: top-right
}