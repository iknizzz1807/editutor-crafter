title: Search Mode State Machine

# States
normal: Normal Mode {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

incremental: Incremental Search {
  shape: circle
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

forward: Search Forward {
  shape: circle
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

backward: Search Backward {
  shape: circle
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

# Initial state indicator
start: {
  shape: circle
  style.fill: "#3fb950"
  width: 20
  height: 20
}

# Transitions
start -> normal

normal -> incremental: / or ? key {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

incremental -> forward: Enter or n key {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

incremental -> backward: N key {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

incremental -> normal: Escape key {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

forward -> forward: n key (next match) {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

forward -> backward: N key {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

backward -> backward: N key (prev match) {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

backward -> forward: n key {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

forward -> normal: Escape or other keys {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

backward -> normal: Escape or other keys {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

incremental -> incremental: Type characters {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

# Notes
note: |md
  **Key Events:**
  - / or ?: Enter incremental search
  - Characters: Build search query
  - Enter/n: Search forward
  - N: Search backward  
  - Escape: Return to normal mode
| {
  shape: page
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}