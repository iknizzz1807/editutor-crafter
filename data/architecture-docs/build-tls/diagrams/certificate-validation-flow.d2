start: Start {
  shape: circle
  style.fill: "#3fb950"
}

receive_certs: Receive Certificate Chain {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

parse_x509: Parse X.509 Certificates {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

parse_valid: Valid ASN.1? {
  shape: diamond
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

build_chain: Build Certificate Chain {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

find_root: Find Trusted Root? {
  shape: diamond
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

verify_signatures: Verify Signatures {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

sig_valid: Signatures Valid? {
  shape: diamond
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

check_validity: Check Validity Period {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

check_constraints: Check Certificate Constraints {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

constraints_valid: Constraints Valid? {
  shape: diamond
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

verify_hostname: Verify Hostname Match {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

hostname_valid: Hostname Matches? {
  shape: diamond
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

success: Verification Success {
  shape: circle
  style.fill: "#3fb950"
  style.font-color: "#1a1a2e"
  style.bold: true
}

failure: Verification Failed {
  shape: circle
  style.fill: "#d63031"
  style.font-color: "#ffffff"
}

start -> receive_certs
receive_certs -> parse_x509
parse_x509 -> parse_valid
parse_valid -> build_chain: Yes
parse_valid -> failure: No
build_chain -> find_root
find_root -> verify_signatures: Yes
find_root -> failure: No
verify_signatures -> sig_valid
sig_valid -> check_validity: Yes
sig_valid -> failure: No
check_validity -> check_constraints
check_constraints -> constraints_valid
constraints_valid -> verify_hostname: Yes
constraints_valid -> failure: No
verify_hostname -> hostname_valid
hostname_valid -> success: Yes
hostname_valid -> failure: No