direction: right

title: Data Model Relationships {
  style.font-size: 24
  style.font-color: "#e6edf3"
}

VPNSession: VPN Session {
  shape: class
  sessionId: String
  localPeer: Peer
  remotePeer: Peer
  encryptionKey: "byte[]"
  status: SessionStatus
  lastActivity: Timestamp
  createdAt: Timestamp
  
  "encrypt(data)": EncryptedPacket
  "decrypt(packet)": "byte[]"
  "isExpired()": boolean
  "refresh()": void
  
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

Peer: Peer {
  shape: class
  peerId: String
  ipAddress: String
  port: int
  publicKey: "byte[]"
  isAuthenticated: boolean
  lastSeen: Timestamp
  
  "authenticate()": boolean
  "generateKeyPair()": void
  "getEndpoint()": String
  
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

EncryptedPacket: Encrypted Packet {
  shape: class
  header: PacketHeader
  encryptedPayload: "byte[]"
  authTag: "byte[]"
  sequenceNumber: long
  timestamp: long
  
  "serialize()": "byte[]"
  "deserialize(data)": void
  "verify()": boolean
  
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

HandshakeMessage: Handshake Message {
  shape: class
  messageType: HandshakeType
  senderPeerId: String
  recipientPeerId: String
  publicKey: "byte[]"
  signature: "byte[]"
  nonce: "byte[]"
  timestamp: long
  
  "sign(privateKey)": void
  "verify(publicKey)": boolean
  "toBytes()": "byte[]"
  
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

RouteEntry: Route Entry {
  shape: class
  destination: String
  gateway: String
  netmask: String
  interface: String
  metric: int
  isActive: boolean
  
  "matches(ip)": boolean
  "activate()": void
  "deactivate()": void
  
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

PacketHeader: Packet Header {
  shape: class
  version: int
  packetType: PacketType
  sourceId: String
  destinationId: String
  length: int
  checksum: int
  
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

VPNSession -> Peer: localPeer {
  style.stroke: "#3fb950"
}
VPNSession -> Peer: remotePeer {
  style.stroke: "#3fb950"
}

VPNSession -> EncryptedPacket: creates {
  style.stroke: "#8b949e"
  style.stroke-dash: 5
}

Peer -> HandshakeMessage: generates {
  style.stroke: "#8b949e"
  style.stroke-dash: 5
}

EncryptedPacket -> PacketHeader: contains {
  style.stroke: "#3fb950"
}

VPNSession -> RouteEntry: manages routes {
  style.stroke: "#8b949e"
  style.stroke-dash: 5
}

HandshakeMessage <-> VPNSession: establishes {
  style.stroke: "#3fb950"
}