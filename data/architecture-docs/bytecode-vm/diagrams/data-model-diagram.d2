# Data Model / Type Relationship Diagram

title: Data Model / Type Relationship Diagram
direction: down

classes: {
  data_class: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  field_style: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#c9d1d9"
  }
}

vm: VM {
  shape: class
  class: data_class
  "stack: Value[]"
  "stack_top: Value*"
  "frames: CallFrame[]"
  "frame_count: int"
  "frame_capacity: int"
  "chunk: Chunk*"
}

chunk: Chunk {
  shape: class
  class: data_class
  "code: uint8_t[]"
  "constants: Value[]"
  "count: int"
  "capacity: int"
}

callframe: CallFrame {
  shape: class
  class: data_class
  "function: ObjFunction*"
  "ip: uint8_t*"
  "slots: Value*"
}

value: Value {
  shape: class
  class: data_class
  "type: ValueType"
  "as: union { double number; bool boolean; }"
}

valuetype: ValueType {
  shape: class
  class: field_style
  "VAL_NUMBER"
  "VAL_BOOL"
  "VAL_NIL"
}

vm -> chunk: "chunk"
vm -> callframe: "frames[]"
vm -> value: "stack[]"
callframe -> chunk: "function->chunk"
chunk -> value: "constants[]"
value -> valuetype: "type"