# VM Runtime State Machine

title: VM Runtime State Machine

direction: right

classes: {
  state: {
    shape: circle
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    width: 140
    height: 140
  }
  init_state: {
    shape: circle
    style.fill: "#3fb950"
    style.stroke: "#3fb950"
    label: ""
    width: 30
    height: 30
  }
  final_state: {
    shape: circle
    style.double-border: true
    style.fill: "#1a1a2e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
    width: 140
    height: 140
  }
  error_state: {
    shape: circle
    style.fill: "#1a1a2e"
    style.stroke: "#ff7b72"
    style.font-color: "#ff7b72"
    style.bold: true
    width: 140
    height: 140
  }
  transition: {
    style.font-color: "#8b949e"
    style.font-size: 14
  }
}

init: {
  class: init_state
}

READY: VM is loaded and ready to execute {
  class: state
}

RUNNING: Executing bytecode instructions {
  class: state
}

HALTED: Execution completed successfully {
  class: final_state
}

ERROR: Runtime error occurred {
  class: error_state
}

init -> READY
READY -> RUNNING: start
RUNNING -> RUNNING: fetch/execute\n(instruction cycle)
RUNNING -> HALTED: halt instruction
RUNNING -> ERROR: runtime error