# State Machine: Load Balancer Routing
State Machine: Load Balancer Routing {
  shape: rectangle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.border-radius: 0

  init: Initial State {
    shape: circle
    style.fill: "#3fb950"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    label: ""
  }

  BLUE_ACTIVE: BLUE Environment Active {
    shape: circle
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    style.stroke-width: 2
  }

  GREEN_ACTIVE: GREEN Environment Active {
    shape: circle
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    style.stroke-width: 2
  }

  init -> BLUE_ACTIVE: "Initial State"

  BLUE_ACTIVE -> GREEN_ACTIVE: "SWITCH_TO_GREEN\n(if healthy)"
  BLUE_ACTIVE -> GREEN_ACTIVE: "ROLLBACK" {
    style.stroke-dash: 3
    style.stroke: "#f85149"
  }

  GREEN_ACTIVE -> BLUE_ACTIVE: "SWITCH_TO_BLUE\n(if healthy)"
  GREEN_ACTIVE -> BLUE_ACTIVE: "ROLLBACK" {
    style.stroke-dash: 3
    style.stroke: "#f85149"
  }
}