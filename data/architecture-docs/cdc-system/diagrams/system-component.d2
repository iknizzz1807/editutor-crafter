title: High-Level System Component Diagram

# External Systems
source_db: Source Database {
  shape: cylinder
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

message_broker: Message Broker {
  shape: queue
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

consumers: Consumers {
  shape: rectangle
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

# CDC System Container
cdc_system: CDC System {
  shape: rectangle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.double-border: true
  style.font-color: "#e6edf3"

  # Main Components
  log_connector: Log Connector/Parser {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }

  change_event_builder: Change Event Builder {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }

  event_streamer: Event Streamer {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }

  schema_registry: Schema Registry {
    shape: cylinder
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }

  # Internal connections
  log_connector -> change_event_builder: "RawLogEntry" {
    style.stroke: "#8b949e"
    style.animated: true
  }

  change_event_builder -> event_streamer: "ChangeEvent" {
    style.stroke: "#8b949e"
    style.animated: true
  }

  # Schema Registry interactions
  change_event_builder <-> schema_registry: "Schema Lookup" {
    style.stroke: "#8b949e"
    style.stroke-dash: 3
  }

  event_streamer <-> schema_registry: "Schema Validation" {
    style.stroke: "#8b949e"
    style.stroke-dash: 3
  }
}

# External connections
source_db -> cdc_system.log_connector: "Transaction Logs" {
  style.stroke: "#3fb950"
  style.animated: true
}

cdc_system.event_streamer -> message_broker: "ChangeEvent Stream" {
  style.stroke: "#3fb950"
  style.animated: true
}

message_broker -> consumers: "ChangeEvent Messages" {
  style.stroke: "#3fb950"
  style.animated: true
}

# Data flow note
note: |md
  **Core Data Flow:**
  1. RawLogEntry (from transaction logs)
  2. ChangeEvent (structured change data)
| {
  shape: page
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  near: top-center
}