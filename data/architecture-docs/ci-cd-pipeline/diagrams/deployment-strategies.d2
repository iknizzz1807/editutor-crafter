title: Deployment Strategy Comparison {
  style.font-size: 24
  style.bold: true
  near: top-center
}

classes: {
  strategy_container: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  process_step: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  decision: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  rollback: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
  success: {
    style.fill: "#00b894"
    style.stroke: "#00cec9"
    style.font-color: "#ffffff"
    style.bold: true
  }
}

rolling: Rolling Deployment {
  class: strategy_container
  
  r_start: Start Deployment {
    class: process_step
  }
  r_select: Select Next Instance {
    class: process_step
  }
  r_stop: Stop Instance {
    class: process_step
  }
  r_update: Update Code {
    class: process_step
  }
  r_start_instance: Start Instance {
    class: process_step
  }
  r_health: Health Check Pass? {
    shape: diamond
    class: decision
  }
  r_more: More Instances? {
    shape: diamond
    class: decision
  }
  r_rollback: Rollback Instance {
    class: rollback
  }
  r_complete: Deployment Complete {
    class: success
  }
  
  r_start -> r_select
  r_select -> r_stop
  r_stop -> r_update
  r_update -> r_start_instance
  r_start_instance -> r_health
  r_health -> r_more: Yes
  r_health -> r_rollback: No
  r_more -> r_select: Yes
  r_more -> r_complete: No
  r_rollback -> r_rollback: Stop All Updates
}

bluegreen: Blue-Green Deployment {
  class: strategy_container
  
  bg_start: Start Deployment {
    class: process_step
  }
  bg_prepare: Prepare Green Environment {
    class: process_step
  }
  bg_deploy: Deploy to Green {
    class: process_step
  }
  bg_test: Run Smoke Tests {
    class: process_step
  }
  bg_test_pass: Tests Pass? {
    shape: diamond
    class: decision
  }
  bg_switch: Switch Traffic to Green {
    class: process_step
  }
  bg_monitor: Monitor Metrics {
    class: process_step
  }
  bg_stable: System Stable? {
    shape: diamond
    class: decision
  }
  bg_cleanup: Cleanup Blue Environment {
    class: process_step
  }
  bg_rollback: Switch Back to Blue {
    class: rollback
  }
  bg_complete: Deployment Complete {
    class: success
  }
  
  bg_start -> bg_prepare
  bg_prepare -> bg_deploy
  bg_deploy -> bg_test
  bg_test -> bg_test_pass
  bg_test_pass -> bg_switch: Yes
  bg_test_pass -> bg_rollback: No
  bg_switch -> bg_monitor
  bg_monitor -> bg_stable
  bg_stable -> bg_cleanup: Yes
  bg_stable -> bg_rollback: No
  bg_cleanup -> bg_complete
}

canary: Canary Deployment {
  class: strategy_container
  
  c_start: Start Deployment {
    class: process_step
  }
  c_deploy: Deploy to Canary Subset {
    class: process_step
  }
  c_route: Route Small Traffic % {
    class: process_step
  }
  c_monitor: Monitor Metrics {
    class: process_step
  }
  c_healthy: Metrics Healthy? {
    shape: diamond
    class: decision
  }
  c_increase: Increase Traffic % {
    class: process_step
  }
  c_full: Full Traffic? {
    shape: diamond
    class: decision
  }
  c_promote: Promote to All Instances {
    class: process_step
  }
  c_rollback: Rollback Canary {
    class: rollback
  }
  c_complete: Deployment Complete {
    class: success
  }
  
  c_start -> c_deploy
  c_deploy -> c_route
  c_route -> c_monitor
  c_monitor -> c_healthy
  c_healthy -> c_increase: Yes
  c_healthy -> c_rollback: No
  c_increase -> c_full
  c_full -> c_monitor: No
  c_full -> c_promote: Yes
  c_promote -> c_complete
}

legend: Strategy Characteristics {
  class: strategy_container
  
  legend_text: |md
    **Rolling:** Low risk, gradual updates, maintains capacity
    **Blue-Green:** Zero downtime, instant rollback, requires 2x resources
    **Canary:** Risk validation, traffic-based testing, gradual exposure
  | {
    shape: page
    style.fill: "#0f3460"
    style.font-color: "#e6edf3"
  }
}