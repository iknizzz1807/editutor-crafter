title: Conflict Resolution Process {
  near: top-center
  style.font-size: 18
  style.bold: true
  style.font-color: "#e6edf3"
}

classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  decision: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  transform: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  error: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
  }
  success: {
    style.fill: "#00b894"
    style.stroke: "#00cec9"
    style.font-color: "#ffffff"
  }
}

start: Start {
  shape: circle
  class: success
  style.fill: "#3fb950"
  label: ""
}

detect: Detect Concurrent\nOperations {
  class: process
}

check_overlap: Operations Overlap\nSame Position? {
  shape: diamond
  class: decision
}

get_server_order: Get Server-Side\nOperation Order {
  class: process
}

transform_ops: Apply Transformation\nFunctions {
  class: transform
}

validate: Validate\nTransformation {
  shape: diamond
  class: decision
}

apply_first: Apply First\nOperation {
  class: process
}

apply_transformed: Apply Transformed\nSecond Operation {
  class: process
}

broadcast: Broadcast Final\nState to Clients {
  class: process
}

conflict_error: Transformation\nFailed {
  class: error
}

rollback: Rollback to\nLast Known State {
  class: error
}

convergence: Document\nConvergence Achieved {
  shape: circle
  class: success
  style.double-border: true
}

start -> detect
detect -> check_overlap
check_overlap -> get_server_order: Yes
check_overlap -> apply_first: No
get_server_order -> transform_ops
transform_ops -> validate
validate -> apply_first: Valid
validate -> conflict_error: Invalid
conflict_error -> rollback
rollback -> detect
apply_first -> apply_transformed
apply_transformed -> broadcast
broadcast -> convergence

note: |md
  **Key Principles:**
  - Server establishes operation order
  - Transform functions preserve user intent
  - All clients converge to same state
| {
  shape: page
  near: bottom-left
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}