title: Data Model Relationships {
  style.font-size: 24
  style.font-color: "#e6edf3"
  near: top-center
}

classes: {
  core_type: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  process_arrow: {
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  container_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

pipeline: Data Transformation Pipeline {
  class: container_style

  file_content: FileContent {
    shape: class
    class: core_type
    - "lines: Line[]"
    - "filename: string"
    - "encoding: string"
    + "get_line_count(): int"
    + "get_content(): Line[]"
  }

  line: Line {
    shape: class
    class: core_type
    - "content: string"
    - "number: int"
    - "hash: int"
    + "equals(other: Line): bool"
    + "get_hash(): int"
  }

  diff_op: DiffOperation {
    shape: class
    class: core_type
    - "operation_type: OpType"
    - "line_ref: Line"
    - "old_line_num: int"
    - "new_line_num: int"
    + "is_insert(): bool"
    + "is_delete(): bool"
    + "is_equal(): bool"
  }

  hunk: Hunk {
    shape: class
    class: core_type
    - "operations: DiffOperation[]"
    - "old_start: int"
    - "new_start: int"
    - "context_size: int"
    + "get_header(): string"
    + "add_context(lines: Line[]): void"
  }

  file_content -> line: contains {
    class: process_arrow
  }

  line -> diff_op: "referenced by" {
    class: process_arrow
  }

  diff_op -> hunk: "grouped into" {
    class: process_arrow
  }
}

algorithms: Algorithmic Processing {
  class: container_style

  lcs: LCS Algorithm {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }

  myers: Myers Diff {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

output: Output Formatting {
  class: container_style

  unified_format: Unified Diff {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }

  context_format: Context Diff {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

pipeline.file_content -> algorithms.lcs: "input files" {
  class: process_arrow
}

algorithms.lcs -> algorithms.myers: "common subsequence" {
  class: process_arrow
}

algorithms.myers -> pipeline.diff_op: generates {
  class: process_arrow
}

pipeline.hunk -> output.unified_format: formats {
  class: process_arrow
}

pipeline.hunk -> output.context_format: formats {
  class: process_arrow
}

data_flow: |md
  **Data Flow:**
  Raw Files → FileContent → Line[] → DiffOperation[] → Hunk[] → Formatted Output
| {
  shape: page
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  near: bottom-center
}