direction: right

# Initial state
init: {
  shape: circle
  style.fill: "#3fb950"
  style.stroke: "#3fb950"
  label: ""
}

# Cart states
empty: Empty Cart {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

active: Active Cart {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

abandoned: Abandoned Cart {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

converted: Converted {
  shape: circle
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.double-border: true
}

# State transitions
init -> empty: Create Cart

empty -> active: Add First Item {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

active -> active: Add Item\nUpdate Quantity\nRemove Item {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

active -> empty: Remove All Items {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

active -> abandoned: Timeout\n(No activity) {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

active -> converted: Complete Checkout {
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

abandoned -> active: Return & Modify Cart {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

abandoned -> converted: Complete Checkout {
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  style.bold: true
}

abandoned -> empty: Clear Cart {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

# Legend
legend: Cart State Transitions {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  note: |md
    **States:**
    - Empty: No items in cart
    - Active: Contains items, user engaged
    - Abandoned: Inactive for timeout period
    - Converted: Successful checkout completed
    
    **Key Actions:**
    - Add/Remove items trigger state changes
    - Timeout moves active â†’ abandoned
    - Checkout completion creates conversion
  | {
    shape: page
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

legend.near: bottom-right