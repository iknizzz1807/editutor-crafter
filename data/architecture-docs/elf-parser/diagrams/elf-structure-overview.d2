title: ELF File Structure Overview

classes: {
  header: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  section: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  table: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  string_table: {
    style.fill: "#2d3748"
    style.stroke: "#f6ad55"
    style.font-color: "#e6edf3"
  }
}

elf_file: ELF File {
  elf_header: ELF Header {
    class: header
    shape: class
    - "e_ident: [16]byte"
    - "e_type: uint16"
    - "e_machine: uint16"
    - "e_shoff: uint64"
    - "e_phoff: uint64"
    - "e_shnum: uint16"
    - "e_phnum: uint16"
    - "e_shstrndx: uint16"
  }

  headers: Headers & Tables {
    section_headers: Section Headers {
      class: section
      shape: class
      - "sh_name: uint32"
      - "sh_type: uint32"
      - "sh_offset: uint64"
      - "sh_size: uint64"
      - "sh_link: uint32"
      - "sh_info: uint32"
    }

    program_headers: Program Headers {
      class: section
      shape: class
      - "p_type: uint32"
      - "p_offset: uint64"
      - "p_vaddr: uint64"
      - "p_filesz: uint64"
      - "p_memsz: uint64"
      - "p_flags: uint32"
    }
  }

  sections: Data Sections {
    symbol_table: Symbol Table {
      class: table
      shape: class
      - "st_name: uint32"
      - "st_value: uint64"
      - "st_size: uint64"
      - "st_info: uint8"
      - "st_shndx: uint16"
    }

    string_table: String Table {
      class: string_table
      shape: class
      - "strings: byte array"
      - "null_terminated: bool"
    }

    dynamic_table: Dynamic Table {
      class: table
      shape: class
      - "d_tag: int64"
      - "d_val: uint64"
    }

    relocation_table: Relocation Table {
      class: table
      shape: class
      - "r_offset: uint64"
      - "r_info: uint64"
      - "r_addend: int64"
    }
  }
}

elf_file.elf_header -> elf_file.headers.section_headers: "sh_offset, sh_num" {
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

elf_file.elf_header -> elf_file.headers.program_headers: "ph_offset, ph_num" {
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

elf_file.headers.section_headers -> elf_file.sections.symbol_table: references {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

elf_file.headers.section_headers -> elf_file.sections.string_table: references {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

elf_file.headers.section_headers -> elf_file.sections.dynamic_table: references {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

elf_file.headers.section_headers -> elf_file.sections.relocation_table: references {
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

elf_file.sections.symbol_table -> elf_file.sections.string_table: "st_name indices" {
  style.stroke: "#f6ad55"
  style.font-color: "#e6edf3"
  style.stroke-dash: 3
}

elf_file.elf_header -> elf_file.sections.string_table: e_shstrndx {
  style.stroke: "#f6ad55"
  style.font-color: "#e6edf3"
  style.stroke-dash: 3
}

note: |md
  ## Key Relationships
  - **ELF Header** acts as master index
  - **Section Headers** describe logical organization
  - **Program Headers** describe memory segments
  - **String Tables** provide shared dictionaries
  - Dotted lines show string table references
| {
  shape: page
  class: string_table
  near: bottom-right
}