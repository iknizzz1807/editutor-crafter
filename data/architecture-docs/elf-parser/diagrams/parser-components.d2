title: Parser Component Architecture

classes: {
  low_level_parser: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  high_level_parser: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  analyzer: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  data_flow: {
    style.stroke: "#8b949e"
    style.stroke-width: 2
  }
}

low_level: Low-Level Parsers {
  class: low_level_parser
  
  binary_reader: Binary Reader {
    class: low_level_parser
  }
  
  endian_handler: Endianness Handler {
    class: low_level_parser
  }
  
  field_parser: Field Parser {
    class: low_level_parser
  }
}

mid_level: Core Parsers {
  class: high_level_parser
  
  header_parser: ELF Header Parser {
    class: high_level_parser
  }
  
  section_parser: Section Parser {
    class: high_level_parser
  }
  
  segment_parser: Segment Parser {
    class: high_level_parser
  }
  
  symbol_parser: Symbol Parser {
    class: high_level_parser
  }
  
  string_parser: String Table Parser {
    class: high_level_parser
  }
}

high_level: Analysis Components {
  class: analyzer
  
  structure_analyzer: Structure Analyzer {
    class: analyzer
  }
  
  dependency_resolver: Dependency Resolver {
    class: analyzer
  }
  
  format_validator: Format Validator {
    class: analyzer
  }
}

elf_file: ELF Binary File {
  shape: cylinder
  style.fill: "#2d3748"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

output: Parsed Data {
  shape: page
  style.fill: "#2d3748"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

# Data flow from file to low-level parsers
elf_file -> binary_reader: raw bytes {
  class: data_flow
}

# Low-level parser dependencies
binary_reader -> endian_handler: byte data {
  class: data_flow
}
endian_handler -> field_parser: ordered bytes {
  class: data_flow
}

# Flow to core parsers
field_parser -> header_parser: parsed fields {
  class: data_flow
}
field_parser -> section_parser: field data {
  class: data_flow
}
field_parser -> segment_parser: field data {
  class: data_flow
}

# Core parser interactions
header_parser -> section_parser: section table info {
  class: data_flow
}
section_parser -> symbol_parser: symbol section data {
  class: data_flow
}
section_parser -> string_parser: string section data {
  class: data_flow
}
string_parser -> symbol_parser: resolved names {
  class: data_flow
}

# Flow to analysis components
header_parser -> structure_analyzer: header info {
  class: data_flow
}
section_parser -> structure_analyzer: section layout {
  class: data_flow
}
symbol_parser -> dependency_resolver: symbol data {
  class: data_flow
}

# Cross-analysis dependencies
structure_analyzer -> format_validator: structure info {
  class: data_flow
}
dependency_resolver -> format_validator: dependency graph {
  class: data_flow
}

# Final output
structure_analyzer -> output: analysis results {
  class: data_flow
}
dependency_resolver -> output: dependency info {
  class: data_flow
}
format_validator -> output: validation report {
  class: data_flow
}