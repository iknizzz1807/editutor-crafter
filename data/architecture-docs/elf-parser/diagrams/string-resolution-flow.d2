direction: down

classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  decision: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  table: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  error: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
  }
}

start: Start Lookup {
  shape: circle
  class: process
}

lookup_type: Lookup Type? {
  shape: diamond
  class: decision
}

section_lookup: Section Name {
  class: process
}

symbol_lookup: Symbol Name {
  class: process
}

library_lookup: Library Name {
  class: process
}

section_check: Has .shstrtab? {
  shape: diamond
  class: decision
}

symbol_check: Has .strtab? {
  shape: diamond
  class: decision
}

dynamic_check: Has .dynstr? {
  shape: diamond
  class: decision
}

section_strtab: Section Header\nString Table\n(.shstrtab) {
  class: table
}

symbol_strtab: String Table\n(.strtab) {
  class: table
}

dynamic_strtab: Dynamic String\nTable (.dynstr) {
  class: table
}

extract_offset: Extract String\nOffset from Entry {
  class: process
}

bounds_check: Offset Within\nTable Bounds? {
  shape: diamond
  class: decision
}

read_string: Read Null-Terminated\nString from Offset {
  class: process
}

return_string: Return String {
  shape: circle
  class: process
}

error_missing: Error: Missing\nString Table {
  class: error
}

error_bounds: Error: Offset\nOut of Bounds {
  class: error
}

start -> lookup_type

lookup_type -> section_lookup: Section Name
lookup_type -> symbol_lookup: Symbol Name  
lookup_type -> library_lookup: Library Name

section_lookup -> section_check
symbol_lookup -> symbol_check
library_lookup -> dynamic_check

section_check -> section_strtab: Yes
section_check -> error_missing: No

symbol_check -> symbol_strtab: Yes
symbol_check -> error_missing: No

dynamic_check -> dynamic_strtab: Yes
dynamic_check -> error_missing: No

section_strtab -> extract_offset
symbol_strtab -> extract_offset
dynamic_strtab -> extract_offset

extract_offset -> bounds_check

bounds_check -> read_string: Yes
bounds_check -> error_bounds: No

read_string -> return_string