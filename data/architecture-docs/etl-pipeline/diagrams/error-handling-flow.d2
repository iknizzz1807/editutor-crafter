title: Error Handling and Recovery Flow

classes: {
  error_node: {
    style.fill: "#d63031"
    style.font-color: "#ffffff"
    style.stroke: "#e17055"
    style.bold: true
  }
  decision: {
    style.fill: "#0984e3"
    style.font-color: "#ffffff"
    style.stroke: "#74b9ff"
    style.bold: true
  }
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  recovery: {
    style.fill: "#00b894"
    style.font-color: "#ffffff"
    style.stroke: "#55a3ff"
    style.bold: true
  }
  escalation: {
    style.fill: "#fdcb6e"
    style.font-color: "#2d3436"
    style.stroke: "#e84393"
    style.bold: true
  }
}

error_detected: Error Detected {
  shape: circle
  class: error_node
}

classify_error: Classify Error Type {
  shape: diamond
  class: decision
}

transient_check: Transient Error? {
  shape: diamond
  class: decision
}

retry_count_check: Retry Count < Max? {
  shape: diamond
  class: decision
}

exponential_backoff: Apply Exponential Backoff {
  class: process
}

retry_operation: Retry Operation {
  class: recovery
}

data_corruption_check: Data Corruption? {
  shape: diamond
  class: decision
}

rollback_data: Rollback Data Changes {
  class: recovery
}

resource_check: Resource Exhaustion? {
  shape: diamond
  class: decision
}

scale_resources: Auto-Scale Resources {
  class: recovery
}

alert_ops: Alert Operations Team {
  class: escalation
}

circuit_breaker: Activate Circuit Breaker {
  class: recovery
}

dead_letter_queue: Send to Dead Letter Queue {
  class: process
}

log_error: Log Error Details {
  class: process
}

success: Operation Successful {
  shape: circle
  class: recovery
}

failed_permanently: Permanent Failure {
  shape: circle
  class: error_node
}

error_detected -> classify_error

classify_error -> transient_check: Network/Timeout
classify_error -> data_corruption_check: Validation Failed
classify_error -> resource_check: System Error

transient_check -> retry_count_check: Yes
transient_check -> alert_ops: No

retry_count_check -> exponential_backoff: Yes
retry_count_check -> dead_letter_queue: No

exponential_backoff -> retry_operation
retry_operation -> success: Success
retry_operation -> classify_error: Failed

data_corruption_check -> rollback_data: Yes
data_corruption_check -> alert_ops: No

rollback_data -> alert_ops

resource_check -> scale_resources: Yes
resource_check -> circuit_breaker: No

scale_resources -> retry_operation
circuit_breaker -> alert_ops

alert_ops -> log_error
dead_letter_queue -> log_error

log_error -> failed_permanently