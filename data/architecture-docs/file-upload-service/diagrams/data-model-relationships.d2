UploadSession: Upload Session {
  shape: class
  - "id: string"
  - "file_name: string"
  - "file_size: number"
  - "chunk_size: number"
  - "total_chunks: number"
  - "uploaded_chunks: number"
  - "status: SessionStatus"
  - "created_at: timestamp"
  - "updated_at: timestamp"
  - "expires_at: timestamp"
  - "upload_url: string"
  - "metadata: Map<string, string>"
  + "is_complete(): boolean"
  + "get_progress(): number"
  + "mark_chunk_uploaded(chunk_id: string): void"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

ChunkMetadata: Chunk Metadata {
  shape: class
  - "id: string"
  - "session_id: string"
  - "chunk_number: number"
  - "byte_offset: number"
  - "size: number"
  - "checksum: string"
  - "status: ChunkStatus"
  - "uploaded_at: timestamp"
  - "retry_count: number"
  - "storage_path: string"
  + "validate_checksum(data: bytes): boolean"
  + "mark_uploaded(): void"
  + "increment_retry(): void"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

FileInfo: File Info {
  shape: class
  - "id: string"
  - "session_id: string"
  - "original_name: string"
  - "content_type: string"
  - "file_size: number"
  - "final_path: string"
  - "checksum: string"
  - "created_at: timestamp"
  - "metadata: Map<string, string>"
  + "get_extension(): string"
  + "validate_integrity(): boolean"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

ScanResult: Scan Result {
  shape: class
  - "id: string"
  - "file_id: string"
  - "scanner_name: string"
  - "scan_status: ScanStatus"
  - "threat_detected: boolean"
  - "threat_name: string"
  - "scan_details: Map<string, string>"
  - "scanned_at: timestamp"
  - "scanner_version: string"
  + "is_safe(): boolean"
  + "get_threat_level(): string"
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

UploadSession -> ChunkMetadata: "1 to many\nhas chunks" {
  style.stroke: "#8b949e"
}

UploadSession -> FileInfo: "1 to 1\ncontains file info" {
  style.stroke: "#8b949e"
}

FileInfo -> ScanResult: "1 to many\nhas scan results" {
  style.stroke: "#8b949e"
}

session_status: Session Status {
  shape: class
  - "PENDING: string"
  - "IN_PROGRESS: string"
  - "COMPLETED: string"
  - "FAILED: string"
  - "EXPIRED: string"
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

chunk_status: Chunk Status {
  shape: class
  - "PENDING: string"
  - "UPLOADED: string"
  - "VERIFIED: string"
  - "FAILED: string"
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

scan_status: Scan Status {
  shape: class
  - "QUEUED: string"
  - "SCANNING: string"
  - "CLEAN: string"
  - "INFECTED: string"
  - "ERROR: string"
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

UploadSession -> session_status: uses {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}

ChunkMetadata -> chunk_status: uses {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}

ScanResult -> scan_status: uses {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}