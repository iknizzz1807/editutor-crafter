title: Parallel Fuzzer Coordination

classes: {
  coordinator: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  worker: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  shared: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  storage: {
    style.fill: "#2d3748"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

master: Master Coordinator {
  class: coordinator
  scheduler: Task Scheduler
  stats: Stats Aggregator
  monitor: Health Monitor
}

corpus: Shared Corpus {
  class: shared
  shape: cylinder
}

coverage: Coverage Database {
  class: storage
  shape: cylinder
}

crashes: Crash Store {
  class: storage
  shape: cylinder
}

sync_manager: Sync Manager {
  class: shared
  corpus_sync: Corpus Sync
  dedup: Deduplication
  merge: Merger
}

worker1: Fuzzer Worker 1 {
  class: worker
  engine: Fuzz Engine
  mutator: Input Mutator
  executor: Target Executor
  tracer: Coverage Tracer
}

worker2: Fuzzer Worker 2 {
  class: worker
  engine: Fuzz Engine
  mutator: Input Mutator
  executor: Target Executor
  tracer: Coverage Tracer
}

worker3: Fuzzer Worker 3 {
  class: worker
  engine: Fuzz Engine
  mutator: Input Mutator
  executor: Target Executor
  tracer: Coverage Tracer
}

workqueue: Work Queue {
  class: shared
  shape: queue
}

master.scheduler -> workqueue: distribute tasks
workqueue -> worker1: assign work
workqueue -> worker2: assign work
workqueue -> worker3: assign work

worker1.tracer -> coverage: coverage data
worker2.tracer -> coverage: coverage data
worker3.tracer -> coverage: coverage data

worker1.engine -> crashes: found crashes
worker2.engine -> crashes: found crashes
worker3.engine -> crashes: found crashes

sync_manager.corpus_sync <-> corpus: sync inputs
worker1.mutator -> sync_manager: new inputs
worker2.mutator -> sync_manager: new inputs
worker3.mutator -> sync_manager: new inputs

sync_manager.dedup -> corpus: deduplicated
sync_manager.merge -> corpus: merged inputs

worker1.engine <-> corpus: read seeds
worker2.engine <-> corpus: read seeds
worker3.engine <-> corpus: read seeds

master.stats <- worker1: metrics
master.stats <- worker2: metrics
master.stats <- worker3: metrics

master.monitor -> worker1: health check
master.monitor -> worker2: health check
master.monitor -> worker3: health check

coverage -> master.scheduler: coverage feedback
master.scheduler -> workqueue: priority adjustment