title: Data Model Relationships {
  near: top-center
  style.font-size: 24
  style.bold: true
  style.font-color: "#e6edf3"
}

classes: {
  core_entity: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.stroke-width: 2
  }
  relationship: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  cardinality: {
    style.font-color: "#ffa726"
    style.font-size: 12
  }
}

peer: Peer {
  shape: class
  class: core_entity
  - node_id: string
  - address: string
  - port: int
  - status: NodeStatus
  - last_seen: Timestamp
  - incarnation: int
}

message: Message {
  shape: class
  class: core_entity
  - sender_id: string
  - message_type: MessageType
  - payload: bytes
  - timestamp: Timestamp
  - sequence_number: int
}

state_entry: StateEntry {
  shape: class
  class: core_entity
  - node_id: string
  - key: string
  - value: bytes
  - version: int
  - timestamp: Timestamp
  - deleted: bool
}

digest: Digest {
  shape: class
  class: core_entity
  - "entries: Map<string, DigestEntry>"
  - max_version: int
  - generation: int
}

digest_entry: DigestEntry {
  shape: class
  class: core_entity
  - key: string
  - version: int
  - timestamp: Timestamp
  - node_id: string
}

peer -> message: sends/receives {
  class: relationship
}

message -> state_entry: contains {
  class: relationship
}

state_entry -> digest_entry: summarized by {
  class: relationship
}

digest -> digest_entry: contains {
  class: relationship
}

peer -> state_entry: maintains {
  class: relationship
}

peer -> digest: generates {
  class: relationship
}