title: Resolver Context and Error Propagation {
  near: top-center
  style.font-size: 18
  style.bold: true
  style.font-color: "#e6edf3"
}

classes: {
  resolver: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  context: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  error: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
  success: {
    style.fill: "#00b894"
    style.stroke: "#00cec9"
    style.font-color: "#ffffff"
  }
  partial: {
    style.fill: "#fdcb6e"
    style.stroke: "#e17055"
    style.font-color: "#2d3436"
  }
}

query_start: Query Start {
  shape: circle
  class: success
}

root_context: Root Context {
  class: context
  shape: rectangle
}

user_resolver: User Resolver {
  class: resolver
}

posts_resolver: Posts Resolver {
  class: resolver
}

comments_resolver: Comments Resolver {
  class: resolver
}

db_error: Database Error {
  class: error
  shape: diamond
}

network_error: Network Timeout {
  class: error
  shape: diamond
}

partial_result: Partial Result {
  class: partial
}

error_propagation: Error Propagation {
  class: error
}

final_response: Final Response {
  class: partial
}

context_flow: Context Flow {
  user_ctx: User Context {
    class: context
  }
  
  posts_ctx: Posts Context {
    class: context
  }
  
  comments_ctx: Comments Context {
    class: context
  }
}

error_handling: Error Handling {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  
  collect_errors: Collect Errors {
    class: error
  }
  
  preserve_data: Preserve Valid Data {
    class: success
  }
  
  format_response: Format Response {
    class: partial
  }
}

query_start -> root_context: Initialize
root_context -> user_resolver: Execute with context

user_resolver -> context_flow.user_ctx: Create user context
context_flow.user_ctx -> posts_resolver: Pass context down

posts_resolver -> context_flow.posts_ctx: Create posts context
context_flow.posts_ctx -> comments_resolver: Pass context down

comments_resolver -> context_flow.comments_ctx: Create comments context

comments_resolver -> db_error: Database fails
db_error -> error_propagation: Bubble up error

posts_resolver -> network_error: API timeout
network_error -> error_propagation: Bubble up error

user_resolver -> partial_result: Returns user data
error_propagation -> error_handling.collect_errors: Collect all errors

error_handling.collect_errors -> error_handling.preserve_data: Keep valid data
error_handling.preserve_data -> error_handling.format_response: Combine data + errors

error_handling.format_response -> final_response: Return partial result

context_note: |md
  **Context Object Contains:**
  - Database connections
  - Authentication info  
  - Request metadata
  - DataLoader instances
  - Custom resolver state
| {
  shape: page
  near: top-left
  style.fill: "#16213e"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"
}

error_note: |md
  **Error Propagation Rules:**
  - Leaf resolver errors bubble up
  - Parent preserves sibling data
  - Context maintains error state
  - Final response has data + errors
| {
  shape: page
  near: bottom-right
  style.fill: "#d63031"
  style.stroke: "#e17055"
  style.font-color: "#ffffff"
}