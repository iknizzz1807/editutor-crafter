shape: sequence_diagram

# Define actors
client: Client
interceptor: Error Interceptor
handler: Service Handler
status_converter: Status Converter

# Error originates in handler
handler -> status_converter: Business logic error
status_converter -> status_converter: Map to gRPC status code

# Status code flows back through interceptor
status_converter -> interceptor: codes.InvalidArgument
interceptor -> interceptor: Add error context
interceptor -> interceptor: Log error details
interceptor -> interceptor: Check if retryable

# Interceptor processes the error
interceptor -> status_converter: Transform error if needed
status_converter -> interceptor: Final status with details

# Error propagates to client
interceptor -> client: gRPC status response
client -> client: Parse status code
client -> client: Extract error details
client -> client: Decide retry strategy

# Alternative flow for transport errors
client -> handler: Request with network issue
handler -> client: codes.Unavailable

# Client retry attempt
client -> interceptor: Retry request
interceptor -> handler: Forward retry
handler -> interceptor: Success response
interceptor -> client: codes.OK

# Styling
client.style.fill: "#1a1a2e"
client.style.stroke: "#3fb950"
client.style.font-color: "#e6edf3"

interceptor.style.fill: "#16213e"
interceptor.style.stroke: "#3fb950"
interceptor.style.font-color: "#e6edf3"
interceptor.style.bold: true

handler.style.fill: "#0f3460"
handler.style.stroke: "#3fb950"
handler.style.font-color: "#e6edf3"

status_converter.style.fill: "#1a1a2e"
status_converter.style.stroke: "#8b949e"
status_converter.style.font-color: "#e6edf3"