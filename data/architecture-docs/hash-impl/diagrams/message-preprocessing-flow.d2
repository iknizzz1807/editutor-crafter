title: Message Preprocessing Steps

classes: {
  process_step: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  decision: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  data: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

input: Input Message {
  class: data
}

validate: Input Validation {
  shape: rectangle
  class: process_step
}

convert: Binary Conversion {
  shape: rectangle
  class: process_step
}

append_bit: Append '1' Bit {
  shape: rectangle
  class: process_step
}

check_length: Length â‰¡ 448 mod 512? {
  shape: diamond
  class: decision
}

zero_pad: Zero Padding {
  shape: rectangle
  class: process_step
}

encode_length: Length Encoding\n(64-bit big-endian) {
  shape: rectangle
  class: process_step
}

parse_blocks: Block Parsing\n(512-bit blocks) {
  shape: rectangle
  class: process_step
}

output: Padded Message Blocks {
  class: data
}

input -> validate: Raw input
validate -> convert: Valid message
convert -> append_bit: Binary data
append_bit -> check_length: Message + '1'
check_length -> zero_pad: No
check_length -> encode_length: Yes {
  style.stroke: "#3fb950"
}
zero_pad -> check_length: Add zeros
encode_length -> parse_blocks: Final padding
parse_blocks -> output: 512-bit blocks