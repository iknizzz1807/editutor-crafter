title: Data Model Relationships

classes: {
  core_data: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  config_data: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  output_data: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

BinaryChunk: {
  shape: class
  class: core_data
  - "offset: u64"
  - "data: Vec<u8>"
  - "size: usize"
  + "new(offset: u64, data: Vec<u8>): BinaryChunk"
  + "is_empty(): bool"
  + "get_byte_at(index: usize): Option<u8>"
}

FormatConfig: {
  shape: class
  class: config_data
  - "bytes_per_line: usize"
  - "group_size: usize"
  - "show_ascii: bool"
  - "show_offset: bool"
  - "uppercase_hex: bool"
  - "offset_format: OffsetFormat"
  + "default(): FormatConfig"
  + "with_grouping(size: usize): FormatConfig"
  + "validate(): Result<(), ConfigError>"
}

OutputLine: {
  shape: class
  class: output_data
  - "offset: String"
  - "hex_data: String"
  - "ascii_data: Option<String>"
  - "line_number: usize"
  + "new(offset: String, hex: String): OutputLine"
  + "with_ascii(ascii: String): OutputLine"
  + "format_for_display(): String"
}

ProcessingPipeline: {
  style.fill: "#2d3748"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  FileReader: File Reader {
    style.fill: "#1a1a2e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  
  HexFormatter: Hex Formatter {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  
  DisplayRenderer: Display Renderer {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

BinaryChunk -> ProcessingPipeline.FileReader: produces
FormatConfig -> ProcessingPipeline.HexFormatter: configures
ProcessingPipeline.FileReader -> ProcessingPipeline.HexFormatter: "BinaryChunk"
ProcessingPipeline.HexFormatter -> ProcessingPipeline.DisplayRenderer: "OutputLine"
ProcessingPipeline.HexFormatter <- FormatConfig: uses
OutputLine -> ProcessingPipeline.DisplayRenderer: consumed by

Dependencies: Data Dependencies {
  style.fill: "#2d3748"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  
  OffsetFormat: OffsetFormat {
    shape: class
    class: config_data
    - "Decimal"
    - "Hexadecimal"
    - "Octal"
  }
  
  ConfigError: ConfigError {
    shape: class
    class: config_data
    - "InvalidGroupSize"
    - "InvalidBytesPerLine"
    - "InvalidFormat"
  }
}

FormatConfig -> Dependencies.OffsetFormat: uses
FormatConfig -> Dependencies.ConfigError: "validates against"

note: |md
  ## Key Relationships
  - **BinaryChunk**: Atomic unit of binary data with file offset
  - **FormatConfig**: Controls formatting options and display preferences  
  - **OutputLine**: Formatted representation ready for display
  - **Pipeline**: Transforms BinaryChunk â†’ OutputLine using FormatConfig
| {
  shape: page
  style.fill: "#2d3748"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  near: bottom-center
}