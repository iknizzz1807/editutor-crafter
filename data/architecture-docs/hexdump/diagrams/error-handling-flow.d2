classes: {
  error_state: {
    style.fill: "#d63031"
    style.font-color: "#ffffff"
    style.stroke: "#e17055"
    style.bold: true
  }
  
  process_state: {
    style.fill: "#1a1a2e"
    style.font-color: "#e6edf3"
    style.stroke: "#3fb950"
  }
  
  decision_state: {
    style.fill: "#16213e"
    style.font-color: "#e6edf3"
    style.stroke: "#3fb950"
    style.bold: true
  }
  
  recovery_state: {
    style.fill: "#0f3460"
    style.font-color: "#e6edf3"
    style.stroke: "#74b9ff"
  }
}

start: Start {
  shape: circle
  style.fill: "#3fb950"
  label: ""
}

detect: Error Detected {
  class: process_state
}

classify: Classify Error Type {
  shape: diamond
  class: decision_state
}

file_access: File Access Error {
  class: error_state
}

io_error: I/O Read Error {
  class: error_state
}

memory_error: Memory Allocation Error {
  class: error_state
}

format_error: Format/Parse Error {
  class: error_state
}

permission_check: Check File Permissions {
  shape: diamond
  class: decision_state
}

file_exists_check: File Exists? {
  shape: diamond
  class: decision_state
}

retry_logic: Retry with Backoff {
  class: recovery_state
}

partial_read: Handle Partial Read {
  class: recovery_state
}

graceful_degrade: Graceful Degradation {
  class: recovery_state
}

user_error: Report User Error {
  class: error_state
}

system_error: Report System Error {
  class: error_state
}

fatal_exit: Fatal Exit {
  shape: circle
  style.fill: "#d63031"
  style.double-border: true
  label: "EXIT"
}

continue_processing: Continue Processing {
  shape: circle
  style.fill: "#00b894"
  style.double-border: true
  label: "OK"
}

log_error: Log Error Details {
  class: process_state
}

start -> detect
detect -> classify

classify -> file_access: File Access
classify -> io_error: I/O Error
classify -> memory_error: Memory Error
classify -> format_error: Parse Error

file_access -> permission_check
permission_check -> user_error: No Permission
permission_check -> file_exists_check: Has Permission

file_exists_check -> user_error: Not Found
file_exists_check -> retry_logic: Exists

io_error -> partial_read: Partial Read
io_error -> retry_logic: Temporary Failure
io_error -> system_error: Hardware Failure

memory_error -> graceful_degrade: Low Memory
memory_error -> fatal_exit: Out of Memory

format_error -> graceful_degrade: Skip Invalid Data
format_error -> user_error: Invalid Format

retry_logic -> log_error
partial_read -> log_error
graceful_degrade -> log_error

log_error -> continue_processing: Recoverable
log_error -> fatal_exit: Critical

user_error -> fatal_exit
system_error -> fatal_exit