<?xml version="1.0" encoding="utf-8"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" data-d2-version="v0.7.1" preserveAspectRatio="xMinYMin meet" viewBox="0 0 18429 6155"><svg class="d2-42667800 d2-svg" width="18429" height="6155" viewBox="-89 -200 18429 6155"><rect x="-89.000000" y="-200.000000" width="18429.000000" height="6155.000000" rx="0.000000" fill="#FFFFFF" class=" fill-N7" stroke-width="0" /><style type="text/css"><![CDATA[
.d2-42667800 .text {
	font-family: "d2-42667800-font-regular";
}
@font-face {
	font-family: d2-42667800-font-regular;
	src: url("data:application/font-woff;base64,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");
}
@font-face {
	font-family: d2-42667800-font-semibold;
	src: url("data:application/font-woff;base64,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");
}
.d2-42667800 .text-bold {
	font-family: "d2-42667800-font-bold";
}
@font-face {
	font-family: d2-42667800-font-bold;
	src: url("data:application/font-woff;base64,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");
}
.d2-42667800 .text-italic {
	font-family: "d2-42667800-font-italic";
}
@font-face {
	font-family: d2-42667800-font-italic;
	src: url("data:application/font-woff;base64,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");
}
.d2-42667800 .text-mono {
	font-family: "d2-42667800-font-mono";
}
@font-face {
	font-family: d2-42667800-font-mono;
	src: url("data:application/font-woff;base64,d09GRgABAAAAACIMAAoAAAAANnAAAgm6AAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAAA9AAAAGAAAABgld/X+GNtYXAAAAFUAAABXgAAAkbDZ1kFZ2x5ZgAAArQAABYbAAAfCL8NN/BoZWFkAAAY0AAAADYAAAA2GanOOmhoZWEAABkIAAAAJAAAACQGMwD4aG10eAAAGSwAAAEDAAABxAjZJw1sb2NhAAAaMAAAAOQAAADk2VPgsm1heHAAABsUAAAAIAAAACAApQJhbmFtZQAAGzQAAAa4AAAQztydAx9wb3N0AAAh7AAAACAAAAAg/7gAMwADAlgBkAAFAAACigJYAAAASwKKAlgAAAFeADIBIwAAAgsFCQMEAwICBCAAAvcCADgDAAAAAAAAAABBREJPAEAAIP//Au7/BgAAA9gBEWAAAZ8AAAAAAeYClAAAACAAA3ictNFLU80PHMfx1+l2+v9FpCKS3zmdDolcSnTcyrXkfgldVBQ9BreNJ2CsPAMrY2VjxROwwbQwzsTaio2x+RpnRpPG1ucBvBafN1LKpVCjoqyAYX0qNUpkZLVqk7dJuy06bLVNp+167bPfAQcdMmjEqDHjJky646577nvgqRfmkvokn3mceZIdyM60iWCJu/kPd4fCgttvaJE79Rf3Ucmd/uXGJzl53brUSuR06NSgWZ1WVaolWmyUjtfxKr7F9/gaX6TjZbyPuXgXn+N5PIuH8z3zLcW3xTfFpo8/PsyWXvkXSzlmwBVX7XbCKadddk2/QX0u6LHHXr0Kiz4+7Igxo8YdV6ZchUpV0qr953/L1FhuhVorrVJntXoNGq2xVpN1zrjkrCG3rddsQ+mJ3xVyCx3al5TYaZcu3c656LxJw24YcdJRN02bccuU6ybM8hMAAP//AQAA//9vnlw5AAB4nIx5C3Qb1bX2Pmf0iB3FtiyNx7Jlvcaa0Vu2RqORZVvWw5Zsx0/Zih3HdpzYSRznnQAhNKQ0Da9AW4WfFkIDlEIL/LSUtH8JLT+3vcBlJSXt5dFy4RZ6gXa5WbSlrWu47W08umtGcuzQxVpd9uicNTpnn3322fvb3z4CJUQBcA2+GwgoAQ1UAgnAaa1au5VlabVaYClOEGgz1kbR22IOoa6gInTtTTc9oWhM/C6x5bP47qXdkRM7dgzMX/rB5OHDX5hHPwMMFgAcxjkoAS2ATs2xDMPSKhWh43Q0S6svmV80a63ligrLW+9MvjMa/bAN7ZuZEfY0Ne0Rx3Buaf/58wAABEwDYBrnoAIMYJP04gJVVaRepSblhia4QIgPMjStXe5M/zC5rSnc3Dlw+97rNg539fZMzA1PbNowh3OWVKSxv1yxtq99y2Z0NCTwnqXLzclWHgBBPL+IXfgM1AEobQzDB0MhLlBFqRmGtqlUpL6qiguEBEqlQpsHP9fTc3O2edzoNyScbRPB4ESbt9PsZ6c1g/fumrs302Dha63x6zKZIwmG5rwBAMAwAoCdOAdrJHvIu5C0Z5eVHvn63We+emqo68C+fQe6cO7xM/c/2X7H0aM3g6TbQQBciXOwVj4XcvnvIPqK+C+oQvwT6sG51M/SH6YBwc0AuFq2+8pY7c3o/4j/isrEBZxL/Sol/icg4POLmMRnwPxp++UCAk/znFalQoOZz3Wt/3w2Pmr0V7f5W8e5nVu6nJ9/xbytuGGujq+xxa/LHD3FPtEh/t7sBQT9ALhkWWfJmzgtrbVq+4dR5fCw+CHOiX9AuqX9iBdflve4GQD9rTie57Q0byVpLUdufvhhdN/DD6cxkUotLaVBHrsVALfjHGgKsjnEqXU0oSa3DhNIv/mVS5M/OoBz4jnU9TdxJxq99VVpzi0AuA7nQFnUh7wlgzpwbulcUWYnAK7AOaiVv9dRnKCTNA6GQgKtJmiCpU2Y1HZuH7cozBPbB5RqTNgnW8YZTKiUOCdemptD1Uv7UadlJGu8SRQRvsmYHbGIz0iyMwBYhXOgW5bNMLxkD4Klq6pIbWb8tTaMSwYKDc6JM7c17gqi4aX96MxtgVlOfBwwNOQXsQOfgXJJw1UnJrmRii14kU06N+TpPhiLHewufK7ftGn9+k2bNJnTu+fuGRi4Z2736UxX7tjRO+88eiwn+eV2AGyWbUmuii4VTWuvBNT2l7r2tLbu7Ty0c8PQcHYnztVnOzvGPOJl1BlPpQWQ/bshP4Hd+AysBQbAvkofpY1hr9JWvRJKnqJ6CEb2Vm++tqD1/nFtN1duKKmosDfljkuaHs+9PZrQnr2rsIMvPaVzu1SKpGqNtO5MMa7KgFqNDjqaWLWDmYvJHc0DyUc3P3Dtnt7Bwd49OEcPtvdMaMX3ESn+Dm1si8WDBT9I5hexAZ8Br2xlVpCV5YMMw7I+fHWUSKBAUSYs2Qs1dt7gCdinw+3rzbxt0hr3CFvaorP1Hksf15SiQ8ZxZ5wNz2p4T8Tujfhol7HMuc6VaAj0e731oTpr0GN21GgcFd54YzAbAAQuAOzDOVADWIvRgPCbWPEm7k6llp6Wde3PL8oxRhY9QstpCzgVkrsqFfLGtjUN17exjqh9sGlaEzw4ie4Vt7cP1tcPtqP7xNnJg0FA4AbAXpyDdQAcwemqqiguFBJ0HHH51dE5rbFSUVlXsTP7Cs6JD0S2RSLbImjr0n5AUAqA+/ApsBfmmTDFRbEgcFSxp+MImijgvprYOzPZQCgViFCVlqpiA1F1aYlKgQkF4Rubmo2pNUpCWbomhk+JM7Vev9Xq99QuLtZ6Cj10/9I+tMYUMZkiJvGv8t5DANiGc2AA4HQERxWVFjhCRxdzjVodevHc+Pi66gpFGakZGz334vj0OqNWUVazbisaQq2PVXnq6jxVj4k/Es+ereZMJq76rCybAcABnINyACt/lWwS4bdHp3X1eoWe0W3e8PYH6Jsv2Hscjh7meXHsAzmPAOBafErGXx5ZeSuJrGQc7RW/i74vnkLXBLAhFVi6lJZ8dzC/iAm0AEZgAahiTAs+TNtUalb2NFJLSzthAyGBL8Okvupj73pv+syNyBD2+zfaLPZDsZktSTXhmDE5h5yzhxvjGmvULXR5Sq2CzU6Gq317NolvJMz+BGO7aY210eK0A4aJ/CI24vOgB2vBy2m1hLVqrrDmakCR0iyK0YM0oU5kCMI64t46G51Jx4ZjXZYuhk5raHMIn39+0ua45cDQddGOHWMD0zSzYK6RbDGQX8S1aOGfyKljPdenuo92NY+anKY4E842+IfD3vUmu2Na03JwIHOwxVXH15j82bAw7K838PUOGXNa8ovo76v2sbwAx0oZpGA4gb+yGirffE3btiZPykwoMu1qwjRk7Ixb2yyuDmeP5uYj/YeiVtPYs0vhmNnb0bVgrvEPhUck+gHt+UVcgxZAJWVLZFOprQxDrGxIwhvryl6iLZNrUUjZF+g6nEodiO+8FmPxc2t29njSVlP9BDrb27m+W0y2HBrsP9h6446ymtLMsIEMVdsK+LMDACfwz6FKQjOaF/hgiAssAw7JkbR24Y47pmY623UmzhKPXLyIHo4qnRt3G6NlJe3NnqQ4UeBNnXkLDqEFaIAW6ClaR7IFHwwVG0kuR9JFvLcxbCHtFz2AWAXhuiKMLo9BjrnrBnRmk9FA8yOc03zhmLY6kOV1bn2lnm/YM7kpcWTUH4/7fYlEU3arEN5M2itsxsF307GoT7GWMVONOoUu5ub73JqkNlgXXO8oKVlr1BqNwai3z4/OtgW5tjYu2Cbe0WKnqxUKnZNkJE4xAYDX4vPFTHXFX6U0LfuqdiKjJJiRpg2ZTLDF3e7G558/5AzNTImvIboj6fGI3waAfB7GANAD+CJmYCcAqGCuofBeyLPF97tW3gOCOQAcxeev5husmpzLKJBq8vm3x793CJ8XTQh+JL710YET8pxuOY+ch4qC7bUSlZJJleQi9/QOfTvPu90NpC2s2bgBvZ9c+gXfUNVaVi7PjUjYjxYkr+a0HCVvk1rZq7zVK3uOJNRYF3ClSZJzcU2ZoMGq76FqDfZKNB+zuYZZb2+X+AjakLUz4tfQBpdbapdtiRZAv2qNq0zZrlYwo1dMieaHPmlJOf6wES38M5wktieZ3BMrfKay2VQqmy1GdsvBzMDBlvYdQ8Ozs8NDkvvDRJ6T5cpxTa1oV/RTmiJ1q/Fpol1N2DZ6t+6IzjTb+i2E4ng8W4Cn1E/x96IW160HMtdFrabxR5BqFT5J+nPo78vrKHmBluVfQRGB0xJX4cfjCsI06J2UQaTTRqgTv7yCHz89O2Z2yxhis4SWepFqBUAQ3AWADWgBKlfbuhjTau1d7WqC2Z+s9VfpDPV1wjYPmj/U3F6yNl2ypq1H/DUgSOcXcRlaAMc/cBLZ5FcxkmU+Ekof9TCu7cloKxlPTE5tnwnP1jtsGX80kOweHLEGpjRec8hU7zXrTMZ1+qTQ3G838JTRZTTbKrSukJ1NOGRf7MgvYhs+DtXFE+ZpXhA4CYjkGqEAeSfTGfr2O9e2//GPfIoO11RauzTcWMt8VHnmTPK38XZNaYtGCwh684vob2he8jnKVqQrkghtEa0/HskMca2uDkcmqVbYRzUzU8gnvtORdPvRoFiTdYcAAQeA7Whe4irWq7gKgp8O7S+vXadYZyjf338BzYu/t6dpOm1HerGmEMcSYRxA8xKKr+I5wpUEL/EVVqIOavXBuUxEvVahUJavaclE1lQqFKoSdaRndi6s0Sg0mhCaF+dtcZqO2y5fLrSoRqy5xE1McJfktWIAmELzMj8R2FUcQk2t8JPYD57Y1LuurlxRZlzXNfLtH45ly60VinJT+cDlD3bp3Hq9R7/zzx/tJ31klZvaL8ttzPsxi+ahRrJh0RUE4SpLlOHP1xu1pdRaLlZZ/uuhw2XmcsW6Ws1c3xuVof5XS+OEotlbj34r/sXSTdNdVrRuaaGhR8JXiZTo0PzV3CWNesU30QPid9GIBx1OesTbk1J+ceUXcVzm+xy0Aej0VVSoGJO6ZSazOkNKtJ8KhQRO6lFqKZOwhdNnpP6PK8pcrbVWG+uLjAbosIWk6uPu1oQrRluGvEZnWU9lsL6Fp+Kd9SPf6g6amw3+DTazG+PaiMkUd9e5Q0sX/BnenRQoZz/tSTk7I65kuDawmXVMhWOHgz5tu16wOZ8VEsZq1zbe2CrnSCmutPgkrAUK6GUGUVB3NXoJq94jz9xnPjO364YbdiWz2aT0GOx2g8Fu1zz54EOPPfbQg08mjt9+8sYbT95+/N/rzWaaNpvr5XPbItfwx+QcIte3ki20HLnlmS+Fe82tj7ajN/g1VMXSS+0FX+0AwKX4pFyP8lFcRDt2xZyhEMeRXbu/0tue9vaa/e6Z5NT+7ptHTK3G1xqnctfwQspr8Xv4HdmWz9zajxVpQNCUX8QqfFKqLa7CEZq/AqfsSplGFpHEnDlAuyxjrfHRuWMHptLN3gGLx7GjtWVzuLfZnfa0zWoEOmTyxfimVFtHwB+qrwvSXqYzGOnWK0rcCU844wEsMVxsxcegRIp+gZO2L4WAjrfySLIDTR7/EBFIWW6riIvnUNvo9PTCSzWtNZSfEoNPCege8ZrEU4AgnF/EpfjYMnMVivVOUXudlbSqV3IQMmV3252W4Zi3270h7QjbPCTaKb6rNfL21unm5G5NyBoyeusTnkS3XmdEXPo5TZl7tKNjS+HOpje/iKtk/3AWeN+ywQrkL4pXsVn1lZNBMWaEKcmmmvpS8Y59Mc/6qWDzqNlnSNRzIwJmJxs27m3egjodvvEtvW3xlPit9tu3T92aZdk6jqoNHt7BeKe3to5LdVkKAOvxMSgD4KKEIAVkGaF+X1Hb2CuIOfSztqEGitj0lROfTaa5zhO3nZ4EQuaqOnwSTOACYSUrr3C+1WdLrDh5FVFMKYVU5+vc2eRoszmauI1Nk7NNDrrJGtpODSTa+KS3F6V7+U1hX9uoxjsQ8MR8FQpDd6Cx2znV7e03KrTuFp+/z4tmIyl/IuxnArT4Ulujl7PpDIkGvgOwXGNrlu2qW0aBAnIsn6iwOhdXkfoyfKojyWxgS4fSTX37I6MWX3XCzm0QMDvROLq3eUs4tTfuWT+FnounHN6JLb1Lf2WNQcoYvH4745Ht2X7bDsnKUmz9Mr+IboT7Ye3VMY88Nr/fZvP7NX474/czdj8g+Le8G90JX5VyN8WuUqsw5W0qGsWKUqXF12Dx+CZ+ETQONCPE2O1sR/PoEYlTymthArNSRkDbQSW1+XxB7lXv4zImWfKLOAxXMIlatRj3Kf3tdU5nXZ3D8bjcOp2PG51OY53TqXFZbU6nzer6ZCv59q/zi+ha/AAoQQtgJ1hOTahX26KiFA/gUqPJ7TaZ3O5LaHRyUnxs0VVPO510vatw57Mnv4j+C/9fMIAdQGCixCdQqoygVstcUNc2cvWCwMRrG23jkaEd9XzApKxbXsId4/yNZmfYXOulfdm0s7mxIcKuWhHBR2gKTePvgBIAsSynVqMKA96LDWjqvb173ytw+ONoCr2Bv4MZSH9B4vDpQ4X3WeTGBNqJVbBbxleAN/EosgABwPNWEo++2dkpvW/JX4ON+Wel9xRvJVvQu3emJex8JT+AfoXflniHslBFUXKkUOjs7JEjs96ZqamZpwZ/c+rUbwZd2QvHjl3IFnD8hvwAuq0wT/IfPih7OKlXPerdtnnzNu/skSNPFSe45OmA4L38LPoYvwhqif0W7kHfQ+Trr99LjPuXsL9wB5qfRYeLYwr3pdqtr7+OyHv9WPRffkQec31Rjn/Zz6UApwvZRDoVjiwy25X7dLko50j0g8lNJVRbc3MbVbJpsjXIhXQqNhhkVboQF7w33CuMBvQ0FURV9Tr/ZLA37K90WN2b/I1ciaKEa+SGfRZnZUHP6fwseregA8UXoXqlBpUVovmCf8j3aeQVjehpjgvpVUwwyKj0IY5rnRxbVmls8l5/pdPiG+aKK/o3ua2OSn+4Nzjp19VXoSBF6wOjQm+4qMMU+gi/JJ8p4tA06uwWn/kasf3yffIZIXVehQbxh9L3Si2nReru/yEuXa7+5Fwl4hB6QnymG3UuT0YwDPuwAnskjBZYgRUogaMESk2p2f/n2v31ikdLGkoerfj6btf1+0zfSPmE554TfKlvmB6U42dT/sdoCX8LOEhenZF9CslE/0DuTYrC9SmpVxF6E5YJlw+zUo4Wxi2BmlaX0+uMdcacnKNM27M+MGhyGJpoF+OMdcWcAWdZxdiLzlinxUI7Yp0Wsz3GWL3VRqexzl5nckZ9njhZ4TAE+2wUr6+x19Ta60yuqK+hpaqCrWnuQ2esbkudroyx2TwWU2WFs/ibhhqfBEJi1DpOoAmB5jn54dTyQ9LyQwu0+jcnKk/MGgZGKrPjFF91guKr5L4hZDhhQMq7xR0Xm+6OnDt37lzk7qaLFy9KMVubX8St+CRmYU/+BtQLDOwFADXsgVtk22dhFhPYI+G4nad5ji/UJWjt008nnn569oXoCy9EXwAE2+EYWsCkNK54RvIB3eW5777l/2PeBx/wPvig94EHvV8r4AX8GBPo55iB3bALJNT4ciGmoAH9Ac9KcWe383ZSSSrRH8Q70LXi68jbsBRd6n9Z8TIg2AUN6N3COIG383ZeSe5CXvF1dG2DNKJ/KVrA0CwAJjAJhHz7yltJaTCpVpMUlUVPihn05Gu33vpaNHr6dPfpdJdH4en6lHl2XhB4luWVpDxPmoWejEaLk9Knuwt41AN5rEFfBkpiNKuuGk14uZg7YfI7WZJyavmaTmZVHyGDzWALUumQ3FanQpKdeuBurMGAGZiS7TQl2Smfh+F8h1SnYBXsk9fV5v+Mm7Baqi2UiEeU2kpaKWQV/4Qq3BfQ02L3hXJUokAlvmfbn5XGW/O/xQIul8dr1SzikJrVotJnfcVRBnTuggtViH9yXRC7AEFd/s84VZTPSlSJFRCJeOlbeaS2XJLsE/9bUbDDBhDQx+g/pPF2u6BEAiIEHfqLeIJAleJPGlCoJKoUlG2lKNQg/gRVEuKJQh55BIfRbqIEq0Cux/JvISX+LBqS8IHgrSSLv4mUfX2FNcYA0BfRvJSv5Dt8LWp5HwXRw0m5IEXwAe5Be/FFyS/RVTzEyDBGI8PgHrqujpaegjwhz8ryKmVesIwWsmS9SvU801lXW9Nk7Aq8j4L20bd0Za3rylJR9P2kWNYyzkvxUsiBkq463ir5CXJHi374UH4RnUOtMu/41EoIeVr7+lqlx+LzWSw+n2a0ry+b7esbDUQiLaFQSyQiyTKCBbfg/UDI3i/FGytQvY3nrKesjzZavP/fdMb0slRvFn0EGPmWp3AZEBK0XPH3R8kd5fuewrVPlb6KGs40hgyNjYYhrKjQKNTqtZV1DEtg04DHKugRQTyLHxLfSXaU+zwosfXVEZ0WoegaXyQYIC2B7oQD0PL5STZArECh+P2RL+Lw6fBj/wsAAP//AQAA//8dRZNfAAABAAAAAgm6tubZ618PPPUAAwPoAAAAANwdDfcAAAAA3BxzS/8//joDGQQkAAAAAwACAAAAAAAAAAEAAAPY/u8AAAJY/z//PwMZAAEAAAAAAAAAAAAAAAAAAABxeJxMkLtKHGAQhU++JiFd6iSQNAlsmoSQK4soXhHFC14+FBFdWUGxsRJLQR/ANxD2VextxUrs7K2VH6bYYjjD/OfM/HyYEUwwnzA9zBhmHXOMOcf8wixgtjG7mAvMDGYZ8x3TL93DjGM65f+GeYv5jflSe5cwW5hFTBczgdmvfW2+gfmDOcDMYv7XvDukl5hpzCRmHvMT8wYzivlRb53SnfL9w3zF/K3MVN1u/73DXA9p4/CAOcI8Yc4wq8Wo3b/BnGLui8dJcevhq9fVr2A2i+P7yvdLm/+w+lZzVS3zDvMZ8xGzhhng821xeSw2LXOF+VCZwQsAAAD//wEAAP//6A9PyAAAAAAqACoATgCCALIA0ADmAPoBKgFCAVgBcgGCAbAB0gH+AiICXgKGAsoC3AMAAxwDWgOIA6YDvAP4BCwEXASQBMYE6gVUBXgFhAWQBaoFyAX6BhwGSAZ8BrAG0AcOBzQHVgd0B6oH1ggECBoIfAiyCMoI9AkyCVYJjAnMCeYKOAp4Co4Krgq6CsYK+gscC1QLZgtyC3oLhguSC64LyAvaC+wMLgxwDIAMjgyeDLwNHA1MDVwNcA2KDZYNqg2+DdoN9g4eDioOMg5KDmIOeg6WDp4OrA68DtQO9A8CDygPPA92D4QAAQAAAHEB+AAqAGUABgABAAAAAAAAAAAAAAAAAAMAA3icnJZLbJPZFcd/zrkBv3gZVA0IVVcjhKYIjJ1JwE0g4JABwiBCSWbaClHVJMaxSOzIdmDoYhZdVl11XXUzXbQStAolaiaBQiCkagWq1EU1q666qLroqppFV9V3vuPEcRI6g5DI7z7O/57Xvf6Ai3ILIeKiEUiCcYQkSeMODvGOsZDklLEjyUXjTpKMGm8jyQ+Nt5Ni0jjKYT41jnGYXxrHOcKfjROc4D/GSQYjR4x30hupGO/iYORXxrvpiiwb72nxM8XByJfGe1d1YsBKR8o4wjc7vjDuYGfHl8bCZXHGrmVPJ+Ny1XgbR+SR8Xaeyd+No3S7XxjH6HZ/NU7Q1bnNeIf4zpzxTrqj3ws5ArujPzWOsDv6c+MODkTvGwvJ6IqxIxU1/Ugnqeg/jLeRilosQf5jUeMoh2IHjGP4WL9xnKOxHxgnyMR+YpwkHVsw3kFX7J/GO8nFmzq7OBy/ZrybU/FPjPe0+Jzi3bjlKrK3RXPfqub+CKTifzOOkIo35zt4N/5fY2Ff4qCx40AiY9zJgcQl420cSIwbb2df4lPjKJnEz4xjvJd4bhznaOJfxgm6k98wTpJLNjV3cir5Y+NdZJJ/MN7NxeS/jfe0+Jmia8cJ472BjszKM1mUV3gKLVyijOcwnkm8PJY5vMzKgizJnDyWV/JE5uS5fCb35bH8Hh+5JEvyQP4kT/DysIXnW3hFPpMHsiQP5XNZkKd4l5UFeSlL8rksyqLOvjL7WfmjvMZzveMLbgRnyCN5oCqhLwtyX+ZlTpYDHa6T4YYsy0t5Jk/ld2q/onq/wcszmZXXsiizuvPYFjufynON8YUsy5wsyW/lRXOW6xzhhryQ1/JYHspTWQxODc6Wl3h5pDOzahPObO7joS1Ovo+XOXkis5qFIMvLzXn196ie3pJfjqqna3VryXfbWknHG/PeUhXbsVpJfo2niwxZMniO2ahLR3nGqXKTIp4R7lGnQZEp6niGqDBGlRrT+n9B18bxvMcEDRpM08txjnNX/6UprKql1XKK43wr8Ie7lGkwgecaReoUqXHH1M5TpUIDzxUKTAW++HcYocoMNcYo+v2kW8d4zlFlXOkqNaqqWmKGSQrU6CJNhvfJ0UeeQQYYpm+dQtM+tD7WZh9aDTPAB3ysvtYpq5d+nfYEVRoaaYU7eLK6liZLlhP0MUWB2xR11y2KfKIeBwo9pDlBDye0Ll/ds/VZKGudCngaWp9xrV2w7zaeKrfeusJljTWoWGD3ERWtX7g2QsN2hqdXGOe42nuNdEIz5lV5Ritbo6y702/lzVUKGr9nkDSei6Ya9NWoZjf4O6P9FvhdpPI1+rPBPaYpMsqE5XOtH0c0hw3uak7XMj5JWStQ0U4OcjKjWQjjbmZthCEu4xlW/co65cvrFIJI2vssq32U1tgmNj13rf53KFDWDrnJpK6s3beCnpvnO8oNevFt2akzphWapqE1qqtWWmtQ4jjDnOdymyf/P0fj+jes/U1mVrsnjC7omuCW5xnRyo/4/XgGdDzEiGbkuwwxykWG+YhRHee5xjXyXGGUIT5Q22Gu6XswzBUG1WJIOVw7rzfgCt/H8yFDuifQLlp+wooFN3Nava+r72Evl5liWnMeeJ7WWIsa4devsOeWqTZt62ozRplbutNr/Sp61wuUrCum1cMpzWWzN9ZuXdgRUxpLUNu19RJVfV9renMDVc89ezuCbg19Cl+Ixleoavqteqa+msOi+rx+XLLfgbK+jeGr0/xGGdFfgrL+fo2p14FtEFHwe9k+M79hZkVrVeMm5bDXZIVz3NPTJu0eeW5qbGoRfplQ1yrUtUaBRz9SlWrzm8ReiyolfZ+mNXNjeqPu6SjsAv0q2XJvwV69mmb9dvN7ZMPZwVs1ae++19hKpn6IGxSYNJWKvZSeCjP6+1nT1fCuaWxk3+hPu1K99UtlQxWP6tveXpP22m62S79m2ivjsuuqvZndijvjzrp+l3cDrt99G+8y7TOU3Md4l8O7v+BdHu9OuozLux53wfW6jDvlci7vMkp51+tygVXkknK/ap3RHafdh8GKPNxyZX7LlRU976zLrp3gskpnXc71uT6Xcxdcj65m3DDe9bqzLuMGgnGzB9XvC6rT6067c24gVHenXb/rc5ebvegGXM6dcf3ufdUYbDmz2/W4wcCzZi9uujf04KTrcj3upOt2/WGmmv24pR8n3WmXcb16Tr9GlQlUm525hV89VpFTGn+wZ8D1BBlp7bWNdQ764Y012pBvtdjQHW/Umd+sM95osfI/AAAA//8BAAD//5uVuAcAAwAAAAAAAP+1ADIAAAABAAAAAAAAAAAAAAAAAAAAAA==");
}
.d2-42667800 .text-mono-bold {
	font-family: "d2-42667800-font-mono-bold";
}
@font-face {
	font-family: d2-42667800-font-mono-bold;
	src: url("data:application/font-woff;base64,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");
}
.d2-42667800 .text-mono-italic {
	font-family: "d2-42667800-font-mono-italic";
}
@font-face {
	font-family: d2-42667800-font-mono-italic;
	src: url("data:application/font-woff;base64,d09GRgABAAAAACJAAAwAAAAANhgAAQQZAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAABHAAAAGAAAABglO/WomNtYXAAAAF8AAABXgAAAkbDZ1kFZ2FzcAAAAtwAAAAIAAAACAAAABBnbHlmAAAC5AAAGCAAACHE92jp1WhlYWQAABsEAAAANgAAADYa8dmqaGhlYQAAGzwAAAAkAAAAJAbDBItobXR4AAAbYAAAAQgAAAHABo0dzmxvY2EAABxoAAAA4gAAAOIIzAAqbWF4cAAAHUwAAAAgAAAAIACkAmxuYW1lAAAdbAAABKkAAA2O9UFlqnBvc3QAACIYAAAAIAAAACD/rQAzcHJlcAAAIjgAAAAHAAAAB2gGjIUABAJYAZAABQAAAooCWP/xAEsCigJYAEQBXgAyAR4AAAILAwkDBAMJAgQgAAB3AgA4AwAAAAAAAAAAQURCTwCBACD//wPY/u8AAAQkAcZgAAGTAAAAAAHeApQAAAAgAAN4nLTRS1PNDxzH8dfpdvr/RaQikt85nQ6JXEp03Mq15H4JXVQUPQa3jSdgrDwDK2NlY8UTsMG0MM7E2oqNsfkaZ0aTxtbnAbwWnzdSyqVQo6KsgGF9KjVKZGS1apO3SbstOmy1Tafteu2z3wEHHTJoxKgx4yZMuuOue+574KkX5pL6JJ95nHmSHcjOtIlgibv5D3eHwoLbb2iRO/UX91HJnf7lxic5ed261ErkdOjUoFmdVlWqJVpslI7X8Sq+xff4Gl+k42W8j7l4F5/jeTyLh/M98y3Ft8U3xaaPPz7Mll75F0s5ZsAVV+12wimnXXZNv0F9Luixx169Cos+PuyIMaPGHVemXIVKVdKq/ed/y9RYboVaK61SZ7V6DRqtsVaTdc645Kwht63XbEPpid8Vcgsd2peU2GmXLt3Ouei8ScNuGHHSUTdNm3HLlOsmzPITAAD//wEAAP//b55cOQAAAAEAAf//AA94nIR5C3xbZ5Xnd757pSvZetl6y3pYupKu3q9r6cp6P/x+yK80chI7tkmch5O0aRMaWihlmzaF0BZ3WgaaCVvCdlm2lIUZtmFgZlqWKSUzJcPwm5bn7LTDlgwDW7YUb9kp9dX+7r2y64R295dfpCvpe5zz/875n//5jGSoihA240cRgZRIhbqREaFTXe4un5thaIriGDPLcbQLd1XhB/xD0DmRIbnT99zzRTI5tDG0/O/wo5vHufOHDs3/6rVvLt511/lfwY8Qbv0rQvA7vI7UqAuhA8DqacLvZ2i5nCI4zk2Z4eCemWmfTCkn7Sn7t8a10NuJ1zdPwh3pE32Zwxx/39VCASECBRHCNF5HemRHfoRO6dmUyWQ0yOWU0YmFd5pgU5l0n58WH6Sn4L1P1vbFw3WfJ9M7/MFGZu/i3mpj99rNpX3JydGTeN1dSUQGIgpS4Un7RxcjcGedi0Y3N3pKbCqLAE22NnANX0QehAY9fn+6r0SwKZOZ8vtpj4YwGkwmNpXhzBoMmfEjmd7criPF7IyV02f88alyxOQZyzMDvV5rf11VPzNV+sDaTCwTDrr9zOD8SqKwkO7tSRk9RoSRCSEcxeuoAxnanhkNGkwz236Yzp499/HE4n27ms3mh+oHl8t4/dydex5Zy1VmPrm6dBghQAWE8BxeR53CCm5q61/hXnhEzX89BF1q/nUWptV4vfpS7c0aEuZMIYRX8DpS7phDTJ2FT2j4Z6Og0vBvFvB69dUa/0Mkji+2NnAeX0TebTzwu+DB0RxLyOUQaaxxib13T+dnLZyeCyZmyxGzZ7zo7dd771f/Xb93v6p2Zrrx6JkhLhTsZURQcoucRfd0hX/V6RP260YIT2z5xBJuPUvQejfRfbaRBTvXONso86+W8Dr/KzBunoQsfwUBohHCxfYcjtXTnJuiCZaiNZ87+oQW/ljzH9c+r61hdbW6+dsaQhiFEMJreB0pkAqhKlC0niVYIDg9jdf4bHjybGOQhPl/63+6idf5gRfxOv9lmOH/Ls8fljA5gBAm8DqStW2kDpxt3A6Dary++Wc1BEiLEJ7E64Jdp/Ss3sxyohclgqM1mCJoIkYw4pP27H6/nIw8sXjPaINUadRyUmaxdTxQ8QBJEpgkKAU5jdf5H64sQ2jzJNyjj6US+s4Yq+f/DbDCG/YqHbWCnr8dAbIihEfwuhBX0p4lQty1vZP17NQ5n7CgghwaO9u430eSHZ3yQbzO773fkskkjXBg8yR8/qPukaFe/hLCKNjawBy+iPSIQaj5TiYIYUowqRKR7nsnBPj6EmvPTLwvV19K2dMT72PDw1mfwVlKCO9GV0lVPd0o33lsNl55f6N8x/HZeD04vHCY7b8pFhxeOMTmbooh4Vz62ueobnsh7YZpmtBv5Xnf2a+VFvtCE0fLR9O1hcNHJ0YP4HX3UH9hvr+H/z8wPD3VzyKRO1oL2/an//8emD1+xtzObbn8Rn9Soev8Kf/56LGuSeVgysZoNd3pP/CuHBxePJLe8q6wO/7D5iLJZRWyItUh2CbEq7/tp+29PNVzepo++6eCt2Mr6dPZwaX9q6OjS5H6vbvxumsgy832O/hfwk2zQ1yM//te/hkpNn2tDWzFF1FEzFeGE30SVmQYAYFMZjt75XKjwWQ2S0wKssZJT9q1Kxuq+CO+iVCF3ZevrDr6zGNJOu2MuaZcyZ78IVU1HY4mnZzP12eMWhv9qelYNhh2Rhxxuy+hjxuieabUjIt2vA8hfCteR5Tgn5SRz9/+EzXGmp+8H0/W65tfleyttDbEfLeKZ5TuywhRK5om2C180ODWwgGZbLwxLpeVi/5KSjs9MasfOag6ts8StsEd/H3mgL425muOwqP8weVbkuK6dyKEP4DXkQahUwSrN5nMbAlzehb+sjbtIpUkqfP7dN+4ib+E1/lH0ycynskxFxzfPCnMzSCE78EPC5F/SjSAkrJJwGo7r/z+tFjRMoExD5bLMElo9TriTE2PZTI5VnR24HNj313uxqSMsqpvww/zeWc22KFgYgwFqlfM9ZqZEp+/uXkLdDhGzZYRB/+miEnrbYTwXvywEBsHgGDNgvGZDMexhJ5mYlispBQJsrt3DSi6KVLHdNy7+/cf3TUiU2tkpN6r+xjMQ/9TxqzJktd+if8L/r9eVnkZTU/a9LSE+QmE8G34YaQT+LK9fglzHAvUd+Ifmy6qrApSTTPdD8zy34v+HJ7628AejzGb7/lbfuK/C/O7EMJj+GGBb88wbsrNgdnNualTJvikho8q4R/s/O1qeKYjbKrGcNlRjQu53drAQXgDGYToF09aKiQsxxI0R8vljFBGxITERoPppxP7gmPL2b5JA6kvrZQVpH/REmgGotaaJziacRZVS/tqp/f2BdxF3jbGxCuJ2I8Yd3Bwb2JAKHMII6+YB1eQsV25GFqgeYpixQwQko1JlbCQaR45RZlMoEk0zER35aFJxkb4FuONPYHRlWp4OO0o9vnmmYitqgq5ivjKM8c8yYOL1dPNZMVfn08OD6YiP/H3SrjWWxvYBW8g57vVSiyFtEAvQFdW84m5o/2VRVuyZzDhGyvQewbCDY/Lf0SVWBquH2+E++iIx+0pzsSnp/yOPjqC2hjOb/l0HYbvDuJPxiUQx4yEzj+5vo1ixHI9ikzv0jOb2RthBFRubWA1vIEC1/ljNMgp4bglnSLttO2ZprzIRicPcnuWlSR/Zwfs6yWIcoYe6qe9tUhil8fhO6FK7B+onZiJrM1Y+zoK2k5zZ3/NU9qdTg54vT19jrB0fqcQwrfjF5FW0kc7eYsiRBn5n08YTsxGh60+U9LFjqqPn+18CCxqbF9p2o3JLn3/wOa/wBf6ZSVpPV2LEePPg5IidlvMyAmw0dfHowYT1+H4N4UFt9cxEwiPpjpNJL0vPrkQHF3OCMFpKB5Sjx7WBnb5I9aKlxlOuwo/9tg4a09PPn7YE1lqVm7dnRSiFOq7GXBEg99jPP7qTYlaBYFwirgbX0F2iWcodhtfgta34ZVThPehybSOdNbHw5WijCxM5mQk408eTJXxFf6toiPlrHFGxsD/ENx6t87LlLL88wihVgsdaW3AK/g7cj86ihCSo7XXxO9bv24x8HPx+2PS9xkJoyRCeBRfQUqklixigdVioRAlPzGxQkJxkf+q7cm+S9P4Cm8H/KOHPgLA8t8VY//B1gZ8F19BZjFWRB6XNOGOsB/MjhHk6ufUr92GiYDHErXpe+uqakVt1cHLpc1XOk2dPlqjzut0CESDsvAGiiJ0q55tp62ZamfvDQjtfF7JU4Sj6vP4QeUf89JBTI5MDGHc1WVL9AyPjWCs19njjkG4VvMFmUgnGw5G1JZu/gIsqLoVVmMgwH92x6Pom3hO8AbqEVF5z2NaKalIx8Bk5IZTgmsHHKzrXc8IYRRrbeAueAN1Ife2SsFbemCbosQwfKuyLxltrGbLwttBlhnmeodKfuFVlVkuV47PRDLL5fKJ6WjFW5qLD89Jrwi3ft9isXWLe4e30RQ7KJEZKf11XCg7X1YQ/n3sxN76B6Zjkxai2/Wt0FCfwITNQMRWv4q/Ou5lDy7Or98UcB55HOA6JhR4ihVzzSJU0EGuhN8lx67PMJhzE0qVnPQvxce3id9QPP+lnWx19ZImENUz8W3q35wEuJ74Aa0ghMPwBtLvPKst4qBWVspGsmdwKuRO6pzdjCV7K8vCtY8HB4NqVU2lXJ7aFNbgWhsY4A2hTxB4r00Vglz8Aw0lSKi2gtKEZgbNEe9KH1t39gcnhlKzqaFDrrBzjotnSrnoEMMtqkyBnmTA7wtYXBaNtZ6KF50JV9wW8PV6/Aatt4/pqzoRoLHWBu7Fx5FjO5c4uoxZiqVo6rqEYidGZETiwc4/8lbtr6tfTxI4GfRWbFbXHtVkSefs+mW/7Ny50v9UGztjUaOG01ulOpVtbWAfXBPi+Q81l6huhEblclWI44kcIQ/4kgeT5cmVspp01idU9YzJb4Ag/3K3u8vLlDnI8TYhxMW1mwjhIbgmMkhbd4kyDr5980RRoabIrpDpPzX4H8M1/uf0KE2P+MDG2yS7Ygjhm+Ga0HsLcw1ySpqrN8mN0hNBM/5MWuhoqJxqggAg1WbtyUYHxqTGrD499sKKHIBUarQda3CN/2dPhaarHiD5t+kKTZdpcPG2t+iCzxYKWN6S9uxACIfgmqjDOWaH1qLMNOP3i90T1fHLu6ZzSjNFqgLqA3tf/vhsRWntkCktVuXxzX+9pSvZpevT3vL6m+/vTnSrHPbOOxC0XmzF8TBcE7j9umpzHSYa7DYFtBaVU+eMBi3OO8YqlE5OdsW7/8M0/3Rvefz7HQpOrjBEvAn4Bf9675zbPdcLus1r6SGPYLsHIWyBa2Ivz4FQk8FNeRTwIf4FNVxQ8PfBsDoGHyzG+HMlYby+tYGr+CIqbqkHUsp5udgBmcSYZmK4HeFGg4Zsh0Qmw7FyOSWXXx7d2ze7ONtnttnjPcnppGvQ6nJPedlmOt5IZDKp6T3Tqf5ocLcvPmwf9uxKx06pZgezc5UMVw2ZPHSByX/kTMzJKEudcTp17o+q2WayGGMbxWy2Ho6nw57Yyer42UxcrEcEygt6Cp9HeuRrV+136+HaLRwnRrJEa5vFZsySGFrIlppRS2JwIRWssd6uclV4666smnv8NnOPX1W8ZSx/5thconRyLH/72lyiGBreuxLbcyQ4Ir79g9PmjjltvXEBOwYh+B/4w0i1dccgYEKwFKP52vKDHendztzpL6oq8E8publr81sVqRdDCDbweSGPT3FtW+UUs61AhWrGUj5q6RNLCZaLzNLB8NHa9J7Y/F1TdNbxA1Vs6oOre6PxbMIXi+R2j7LLq7cOECDxnLO1gUl8XsiZpshRTtxu9PwMl9quStJmYrEySndnv0vNVEyprnglEB0JM/NjHdMrkWIqMu72BQ7l+6ajjfl6vXRc5Ug6gybG4uwP+tJOyHlLvmjC05PwhDzlaH2vkdCNcuVmVMohA0LYij8s9BMr+kyGE/sTsS9gCSjNyzVywhAw/gweV/OKDnh09m74pj1nNcfNPyux8NjmPcIa5tYGtuEPC5jd4I8QoBQj3lVtOaPBv03NVcyp7mQ1EJ1hawVHPGajx2G/iv95ylFk2OlYaHhB8CFkDpj941yx1KFX90CmdkXdRY/nc/vKbgSo2trAUXxeiK0d+vYGwZ6RrgnkFPdOXYau4v50euF0xV9J6lKWgj/aHInMFBLDgd50L7sUIk3V8UB0MuGp7Fb1Hxk6duk4Z2IsQY89sueB5dlmciocTlszmYIj0UOPFpLNuk/E8TaEcE3C8VSJ4MSmSkNSF8y5idW6ir9fDX/dUVoYSAX073v8/g+VqVoyt3b0to80hFwRtHo3Po9cKIZKW/5kMlx6u2JJQSAVK/22W2LuE6KbMcxIH0GR25tmhhMub2Yhm5iKD+a7Q67ckZ54zsW6PDnaX+KCQ2F7LOfqH2JKKt9IX2I0bSBdpUBmIuCuJCp7naTal/Xl5qJwwDqZ6I2YrQmPmw3yz9vSjD3k7dU5RjMMa0OAIq0NbJHOoLlda7fEiHyrtaA0mL5BG73IlFM61lLwR+ZHwtOFxEjAnXb17Q8R5spEINJI0JWb2OJSX3rhtErA3u0I721jH8oI2DvjPfRYPrW77hNP6ERGiuWvtDZgFH1KqF9SbdxSSv/LTluCVofHElD5ndZwD+O0hHukOftbabgJ/TEyIdRkBJI3t+XO9uSjnSNNRadN4dBZaUvA4vIV116IGpv9uYhSTTssAXM8XDk+Jmh2Yf912CQZVEFDcAjLUUXU8sIe139fFTiy9dvWBqbQOaRCVuS/wWb2PT8ErQ4LY7Q4YpdsdovfZLFvPTjiKrfNyphddl9q50PAJDwgjL7W2oDP4MeRDHUhtKrnWIqgdjAvEP26Gf3skM2d9PS4Er+A+aUl/gsbdA/d57F70pLmfUKwGT+JnILCOiNE6bb6fIev5JRQeXcs/TMf57CFbeFYqOIMe/eX4gN+f95lj/TAwNZu0QprNviCPZ6I182EWVe/P1JOWsyBuGeHBQBOOAT/BX8ZyRCqCpWeAqfRcNg0BIdeXlt7WeqdvgiHsBt/mfSj4QeFHmn4lPR9E6IY4LBcjo6LdzW/Rj/Fu8CBCIQOc26qW4PnNT+tiRzderV1Br7f+rrw2zDnpuxqeEX9Mek39O3WNE7gf0IahAbbqWqWbuRgfrAx9ciq98ID1epXyt+4+QPf/Xwxvrr56NLnykIv0hqGB/GLYnwy0sUeJ+CFR30XP1quJQenn/p6fHXzkZVLFab8jZu/yv9CitG7W0dwHj+HKISaeul+/O4vgVbx0oUXFZ8mFqJv81FxnLZ1BF5oj5Pu0gmt8qXHXlSC7qlPRwkcffsJcdwtrSN4GD+HUm2NKp6gnxZKjyD4xcomHKgoG6TaIzEqS0EmW+0ydumzOVWxbicphZLSNSuHlHPhcodCo+hIRN0OrVEbC850fDoctw2MlA1dTn3K4tX3FiueRn80lgjviyWzFCkL2Cz1karJ6YgKNilbR+CfJZuaXFu3ZMQ2o20fTXPt0isSC+WRokwup5XKuUipQ6lWdCYi4BG2j4ZmOlYlQ/v73zF0d/XT1+1vrUn7tw3VuXYYKtikai3jUfy8EANNYEEF/3uE7/wscejtC+K5gLIlhyn8a+H3wS62C5RDbxG/eNsiYvxsaxk+Jc0dJFg9zD9WfkyaCmgV3YK12CfEzxmGYzgzx1KcmTJTzCc89z1oeiwWs3xR9aXJ0NLtjs+NBNJP/zkXGv+C5TNi/lVbz8Pv8FOIRsM71emOBmcrFp2E0SDn2nG2rQz/oPf5ZbxJh2w1L8M54/ZU1V/yOQP5aMwa95n2Z72RTNbvydHMYCQ67ogZWI87lg65sr7efC7kTziYEG3zOrX2AS5QCKoZTTzkjVu1Dm/EWZv6byF1JBJizYZAOhgseiLukM3t9dBhW3ekPxjuDwgYkgJDYh8+jwhEoU6kbd9d6FmC4NyUjHNTjRfYF9avsFf+RgMXtXxIAxc1+Pzm7cJ/+Pcs+32WFe9FXm1t4FV8nmTQidadMIn96GaEEIVOoHPt3uYoBhxGnQitpuk0m2aNrJE2gvry5dLly0efyz33XO45BOgwuht+gw3S/ah4NuLBPBy6eDH0J38ivt4defzx8KVL4ccfj1ySeAX9NQb4vtyPjqNjSGCXT4p73oGS8Bo+LOTjqi/tM8qMMniNfwBO89+DZHKzsDlxlbyKAB1DSXhZGncm7Uv70jLjMUjy34PTSWHExGZB4l6hPwOsR4TYoaXdRmGwkaKMZnMTnuR3w5Mv3X//S/n8YxeGLtTHo2R07D3m+dIcl2aYtMwozhNmwZP5/GMDY1EyOl6/MCTxTgMAd8AjyIpQ1RPDkpgTokjSd2Ibe68jEWSMWodNlbIN+5zxIGPU2YUPQ4BtHqvGRxuHMjaPVe3zmgYzEg830KdwB2zK/WhZxGtZwqv1ZmsQe+EaCos3HYS83dJutzKUWJqF/pb2+BkNQXXcP1HQ9HKppWRlosNi0neqlSRFgdKk9VsUpL04EHAlNZRKqSD/Al/i/3FgpMBBMXFibZ4j1SqAHJb15V1Jh5FmCmyf1AN3tX6D+zEl9GWDkAYz5Ta6zeDmXwdd4Cr8FV+/qgUlCcrIs5VnhfHu1r9gDmvF8V0UAyxQTBeono20R1nhr64GQMe/HrjK1xEgR+s3eLC9PsO5026GAyOkmat8DZ65yoBOK6wc4X9HSmcwjzh4E34gjF/1cTLggOD08Fv+XgKs/LcjUOjIyzhZXgm5GP9tsBD8vSLGADgHTxNauRzdImL7Y5Dhu2FO4KN62m1k8OdB1mhIe4h3jXDt/3n/ty83SpK5P1Pzo0CE3OaIrdtVUpUKqh4NyEr8ZaVW4fdoVDlNNwJI4En4Mv6O+BfancoFjpo9+t7uHlcQT9qt+t5uu9UREOpwi4G/hGuCKnmH0Tixfsnld8ZGTG4T664OqOdf0UD4oOHQj+06TmcYq8HlEt+5clTKb6m2C/7Npd1CXEM0l5Pi/67WBnwWikj9zq3Jlrhj3ulTjAbTb5L1+FQyVYtPBewJF+20J11eVb2Q25euF/r3ZeLMQDgcYgbCobCwbutV5MCr+ITIXQJbmAW+UHj/0foV69/7HOFnHJ+xvxBGsHUWgm1VhjPDfffWbsO5J5J/+n8BAAD//wEAAP//HT3hSgABAAAAAQQZEPMsol8PPPUAAwPoAAAAANwcc7AAAAAA3ZceoP70/joDMQQkAAIABgACAAAAAAAAAAEAAAPY/u8AAAJY/vT/JwMxA+gAwv/FAAAAAAAAAAAAAABweJxEkL8rwFEUxc87Gyk/IwPlVyKJEgr5yqYw+kwKiZIUEyV/gf/CZrEZTf4Di91isSgL9fS8W4bbud17zzvnHaM1I5n8bjRhtGnUa7RstG20YtRlNGI0aXRg1G7UH/dzgWU/ZrRv1BhdGc2b/GN0atQZt6NG69GvGl0YdcT82OQPo1mj2+rrbz5t8ndw9owWjDaMFo126l6tJr8YDRt1Gy0ZjYenQaMeo77473loTxk9GO3+Y/40ejS6M6nw7qtG8ZXfjJ7D003kcGbUYtRmUsEno8PQaYJTPB4FXhqdRF9qq1b+ioyGjAaMMCmZ/FpzSTORTeFc13dT+gUAAP//AQAA///xNlonAAAAKgAqAE4AiAC8AN4A+AEQAUgBYgF6AZoBqgHkAgwCRgJsAroC6AMsA0ADbAOKA8oD+gQaBDQEbASmBNYFDgVMBXQFvgXuBfoGBgYkBkwGkgbABvIHKgdoB4oHygf6CCgIRgiACKwI3gj2CU4JlAmuCdwKIgpECn4KxgrkC0ALiAuiC8gL1AvgDBgMOgx6DIwMmAygDK4MvAzYDPQNCA0cDWYNsA3ADc4N3A36DmIOhg6WDqoOxA7QDuQO+A8UDzAPXA9oD6oPwg/aD/IQDhAWECQQTBBkEIYQlBDAENQQ4gAAAAEAAABwAfgAKgBxAAYAAQAAAAAAAAAAAAAAAAADAAJ4nJyVz28b1RfFP45Te5ym+eZbSkkKlEcppQ3OxLHaqGoRIv2lGkJSYpcKqiIm9sQZ4l/yjNsG8UewYMWCJRIb/gAWiAXqiiUrViwQKxasWKN35zoet02Ko0r1eXnv3nvuOfe9Aa6m50iTGs8Bj0BxipM8UjzGJH8oTvM2fyseJ59yFR+ilvpYcYazqR8VZ/kp9adih/Nj3yrOcX7sN8WHKaanFB9Jm/Q7iqc4n/lU8SxnMl/FOAUTmR8UpwbcUmNMZ35WnGY686vicSYz/TOHMBnln8qQz04rzlLIvqXYwc02FOcoZr9WPMHF7C+KDydqTSZqHUnUmkrk+V+C83SC8/855owrPsqEM6P4OaacU4qPMekUFD/PtNPneRzHWVH8AhNORfFMgvNsotYJJp1PFL+Y+PtLCQ4vJzicTHB4JcHBJDi8muBwiqPOZ4pfS/A5naj1eoLDGU45Xyh+gyXnG8VnmXH6ep4j7/yleI5Crs/tTU7kbirO4+Y2FM9zMvelYpdi7nvFCxzP/a64wFzuH8WLzEwYxUXyExcVX0hwvi46fIehSIFFChjmdVWU1TI12mzgYyizQ0iET5MQQ4kWVdp06cj/nuzVMJxli4iIDpdYYIEH8s/F283mSmSTBc6Rx/CAgIgtDOv4hPh0ua/ZbtCmRYRhFY+m5WJmKNOmR5cqvpnFTa4xXKVNTdAturQpEeHRIKDKIq50u8RllrnGFda4PBTfj45j54ei969jhs5+KH2EBNKBGaq8RZtIVGhxf3fPZVH3m3hs48upTXweSpUiLhdwWeICS5LrYLwDcdDDEIlzNXHVo8s2hjabB/Y+kE6tlzbuNi1xNt4rC59IHLbVW9RYkHgjfW6JXkYy98TzLoGcdg/E5hYePRoYruFiuKlZ7cRVRFv725NJtLx9WiNMbsQOHXwqbKmeg0kti4YRD0TTgeKxF7ZOqJr0RIW4775qZUqsYFiT/K2hzCtDGWwnT5uyRel3wGy47sD/+3gENPDYoCE7g5voSd1lPhAccQnzmDohVXGoQyQehZLLFQ/qLLDGDVYeY/JsjWryG3u/QW93euLu7NTY+79MWZwvm1kMV2RdoiyK3KFEhZuscZuKrJdZZ51lVqlQ4rrErrEuN3iNVa5JRElwvHdDbsAqH2F4j5Kcsbl91Sd2zN7LjrAPhXs8ywFNOqK5Ze5Kr750OLrDhk3N2o8NJaZKwKacNOJfizo9POo6FR1h2BQt+7MxuHXxRDSlF+vtYL9OW17ertxcm9Wwo2+HndaYU/xCRP/BVfdAM7P3q5Z809blJnrCvK+5Lz0Or+uU5csRYFLvEopeoahplfhcurVvwV0K3NN73aYuL0lHeqzK7O/IKvbrLvP7nPX0feqKPttyfo57T9S2r0pD/tYVZwPqmv0096TPSL2I3zRDi558A7uyG98KXyIW9+XzeKZQe8gLr+s81C/BinCwng2Q/SbX5SW1PN8X7oHwKMsbbO+p7aPGld1fe7bKNnfkxsR5BlX6555W1+z53epPQnJ//hncR802iHz22b11GbXqfpqOmmsvT0bN86SXo2fQyH8BAAD//wEAAP//MIYSVAAAAAADAAD/9QAA/7UAMgAAAAEAAAAAAAAAAAAAAAAAAAAAuAH/hbAEjQA=");
}]]></style><style type="text/css"><![CDATA[.shape {
  shape-rendering: geometricPrecision;
  stroke-linejoin: round;
}
.connection {
  stroke-linecap: round;
  stroke-linejoin: round;
}
.blend {
  mix-blend-mode: multiply;
  opacity: 0.5;
}

		.d2-42667800 .fill-N1{fill:#0A0F25;}
		.d2-42667800 .fill-N2{fill:#676C7E;}
		.d2-42667800 .fill-N3{fill:#9499AB;}
		.d2-42667800 .fill-N4{fill:#CFD2DD;}
		.d2-42667800 .fill-N5{fill:#DEE1EB;}
		.d2-42667800 .fill-N6{fill:#EEF1F8;}
		.d2-42667800 .fill-N7{fill:#FFFFFF;}
		.d2-42667800 .fill-B1{fill:#000E3D;}
		.d2-42667800 .fill-B2{fill:#234CDA;}
		.d2-42667800 .fill-B3{fill:#6B8AFB;}
		.d2-42667800 .fill-B4{fill:#A6B8F8;}
		.d2-42667800 .fill-B5{fill:#D2DBFD;}
		.d2-42667800 .fill-B6{fill:#E7EAFF;}
		.d2-42667800 .fill-AA2{fill:#5829DC;}
		.d2-42667800 .fill-AA4{fill:#B4AEF8;}
		.d2-42667800 .fill-AA5{fill:#E4DBFF;}
		.d2-42667800 .fill-AB4{fill:#7FDBF8;}
		.d2-42667800 .fill-AB5{fill:#C3F0FF;}
		.d2-42667800 .stroke-N1{stroke:#0A0F25;}
		.d2-42667800 .stroke-N2{stroke:#676C7E;}
		.d2-42667800 .stroke-N3{stroke:#9499AB;}
		.d2-42667800 .stroke-N4{stroke:#CFD2DD;}
		.d2-42667800 .stroke-N5{stroke:#DEE1EB;}
		.d2-42667800 .stroke-N6{stroke:#EEF1F8;}
		.d2-42667800 .stroke-N7{stroke:#FFFFFF;}
		.d2-42667800 .stroke-B1{stroke:#000E3D;}
		.d2-42667800 .stroke-B2{stroke:#234CDA;}
		.d2-42667800 .stroke-B3{stroke:#6B8AFB;}
		.d2-42667800 .stroke-B4{stroke:#A6B8F8;}
		.d2-42667800 .stroke-B5{stroke:#D2DBFD;}
		.d2-42667800 .stroke-B6{stroke:#E7EAFF;}
		.d2-42667800 .stroke-AA2{stroke:#5829DC;}
		.d2-42667800 .stroke-AA4{stroke:#B4AEF8;}
		.d2-42667800 .stroke-AA5{stroke:#E4DBFF;}
		.d2-42667800 .stroke-AB4{stroke:#7FDBF8;}
		.d2-42667800 .stroke-AB5{stroke:#C3F0FF;}
		.d2-42667800 .background-color-N1{background-color:#0A0F25;}
		.d2-42667800 .background-color-N2{background-color:#676C7E;}
		.d2-42667800 .background-color-N3{background-color:#9499AB;}
		.d2-42667800 .background-color-N4{background-color:#CFD2DD;}
		.d2-42667800 .background-color-N5{background-color:#DEE1EB;}
		.d2-42667800 .background-color-N6{background-color:#EEF1F8;}
		.d2-42667800 .background-color-N7{background-color:#FFFFFF;}
		.d2-42667800 .background-color-B1{background-color:#000E3D;}
		.d2-42667800 .background-color-B2{background-color:#234CDA;}
		.d2-42667800 .background-color-B3{background-color:#6B8AFB;}
		.d2-42667800 .background-color-B4{background-color:#A6B8F8;}
		.d2-42667800 .background-color-B5{background-color:#D2DBFD;}
		.d2-42667800 .background-color-B6{background-color:#E7EAFF;}
		.d2-42667800 .background-color-AA2{background-color:#5829DC;}
		.d2-42667800 .background-color-AA4{background-color:#B4AEF8;}
		.d2-42667800 .background-color-AA5{background-color:#E4DBFF;}
		.d2-42667800 .background-color-AB4{background-color:#7FDBF8;}
		.d2-42667800 .background-color-AB5{background-color:#C3F0FF;}
		.d2-42667800 .color-N1{color:#0A0F25;}
		.d2-42667800 .color-N2{color:#676C7E;}
		.d2-42667800 .color-N3{color:#9499AB;}
		.d2-42667800 .color-N4{color:#CFD2DD;}
		.d2-42667800 .color-N5{color:#DEE1EB;}
		.d2-42667800 .color-N6{color:#EEF1F8;}
		.d2-42667800 .color-N7{color:#FFFFFF;}
		.d2-42667800 .color-B1{color:#000E3D;}
		.d2-42667800 .color-B2{color:#234CDA;}
		.d2-42667800 .color-B3{color:#6B8AFB;}
		.d2-42667800 .color-B4{color:#A6B8F8;}
		.d2-42667800 .color-B5{color:#D2DBFD;}
		.d2-42667800 .color-B6{color:#E7EAFF;}
		.d2-42667800 .color-AA2{color:#5829DC;}
		.d2-42667800 .color-AA4{color:#B4AEF8;}
		.d2-42667800 .color-AA5{color:#E4DBFF;}
		.d2-42667800 .color-AB4{color:#7FDBF8;}
		.d2-42667800 .color-AB5{color:#C3F0FF;}.appendix text.text{fill:#0A0F25}.md{--color-fg-default:#0A0F25;--color-fg-muted:#676C7E;--color-fg-subtle:#9499AB;--color-canvas-default:#FFFFFF;--color-canvas-subtle:#EEF1F8;--color-border-default:#000E3D;--color-border-muted:#234CDA;--color-neutral-muted:#EEF1F8;--color-accent-fg:#234CDA;--color-accent-emphasis:#234CDA;--color-attention-subtle:#676C7E;--color-danger-fg:red;}.sketch-overlay-B1{fill:url(#streaks-darker-d2-42667800);mix-blend-mode:lighten}.sketch-overlay-B2{fill:url(#streaks-dark-d2-42667800);mix-blend-mode:overlay}.sketch-overlay-B3{fill:url(#streaks-normal-d2-42667800);mix-blend-mode:color-burn}.sketch-overlay-B4{fill:url(#streaks-normal-d2-42667800);mix-blend-mode:color-burn}.sketch-overlay-B5{fill:url(#streaks-normal-d2-42667800);mix-blend-mode:color-burn}.sketch-overlay-B6{fill:url(#streaks-bright-d2-42667800);mix-blend-mode:darken}.sketch-overlay-AA2{fill:url(#streaks-darker-d2-42667800);mix-blend-mode:lighten}.sketch-overlay-AA4{fill:url(#streaks-normal-d2-42667800);mix-blend-mode:color-burn}.sketch-overlay-AA5{fill:url(#streaks-bright-d2-42667800);mix-blend-mode:darken}.sketch-overlay-AB4{fill:url(#streaks-normal-d2-42667800);mix-blend-mode:color-burn}.sketch-overlay-AB5{fill:url(#streaks-bright-d2-42667800);mix-blend-mode:darken}.sketch-overlay-N1{fill:url(#streaks-darker-d2-42667800);mix-blend-mode:lighten}.sketch-overlay-N2{fill:url(#streaks-dark-d2-42667800);mix-blend-mode:overlay}.sketch-overlay-N3{fill:url(#streaks-normal-d2-42667800);mix-blend-mode:color-burn}.sketch-overlay-N4{fill:url(#streaks-normal-d2-42667800);mix-blend-mode:color-burn}.sketch-overlay-N5{fill:url(#streaks-bright-d2-42667800);mix-blend-mode:darken}.sketch-overlay-N6{fill:url(#streaks-bright-d2-42667800);mix-blend-mode:darken}.sketch-overlay-N7{fill:url(#streaks-bright-d2-42667800);mix-blend-mode:darken}.light-code{display: block}.dark-code{display: none}]]></style><style type="text/css">.d2-42667800 .md em,
.d2-42667800 .md dfn {
  font-family: "d2-42667800-font-italic";
}

.d2-42667800 .md b,
.d2-42667800 .md strong {
  font-family: "d2-42667800-font-bold";
}

.d2-42667800 .md code,
.d2-42667800 .md kbd,
.d2-42667800 .md pre,
.d2-42667800 .md samp {
  font-family: "d2-42667800-font-mono";
  font-size: 1em;
}

.d2-42667800 .md {
  tab-size: 4;
}

/* variables are provided in d2renderers/d2svg/d2svg.go */

.d2-42667800 .md {
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  margin: 0;
  background-color: transparent; /* we don't want to define the background color */
  font-family: "d2-42667800-font-regular";
  font-size: 16px;
  line-height: 1.5;
  word-wrap: break-word;
}

.d2-42667800 .md details,
.d2-42667800 .md figcaption,
.d2-42667800 .md figure {
  display: block;
}

.d2-42667800 .md summary {
  display: list-item;
}

.d2-42667800 .md [hidden] {
  display: none !important;
}

.d2-42667800 .md a {
  background-color: transparent;
  color: var(--color-accent-fg);
  text-decoration: none;
}

.d2-42667800 .md a:active,
.d2-42667800 .md a:hover {
  outline-width: 0;
}

.d2-42667800 .md abbr[title] {
  border-bottom: none;
  text-decoration: underline dotted;
}

.d2-42667800 .md dfn {
  font-style: italic;
}

.d2-42667800 .md h1 {
  margin: 0.67em 0;
  padding-bottom: 0.3em;
  font-size: 2em;
  border-bottom: 1px solid var(--color-border-muted);
}

.d2-42667800 .md mark {
  background-color: var(--color-attention-subtle);
  color: var(--color-text-primary);
}

.d2-42667800 .md small {
  font-size: 90%;
}

.d2-42667800 .md sub,
.d2-42667800 .md sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}

.d2-42667800 .md sub {
  bottom: -0.25em;
}

.d2-42667800 .md sup {
  top: -0.5em;
}

.d2-42667800 .md img {
  border-style: none;
  max-width: 100%;
  box-sizing: content-box;
  background-color: var(--color-canvas-default);
}

.d2-42667800 .md figure {
  margin: 1em 40px;
}

.d2-42667800 .md hr {
  box-sizing: content-box;
  overflow: hidden;
  background: transparent;
  border-bottom: 1px solid var(--color-border-muted);
  height: 0.25em;
  padding: 0;
  margin: 24px 0;
  background-color: var(--color-border-default);
  border: 0;
}

.d2-42667800 .md input {
  font: inherit;
  margin: 0;
  overflow: visible;
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

.d2-42667800 .md [type="button"],
.d2-42667800 .md [type="reset"],
.d2-42667800 .md [type="submit"] {
  -webkit-appearance: button;
}

.d2-42667800 .md [type="button"]::-moz-focus-inner,
.d2-42667800 .md [type="reset"]::-moz-focus-inner,
.d2-42667800 .md [type="submit"]::-moz-focus-inner {
  border-style: none;
  padding: 0;
}

.d2-42667800 .md [type="button"]:-moz-focusring,
.d2-42667800 .md [type="reset"]:-moz-focusring,
.d2-42667800 .md [type="submit"]:-moz-focusring {
  outline: 1px dotted ButtonText;
}

.d2-42667800 .md [type="checkbox"],
.d2-42667800 .md [type="radio"] {
  box-sizing: border-box;
  padding: 0;
}

.d2-42667800 .md [type="number"]::-webkit-inner-spin-button,
.d2-42667800 .md [type="number"]::-webkit-outer-spin-button {
  height: auto;
}

.d2-42667800 .md [type="search"] {
  -webkit-appearance: textfield;
  outline-offset: -2px;
}

.d2-42667800 .md [type="search"]::-webkit-search-cancel-button,
.d2-42667800 .md [type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}

.d2-42667800 .md ::-webkit-input-placeholder {
  color: inherit;
  opacity: 0.54;
}

.d2-42667800 .md ::-webkit-file-upload-button {
  -webkit-appearance: button;
  font: inherit;
}

.d2-42667800 .md a:hover {
  text-decoration: underline;
}

.d2-42667800 .md hr::before {
  display: table;
  content: "";
}

.d2-42667800 .md hr::after {
  display: table;
  clear: both;
  content: "";
}

.d2-42667800 .md table {
  border-spacing: 0;
  border-collapse: collapse;
  display: block;
  width: max-content;
  max-width: 100%;
  overflow: auto;
}

.d2-42667800 .md td,
.d2-42667800 .md th {
  padding: 0;
}

.d2-42667800 .md details summary {
  cursor: pointer;
}

.d2-42667800 .md details:not([open]) > *:not(summary) {
  display: none !important;
}

.d2-42667800 .md kbd {
  display: inline-block;
  padding: 3px 5px;
  color: var(--color-fg-default);
  vertical-align: middle;
  background-color: var(--color-canvas-subtle);
  border: solid 1px var(--color-neutral-muted);
  border-bottom-color: var(--color-neutral-muted);
  border-radius: 6px;
  box-shadow: inset 0 -1px 0 var(--color-neutral-muted);
}

.d2-42667800 .md h1,
.d2-42667800 .md h2,
.d2-42667800 .md h3,
.d2-42667800 .md h4,
.d2-42667800 .md h5,
.d2-42667800 .md h6 {
  margin-top: 24px;
  margin-bottom: 16px;
  font-weight: 400;
  line-height: 1.25;
  font-family: "d2-42667800-font-semibold";
}

.d2-42667800 .md h2 {
  padding-bottom: 0.3em;
  font-size: 1.5em;
  border-bottom: 1px solid var(--color-border-muted);
}

.d2-42667800 .md h3 {
  font-size: 1.25em;
}

.d2-42667800 .md h4 {
  font-size: 1em;
}

.d2-42667800 .md h5 {
  font-size: 0.875em;
}

.d2-42667800 .md h6 {
  font-size: 0.85em;
  color: var(--color-fg-muted);
}

.d2-42667800 .md p {
  margin-top: 0;
  margin-bottom: 10px;
}

.d2-42667800 .md blockquote {
  margin: 0;
  padding: 0 1em;
  color: var(--color-fg-muted);
  border-left: 0.25em solid var(--color-border-default);
}

.d2-42667800 .md ul,
.d2-42667800 .md ol {
  margin-top: 0;
  margin-bottom: 0;
  padding-left: 2em;
}

.d2-42667800 .md ol ol,
.d2-42667800 .md ul ol {
  list-style-type: lower-roman;
}

.d2-42667800 .md ul ul ol,
.d2-42667800 .md ul ol ol,
.d2-42667800 .md ol ul ol,
.d2-42667800 .md ol ol ol {
  list-style-type: lower-alpha;
}

.d2-42667800 .md dd {
  margin-left: 0;
}

.d2-42667800 .md pre {
  margin-top: 0;
  margin-bottom: 0;
  word-wrap: normal;
}

.d2-42667800 .md ::placeholder {
  color: var(--color-fg-subtle);
  opacity: 1;
}

.d2-42667800 .md input::-webkit-outer-spin-button,
.d2-42667800 .md input::-webkit-inner-spin-button {
  margin: 0;
  -webkit-appearance: none;
  appearance: none;
}

.d2-42667800 .md::before {
  display: table;
  content: "";
}

.d2-42667800 .md::after {
  display: table;
  clear: both;
  content: "";
}

.d2-42667800 .md > *:first-child {
  margin-top: 0 !important;
}

.d2-42667800 .md > *:last-child {
  margin-bottom: 0 !important;
}

.d2-42667800 .md a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.d2-42667800 .md .absent {
  color: var(--color-danger-fg);
}

.d2-42667800 .md .anchor {
  float: left;
  padding-right: 4px;
  margin-left: -20px;
  line-height: 1;
}

.d2-42667800 .md .anchor:focus {
  outline: none;
}

.d2-42667800 .md p,
.d2-42667800 .md blockquote,
.d2-42667800 .md ul,
.d2-42667800 .md ol,
.d2-42667800 .md dl,
.d2-42667800 .md table,
.d2-42667800 .md pre,
.d2-42667800 .md details {
  margin-top: 0;
  margin-bottom: 16px;
}

.d2-42667800 .md blockquote > :first-child {
  margin-top: 0;
}

.d2-42667800 .md blockquote > :last-child {
  margin-bottom: 0;
}

.d2-42667800 .md sup > a::before {
  content: "[";
}

.d2-42667800 .md sup > a::after {
  content: "]";
}

.d2-42667800 .md h1:hover .anchor,
.d2-42667800 .md h2:hover .anchor,
.d2-42667800 .md h3:hover .anchor,
.d2-42667800 .md h4:hover .anchor,
.d2-42667800 .md h5:hover .anchor,
.d2-42667800 .md h6:hover .anchor {
  text-decoration: none;
}

.d2-42667800 .md h1 tt,
.d2-42667800 .md h1 code,
.d2-42667800 .md h2 tt,
.d2-42667800 .md h2 code,
.d2-42667800 .md h3 tt,
.d2-42667800 .md h3 code,
.d2-42667800 .md h4 tt,
.d2-42667800 .md h4 code,
.d2-42667800 .md h5 tt,
.d2-42667800 .md h5 code,
.d2-42667800 .md h6 tt,
.d2-42667800 .md h6 code {
  padding: 0 0.2em;
  font-size: inherit;
}

.d2-42667800 .md ul.no-list,
.d2-42667800 .md ol.no-list {
  padding: 0;
  list-style-type: none;
}

.d2-42667800 .md ol[type="1"] {
  list-style-type: decimal;
}

.d2-42667800 .md ol[type="a"] {
  list-style-type: lower-alpha;
}

.d2-42667800 .md ol[type="i"] {
  list-style-type: lower-roman;
}

.d2-42667800 .md div > ol:not([type]) {
  list-style-type: decimal;
}

.d2-42667800 .md ul ul,
.d2-42667800 .md ul ol,
.d2-42667800 .md ol ol,
.d2-42667800 .md ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.d2-42667800 .md li > p {
  margin-top: 16px;
}

.d2-42667800 .md li + li {
  margin-top: 0.25em;
}

.d2-42667800 .md dl {
  padding: 0;
}

.d2-42667800 .md dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-family: "d2-42667800-font-semibold";
}

.d2-42667800 .md dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.d2-42667800 .md table th {
  font-family: "d2-42667800-font-semibold";
}

.d2-42667800 .md table th,
.d2-42667800 .md table td {
  padding: 6px 13px;
  border: 1px solid var(--color-border-default);
}

.d2-42667800 .md table tr {
  background-color: var(--color-canvas-default);
  border-top: 1px solid var(--color-border-muted);
}

.d2-42667800 .md table tr:nth-child(2n) {
  background-color: var(--color-canvas-subtle);
}

.d2-42667800 .md table img {
  background-color: transparent;
}

.d2-42667800 .md img[align="right"] {
  padding-left: 20px;
}

.d2-42667800 .md img[align="left"] {
  padding-right: 20px;
}

.d2-42667800 .md span.frame {
  display: block;
  overflow: hidden;
}

.d2-42667800 .md span.frame > span {
  display: block;
  float: left;
  width: auto;
  padding: 7px;
  margin: 13px 0 0;
  overflow: hidden;
  border: 1px solid var(--color-border-default);
}

.d2-42667800 .md span.frame span img {
  display: block;
  float: left;
}

.d2-42667800 .md span.frame span span {
  display: block;
  padding: 5px 0 0;
  clear: both;
  color: var(--color-fg-default);
}

.d2-42667800 .md span.align-center {
  display: block;
  overflow: hidden;
  clear: both;
}

.d2-42667800 .md span.align-center > span {
  display: block;
  margin: 13px auto 0;
  overflow: hidden;
  text-align: center;
}

.d2-42667800 .md span.align-center span img {
  margin: 0 auto;
  text-align: center;
}

.d2-42667800 .md span.align-right {
  display: block;
  overflow: hidden;
  clear: both;
}

.d2-42667800 .md span.align-right > span {
  display: block;
  margin: 13px 0 0;
  overflow: hidden;
  text-align: right;
}

.d2-42667800 .md span.align-right span img {
  margin: 0;
  text-align: right;
}

.d2-42667800 .md span.float-left {
  display: block;
  float: left;
  margin-right: 13px;
  overflow: hidden;
}

.d2-42667800 .md span.float-left span {
  margin: 13px 0 0;
}

.d2-42667800 .md span.float-right {
  display: block;
  float: right;
  margin-left: 13px;
  overflow: hidden;
}

.d2-42667800 .md span.float-right > span {
  display: block;
  margin: 13px auto 0;
  overflow: hidden;
  text-align: right;
}

.d2-42667800 .md code,
.d2-42667800 .md tt {
  padding: 0.2em 0.4em;
  margin: 0;
  font-size: 85%;
  background-color: var(--color-neutral-muted);
  border-radius: 6px;
}

.d2-42667800 .md code br,
.d2-42667800 .md tt br {
  display: none;
}

.d2-42667800 .md del code {
  text-decoration: inherit;
}

.d2-42667800 .md pre code {
  font-size: 100%;
}

.d2-42667800 .md pre > code {
  padding: 0;
  margin: 0;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.d2-42667800 .md .highlight {
  margin-bottom: 16px;
}

.d2-42667800 .md .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.d2-42667800 .md .highlight pre,
.d2-42667800 .md pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: var(--color-canvas-subtle);
  border-radius: 6px;
}

.d2-42667800 .md pre code,
.d2-42667800 .md pre tt {
  display: inline;
  max-width: auto;
  padding: 0;
  margin: 0;
  overflow: visible;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.d2-42667800 .md .csv-data td,
.d2-42667800 .md .csv-data th {
  padding: 5px;
  overflow: hidden;
  font-size: 12px;
  line-height: 1;
  text-align: left;
  white-space: nowrap;
}

.d2-42667800 .md .csv-data .blob-num {
  padding: 10px 8px 9px;
  text-align: right;
  background: var(--color-canvas-default);
  border: 0;
}

.d2-42667800 .md .csv-data tr {
  border-top: 0;
}

.d2-42667800 .md .csv-data th {
  font-family: "d2-42667800-font-semibold";
  background: var(--color-canvas-subtle);
  border-top: 0;
}

.d2-42667800 .md .footnotes {
  font-size: 12px;
  color: var(--color-fg-muted);
  border-top: 1px solid var(--color-border-default);
}

.d2-42667800 .md .footnotes ol {
  padding-left: 16px;
}

.d2-42667800 .md .footnotes li {
  position: relative;
}

.d2-42667800 .md .footnotes li:target::before {
  position: absolute;
  top: -8px;
  right: -8px;
  bottom: -8px;
  left: -24px;
  pointer-events: none;
  content: "";
  border: 2px solid var(--color-accent-emphasis);
  border-radius: 6px;
}

.d2-42667800 .md .footnotes li:target {
  color: var(--color-fg-default);
}

.d2-42667800 .md .task-list-item {
  list-style-type: none;
}

.d2-42667800 .md .task-list-item label {
  font-weight: 400;
}

.d2-42667800 .md .task-list-item.enabled label {
  cursor: pointer;
}

.d2-42667800 .md .task-list-item + .task-list-item {
  margin-top: 3px;
}

.d2-42667800 .md .task-list-item .handle {
  display: none;
}

.d2-42667800 .md .task-list-item-checkbox {
  margin: 0 0.2em 0.25em -1.6em;
  vertical-align: middle;
}

.d2-42667800 .md .contains-task-list:dir(rtl) .task-list-item-checkbox {
  margin: 0 -1.6em 0.25em 0.2em;
}
</style><g class="dGl0bGU="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="8793.000000" y="-99.000000" width="665" height="91"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><h1>HTTP Server (Basic)  Implementation Blueprint</h1>
<p><strong>Language: C</strong> | All 4 Milestones | Socket  Parse  Serve  Concurrent</p>
</div></foreignObject></g></g><g class="TDBfY29uZmln"><g class="shape" ><rect x="12.000000" y="1343.000000" width="3286.000000" height="1090.000000" rx="8.000000" stroke="#6366F1" fill="#EEF2FF" style="stroke-width:2;" /></g><text x="1655.000000" y="1362.000000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:14px">Process Entry &amp; Config</text></g><g class="TDFfbTE="><g class="shape" ><rect x="3595.000000" y="1043.000000" width="4992.000000" height="2535.000000" rx="8.000000" stroke="#F59E0B" fill="#FFF7ED" style="stroke-width:2;" /></g><text x="6091.000000" y="1062.000000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:14px"><tspan x="6091.000000" dy="0.000000">M1: TCP Server &amp; HTTP Response</tspan><tspan x="6091.000000" dy="16.000000">[http-server-basic-m1]</tspan></text></g><g class="TDJfbTI="><g class="shape" ><rect x="8824.000000" y="12.000000" width="1104.000000" height="4597.000000" rx="8.000000" stroke="#22C55E" fill="#F0FDF4" style="stroke-width:2;" /></g><text x="9376.000000" y="31.000000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:14px"><tspan x="9376.000000" dy="0.000000">M2: HTTP Request Parsing</tspan><tspan x="9376.000000" dy="16.000000">[http-server-basic-m2]</tspan></text></g><g class="TDNfbTM="><g class="shape" ><rect x="10160.000000" y="1546.000000" width="3392.000000" height="3866.000000" rx="8.000000" stroke="#F97316" fill="#FFF7ED" style="stroke-width:2;" /></g><text x="11856.000000" y="1565.000000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:14px"><tspan x="11856.000000" dy="0.000000">M3: Static File Serving</tspan><tspan x="11856.000000" dy="16.000000">[http-server-basic-m3]</tspan></text></g><g class="TDRfbTQ="><g class="shape" ><rect x="13840.000000" y="3078.000000" width="4399.000000" height="2776.000000" rx="8.000000" stroke="#8B5CF6" fill="#F5F3FF" style="stroke-width:2;" /></g><text x="16039.500000" y="3097.000000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:14px"><tspan x="16039.500000" dy="0.000000">M4: Concurrent Connections</tspan><tspan x="16039.500000" dy="16.000000">[http-server-basic-m4]</tspan></text></g><g class="aGFyZHdhcmVfbm90ZXM="><g class="shape" ><rect x="1016.000000" y="4187.000000" width="2282.000000" height="336.000000" rx="8.000000" stroke="#94A3B8" fill="#F1F5F9" style="stroke-width:1;" /></g><text x="2157.000000" y="4205.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:13px">Hardware Soul &amp; Scale Indicators</text></g><g class="TDBfY29uZmlnLm1haW5fYw=="><g class="shape" ><rect x="62.000000" y="1393.000000" width="3186.000000" height="625.000000" rx="6.000000" stroke="#000E3D" fill="#DBEAFE" class=" stroke-B1" style="stroke-width:2;" /></g><text x="1655.000000" y="1422.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">main.c  Entry Point</text></g><g class="TDBfY29uZmlnLmNvbnN0YW50cw=="><g class="shape" ><rect x="1347.000000" y="2038.000000" width="615.000000" height="345.000000" rx="6.000000" stroke="#000E3D" fill="#FEF3C7" class=" stroke-B1" style="stroke-width:2;" /></g><text x="1654.500000" y="2067.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">Global Constants</text></g><g class="TDFfbTEuc29ja2V0X2RhbmNl"><g class="shape" ><rect x="3645.000000" y="1093.000000" width="4036.000000" height="820.000000" rx="6.000000" stroke="#000E3D" fill="#FFFBEB" class=" stroke-B1" style="stroke-width:2;" /></g><text x="5663.000000" y="1122.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">socket.c  7-Step Socket Dance</text></g><g class="TDFfbTEuYWNjdW11bGF0b3I="><g class="shape" ><rect x="6331.000000" y="1933.000000" width="1350.000000" height="1107.000000" rx="6.000000" stroke="#000E3D" fill="#FEF2F2" class=" stroke-B1" style="stroke-width:2;" /></g><text x="7006.000000" y="1962.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">utils.c  Partial Read Accumulator</text></g><g class="TDFfbTEucmVzcG9uc2VfYnVpbGRlcg=="><g class="shape" ><rect x="7893.000000" y="2102.000000" width="644.000000" height="769.000000" rx="6.000000" stroke="#000E3D" fill="#F0FDF4" class=" stroke-B1" style="stroke-width:2;" /></g><text x="8215.000000" y="2131.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">http.c  Hardcoded Response Builder</text></g><g class="TDFfbTEuc2lncGlwZQ=="><g class="shape" ><rect x="4740.000000" y="3060.000000" width="1846.000000" height="124.000000" rx="6.000000" stroke="#000E3D" fill="#FFF1F2" class=" stroke-B1" style="stroke-width:2;" /></g><text x="5663.000000" y="3089.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">Signal Safety  SIGPIPE</text></g><g class="TDFfbTEubTFfZXJyb3Jz"><g class="shape" ><rect x="5434.000000" y="3204.000000" width="458.000000" height="324.000000" rx="6.000000" stroke="#000E3D" fill="#F8FAFC" class=" stroke-B1" style="stroke-width:2;" /></g><text x="5663.000000" y="3233.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">M1 Error Matrix</text></g><g class="TDJfbTIuZGF0YV9tb2RlbA=="><g class="shape" ><rect x="9004.000000" y="62.000000" width="744.000000" height="1012.000000" rx="6.000000" stroke="#000E3D" fill="#DCFCE7" class=" stroke-B1" style="stroke-width:2;" /></g><text x="9376.000000" y="91.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">http_types.h  Data Structures</text></g><g class="TDJfbTIucGFyc2VyX2NvcmU="><g class="shape" ><rect x="8874.000000" y="1094.000000" width="1004.000000" height="2337.000000" rx="6.000000" stroke="#000E3D" fill="#F0FDF4" class=" stroke-B1" style="stroke-width:2;" /></g><text x="9376.000000" y="1123.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">http_parser.c  Parsing Logic</text></g><g class="TDJfbTIuZXJyb3JfcmVzcG9uc2Vz"><g class="shape" ><rect x="9063.000000" y="3451.000000" width="625.000000" height="598.000000" rx="6.000000" stroke="#000E3D" fill="#FEF2F2" class=" stroke-B1" style="stroke-width:2;" /></g><text x="9375.500000" y="3480.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">http_errors.c  Error Responses</text></g><g class="TDJfbTIudXJsX2RlY29kZQ=="><g class="shape" ><rect x="9063.000000" y="4069.000000" width="625.000000" height="490.000000" rx="6.000000" stroke="#000E3D" fill="#FFFBEB" class=" stroke-B1" style="stroke-width:2;" /></g><text x="9375.500000" y="4098.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">URL Decode (path_utils.c)</text></g><g class="TDNfbTMucGF0aF9zZWN1cml0eQ=="><g class="shape" ><rect x="10420.000000" y="1596.000000" width="2872.000000" height="1077.000000" rx="6.000000" stroke="#000E3D" fill="#FEF9C3" class=" stroke-B1" style="stroke-width:2;" /></g><text x="11856.000000" y="1625.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">path_utils.c  Security Firewall</text></g><g class="TDNfbTMubWltZV90eXBlcw=="><g class="shape" ><rect x="11516.000000" y="2693.000000" width="680.000000" height="694.000000" rx="6.000000" stroke="#000E3D" fill="#F0F9FF" class=" stroke-B1" style="stroke-width:2;" /></g><text x="11856.000000" y="2722.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">mime_types.h  MIME Lookup Table</text></g><g class="TDNfbTMuY29uZGl0aW9uYWxfY2FjaGU="><g class="shape" ><rect x="11200.000000" y="3407.000000" width="1312.000000" height="555.000000" rx="6.000000" stroke="#000E3D" fill="#F0FDF4" class=" stroke-B1" style="stroke-width:2;" /></g><text x="11856.000000" y="3436.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">date_utils.c  Conditional GETs</text></g><g class="TDNfbTMuZmlsZV9oYW5kbGVy"><g class="shape" ><rect x="10210.000000" y="3982.000000" width="3292.000000" height="962.000000" rx="6.000000" stroke="#000E3D" fill="#FEF2F2" class=" stroke-B1" style="stroke-width:2;" /></g><text x="11856.000000" y="4011.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">file_handler.c  8-Phase Orchestrator</text></g><g class="TDNfbTMubTNfZXJyb3Jz"><g class="shape" ><rect x="11595.000000" y="4964.000000" width="521.000000" height="398.000000" rx="6.000000" stroke="#000E3D" fill="#F8FAFC" class=" stroke-B1" style="stroke-width:2;" /></g><text x="11855.500000" y="4993.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">M3 Error Matrix</text></g><g class="TDRfbTQucG9vbF9kYXRhX21vZGVs"><g class="shape" ><rect x="14097.000000" y="3128.000000" width="1841.000000" height="1078.000000" rx="6.000000" stroke="#000E3D" fill="#EDE9FE" class=" stroke-B1" style="stroke-width:2;" /></g><text x="15017.500000" y="3157.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">concurrency_types.h  Data Structures</text></g><g class="TDRfbTQudGhyZWFkX3Bvb2xfaW1wbA=="><g class="shape" ><rect x="16385.000000" y="3742.000000" width="673.000000" height="1705.000000" rx="6.000000" stroke="#000E3D" fill="#DDD6FE" class=" stroke-B1" style="stroke-width:2;" /></g><text x="16721.500000" y="3771.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">thread_pool.c  Core Implementation</text></g><g class="TDRfbTQua2VlcGFsaXZl"><g class="shape" ><rect x="17294.000000" y="4043.000000" width="895.000000" height="1103.000000" rx="6.000000" stroke="#000E3D" fill="#F3E8FF" class=" stroke-B1" style="stroke-width:2;" /></g><text x="17741.500000" y="4072.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">connection_handler.c  Keep-Alive Loop</text></g><g class="TDRfbTQuc2lnbmFscw=="><g class="shape" ><rect x="13890.000000" y="4226.000000" width="2256.000000" height="738.000000" rx="6.000000" stroke="#000E3D" fill="#FEF3C7" class=" stroke-B1" style="stroke-width:2;" /></g><text x="15018.000000" y="4255.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">signals.c  Dedicated Signal Thread</text></g><g class="TDRfbTQubXV0ZXhfZGlzY2lwbGluZQ=="><g class="shape" ><rect x="14359.000000" y="4984.000000" width="1318.000000" height="332.000000" rx="6.000000" stroke="#000E3D" fill="#FEE2E2" class=" stroke-B1" style="stroke-width:2;" /></g><text x="15018.000000" y="5013.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">Mutex Rules &amp; Lock Ordering</text></g><g class="TDRfbTQucG9vbF9zaXppbmc="><g class="shape" ><rect x="13900.000000" y="5336.000000" width="2236.000000" height="124.000000" rx="6.000000" stroke="#000E3D" fill="#ECFDF5" class=" stroke-B1" style="stroke-width:2;" /></g><text x="15018.000000" y="5365.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">Thread Pool Sizing Formula</text></g><g class="TDRfbTQubTRfZXJyb3Jz"><g class="shape" ><rect x="14666.000000" y="5480.000000" width="703.000000" height="324.000000" rx="6.000000" stroke="#000E3D" fill="#F8FAFC" class=" stroke-B1" style="stroke-width:2;" /></g><text x="15017.500000" y="5509.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:24px">M4 Error Matrix</text></g><g class="aGFyZHdhcmVfbm90ZXMuY2FjaGVfaGllcmFyY2h5"><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="1109.000000" y="4237.000000" width="2095" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Cache Line = 64 bytes</strong> (x86-64)
L1 Cache: 32-64KB, ~1ns  entire HTTP req fits here
L2 Cache: 256-512KB, ~4ns  64KB IO buf fits here
L3 Cache: 8-32MB, ~20ns  page cache metadata
RAM: DDR4 ~20GB/s  100KB file copy  5s
NVMe SSD: ~100s  cold file read latency
Spinning HDD: ~5ms  50,000 slower than L1</p>
</div></foreignObject></g></g><g class="aGFyZHdhcmVfbm90ZXMuc3lzY2FsbF9jb3N0cw=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="1066.000000" y="4281.000000" width="2182" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Syscall overhead:</strong> ~1-2s (mode switch + TLB flush)
realpath(): Nlstat() calls, N=path components  ~10s
read() cached: memcpy kerneluser, ~1ns/byte
write() to socket: fill send buffer (~87KB default)
accept(): TASK_INTERRUPTIBLE sleep  wake on SYN+ACK+ACK
context switch: ~1-5s, saves 80 cache lines of register state</p>
</div></foreignObject></g></g><g class="aGFyZHdhcmVfbm90ZXMuYXRvbWljX29wcw=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="1917.000000" y="4325.000000" width="479" height="148"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>LOCK CMPXCHG</strong> (pthread_mutex on x86):</p>
<ul>
<li>Uncontested: ~20-50 cycles = ~25ns at 2GHz</li>
<li>Contested: futex_wait syscall = ~2-5s</li>
<li>False sharing: two vars in same 64B line  unnecessary invalidation</li>
<li>Solution: <strong>attribute</strong>((aligned(64))) per hot field</li>
</ul>
</div></foreignObject></g></g><g class="TDBfY29uZmlnLm1haW5fYy5jbGlfYXJncw=="><g class="shape" ></g><g transform="translate(1421.000000 1443.000000)" class="light-code"><rect width="467.000000" height="78.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;CLI:&#160;./http_server&#160;[port]&#160;[doc_root]
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;port&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">atoi</tspan>(argv[<tspan fill="#009999">1</tspan>]);&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;default&#160;8080
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>doc_root&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;argv[<tspan fill="#009999">2</tspan>];&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;default&#160;&quot;.&quot;
</tspan></text></g></g><g transform="translate(1421.000000 1443.000000)" class="dark-code"><rect width="467.000000" height="78.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;CLI:&#160;./http_server&#160;[port]&#160;[doc_root]
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">port</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">atoi</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">argv</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;default&#160;8080
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">doc_root</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">argv</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">2</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;default&#160;&quot;.&quot;
</tspan></text></g></g></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcQ=="><g class="shape" ><rect x="112.000000" y="1541.000000" width="3086.000000" height="166.000000" rx="4.000000" stroke="#000E3D" fill="#EFF6FF" class=" stroke-B1" style="stroke-width:2;" /></g><text x="1655.000000" y="1566.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">Startup Sequence</text></g><g class="TDBfY29uZmlnLm1haW5fYy5zZXJ2ZXJfY29uZmlnX3Q="><g class="shape" ><rect x="1352.000000" y="1727.000000" width="606.000000" height="241.000000" rx="4.000000" stroke="#000E3D" fill="#F0FDF4" class=" stroke-B1" style="stroke-width:2;" /></g><text x="1655.000000" y="1752.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">server_config_t [16 bytes]</text></g><g class="TDBfY29uZmlnLmNvbnN0YW50cy52YWxz"><g class="shape" ></g><g transform="translate(1397.000000 2088.000000)" class="light-code"><rect width="515.000000" height="245.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;DEFAULT_PORT&#160;&#160;&#160;&#160;&#160;&#160;&#160;8080</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999999"  class="text-mono-bold text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;BACKLOG&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SOMAXCONN</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999999"  class="text-mono-bold text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;REQUEST_BUF_SIZE&#160;&#160;&#160;8192&#160;&#160;&#160;</tspan><tspan fill="#999988" class="text-mono-italic">//&#160;8KB&#160;&#160;max&#160;URI
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;MAX_RESPONSE_SIZE&#160;&#160;4096&#160;&#160;&#160;</tspan><tspan fill="#999988" class="text-mono-italic">//&#160;4KB&#160;headers
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;POOL_SIZE_DEFAULT&#160;&#160;16&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#999988" class="text-mono-italic">//&#160;worker&#160;threads
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;QUEUE_SIZE_DEFAULT&#160;256&#160;&#160;&#160;&#160;</tspan><tspan fill="#999988" class="text-mono-italic">//&#160;circular&#160;queue
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;IDLE_TIMEOUT_SECS&#160;&#160;30&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#999988" class="text-mono-italic">//&#160;SO_RCVTIMEO
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;MAX_PATH_SIZE&#160;&#160;&#160;&#160;&#160;&#160;4096&#160;&#160;&#160;</tspan><tspan fill="#999988" class="text-mono-italic">//&#160;PATH_MAX
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;IO_BUFFER_SIZE&#160;&#160;&#160;&#160;&#160;65536&#160;&#160;</tspan><tspan fill="#999988" class="text-mono-italic">//&#160;64KB&#160;I/O&#160;chunks
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;MAX_HEADERS&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;32</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#999999"  class="text-mono-bold text-mono-italic"></tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">#</tspan><tspan fill="#999999"  class="text-mono-bold text-mono-italic">define&#160;MAX_HEADER_LEN&#160;&#160;&#160;&#160;&#160;8192</tspan></text></g></g><g transform="translate(1397.000000 2088.000000)" class="dark-code"><rect width="515.000000" height="245.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;DEFAULT_PORT&#160;&#160;&#160;&#160;&#160;&#160;&#160;8080</tspan><tspan fill="#6c7086" class="text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;BACKLOG&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SOMAXCONN</tspan><tspan fill="#6c7086" class="text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;REQUEST_BUF_SIZE&#160;&#160;&#160;8192&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;8KB&#160;&#160;max&#160;URI
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;MAX_RESPONSE_SIZE&#160;&#160;4096&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;4KB&#160;headers
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;POOL_SIZE_DEFAULT&#160;&#160;16&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;worker&#160;threads
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;QUEUE_SIZE_DEFAULT&#160;256&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;circular&#160;queue
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;IDLE_TIMEOUT_SECS&#160;&#160;30&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;SO_RCVTIMEO
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;MAX_PATH_SIZE&#160;&#160;&#160;&#160;&#160;&#160;4096&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;PATH_MAX
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;IO_BUFFER_SIZE&#160;&#160;&#160;&#160;&#160;65536&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;64KB&#160;I/O&#160;chunks
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;MAX_HEADERS&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;32</tspan><tspan fill="#6c7086" class="text-mono-italic">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">#</tspan><tspan fill="#6c7086" class="text-mono-italic">define&#160;MAX_HEADER_LEN&#160;&#160;&#160;&#160;&#160;8192</tspan></text></g></g></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZQ=="><g class="shape" ><rect x="3695.000000" y="1143.000000" width="3936.000000" height="261.000000" rx="4.000000" stroke="#000E3D" fill="#FEF9C3" class=" stroke-B1" style="stroke-width:2;" /></g><text x="5663.000000" y="1168.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">Steps in Order</text></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLmZkX3RhYmxl"><g class="shape" ><rect x="5380.000000" y="1424.000000" width="565.000000" height="439.000000" rx="4.000000" stroke="#000E3D" fill="#ECFDF5" class=" stroke-B1" style="stroke-width:2;" /></g><text x="5662.500000" y="1449.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">Kernel FD Table (per-process)</text></g><g class="TDFfbTEuYWNjdW11bGF0b3IucHJvYmxlbQ=="><g class="shape" ><rect x="6381.000000" y="1983.000000" width="1250.000000" height="124.000000" rx="4.000000" stroke="#000E3D" fill="#FEE2E2" class=" stroke-B1" style="stroke-width:2;" /></g><text x="7006.000000" y="2008.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">TCP Byte Stream Problem</text></g><g class="TDFfbTEuYWNjdW11bGF0b3IuaW1wbA=="><g class="shape" ></g><g transform="translate(6748.000000 2127.000000)" class="light-code"><rect width="515.000000" height="536.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;utils.c
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;Returns&#160;total&#160;bytes&#160;read&#160;on&#160;success
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;Returns&#160;-1&#160;on&#160;error,&#160;disconnect,&#160;or&#160;overflow
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">ssize_t</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">read_http_request</tspan>(
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;client_fd,
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>buf,&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;dest:&#160;stack-alloc&#160;8192B
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;buf_size,&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;8192
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>header_end&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;OUT:&#160;offset&#160;after&#160;\r\n\r\n
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#999988" class="text-mono-italic"></tspan>)&#160;{
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;total&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">while</tspan>&#160;(total&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>&#160;buf_size&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan>&#160;<tspan fill="#009999">1</tspan>)&#160;{
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">ssize_t</tspan>&#160;n&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">read</tspan>(client_fd,
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;buf&#160;<tspan fill="#000000" class="text-mono-bold">+</tspan>&#160;total,
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;buf_size&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan>&#160;<tspan fill="#009999">1</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan>&#160;total);
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(n&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;n;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0=disconnect,-1=err
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;total&#160;<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;n;
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;buf[total]&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\0</tspan><tspan fill="#dd1144">'</tspan>;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;null-term&#160;for&#160;strstr
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>end&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">strstr</tspan>(buf,&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>);
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(end)&#160;{
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>header_end&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">int</tspan>)(end&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan>&#160;buf)&#160;<tspan fill="#000000" class="text-mono-bold">+</tspan>&#160;<tspan fill="#009999">4</tspan>;
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">ssize_t</tspan>)total;
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="29.600000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="30.900000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;buffer&#160;full&#160;=&#160;414
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#999988" class="text-mono-italic"></tspan>}</text></g></g><g transform="translate(6748.000000 2127.000000)" class="dark-code"><rect width="515.000000" height="536.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;utils.c
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Returns&#160;total&#160;bytes&#160;read&#160;on&#160;success
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Returns&#160;-1&#160;on&#160;error,&#160;disconnect,&#160;or&#160;overflow
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">ssize_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">read_http_request</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;dest:&#160;stack-alloc&#160;8192B
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">buf_size</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;8192
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">header_end</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;OUT:&#160;offset&#160;after&#160;\r\n\r\n
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">total</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">while</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">total</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">buf_size</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">ssize_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">read</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">total</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">buf_size</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">total</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0=disconnect,-1=err
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">total</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">total</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\0</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;null-term&#160;for&#160;strstr
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">end</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">strstr</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">end</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">header_end</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">end</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">4</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">ssize_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">total</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;buffer&#160;full&#160;=&#160;414
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDFfbTEuYWNjdW11bGF0b3Iud3JpdGVfYWxs"><g class="shape" ></g><g transform="translate(6748.000000 2683.000000)" class="light-code"><rect width="515.000000" height="307.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;utils.c&#160;&#160;partial&#160;write&#160;protection
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">write_all</tspan>(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;fd,&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>buf,&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;len)&#160;{
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;written&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">while</tspan>&#160;(written&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>&#160;len)&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">ssize_t</tspan>&#160;n&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">write</tspan>(fd,
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;buf&#160;<tspan fill="#000000" class="text-mono-bold">+</tspan>&#160;written,
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;len&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan>&#160;written);
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(n&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;EPIPE&#160;&#160;-1
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;written&#160;<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;n;
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="15.300000em">}
</text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#999988" class="text-mono-italic">//&#160;MSG_NOSIGNAL&#160;alternative&#160;on&#160;Linux:
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;send(fd,&#160;buf,&#160;len,&#160;MSG_NOSIGNAL)
</tspan></text></g></g><g transform="translate(6748.000000 2683.000000)" class="dark-code"><rect width="515.000000" height="307.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;utils.c&#160;&#160;partial&#160;write&#160;protection
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">write_all</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">written</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">while</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">written</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">ssize_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">write</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">written</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">written</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;EPIPE&#160;&#160;-1
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">written</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;MSG_NOSIGNAL&#160;alternative&#160;on&#160;Linux:
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;send(fd,&#160;buf,&#160;len,&#160;MSG_NOSIGNAL)
</tspan></text></g></g></g><g class="TDFfbTEucmVzcG9uc2VfYnVpbGRlci5pbXBs"><g class="shape" ></g><g transform="translate(7943.000000 2152.000000)" class="light-code"><rect width="544.000000" height="473.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;http.c&#160;&#160;build&#160;valid&#160;HTTP/1.1&#160;200&#160;OK
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;Returns:&#160;bytes&#160;in&#160;buf,&#160;or&#160;-1&#160;on&#160;overflow
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">build_hardcoded_response</tspan>(<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>buf,&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;4096B
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;buf_size)&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">time_t</tspan>&#160;now&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">time</tspan>(<tspan fill="#0086b3">NULL</tspan>);
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;tm&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>gmt&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">gmtime</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>now);
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;date[<tspan fill="#009999">64</tspan>];
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;RFC&#160;1123&#160;format:&#160;&quot;Sat,&#160;28&#160;Feb&#160;2026&#160;12:00:00&#160;GMT&quot;
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">strftime</tspan>(date,&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(date),
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">%a,&#160;%d&#160;%b&#160;%Y&#160;%H:%M:%S&#160;GMT</tspan><tspan fill="#dd1144">&quot;</tspan>,&#160;gmt);
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>body&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;</tspan><tspan fill="#dd1144">&quot;</tspan>;
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;blen&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">int</tspan>)<tspan fill="#990000" class="text-mono-bold">strlen</tspan>(body);
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">snprintf</tspan>(buf,&#160;buf_size,
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">HTTP/1.1&#160;200&#160;OK</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Content-Type:&#160;text/html;&#160;charset=utf-8</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Content-Length:&#160;%d</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Date:&#160;%s</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Connection:&#160;close</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">%s</tspan><tspan fill="#dd1144">&quot;</tspan>,
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;&#160;&#160;blen,&#160;date,&#160;body);
</text><text class="text-mono" x="0" y="28.300000em">}</text></g></g><g transform="translate(7943.000000 2152.000000)" class="dark-code"><rect width="544.000000" height="473.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;http.c&#160;&#160;build&#160;valid&#160;HTTP/1.1&#160;200&#160;OK
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Returns:&#160;bytes&#160;in&#160;buf,&#160;or&#160;-1&#160;on&#160;overflow
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">build_hardcoded_response</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;4096B
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">buf_size</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">time_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">now</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">time</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb">NULL</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">tm</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">gmt</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">gmtime</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">now</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">date</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">64</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;RFC&#160;1123&#160;format:&#160;&quot;Sat,&#160;28&#160;Feb&#160;2026&#160;12:00:00&#160;GMT&quot;
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">strftime</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">date</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">date</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">%a,&#160;%d&#160;%b&#160;%Y&#160;%H:%M:%S&#160;GMT</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">gmt</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">body</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">blen</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89b4fa">strlen</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">body</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">snprintf</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">buf_size</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">HTTP/1.1&#160;200&#160;OK</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Content-Type:&#160;text/html;&#160;charset=utf-8</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Content-Length:&#160;%d</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Date:&#160;%s</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Connection:&#160;close</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">%s</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">blen</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">date</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">body</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDFfbTEucmVzcG9uc2VfYnVpbGRlci5oZWFkZXJzX2V4cGxhaW5lZA=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="8017.000000" y="2645.000000" width="396" height="176"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Required headers (RFC 7231):</strong></p>
<ul>
<li><code>Content-Type</code>  browser needs this to render</li>
<li><code>Content-Length</code>  client knows when body ends</li>
<li><code>Date</code>  required by HTTP/1.1 7.1.1.2</li>
<li><code>Connection: close</code>  no keep-alive in M1</li>
<li>Blank line <code>\r\n</code>  mandatory header/body separator</li>
</ul>
</div></foreignObject></g></g><g class="TDFfbTEuc2lncGlwZS50eHQ="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="4790.000000" y="3110.000000" width="1746" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Problem:</strong> Client disconnects mid-write.
1st write() succeeds (kernel doesn't know yet).
2nd write()  kernel delivers <strong>SIGPIPE</strong>  default
handler <strong>kills the process</strong>.
<strong>Fix at startup:</strong>
<code>signal(SIGPIPE, SIG_IGN);</code>
Now write() returns -1, errno=EPIPE. Check and close.</p>
</div></foreignObject></g></g><g class="TDFfbTEubTFfZXJyb3JzLnRibA=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="5484.000000" y="3254.000000" width="358" height="224"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><table>
<thead>
<tr>
<th>errno</th>
<th>syscall</th>
<th>Recovery</th>
</tr>
</thead>
<tbody>
<tr>
<td>EADDRINUSE</td>
<td>bind()</td>
<td>exit(1)</td>
</tr>
<tr>
<td>EINTR</td>
<td>accept()</td>
<td>continue loop</td>
</tr>
<tr>
<td>EMFILE</td>
<td>accept()</td>
<td>sleep(1)+continue</td>
</tr>
<tr>
<td>EPIPE</td>
<td>write()</td>
<td>close(client_fd)</td>
</tr>
<tr>
<td>buffer full</td>
<td>read loop</td>
<td>close, no response</td>
</tr>
</tbody>
</table>
</div></foreignObject></g></g><g class="TDJfbTIuZGF0YV9tb2RlbC5oZWFkZXJfc3RydWN0"><g class="shape" ><rect x="9073.000000" y="112.000000" width="606.000000" height="199.000000" rx="4.000000" stroke="#000E3D" fill="#F0FDF4" class=" stroke-B1" style="stroke-width:2;" /></g><text x="9376.000000" y="137.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">http_header_t [8448 bytes each]</text></g><g class="TDJfbTIuZGF0YV9tb2RlbC5yZXF1ZXN0X3N0cnVjdA=="><g class="shape" ><rect x="9054.000000" y="331.000000" width="644.000000" height="532.000000" rx="4.000000" stroke="#000E3D" fill="#ECFDF5" class=" stroke-B1" style="stroke-width:2;" /></g><text x="9376.000000" y="356.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">http_request_t [~278 KB stack alloc]</text></g><g class="TDJfbTIuZGF0YV9tb2RlbC5tZXRob2RfZW51bQ=="><g class="shape" ></g><g transform="translate(9267.000000 883.000000)" class="light-code"><rect width="218.000000" height="141.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">enum</tspan>&#160;{
</text><text class="text-mono" x="0" y="2.300000em">&#160;&#160;METHOD_GET&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>,
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;METHOD_HEAD&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">1</tspan>,
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;METHOD_POST&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">2</tspan>,
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;METHOD_UNKNOWN&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">3</tspan>
</text><text class="text-mono" x="0" y="7.500000em">}&#160;<tspan fill="#445588" class="text-mono-bold">http_method_t</tspan>;</text></g></g><g transform="translate(9267.000000 883.000000)" class="dark-code"><rect width="218.000000" height="141.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">enum</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">METHOD_GET</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">METHOD_HEAD</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">METHOD_POST</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">2</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">METHOD_UNKNOWN</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">3</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">http_method_t</tspan><tspan fill="#cdd6f4">;</tspan></text></g></g></g><g class="TDJfbTIucGFyc2VyX2NvcmUuc3RhdGVz"><g class="shape" ><rect x="8924.000000" y="1144.000000" width="904.000000" height="124.000000" rx="4.000000" stroke="#000E3D" fill="#DCFCE7" class=" stroke-B1" style="stroke-width:2;" /></g><text x="9376.000000" y="1169.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">Parser State Machine</text></g><g class="TDJfbTIucGFyc2VyX2NvcmUucGFyc2VfcmVxdWVzdF9saW5l"><g class="shape" ></g><g transform="translate(9108.000000 1288.000000)" class="light-code"><rect width="535.000000" height="536.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;http_parser.c
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;Returns:&#160;0=OK,&#160;400=bad,&#160;414=URI&#160;long,&#160;501=method
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">parse_request_line</tspan>(<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>line,
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">http_request_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>req)&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;&quot;METHOD&#160;SP&#160;URI&#160;SP&#160;HTTP/1.X&quot;
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>path_start&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">strchr</tspan>(line,&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">&#160;</tspan><tspan fill="#dd1144">'</tspan>);
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">!</tspan>path_start)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">400</tspan>;
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;method_len&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;path_start&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan>&#160;line;
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;path_start<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>;
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>ver_start&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">strchr</tspan>(path_start,&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">&#160;</tspan><tspan fill="#dd1144">'</tspan>);
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">!</tspan>ver_start)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">400</tspan>;
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;path_len&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;ver_start&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan>&#160;path_start;
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;ver_start<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>;
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;method:&#160;memcmp&#160;not&#160;strcmp&#160;(bounded,&#160;fast)
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>method&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">parse_method</tspan>(line,&#160;method_len);
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>method&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;METHOD_UNKNOWN)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">501</tspan>;
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(path_len&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">400</tspan>;
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(path_len&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;MAX_PATH_LEN)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">414</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;8192B
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">memcpy</tspan>(req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>path,&#160;path_start,&#160;path_len);
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;&#160;&#160;req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>path[path_len]&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\0</tspan><tspan fill="#dd1144">'</tspan>;
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>http_minor&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">parse_http_version</tspan>(ver_start,
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">strlen</tspan>(ver_start));
</text><text class="text-mono" x="0" y="29.600000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>http_minor&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">400</tspan>;
</text><text class="text-mono" x="0" y="30.900000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="32.200000em">}</text></g></g><g transform="translate(9108.000000 1288.000000)" class="dark-code"><rect width="535.000000" height="536.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;http_parser.c
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Returns:&#160;0=OK,&#160;400=bad,&#160;414=URI&#160;long,&#160;501=method
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">parse_request_line</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">line</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">http_request_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&quot;METHOD&#160;SP&#160;URI&#160;SP&#160;HTTP/1.X&quot;
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">path_start</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">strchr</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">line</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">&#160;</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">path_start</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">400</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">method_len</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">path_start</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">line</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">path_start</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">ver_start</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">strchr</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">path_start</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">&#160;</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">ver_start</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">400</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">path_len</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">ver_start</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">path_start</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">ver_start</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;method:&#160;memcmp&#160;not&#160;strcmp&#160;(bounded,&#160;fast)
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">method</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">parse_method</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">line</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">method_len</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">method</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">METHOD_UNKNOWN</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">501</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">path_len</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">400</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">path_len</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">MAX_PATH_LEN</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">414</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;8192B
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">memcpy</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">path</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">path_start</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">path_len</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">path</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">path_len</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\0</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">http_minor</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">parse_http_version</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">ver_start</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">strlen</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">ver_start</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">http_minor</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">400</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDJfbTIucGFyc2VyX2NvcmUucGFyc2VfaGVhZGVyX2xpbmU="><g class="shape" ></g><g transform="translate(9099.000000 1844.000000)" class="light-code"><rect width="554.000000" height="411.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;http_parser.c&#160;&#160;one&#160;header&#160;line&#160;&quot;Name:&#160;Value\r\n&quot;
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;Returns:&#160;0=OK,&#160;-1=malformed(skip),&#160;-2=too&#160;many
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">parse_header_line</tspan>(<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>line,
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">http_request_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>req)&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>header_count&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;MAX_HEADERS)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">2</tspan>;
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>colon&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">strchr</tspan>(line,&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">:</tspan><tspan fill="#dd1144">'</tspan>);
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">!</tspan>colon)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;name_len&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;colon&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan>&#160;line;
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(name_len&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan>
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;name_len&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>headers[<tspan fill="#009999">0</tspan>].name))
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">http_header_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>h&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>headers[req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>header_count];
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">memcpy</tspan>(h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>name,&#160;line,&#160;name_len);
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>name[name_len]&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\0</tspan><tspan fill="#dd1144">'</tspan>;
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">str_to_lower</tspan>(h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>name);&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;'A'|0x20&#160;&#160;'a'&#160;trick
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">strip_ows</tspan>(colon<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">1</tspan>,&#160;h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>value,&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(h<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>value));
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>header_count<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>;
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="24.400000em">}</text></g></g><g transform="translate(9099.000000 1844.000000)" class="dark-code"><rect width="554.000000" height="411.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;http_parser.c&#160;&#160;one&#160;header&#160;line&#160;&quot;Name:&#160;Value\r\n&quot;
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Returns:&#160;0=OK,&#160;-1=malformed(skip),&#160;-2=too&#160;many
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">parse_header_line</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">line</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">http_request_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">header_count</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">MAX_HEADERS</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">2</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">colon</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">strchr</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">line</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">:</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">colon</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">name_len</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">colon</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">line</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">name_len</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">name_len</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">headers</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">name</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">http_header_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">headers</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">header_count</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">memcpy</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">name</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">line</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">name_len</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">name</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">name_len</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\0</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">str_to_lower</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">name</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;'A'|0x20&#160;&#160;'a'&#160;trick
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">strip_ows</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">colon</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">value</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">h</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">value</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">header_count</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDJfbTIucGFyc2VyX2NvcmUuaGVscGVycw=="><g class="shape" ></g><g transform="translate(9128.000000 2275.000000)" class="light-code"><rect width="496.000000" height="369.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Case&#160;normalization&#160;&#160;ASCII&#160;only,&#160;no&#160;locale
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#000000" class="text-mono-bold">static</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">str_to_lower</tspan>(<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>s)&#160;{
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">for</tspan>&#160;(;&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>s;&#160;<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>s)
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">*</tspan>s&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">A</tspan><tspan fill="#dd1144">'</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>s&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">Z</tspan><tspan fill="#dd1144">'</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>s&#160;<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0x20</tspan>;
</text><text class="text-mono" x="0" y="6.200000em">}
</text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#999988" class="text-mono-italic">//&#160;OWS&#160;strip:&#160;RFC&#160;7230&#160;3.2.6
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;&quot;&#160;&#160;value&#160;&#160;&quot;&#160;&#160;&quot;value&quot;
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#000000" class="text-mono-bold">static</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">strip_ows</tspan>(<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>s,&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>out,
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;out_size)&#160;{
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">while</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">*</tspan>s&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">&#160;</tspan><tspan fill="#dd1144">'</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>s&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\t</tspan><tspan fill="#dd1144">'</tspan>)&#160;s<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>;
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;len&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">strlen</tspan>(s);
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">while</tspan>&#160;(len&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan>&#160;<tspan fill="#009999">0</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan>
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(s[len<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>]<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">&#160;</tspan><tspan fill="#dd1144">'</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan>s[len<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>]<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\t</tspan><tspan fill="#dd1144">'</tspan>))&#160;len<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">-</tspan>;
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(len&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;out_size)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">memcpy</tspan>(out,&#160;s,&#160;len);&#160;out[len]&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\0</tspan><tspan fill="#dd1144">'</tspan>;
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="21.800000em">}</text></g></g><g transform="translate(9128.000000 2275.000000)" class="dark-code"><rect width="496.000000" height="369.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;Case&#160;normalization&#160;&#160;ASCII&#160;only,&#160;no&#160;locale
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cba6f7">static</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">str_to_lower</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">for</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">A</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">Z</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0x20</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;OWS&#160;strip:&#160;RFC&#160;7230&#160;3.2.6
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&quot;&#160;&#160;value&#160;&#160;&quot;&#160;&#160;&quot;value&quot;
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cba6f7">static</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">strip_ows</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">out</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">out_size</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">while</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">&#160;</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\t</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">strlen</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">while</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">&#160;</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\t</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">out_size</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">memcpy</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">out</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">out</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\0</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDJfbTIucGFyc2VyX2NvcmUuc2VtYW50aWNfZXh0cmFjdA=="><g class="shape" ></g><g transform="translate(9089.000000 2664.000000)" class="light-code"><rect width="573.000000" height="473.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;After&#160;all&#160;headers&#160;parsed,&#160;extract&#160;control&#160;fields
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">extract_semantic_headers</tspan>(<tspan fill="#445588" class="text-mono-bold">http_request_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>req)&#160;{
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;Content-Length:&#160;use&#160;strtol&#160;not&#160;atoi&#160;(error&#160;detect)
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>cl&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">request_get_header</tspan>(req,
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">content-length</tspan><tspan fill="#dd1144">&quot;</tspan>);
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(cl)&#160;{
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>end;
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">long</tspan>&#160;v&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">strtol</tspan>(cl,&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>end,&#160;<tspan fill="#009999">10</tspan>);
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>content_length&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(<tspan fill="#000000" class="text-mono-bold">*</tspan>end<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\0</tspan><tspan fill="#dd1144">'</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan>&#160;v<tspan fill="#000000" class="text-mono-bold">&gt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan>&#160;v<tspan fill="#000000" class="text-mono-bold">&lt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>(<tspan fill="#009999">64</tspan><tspan fill="#000000" class="text-mono-bold">&lt;</tspan><tspan fill="#000000" class="text-mono-bold">&lt;</tspan><tspan fill="#009999">20</tspan>))&#160;<tspan fill="#000000" class="text-mono-bold">?</tspan>
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(<tspan fill="#445588" class="text-mono-bold">int</tspan>)<tspan fill="#990000" class="text-mono-bold">v</tspan>&#160;:&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;max&#160;64MB
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;}&#160;<tspan fill="#000000" class="text-mono-bold">else</tspan>&#160;req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>content_length&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;Connection:&#160;keep-alive&#160;semantics
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>conn&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">request_get_header</tspan>(req,
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">connection</tspan><tspan fill="#dd1144">&quot;</tspan>);
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>http_minor&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">1</tspan>)&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;HTTP/1.1&#160;default=ka
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>keep_alive&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">!</tspan>conn&#160;<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan>
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">strcasecmp</tspan>(conn,<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">close</tspan><tspan fill="#dd1144">&quot;</tspan>)<tspan fill="#000000" class="text-mono-bold">!</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">?</tspan>&#160;<tspan fill="#009999">1</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">:</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">else</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;HTTP/1.0&#160;default=close
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>keep_alive&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;(conn&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan>
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">strcasecmp</tspan>(conn,<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">keep-alive</tspan><tspan fill="#dd1144">&quot;</tspan>)<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">?</tspan>&#160;<tspan fill="#009999">1</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">:</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="28.300000em">}</text></g></g><g transform="translate(9089.000000 2664.000000)" class="dark-code"><rect width="573.000000" height="473.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;After&#160;all&#160;headers&#160;parsed,&#160;extract&#160;control&#160;fields
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">extract_semantic_headers</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">http_request_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Content-Length:&#160;use&#160;strtol&#160;not&#160;atoi&#160;(error&#160;detect)
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">cl</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">request_get_header</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">content-length</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">cl</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">end</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">long</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">v</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">strtol</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">cl</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">end</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">10</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">content_length</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">end</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\0</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">v</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">v</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#fab387">64</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#fab387">20</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">?</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89dceb">v</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">:</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;max&#160;64MB
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">content_length</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Connection:&#160;keep-alive&#160;semantics
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">request_get_header</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">connection</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">http_minor</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;HTTP/1.1&#160;default=ka
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">keep_alive</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">strcasecmp</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">close</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">?</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">:</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;HTTP/1.0&#160;default=close
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">keep_alive</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">strcasecmp</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">conn</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">keep-alive</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">?</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">:</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDJfbTIucGFyc2VyX2NvcmUubG9va3Vw"><g class="shape" ></g><g transform="translate(9128.000000 3157.000000)" class="light-code"><rect width="496.000000" height="224.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;O(N)&#160;linear&#160;search&#160;&#160;N32,&#160;all&#160;in&#160;L1&#160;cache
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;name&#160;MUST&#160;be&#160;already&#160;lowercase
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan><tspan fill="#990000" class="text-mono-bold">request_get_header</tspan>(
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">http_request_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>req,
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>name)&#160;{
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">for</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;i<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>;&#160;i<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>header_count;&#160;i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>)
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#990000" class="text-mono-bold">strcmp</tspan>(req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>headers[i].name,&#160;name)<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>)
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;req<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>headers[i].value;
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#0086b3">NULL</tspan>;
</text><text class="text-mono" x="0" y="12.700000em">}</text></g></g><g transform="translate(9128.000000 3157.000000)" class="dark-code"><rect width="496.000000" height="224.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;O(N)&#160;linear&#160;search&#160;&#160;N32,&#160;all&#160;in&#160;L1&#160;cache
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;name&#160;MUST&#160;be&#160;already&#160;lowercase
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#89b4fa">request_get_header</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">http_request_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">name</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">for</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">header_count</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89b4fa">strcmp</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">headers</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">name</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">name</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">headers</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">value</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">NULL</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDJfbTIuZXJyb3JfcmVzcG9uc2VzLmltcGw="><g class="shape" ></g><g transform="translate(9113.000000 3501.000000)" class="light-code"><rect width="525.000000" height="328.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">send_error_response</tspan>(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;client_fd,
</text><text class="text-mono" x="0" y="2.300000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;status,&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>reason,
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>body)&#160;{
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;buf[<tspan fill="#009999">2048</tspan>];
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;blen&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">int</tspan>)<tspan fill="#990000" class="text-mono-bold">strlen</tspan>(body);
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;must&#160;include:&#160;Date,&#160;Content-Length,&#160;Connection
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">snprintf</tspan>(buf,&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(buf),
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">HTTP/1.1&#160;%d&#160;%s</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Content-Type:&#160;text/html;&#160;charset=utf-8</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Content-Length:&#160;%d</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Connection:&#160;close</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">\r</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">%s</tspan><tspan fill="#dd1144">&quot;</tspan>,
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;&#160;&#160;status,&#160;reason,&#160;blen,&#160;body);
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">write_all</tspan>(client_fd,&#160;buf,&#160;<tspan fill="#990000" class="text-mono-bold">strlen</tspan>(buf));
</text><text class="text-mono" x="0" y="17.900000em">}
</text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Convenience:&#160;send_400(),&#160;send_414(),&#160;send_501()
</tspan></text></g></g><g transform="translate(9113.000000 3501.000000)" class="dark-code"><rect width="525.000000" height="328.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">send_error_response</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">status</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">reason</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">body</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">2048</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">blen</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89b4fa">strlen</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">body</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;must&#160;include:&#160;Date,&#160;Content-Length,&#160;Connection
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">snprintf</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">HTTP/1.1&#160;%d&#160;%s</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Content-Type:&#160;text/html;&#160;charset=utf-8</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Content-Length:&#160;%d</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Connection:&#160;close</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#89b4fa">\r</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">%s</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">status</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">reason</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">blen</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">body</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">write_all</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">strlen</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">buf</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Convenience:&#160;send_400(),&#160;send_414(),&#160;send_501()
</tspan></text></g></g></g><g class="TDJfbTIuZXJyb3JfcmVzcG9uc2VzLmNvZGVz"><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="9158.000000" y="3849.000000" width="435" height="150"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><table>
<thead>
<tr>
<th>Code</th>
<th>Trigger</th>
<th>RFC</th>
</tr>
</thead>
<tbody>
<tr>
<td>400</td>
<td>Bad request line, no Host (1.1)</td>
<td>RFC 7230 3.1</td>
</tr>
<tr>
<td>414</td>
<td>URI &gt; 8192 bytes</td>
<td>RFC 7231 6.5.12</td>
</tr>
<tr>
<td>501</td>
<td>Valid but unsupported method</td>
<td>RFC 7231 6.6.2</td>
</tr>
</tbody>
</table>
</div></foreignObject></g></g><g class="TDJfbTIudXJsX2RlY29kZS5pbXBs"><g class="shape" ></g><g transform="translate(9113.000000 4119.000000)" class="light-code"><rect width="525.000000" height="390.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Converts&#160;%XX&#160;hex&#160;sequences&#160;to&#160;raw&#160;bytes
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;Returns&#160;0=OK,&#160;-1=malformed&#160;or&#160;%00&#160;(null&#160;injection)
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">url_decode</tspan>(<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>src,&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>out,
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;out_size)&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;i<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>,&#160;j<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">while</tspan>&#160;(src[i]&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan>&#160;j<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">1</tspan><tspan fill="#000000" class="text-mono-bold">&lt;</tspan>out_size)&#160;{
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(src[i]<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">%</tspan><tspan fill="#dd1144">'</tspan>)&#160;{
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">!</tspan>src[i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">1</tspan>]<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">!</tspan>src[i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">2</tspan>])&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;hex[<tspan fill="#009999">3</tspan>]<tspan fill="#000000" class="text-mono-bold">=</tspan>{src[i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">1</tspan>],src[i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">2</tspan>],<tspan fill="#009999">0</tspan>};
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>end;
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">long</tspan>&#160;v&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">strtol</tspan>(hex,&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>end,&#160;<tspan fill="#009999">16</tspan>);
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">*</tspan>end<tspan fill="#000000" class="text-mono-bold">!</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\0</tspan><tspan fill="#dd1144">'</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;bad&#160;hex
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(v<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;%00&#160;null&#160;inject!
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;out[j<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>]<tspan fill="#000000" class="text-mono-bold">=</tspan>(<tspan fill="#445588" class="text-mono-bold">char</tspan>)v;&#160;i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">3</tspan>;
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}&#160;<tspan fill="#000000" class="text-mono-bold">else</tspan>&#160;{&#160;out[j<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>]<tspan fill="#000000" class="text-mono-bold">=</tspan>src[i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>];&#160;}
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;out[j]<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\0</tspan><tspan fill="#dd1144">'</tspan>;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="23.100000em">}</text></g></g><g transform="translate(9113.000000 4119.000000)" class="dark-code"><rect width="525.000000" height="390.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;Converts&#160;%XX&#160;hex&#160;sequences&#160;to&#160;raw&#160;bytes
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Returns&#160;0=OK,&#160;-1=malformed&#160;or&#160;%00&#160;(null&#160;injection)
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">url_decode</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">src</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">out</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">out_size</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">while</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">src</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">1</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">out_size</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">src</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">%</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">src</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">src</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">2</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">hex</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">3</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">src</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">src</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">2</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">end</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">long</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">v</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">strtol</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">hex</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">end</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">16</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">end</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\0</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;bad&#160;hex
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">v</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;%00&#160;null&#160;inject!
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">out</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">v</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">3</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">out</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">src</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">out</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\0</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDNfbTMucGF0aF9zZWN1cml0eS5hdHRhY2tfdmVjdG9ycw=="><g class="shape" ><rect x="11462.000000" y="1646.000000" width="788.000000" height="236.000000" rx="4.000000" stroke="#000E3D" fill="#FEF3C7" class=" stroke-B1" style="stroke-width:2;" /></g><text x="11856.000000" y="1671.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">5 Traversal Attack Vectors</text></g><g class="TDNfbTMucGF0aF9zZWN1cml0eS5zYWZlX2FsZ29yaXRobQ=="><g class="shape" ><rect x="10470.000000" y="1902.000000" width="2772.000000" height="124.000000" rx="4.000000" stroke="#000E3D" fill="#ECFDF5" class=" stroke-B1" style="stroke-width:2;" /></g><text x="11856.000000" y="1927.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">The ONLY Safe Algorithm</text></g><g class="TDNfbTMucGF0aF9zZWN1cml0eS5pbXBs"><g class="shape" ></g><g transform="translate(11569.000000 2046.000000)" class="light-code"><rect width="573.000000" height="577.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;path_utils.c
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;Returns:&#160;0=safe&#160;path&#160;in&#160;resolved_out
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;400=bad&#160;encoding,&#160;403=traversal,&#160;404=missing
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">resolve_safe_path</tspan>(
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>url_path,
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>canonical_root,&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;pre-computed&#160;at&#160;startup
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>resolved_out&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;PATH_MAX=4096&#160;bytes
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#999988" class="text-mono-italic"></tspan>)&#160;{
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;decoded[MAX_PATH_SIZE];
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#990000" class="text-mono-bold">url_decode</tspan>(url_path,&#160;decoded,
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(decoded))&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">400</tspan>;
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;raw[MAX_PATH_SIZE&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>&#160;<tspan fill="#009999">2</tspan>];
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">snprintf</tspan>(raw,&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(raw),&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">%s%s</tspan><tspan fill="#dd1144">&quot;</tspan>,
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;canonical_root,&#160;decoded);
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>canon&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">realpath</tspan>(raw,&#160;resolved_out);
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">!</tspan>canon)&#160;{
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(errno<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>ENOENT)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">404</tspan>;
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(errno<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>EACCES)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">403</tspan>;
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">404</tspan>;
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;root_len&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">strlen</tspan>(canonical_root);
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#990000" class="text-mono-bold">strncmp</tspan>(resolved_out,&#160;canonical_root,
</text><text class="text-mono" x="0" y="29.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;root_len)&#160;<tspan fill="#000000" class="text-mono-bold">!</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">403</tspan>;
</text><text class="text-mono" x="0" y="30.900000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;next&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;resolved_out[root_len];
</text><text class="text-mono" x="0" y="32.200000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(next&#160;<tspan fill="#000000" class="text-mono-bold">!</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">\0</tspan><tspan fill="#dd1144">'</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan>&#160;next&#160;<tspan fill="#000000" class="text-mono-bold">!</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">'</tspan><tspan fill="#dd1144">/</tspan><tspan fill="#dd1144">'</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">403</tspan>;
</text><text class="text-mono" x="0" y="33.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;path&#160;is&#160;safe
</tspan></text><text class="text-mono" x="0" y="34.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan>}</text></g></g><g transform="translate(11569.000000 2046.000000)" class="dark-code"><rect width="573.000000" height="577.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;path_utils.c
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Returns:&#160;0=safe&#160;path&#160;in&#160;resolved_out
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;400=bad&#160;encoding,&#160;403=traversal,&#160;404=missing
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">resolve_safe_path</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">url_path</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">canonical_root</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;pre-computed&#160;at&#160;startup
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">resolved_out</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;PATH_MAX=4096&#160;bytes
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">decoded</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">MAX_PATH_SIZE</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89b4fa">url_decode</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">url_path</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">decoded</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">decoded</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">400</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">raw</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">MAX_PATH_SIZE</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">2</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">snprintf</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">raw</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">raw</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">%s%s</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">canonical_root</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">decoded</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">canon</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">realpath</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">raw</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">resolved_out</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">canon</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">errno</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">ENOENT</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">404</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">errno</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">EACCES</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">403</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">404</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">root_len</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">strlen</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">canonical_root</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89b4fa">strncmp</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">resolved_out</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">canonical_root</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">root_len</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">403</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">next</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">resolved_out</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">root_len</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">next</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">\0</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">next</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#a6e3a1">/</tspan><tspan fill="#a6e3a1">'</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">403</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="33.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;path&#160;is&#160;safe
</tspan></text><text class="text-mono" x="0" y="34.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDNfbTMubWltZV90eXBlcy50YWJsZQ=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="11566.000000" y="2743.000000" width="580" height="594"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><table>
<thead>
<tr>
<th>Extension</th>
<th>MIME Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>.html/.htm</td>
<td>text/html; charset=utf-8</td>
</tr>
<tr>
<td>.css</td>
<td>text/css</td>
</tr>
<tr>
<td>.js</td>
<td>application/javascript</td>
</tr>
<tr>
<td>.json</td>
<td>application/json</td>
</tr>
<tr>
<td>.png</td>
<td>image/png</td>
</tr>
<tr>
<td>.jpg/.jpeg</td>
<td>image/jpeg</td>
</tr>
<tr>
<td>.gif</td>
<td>image/gif</td>
</tr>
<tr>
<td>.svg</td>
<td>image/svg+xml</td>
</tr>
<tr>
<td>.txt</td>
<td>text/plain; charset=utf-8</td>
</tr>
<tr>
<td>.pdf</td>
<td>application/pdf</td>
</tr>
<tr>
<td>.ico</td>
<td>image/x-icon</td>
</tr>
<tr>
<td>.webp</td>
<td>image/webp</td>
</tr>
<tr>
<td>(unknown)</td>
<td>application/octet-stream</td>
</tr>
<tr>
<td>Lookup: strrchr(path,'.')  lowercase ext  linear scan</td>
<td></td>
</tr>
<tr>
<td>15 entries  16B struct = 240B  fits in 4 cache lines</td>
<td></td>
</tr>
</tbody>
</table>
</div></foreignObject></g></g><g class="TDNfbTMuY29uZGl0aW9uYWxfY2FjaGUuaW1wbA=="><g class="shape" ></g><g transform="translate(11588.000000 3457.000000)" class="light-code"><rect width="535.000000" height="411.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;MUST&#160;use&#160;timegm()&#160;not&#160;mktime()&#160;&#160;HTTP&#160;dates&#160;are&#160;UTC
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">time_t</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">parse_http_date</tspan>(<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>s)&#160;{
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;tm&#160;tm&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;{<tspan fill="#009999">0</tspan>};
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">!</tspan><tspan fill="#990000" class="text-mono-bold">strptime</tspan>(s,
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">%a,&#160;%d&#160;%b&#160;%Y&#160;%H:%M:%S&#160;GMT</tspan><tspan fill="#dd1144">&quot;</tspan>,&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>tm))
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">time_t</tspan>)<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">timegm</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>tm);&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;UTC,&#160;not&#160;local&#160;timezone
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#999988" class="text-mono-italic"></tspan>}
</text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Returns&#160;1&#160;if&#160;304&#160;should&#160;be&#160;sent
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">should_send_304</tspan>(<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">http_request_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>req,
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">time_t</tspan>&#160;file_mtime)&#160;{
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>ims&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">request_get_header</tspan>(req,&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">if-modified-since</tspan><tspan fill="#dd1144">&quot;</tspan>);
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">!</tspan>ims)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">time_t</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">client_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">parse_http_date</tspan>(ims);
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">client_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">time_t</tspan>)<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;&lt;=&#160;not&#160;&lt;&#160;:&#160;1-second&#160;HTTP-date&#160;resolution
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;(file_mtime&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">client_t</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">?</tspan>&#160;<tspan fill="#009999">1</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">:</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="24.400000em">}</text></g></g><g transform="translate(11588.000000 3457.000000)" class="dark-code"><rect width="535.000000" height="411.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;MUST&#160;use&#160;timegm()&#160;not&#160;mktime()&#160;&#160;HTTP&#160;dates&#160;are&#160;UTC
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">time_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">parse_http_date</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">tm</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">tm</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#89b4fa">strptime</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">s</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">%a,&#160;%d&#160;%b&#160;%Y&#160;%H:%M:%S&#160;GMT</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">tm</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">time_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">timegm</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">tm</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;UTC,&#160;not&#160;local&#160;timezone
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Returns&#160;1&#160;if&#160;304&#160;should&#160;be&#160;sent
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">should_send_304</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">http_request_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">time_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">file_mtime</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">ims</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">request_get_header</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">if-modified-since</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">ims</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">time_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">client_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">parse_http_date</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">ims</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">client_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">time_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&lt;=&#160;not&#160;&lt;&#160;:&#160;1-second&#160;HTTP-date&#160;resolution
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">file_mtime</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">client_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">?</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">:</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDNfbTMuY29uZGl0aW9uYWxfY2FjaGUuZmxvdw=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="11250.000000" y="3888.000000" width="1212" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Caching flow:</strong>
Client  <code>If-Modified-Since: &lt;timestamp&gt;</code>
Server stat()  st_mtime
st_mtime  client_t  <code>304 Not Modified</code> (no body)
st_mtime &gt; client_t  <code>200 OK</code> + full file</p>
</div></foreignObject></g></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcw=="><g class="shape" ><rect x="10260.000000" y="4032.000000" width="3192.000000" height="166.000000" rx="4.000000" stroke="#000E3D" fill="#FFF1F2" class=" stroke-B1" style="stroke-width:2;" /></g><text x="11856.000000" y="4057.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">serve_static_file()  8 Phases</text></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLmlvX2xvb3A="><g class="shape" ></g><g transform="translate(11584.000000 4218.000000)" class="light-code"><rect width="544.000000" height="328.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;file_handler.c&#160;&#160;64KB&#160;I/O&#160;transfer&#160;loop
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;WHY&#160;64KB:&#160;16&#160;pages&#160;&#160;4KB,&#160;fits&#160;L2&#160;cache&#160;(256-512KB)
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;2&#160;syscalls&#160;per&#160;64KB&#160;(read+write)&#160;amortized
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;~800&#160;MB/s&#160;on&#160;page-cached&#160;files
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;io_buf[<tspan fill="#009999">65536</tspan>]&#160;<tspan fill="#990000" class="text-mono-bold">__attribute__</tspan>((<tspan fill="#990000" class="text-mono-bold">aligned</tspan>(<tspan fill="#009999">64</tspan>)));
</text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#999988" class="text-mono-italic">//&#160;aligned(64):&#160;1&#160;cache&#160;line&#160;boundary&#160;per&#160;chunk&#160;start
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">ssize_t</tspan>&#160;n;
</text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#000000" class="text-mono-bold">while</tspan>&#160;((n&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">read</tspan>(file_fd,&#160;io_buf,
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(io_buf)))&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;{
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#990000" class="text-mono-bold">write_all</tspan>(client_fd,&#160;io_buf,&#160;n)&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>&#160;<tspan fill="#009999">0</tspan>)
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">break</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;client&#160;disconnected&#160;(EPIPE)
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan>}
</text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#990000" class="text-mono-bold">close</tspan>(file_fd);&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;MANDATORY&#160;on&#160;all&#160;exit&#160;paths
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;sendfile()&#160;optimization:&#160;0&#160;copies,&#160;DMA&#160;direct
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;sendfile(client_fd,&#160;file_fd,&#160;NULL,&#160;file_size)
</tspan></text></g></g><g transform="translate(11584.000000 4218.000000)" class="dark-code"><rect width="544.000000" height="328.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;file_handler.c&#160;&#160;64KB&#160;I/O&#160;transfer&#160;loop
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;WHY&#160;64KB:&#160;16&#160;pages&#160;&#160;4KB,&#160;fits&#160;L2&#160;cache&#160;(256-512KB)
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;2&#160;syscalls&#160;per&#160;64KB&#160;(read+write)&#160;amortized
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;~800&#160;MB/s&#160;on&#160;page-cached&#160;files
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">io_buf</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">65536</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">__attribute__</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89b4fa">aligned</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#fab387">64</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;aligned(64):&#160;1&#160;cache&#160;line&#160;boundary&#160;per&#160;chunk&#160;start
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">ssize_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cba6f7">while</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">read</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">file_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">io_buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">io_buf</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89b4fa">write_all</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">io_buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">break</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;client&#160;disconnected&#160;(EPIPE)
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#89b4fa">close</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">file_fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;MANDATORY&#160;on&#160;all&#160;exit&#160;paths
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;sendfile()&#160;optimization:&#160;0&#160;copies,&#160;DMA&#160;direct
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;sendfile(client_fd,&#160;file_fd,&#160;NULL,&#160;file_size)
</tspan></text></g></g></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLmRpcmVjdG9yeV9pbmRleA=="><g class="shape" ></g><g transform="translate(11612.000000 4566.000000)" class="light-code"><rect width="487.000000" height="328.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;handle_directory_path()
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;Returns:&#160;0=regular&#160;file,&#160;1=index.html&#160;found,
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;-1=no&#160;index.html&#160;(403),&#160;-2=stat&#160;err
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">handle_directory_path</tspan>(<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>path,
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;path_buf,
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;stat&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>st)&#160;{
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">!</tspan><tspan fill="#990000" class="text-mono-bold">S_ISDIR</tspan>(st<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>st_mode))&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">size_t</tspan>&#160;len&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">strlen</tspan>(path);
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;append&#160;/index.html&#160;(max&#160;11&#160;bytes)
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(len<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">12</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan>&#160;path_buf)&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">strncat</tspan>(path,&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">/index.html</tspan><tspan fill="#dd1144">&quot;</tspan>,&#160;path_buf<tspan fill="#000000" class="text-mono-bold">-</tspan>len<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>);
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#990000" class="text-mono-bold">stat</tspan>(path,&#160;st)&#160;<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>&#160;<tspan fill="#009999">0</tspan>)
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;(errno<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>ENOENT)&#160;<tspan fill="#000000" class="text-mono-bold">?</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">:</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">2</tspan>;
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="19.200000em">}</text></g></g><g transform="translate(11612.000000 4566.000000)" class="dark-code"><rect width="487.000000" height="328.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;handle_directory_path()
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Returns:&#160;0=regular&#160;file,&#160;1=index.html&#160;found,
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;-1=no&#160;index.html&#160;(403),&#160;-2=stat&#160;err
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">handle_directory_path</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">path</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">path_buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">stat</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">st</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#89b4fa">S_ISDIR</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">st</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">st_mode</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">strlen</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">path</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;append&#160;/index.html&#160;(max&#160;11&#160;bytes)
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">12</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">path_buf</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">strncat</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">path</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">/index.html</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">path_buf</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">len</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89b4fa">stat</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">path</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">st</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">errno</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">ENOENT</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">?</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">:</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">2</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDNfbTMubTNfZXJyb3JzLnRibA=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="11645.000000" y="5014.000000" width="421" height="298"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><table>
<thead>
<tr>
<th>Condition</th>
<th>Detected By</th>
<th>Response</th>
</tr>
</thead>
<tbody>
<tr>
<td>%00 in URL</td>
<td>url_decode</td>
<td>400</td>
</tr>
<tr>
<td>../traversal</td>
<td>realpath+strncmp</td>
<td>403</td>
</tr>
<tr>
<td>symlink outside root</td>
<td>realpath</td>
<td>403</td>
</tr>
<tr>
<td>file not found</td>
<td>realpath ENOENT</td>
<td>404</td>
</tr>
<tr>
<td>no index.html</td>
<td>stat ENOENT</td>
<td>403</td>
</tr>
<tr>
<td>device file</td>
<td>S_ISREG</td>
<td>403</td>
</tr>
<tr>
<td>client quit mid-file</td>
<td>write_all -1</td>
<td>close file_fd</td>
</tr>
</tbody>
</table>
</div></foreignObject></g></g><g class="TDRfbTQucG9vbF9kYXRhX21vZGVsLndvcmtfaXRlbQ=="><g class="shape" ><rect x="14715.000000" y="3178.000000" width="606.000000" height="199.000000" rx="4.000000" stroke="#000E3D" fill="#F5F3FF" class=" stroke-B1" style="stroke-width:2;" /></g><text x="15018.000000" y="3203.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">work_item_t [8 bytes]</text></g><g class="TDRfbTQucG9vbF9kYXRhX21vZGVsLnBvb2xfc3RydWN0"><g class="shape" ><rect x="14705.000000" y="3397.000000" width="625.000000" height="615.000000" rx="4.000000" stroke="#000E3D" fill="#EDE9FE" class=" stroke-B1" style="stroke-width:2;" /></g><text x="15017.500000" y="3422.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">thread_pool_t [~256 bytes + heap]</text></g><g class="TDRfbTQucG9vbF9kYXRhX21vZGVsLnF1ZXVlX3Zpeg=="><g class="shape" ><rect x="14147.000000" y="4032.000000" width="1741.000000" height="124.000000" rx="4.000000" stroke="#000E3D" fill="#F3F4F6" class=" stroke-B1" style="stroke-width:2;" /></g><text x="15017.500000" y="4057.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">Circular Buffer State</text></g><g class="TDRfbTQudGhyZWFkX3Bvb2xfaW1wbC5pbml0"><g class="shape" ></g><g transform="translate(16435.000000 3792.000000)" class="light-code"><rect width="573.000000" height="577.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;thread_pool.c
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">thread_pool_init</tspan>(<tspan fill="#445588" class="text-mono-bold">thread_pool_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>pool,
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;num_threads,&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;queue_cap,
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>root,&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;timeout)&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">memset</tspan>(pool,&#160;<tspan fill="#009999">0</tspan>,&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(<tspan fill="#000000" class="text-mono-bold">*</tspan>pool));
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">calloc</tspan>(queue_cap,<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(<tspan fill="#445588" class="text-mono-bold">work_item_t</tspan>));
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_capacity&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;queue_cap;
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>num_threads&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;num_threads;
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>doc_root&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;root;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;read-only
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>idle_timeout&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;timeout;
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_mutex_init</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock,&#160;<tspan fill="#0086b3">NULL</tspan>);
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_cond_init</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>not_empty,&#160;<tspan fill="#0086b3">NULL</tspan>);
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_cond_init</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>not_full,&#160;<tspan fill="#0086b3">NULL</tspan>);
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>threads&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">calloc</tspan>(num_threads,<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(<tspan fill="#445588" class="text-mono-bold">pthread_t</tspan>));
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">for</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;i<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>;&#160;i<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>num_threads;&#160;i<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>)&#160;{
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#990000" class="text-mono-bold">pthread_create</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>threads[i],&#160;<tspan fill="#0086b3">NULL</tspan>,
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;worker_thread_fn,&#160;pool)&#160;<tspan fill="#000000" class="text-mono-bold">!</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">0</tspan>)&#160;{
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;partial&#160;creation:&#160;shutdown&#160;already-created
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>shutdown&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_cond_broadcast</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>not_empty);
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">for</tspan>&#160;(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;j<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>;j<tspan fill="#000000" class="text-mono-bold">&lt;</tspan>i;j<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>)
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_join</tspan>(pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>threads[j],&#160;<tspan fill="#0086b3">NULL</tspan>);
</text><text class="text-mono" x="0" y="29.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="30.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="32.200000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="33.500000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="34.800000em">}</text></g></g><g transform="translate(16435.000000 3792.000000)" class="dark-code"><rect width="573.000000" height="577.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;thread_pool.c
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">thread_pool_init</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">thread_pool_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">num_threads</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">queue_cap</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">root</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">timeout</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">memset</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">calloc</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">queue_cap</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">work_item_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_capacity</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">queue_cap</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">num_threads</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">num_threads</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">doc_root</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">root</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;read-only
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">idle_timeout</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">timeout</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_mutex_init</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">NULL</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_cond_init</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">not_empty</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">NULL</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_cond_init</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">not_full</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">NULL</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">threads</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">calloc</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">num_threads</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">pthread_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">for</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">num_threads</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89b4fa">pthread_create</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">threads</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">NULL</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">worker_thread_fn</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;partial&#160;creation:&#160;shutdown&#160;already-created
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">shutdown</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_cond_broadcast</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">not_empty</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">for</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#cdd6f4">i</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_join</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">threads</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">j</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">NULL</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="33.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="34.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDRfbTQudGhyZWFkX3Bvb2xfaW1wbC53b3JrZXJfbG9vcA=="><g class="shape" ></g><g transform="translate(16440.000000 4389.000000)" class="light-code"><rect width="563.000000" height="598.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Worker&#160;thread&#160;&#160;runs&#160;forever&#160;until&#160;shutdown
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#000000" class="text-mono-bold">static</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan><tspan fill="#990000" class="text-mono-bold">worker_thread_fn</tspan>(<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>arg)&#160;{
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">thread_pool_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>pool&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;arg;
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">for</tspan>&#160;(;;)&#160;{
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_mutex_lock</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock);
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;WHILE&#160;not&#160;IF:&#160;handles&#160;spurious&#160;wakeups
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">while</tspan>&#160;(pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_size<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">!</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>shutdown)
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_cond_wait</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>not_empty,
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock);
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>shutdown&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan><tspan fill="#000000" class="text-mono-bold">&amp;</tspan>&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_size<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#009999">0</tspan>)&#160;{
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_mutex_unlock</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock);
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#0086b3">NULL</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;exit&#160;cleanly
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;Dequeue
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">work_item_t</tspan>&#160;item&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue[pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_head];
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_head&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_head<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">1</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">%</tspan>&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_capacity;
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_size<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">-</tspan>;
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>active_conns<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>;
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_cond_signal</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>not_full);
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_mutex_unlock</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock);
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;&#160;I/O&#160;OUTSIDE&#160;lock&#160;&#160;critical&#160;discipline
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">handle_connection</tspan>(item.client_fd,&#160;pool);
</text><text class="text-mono" x="0" y="30.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_mutex_lock</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock);
</text><text class="text-mono" x="0" y="32.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>active_conns<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">-</tspan>;
</text><text class="text-mono" x="0" y="33.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_mutex_unlock</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock);
</text><text class="text-mono" x="0" y="34.800000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="36.100000em">}</text></g></g><g transform="translate(16440.000000 4389.000000)" class="dark-code"><rect width="563.000000" height="598.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;Worker&#160;thread&#160;&#160;runs&#160;forever&#160;until&#160;shutdown
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cba6f7">static</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#89b4fa">worker_thread_fn</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">arg</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">thread_pool_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">arg</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">for</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_mutex_lock</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;WHILE&#160;not&#160;IF:&#160;handles&#160;spurious&#160;wakeups
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">while</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_size</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">shutdown</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_cond_wait</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">not_empty</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">shutdown</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_size</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_mutex_unlock</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">NULL</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;exit&#160;cleanly
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Dequeue
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">work_item_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">item</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_head</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_head</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_head</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">%</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_capacity</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_size</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">active_conns</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_cond_signal</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">not_full</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_mutex_unlock</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&#160;I/O&#160;OUTSIDE&#160;lock&#160;&#160;critical&#160;discipline
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">handle_connection</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">item</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_mutex_lock</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">active_conns</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="33.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_mutex_unlock</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="34.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="36.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDRfbTQudGhyZWFkX3Bvb2xfaW1wbC5zdWJtaXQ="><g class="shape" ></g><g transform="translate(16468.000000 5007.000000)" class="light-code"><rect width="506.000000" height="390.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Returns&#160;0=queued,&#160;-1=full&#160;or&#160;shutdown&#160;&#160;send&#160;503
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">thread_pool_submit</tspan>(<tspan fill="#445588" class="text-mono-bold">thread_pool_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>pool,
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;client_fd)&#160;{
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_mutex_lock</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock);
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>shutdown&#160;<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan>
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_size&#160;<tspan fill="#000000" class="text-mono-bold">&gt;</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_capacity)&#160;{
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_mutex_unlock</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock);
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue[pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_tail]&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>
</text><text class="text-mono" x="0" y="14.000000em">&#160;&#160;&#160;&#160;&#160;&#160;(<tspan fill="#445588" class="text-mono-bold">work_item_t</tspan>){.client_fd&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;client_fd};
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_tail&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;&#160;&#160;(pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_tail<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#009999">1</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">%</tspan>&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_capacity;
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>queue_size<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>;
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_cond_signal</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>not_empty);
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_mutex_unlock</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock);
</text><text class="text-mono" x="0" y="21.800000em">&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#009999">0</tspan>;
</text><text class="text-mono" x="0" y="23.100000em">}</text></g></g><g transform="translate(16468.000000 5007.000000)" class="dark-code"><rect width="506.000000" height="390.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;Returns&#160;0=queued,&#160;-1=full&#160;or&#160;shutdown&#160;&#160;send&#160;503
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">thread_pool_submit</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">thread_pool_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_mutex_lock</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">shutdown</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_size</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_capacity</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_mutex_unlock</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_tail</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">work_item_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_tail</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_tail</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">%</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_capacity</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">queue_size</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_cond_signal</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">not_empty</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_mutex_unlock</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDRfbTQua2VlcGFsaXZlLnRpbWVvdXRfc2V0dXA="><g class="shape" ></g><g transform="translate(17479.000000 4093.000000)" class="light-code"><rect width="525.000000" height="141.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Set&#160;recv&#160;timeout&#160;ONCE&#160;per&#160;connection&#160;(before&#160;loop)
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;SO_RCVTIMEO:&#160;read()&#160;returns&#160;EAGAIN&#160;after&#160;30s&#160;idle
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;&#160;breaks&#160;keep-alive&#160;loop&#160;&#160;close&#160;&#160;thread&#160;freed
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;timeval&#160;tv&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;{.tv_sec&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>idle_timeout};
</text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#990000" class="text-mono-bold">setsockopt</tspan>(client_fd,&#160;SOL_SOCKET,&#160;SO_RCVTIMEO,
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>tv,&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(tv));</text></g></g><g transform="translate(17479.000000 4093.000000)" class="dark-code"><rect width="525.000000" height="141.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;Set&#160;recv&#160;timeout&#160;ONCE&#160;per&#160;connection&#160;(before&#160;loop)
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;SO_RCVTIMEO:&#160;read()&#160;returns&#160;EAGAIN&#160;after&#160;30s&#160;idle
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&#160;breaks&#160;keep-alive&#160;loop&#160;&#160;close&#160;&#160;thread&#160;freed
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">timeval</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">tv</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">tv_sec</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">idle_timeout</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#89b4fa">setsockopt</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">SOL_SOCKET</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">SO_RCVTIMEO</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">tv</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">tv</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan></text></g></g></g><g class="TDRfbTQua2VlcGFsaXZlLmxvb3A="><g class="shape" ></g><g transform="translate(17474.000000 4254.000000)" class="light-code"><rect width="535.000000" height="702.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;handle_connection()&#160;&#160;called&#160;by&#160;worker&#160;thread
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">handle_connection</tspan>(<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;client_fd,
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">thread_pool_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>pool)&#160;{
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;set&#160;SO_RCVTIMEO&#160;once&#160;here&#160;(30s)
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">for</tspan>&#160;(;;)&#160;{&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;keep-alive&#160;loop
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;req_buf[REQUEST_BUF_SIZE];&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;8192B&#160;stack
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;header_end&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">ssize_t</tspan>&#160;n&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">read_http_request</tspan>(client_fd,
</text><text class="text-mono" x="0" y="11.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;req_buf,&#160;REQUEST_BUF_SIZE,&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>header_end);
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(n<tspan fill="#000000" class="text-mono-bold">&lt;</tspan><tspan fill="#009999">0</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan>&#160;header_end<tspan fill="#000000" class="text-mono-bold">&lt;</tspan><tspan fill="#009999">0</tspan>)&#160;<tspan fill="#000000" class="text-mono-bold">break</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;timeout/err
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">http_request_t</tspan>&#160;req;
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;err&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">parse_http_request</tspan>(req_buf,
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;(<tspan fill="#445588" class="text-mono-bold">size_t</tspan>)n,&#160;header_end,&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>req);
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(err)&#160;{&#160;<tspan fill="#990000" class="text-mono-bold">send_error_by_code</tspan>(client_fd,err);
</text><text class="text-mono" x="0" y="19.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">break</tspan>;&#160;}
</text><text class="text-mono" x="0" y="20.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;update&#160;stats&#160;(brief&#160;lock)
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_mutex_lock</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock);
</text><text class="text-mono" x="0" y="23.100000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>total_reqs<tspan fill="#000000" class="text-mono-bold">+</tspan><tspan fill="#000000" class="text-mono-bold">+</tspan>;
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_mutex_unlock</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock);
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(req.method<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>METHOD_GET&#160;<tspan fill="#000000" class="text-mono-bold">|</tspan><tspan fill="#000000" class="text-mono-bold">|</tspan>
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;req.method<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>METHOD_HEAD)
</text><text class="text-mono" x="0" y="28.300000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">serve_static_file</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>req,&#160;client_fd,
</text><text class="text-mono" x="0" y="29.600000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>doc_root);
</text><text class="text-mono" x="0" y="30.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">else</tspan>&#160;{
</text><text class="text-mono" x="0" y="32.200000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">send_error_response</tspan>(client_fd,&#160;<tspan fill="#009999">501</tspan>,
</text><text class="text-mono" x="0" y="33.500000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">Not&#160;Implemented</tspan><tspan fill="#dd1144">&quot;</tspan>,&#160;<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">...</tspan><tspan fill="#dd1144">&quot;</tspan>);
</text><text class="text-mono" x="0" y="34.800000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">break</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;no&#160;keep-alive&#160;after&#160;501
</tspan></text><text class="text-mono" x="0" y="36.100000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="37.400000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">if</tspan>&#160;(<tspan fill="#000000" class="text-mono-bold">!</tspan>req.keep_alive)&#160;<tspan fill="#000000" class="text-mono-bold">break</tspan>;
</text><text class="text-mono" x="0" y="38.700000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;else:&#160;loop&#160;&#160;wait&#160;for&#160;next&#160;request
</tspan></text><text class="text-mono" x="0" y="40.000000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;}
</text><text class="text-mono" x="0" y="41.300000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">close</tspan>(client_fd);&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;always&#160;close&#160;on&#160;exit
</tspan></text><text class="text-mono" x="0" y="42.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan>}</text></g></g><g transform="translate(17474.000000 4254.000000)" class="dark-code"><rect width="535.000000" height="702.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;handle_connection()&#160;&#160;called&#160;by&#160;worker&#160;thread
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">handle_connection</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">thread_pool_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;set&#160;SO_RCVTIMEO&#160;once&#160;here&#160;(30s)
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">for</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;keep-alive&#160;loop
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">req_buf</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#cdd6f4">REQUEST_BUF_SIZE</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;8192B&#160;stack
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">header_end</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">ssize_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">read_http_request</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">req_buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">REQUEST_BUF_SIZE</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">header_end</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">header_end</tspan><tspan fill="#89dceb" class="text-mono-bold">&lt;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">break</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;timeout/err
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">http_request_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">err</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">parse_http_request</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">req_buf</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">size_t</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">n</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">header_end</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">err</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">send_error_by_code</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">err</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">break</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;update&#160;stats&#160;(brief&#160;lock)
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_mutex_lock</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">total_reqs</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#89dceb" class="text-mono-bold">+</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_mutex_unlock</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">method</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">METHOD_GET</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#89dceb" class="text-mono-bold">|</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">method</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">METHOD_HEAD</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">serve_static_file</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">doc_root</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="32.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">send_error_response</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">501</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="33.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">Not&#160;Implemented</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">...</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="34.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">break</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;no&#160;keep-alive&#160;after&#160;501
</tspan></text><text class="text-mono" x="0" y="36.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="37.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">!</tspan><tspan fill="#cdd6f4">req</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">keep_alive</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">break</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="38.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;else:&#160;loop&#160;&#160;wait&#160;for&#160;next&#160;request
</tspan></text><text class="text-mono" x="0" y="40.000000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="41.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">close</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;always&#160;close&#160;on&#160;exit
</tspan></text><text class="text-mono" x="0" y="42.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDRfbTQua2VlcGFsaXZlLnNsb3dsb3Jpc19kZWZlbnNl"><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="17344.000000" y="4976.000000" width="795" height="120"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Slowloris Attack:</strong> 10,000 connections, 1 byte/20s
 thread-per-connection  80GB virtual memory, OOM
<strong>Pool defense:</strong></p>
<ul>
<li>17th connection  queue (no thread consumed)</li>
<li>SO_RCVTIMEO=30s  idle connections closed</li>
<li>Queue full (256)  send_503() immediately</li>
</ul>
</div></foreignObject></g></g><g class="TDRfbTQuc2lnbmFscy5pbXBs"><g class="shape" ></g><g transform="translate(14755.000000 4276.000000)" class="light-code"><rect width="525.000000" height="494.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;signals.c&#160;&#160;ONE&#160;thread&#160;owns&#160;all&#160;signals
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#000000" class="text-mono-bold">static</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan><tspan fill="#990000" class="text-mono-bold">signal_handler_thread</tspan>(<tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>arg)&#160;{
</text><text class="text-mono" x="0" y="3.600000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">thread_pool_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>pool&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;arg;
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">sigset_t</tspan>&#160;waitset;
</text><text class="text-mono" x="0" y="6.200000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">sigemptyset</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>waitset);
</text><text class="text-mono" x="0" y="7.500000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">sigaddset</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>waitset,&#160;SIGTERM);
</text><text class="text-mono" x="0" y="8.800000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">sigaddset</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>waitset,&#160;SIGINT);
</text><text class="text-mono" x="0" y="10.100000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">signal</tspan>(SIGPIPE,&#160;SIG_IGN);&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;still&#160;ignore&#160;SIGPIPE
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;sig;
</text><text class="text-mono" x="0" y="12.700000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">sigwait</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>waitset,&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>sig);&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;BLOCKS&#160;until&#160;signal
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">printf</tspan>(<tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">[%s]&#160;Graceful&#160;shutdown...</tspan><tspan fill="#dd1144">\n</tspan><tspan fill="#dd1144">&quot;</tspan>,
</text><text class="text-mono" x="0" y="15.300000em">&#160;&#160;&#160;&#160;&#160;&#160;sig<tspan fill="#000000" class="text-mono-bold">=</tspan><tspan fill="#000000" class="text-mono-bold">=</tspan>SIGTERM<tspan fill="#000000" class="text-mono-bold">?</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">SIGTERM</tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#000000" class="text-mono-bold">:</tspan><tspan fill="#dd1144"></tspan><tspan fill="#dd1144">&quot;</tspan><tspan fill="#dd1144">SIGINT</tspan><tspan fill="#dd1144">&quot;</tspan>);
</text><text class="text-mono" x="0" y="16.600000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">thread_pool_shutdown</tspan>(pool);
</text><text class="text-mono" x="0" y="17.900000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">close</tspan>(g_server_fd);&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;unblocks&#160;accept()
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">return</tspan>&#160;<tspan fill="#0086b3">NULL</tspan>;
</text><text class="text-mono" x="0" y="20.500000em">}
</text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#999988" class="text-mono-italic">//&#160;thread_pool_shutdown():
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">void</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">thread_pool_shutdown</tspan>(<tspan fill="#445588" class="text-mono-bold">thread_pool_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>pool)&#160;{
</text><text class="text-mono" x="0" y="24.400000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_mutex_lock</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock);
</text><text class="text-mono" x="0" y="25.700000em">&#160;&#160;&#160;&#160;pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>shutdown&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="27.000000em">&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_cond_broadcast</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>not_empty);&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;ALL
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;<tspan fill="#990000" class="text-mono-bold">pthread_mutex_unlock</tspan>(<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>pool<tspan fill="#000000" class="text-mono-bold">-</tspan><tspan fill="#000000" class="text-mono-bold">&gt;</tspan>lock);
</text><text class="text-mono" x="0" y="29.600000em">}</text></g></g><g transform="translate(14755.000000 4276.000000)" class="dark-code"><rect width="525.000000" height="494.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;signals.c&#160;&#160;ONE&#160;thread&#160;owns&#160;all&#160;signals
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cba6f7">static</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#89b4fa">signal_handler_thread</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">arg</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">thread_pool_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">arg</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">sigset_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">waitset</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">sigemptyset</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">waitset</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">sigaddset</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">waitset</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">SIGTERM</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">sigaddset</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">waitset</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">SIGINT</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">signal</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">SIGPIPE</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">SIG_IGN</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;still&#160;ignore&#160;SIGPIPE
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">sig</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">sigwait</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">waitset</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">sig</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;BLOCKS&#160;until&#160;signal
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">printf</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">[%s]&#160;Graceful&#160;shutdown...</tspan><tspan fill="#89b4fa">\n</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">sig</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">SIGTERM</tspan><tspan fill="#89dceb" class="text-mono-bold">?</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">SIGTERM</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#89dceb" class="text-mono-bold">:</tspan><tspan fill="#f38ba8"></tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#a6e3a1">SIGINT</tspan><tspan fill="#a6e3a1">&quot;</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">thread_pool_shutdown</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">close</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">g_server_fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;unblocks&#160;accept()
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb">NULL</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;thread_pool_shutdown():
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">void</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">thread_pool_shutdown</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#f38ba8">thread_pool_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_mutex_lock</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">shutdown</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_cond_broadcast</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">not_empty</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;ALL
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#89b4fa">pthread_mutex_unlock</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">pool</tspan><tspan fill="#89dceb" class="text-mono-bold">-</tspan><tspan fill="#89dceb" class="text-mono-bold">&gt;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">}</tspan></text></g></g></g><g class="TDRfbTQuc2lnbmFscy5ncmFjZWZ1bF9zaHV0ZG93bg=="><g class="shape" ><rect x="13940.000000" y="4790.000000" width="2156.000000" height="124.000000" rx="4.000000" stroke="#000E3D" fill="#FFFBEB" class=" stroke-B1" style="stroke-width:2;" /></g><text x="15018.000000" y="4815.000000" fill="#0A0F25" class="text fill-N1" style="text-anchor:middle;font-size:20px">4-Phase Graceful Shutdown</text></g><g class="TDRfbTQubXV0ZXhfZGlzY2lwbGluZS5ydWxlcw=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="14429.000000" y="5034.000000" width="1178" height="188"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Lock Hierarchy (prevents deadlock):</strong></p>
<ol>
<li><code>pool-&gt;lock</code>  queue + shutdown + stats</li>
<li><code>log_mutex</code>  stdout access log
<strong>Rule:</strong> Never acquire log_mutex while holding pool-&gt;lock
<strong>Rule:</strong> NEVER hold pool-&gt;lock during I/O (read/write/open)
<strong>Data Race Prevention:</strong></li>
</ol>
<ul>
<li>pool-&gt;shutdown: always read/write under pool-&gt;lock
(or use atomic_int with atomic_load_explicit)</li>
<li>pool-&gt;total_reqs: brief lock acquire/increment/release</li>
<li>pool-&gt;doc_root: read-only after init  NO lock needed
<strong>Test:</strong> gcc -fsanitize=thread  zero DATA RACE reports</li>
</ul>
</div></foreignObject></g></g><g class="TDRfbTQubXV0ZXhfZGlzY2lwbGluZS5tdXRleF9jb3N0"><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="14409.000000" y="5242.000000" width="1218" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Hardware cost of mutex_lock:</strong>
LOCK CMPXCHG (x86)  20-50ns uncontested
Contested  futex syscall  ~2-5s (kernel sleep)
Cache coherence: invalidates 64B cache line on all cores</p>
</div></foreignObject></g></g><g class="TDRfbTQucG9vbF9zaXppbmcuZm9ybXVsYQ=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="13950.000000" y="5386.000000" width="2136" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>I/O-bound formula (Little's Law):</strong>
<code>pool_size = num_cores  (1 + wait_time / compute_time)</code>
Page-cached files: wait1s, compute30s
 pool_size  cores  1.03  <strong>num_cores</strong>
SSD cold reads: wait100s, compute30s
 pool_size  cores  4.3  <strong>~4 num_cores</strong>
Default 16 = good for 4-core machine + SSD</p>
</div></foreignObject></g></g><g class="TDRfbTQubTRfZXJyb3JzLnRibA=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="14716.000000" y="5530.000000" width="603" height="224"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><table>
<thead>
<tr>
<th>Error</th>
<th>Detected By</th>
<th>Recovery</th>
</tr>
</thead>
<tbody>
<tr>
<td>EAGAIN/EWOULDBLOCK</td>
<td>read()</td>
<td>SO_RCVTIMEO fired  break loop</td>
</tr>
<tr>
<td>EMFILE</td>
<td>accept()</td>
<td>usleep(100ms) + continue</td>
</tr>
<tr>
<td>Queue full</td>
<td>thread_pool_submit</td>
<td>send_503 + close</td>
</tr>
<tr>
<td>pthread_create fail</td>
<td>thread_pool_init</td>
<td>shutdown others + return -1</td>
</tr>
<tr>
<td>EINTR</td>
<td>accept()</td>
<td>continue loop</td>
</tr>
</tbody>
</table>
</div></foreignObject></g></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS5zMQ=="><g class="shape" ><rect x="162.000000" y="1591.000000" width="234.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="279.000000" y="1629.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> signal(SIGPIPE, SIG_IGN)</text></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS5zMg=="><g class="shape" ><rect x="466.000000" y="1591.000000" width="347.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="639.500000" y="1629.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> sigfillset + pthread_sigmask(SIG_BLOCK)</text></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS5zMw=="><g class="shape" ><rect x="883.000000" y="1591.000000" width="365.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="1065.500000" y="1629.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> realpath(doc_root, canonical_root)  ONCE</text></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS5zNA=="><g class="shape" ><rect x="1318.000000" y="1591.000000" width="341.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="1488.500000" y="1629.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> thread_pool_init(pool, 16, 256, root, 30)</text></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS5zNQ=="><g class="shape" ><rect x="1729.000000" y="1591.000000" width="351.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="1904.500000" y="1629.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> socket()  setsockopt()  bind()  listen()</text></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS5zNg=="><g class="shape" ><rect x="2150.000000" y="1591.000000" width="340.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="2320.000000" y="1629.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> pthread_create(signal_handler_thread)</text></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS5zNw=="><g class="shape" ><rect x="2560.000000" y="1591.000000" width="231.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="2675.500000" y="1629.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> accept_loop()  BLOCKS</text></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS5zOA=="><g class="shape" ><rect x="2861.000000" y="1591.000000" width="287.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="3004.500000" y="1629.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> thread_pool_join() on shutdown</text></g><g class="TDBfY29uZmlnLm1haW5fYy5zZXJ2ZXJfY29uZmlnX3QuZmllbGRz"><g class="shape" ></g><g transform="translate(1402.000000 1777.000000)" class="light-code"><rect width="506.000000" height="141.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;{
</text><text class="text-mono" x="0" y="2.300000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;port;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x00&#160;&#160;TCP&#160;port&#160;(default&#160;8080)
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;server_fd;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x04&#160;&#160;listening&#160;socket&#160;FD
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;is_running;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x08&#160;&#160;accept&#160;loop&#160;flag
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;pad[<tspan fill="#009999">4</tspan>];&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x0C&#160;&#160;alignment&#160;padding
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#999988" class="text-mono-italic"></tspan>}&#160;<tspan fill="#445588" class="text-mono-bold">server_config_t</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;Total:&#160;16&#160;bytes
</tspan></text></g></g><g transform="translate(1402.000000 1777.000000)" class="dark-code"><rect width="506.000000" height="141.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">port</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x00&#160;&#160;TCP&#160;port&#160;(default&#160;8080)
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">server_fd</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x04&#160;&#160;listening&#160;socket&#160;FD
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">is_running</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x08&#160;&#160;accept&#160;loop&#160;flag
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">pad</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">4</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x0C&#160;&#160;alignment&#160;padding
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">server_config_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Total:&#160;16&#160;bytes
</tspan></text></g></g></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZS5kMQ=="><g class="shape" ></g><g transform="translate(3745.000000 1234.000000)" class="light-code"><rect width="477.000000" height="78.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Step&#160;1:&#160;CREATE
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;server_fd&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">socket</tspan>(AF_INET,&#160;SOCK_STREAM,&#160;<tspan fill="#009999">0</tspan>);
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic">//&#160;AF_INET=IPv4,&#160;SOCK_STREAM=TCP,&#160;proto=0(auto)
</tspan></text></g></g><g transform="translate(3745.000000 1234.000000)" class="dark-code"><rect width="477.000000" height="78.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;Step&#160;1:&#160;CREATE
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">server_fd</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">socket</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">AF_INET</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">SOCK_STREAM</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;AF_INET=IPv4,&#160;SOCK_STREAM=TCP,&#160;proto=0(auto)
</tspan></text></g></g></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZS5kMg=="><g class="shape" ></g><g transform="translate(4292.000000 1224.000000)" class="light-code"><rect width="506.000000" height="99.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Step&#160;2:&#160;REUSE&#160;PORT&#160;(avoid&#160;EADDRINUSE&#160;on&#160;restart)
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;opt&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#009999">1</tspan>;
</text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#990000" class="text-mono-bold">setsockopt</tspan>(server_fd,&#160;SOL_SOCKET,
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SO_REUSEADDR,&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>opt,&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(opt));</text></g></g><g transform="translate(4292.000000 1224.000000)" class="dark-code"><rect width="506.000000" height="99.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;Step&#160;2:&#160;REUSE&#160;PORT&#160;(avoid&#160;EADDRINUSE&#160;on&#160;restart)
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">opt</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#fab387">1</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#89b4fa">setsockopt</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">server_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">SOL_SOCKET</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">SO_REUSEADDR</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">opt</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">opt</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan></text></g></g></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZS5kMw=="><g class="shape" ></g><g transform="translate(4868.000000 1193.000000)" class="light-code"><rect width="544.000000" height="161.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Step&#160;3:&#160;BIND&#160;&#160;htons()&#160;converts&#160;port&#160;to
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;Network&#160;Byte&#160;Order&#160;(big-endian)
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;sockaddr_in&#160;addr&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;{<tspan fill="#009999">0</tspan>};
</text><text class="text-mono" x="0" y="4.900000em">addr.sin_family&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;AF_INET;
</text><text class="text-mono" x="0" y="6.200000em">addr.sin_addr.s_addr&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;INADDR_ANY;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;all&#160;ifaces
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#999988" class="text-mono-italic"></tspan>addr.sin_port&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">htons</tspan>(<tspan fill="#009999">8080</tspan>);
</text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#990000" class="text-mono-bold">bind</tspan>(server_fd,&#160;(<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;sockaddr<tspan fill="#000000" class="text-mono-bold">*</tspan>)<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>addr,&#160;<tspan fill="#000000" class="text-mono-bold">sizeof</tspan>(addr));</text></g></g><g transform="translate(4868.000000 1193.000000)" class="dark-code"><rect width="544.000000" height="161.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;Step&#160;3:&#160;BIND&#160;&#160;htons()&#160;converts&#160;port&#160;to
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Network&#160;Byte&#160;Order&#160;(big-endian)
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">sockaddr_in</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">addr</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#fab387">0</tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">addr</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">sin_family</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">AF_INET</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">addr</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">sin_addr</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">s_addr</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">INADDR_ANY</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;all&#160;ifaces
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">addr</tspan><tspan fill="#cdd6f4">.</tspan><tspan fill="#cdd6f4">sin_port</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">htons</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#fab387">8080</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#89b4fa">bind</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">server_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">sockaddr</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">addr</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">sizeof</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">addr</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan></text></g></g></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZS5kNA=="><g class="shape" ></g><g transform="translate(5482.000000 1234.000000)" class="light-code"><rect width="439.000000" height="78.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Step&#160;4:&#160;LISTEN&#160;&#160;kernel&#160;queues&#160;handshakes
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;SOMAXCONN&#160;=&#160;128-4096&#160;(OS&#160;default&#160;max)
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#990000" class="text-mono-bold">listen</tspan>(server_fd,&#160;SOMAXCONN);</text></g></g><g transform="translate(5482.000000 1234.000000)" class="dark-code"><rect width="439.000000" height="78.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;Step&#160;4:&#160;LISTEN&#160;&#160;kernel&#160;queues&#160;handshakes
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;SOMAXCONN&#160;=&#160;128-4096&#160;(OS&#160;default&#160;max)
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#89b4fa">listen</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">server_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">SOMAXCONN</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan></text></g></g></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZS5kNQ=="><g class="shape" ></g><g transform="translate(5991.000000 1213.000000)" class="light-code"><rect width="525.000000" height="120.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Step&#160;5:&#160;ACCEPT&#160;&#160;blocks;&#160;returns&#160;NEW&#160;fd&#160;per&#160;client
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;server_fd&#160;stays&#160;open;&#160;client_fd&#160;is&#160;temporary
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;client_fd&#160;<tspan fill="#000000" class="text-mono-bold">=</tspan>&#160;<tspan fill="#990000" class="text-mono-bold">accept</tspan>(server_fd,
</text><text class="text-mono" x="0" y="4.900000em">&#160;&#160;(<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;sockaddr<tspan fill="#000000" class="text-mono-bold">*</tspan>)<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>client_addr,&#160;<tspan fill="#000000" class="text-mono-bold">&amp;</tspan>client_len);
</text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#999988" class="text-mono-italic">//&#160;EINTR&#160;&#160;retry;&#160;EMFILE&#160;&#160;sleep+retry
</tspan></text></g></g><g transform="translate(5991.000000 1213.000000)" class="dark-code"><rect width="525.000000" height="120.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;Step&#160;5:&#160;ACCEPT&#160;&#160;blocks;&#160;returns&#160;NEW&#160;fd&#160;per&#160;client
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;server_fd&#160;stays&#160;open;&#160;client_fd&#160;is&#160;temporary
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">=</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89b4fa">accept</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">server_fd</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">sockaddr</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">client_addr</tspan><tspan fill="#cdd6f4">,</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">&amp;</tspan><tspan fill="#cdd6f4">client_len</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;EINTR&#160;&#160;retry;&#160;EMFILE&#160;&#160;sleep+retry
</tspan></text></g></g></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZS5kNg=="><g class="shape" ></g><g transform="translate(6586.000000 1255.000000)" class="light-code"><rect width="467.000000" height="37.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Step&#160;6:&#160;READ&#160;/&#160;WRITE&#160;(see&#160;accumulator&#160;below)
</tspan></text></g></g><g transform="translate(6586.000000 1255.000000)" class="dark-code"><rect width="467.000000" height="37.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;Step&#160;6:&#160;READ&#160;/&#160;WRITE&#160;(see&#160;accumulator&#160;below)
</tspan></text></g></g></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZS5kNw=="><g class="shape" ></g><g transform="translate(7123.000000 1245.000000)" class="light-code"><rect width="458.000000" height="57.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#999988" class="text-mono-italic">//&#160;Step&#160;7:&#160;CLOSE&#160;&#160;mandatory;&#160;prevents&#160;FD&#160;leak
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#990000" class="text-mono-bold">close</tspan>(client_fd);&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;triggers&#160;TCP&#160;FIN
</tspan></text></g></g><g transform="translate(7123.000000 1245.000000)" class="dark-code"><rect width="458.000000" height="57.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#6c7086" class="text-mono-italic">//&#160;Step&#160;7:&#160;CLOSE&#160;&#160;mandatory;&#160;prevents&#160;FD&#160;leak
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#89b4fa">close</tspan><tspan fill="#cdd6f4">(</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">)</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;triggers&#160;TCP&#160;FIN
</tspan></text></g></g></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLmZkX3RhYmxlLnRibA=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="5430.000000" y="1474.000000" width="465" height="339"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><table>
<thead>
<tr>
<th>Slot</th>
<th>Resource</th>
<th>Lifetime</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>stdin</td>
<td>process</td>
</tr>
<tr>
<td>1</td>
<td>stdout</td>
<td>process</td>
</tr>
<tr>
<td>2</td>
<td>stderr</td>
<td>process</td>
</tr>
<tr>
<td>3</td>
<td>server_fd (listening)</td>
<td>server lifetime</td>
</tr>
<tr>
<td>4..N</td>
<td>client_fd (connection)</td>
<td>per-request</td>
</tr>
<tr>
<td><strong>Limit:</strong> ~1024 FDs (ulimit -n)</td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Leak check:</strong> ls /proc/PID/fd</td>
<td>wc -l</td>
<td></td>
</tr>
</tbody>
</table>
</div></foreignObject></g></g><g class="TDFfbTEuYWNjdW11bGF0b3IucHJvYmxlbS50eHQ="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="6431.000000" y="2033.000000" width="1150" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>TCP delivers BYTES, not messages.</strong>
One HTTP request may arrive in 1 to N read() calls.
Causes: MTU ~1500B, Nagle, kernel scheduling.
Must accumulate until \r\n\r\n found.</p>
</div></foreignObject></g></g><g class="TDJfbTIuZGF0YV9tb2RlbC5oZWFkZXJfc3RydWN0LmZpZWxkcw=="><g class="shape" ></g><g transform="translate(9123.000000 162.000000)" class="light-code"><rect width="506.000000" height="99.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;{
</text><text class="text-mono" x="0" y="2.300000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;name[<tspan fill="#009999">256</tspan>];&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x0000&#160;lowercase&#160;norm'd&#160;name
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;value[<tspan fill="#009999">8192</tspan>];&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x0100&#160;OWS-stripped&#160;value
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan>}&#160;<tspan fill="#445588" class="text-mono-bold">http_header_t</tspan>;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;Total:&#160;8448&#160;bytes
</tspan></text></g></g><g transform="translate(9123.000000 162.000000)" class="dark-code"><rect width="506.000000" height="99.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">name</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">256</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x0000&#160;lowercase&#160;norm'd&#160;name
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">value</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">8192</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x0100&#160;OWS-stripped&#160;value
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">http_header_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Total:&#160;8448&#160;bytes
</tspan></text></g></g></g><g class="TDJfbTIuZGF0YV9tb2RlbC5yZXF1ZXN0X3N0cnVjdC5maWVsZHM="><g class="shape" ></g><g transform="translate(9104.000000 381.000000)" class="light-code"><rect width="544.000000" height="432.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;{
</text><text class="text-mono" x="0" y="2.300000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x00000&#160;method&#160;enum
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;method;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;METHOD_GET=0,HEAD=1
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;POST=2,UNKNOWN=3
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x00004&#160;URI&#160;path
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;path[<tspan fill="#009999">8192</tspan>];&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;URL-decoded&#160;path
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x02004&#160;HTTP&#160;minor&#160;version
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;http_minor;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0=HTTP/1.0,&#160;1=HTTP/1.1
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x02008&#160;headers&#160;array&#160;(contiguous,&#160;cache-friendly)
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">http_header_t</tspan>&#160;headers[<tspan fill="#009999">32</tspan>];&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;32&#160;&#160;8448B&#160;=&#160;270,336B
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x44008&#160;header&#160;count
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;header_count;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0..32
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x4400C&#160;content&#160;length
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;content_length;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;-1=absent,&#160;0..N
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x44010&#160;keep-alive&#160;flag
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;keep_alive;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;1=persist,&#160;0=close
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x44018&#160;body&#160;pointer&#160;(zero-copy&#160;into&#160;buf)
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>body;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;NULL&#160;if&#160;no&#160;body
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#999988" class="text-mono-italic"></tspan>}&#160;<tspan fill="#445588" class="text-mono-bold">http_request_t</tspan>;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;~278,560&#160;bytes&#160;total
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;&#160;Stack&#160;alloc:&#160;thread&#160;stack&#160;must&#160;be&#160;8MB
</tspan></text></g></g><g transform="translate(9104.000000 381.000000)" class="dark-code"><rect width="544.000000" height="432.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x00000&#160;method&#160;enum
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">method</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;METHOD_GET=0,HEAD=1
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;POST=2,UNKNOWN=3
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x00004&#160;URI&#160;path
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">path</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">8192</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;URL-decoded&#160;path
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x02004&#160;HTTP&#160;minor&#160;version
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">http_minor</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0=HTTP/1.0,&#160;1=HTTP/1.1
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x02008&#160;headers&#160;array&#160;(contiguous,&#160;cache-friendly)
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">http_header_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">headers</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">32</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;32&#160;&#160;8448B&#160;=&#160;270,336B
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x44008&#160;header&#160;count
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">header_count</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0..32
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x4400C&#160;content&#160;length
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">content_length</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;-1=absent,&#160;0..N
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x44010&#160;keep-alive&#160;flag
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">keep_alive</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;1=persist,&#160;0=close
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x44018&#160;body&#160;pointer&#160;(zero-copy&#160;into&#160;buf)
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">body</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;NULL&#160;if&#160;no&#160;body
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">http_request_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;~278,560&#160;bytes&#160;total
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&#160;Stack&#160;alloc:&#160;thread&#160;stack&#160;must&#160;be&#160;8MB
</tspan></text></g></g></g><g class="TDJfbTIucGFyc2VyX2NvcmUuc3RhdGVzLnNt"><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="8974.000000" y="1194.000000" width="804" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p>STATE_REQ_LINE  STATE_HEADERS  STATE_SEMANTIC  STATE_COMPLETE
 (any error)  STATE_ERROR  send 4xx</p>
</div></foreignObject></g></g><g class="TDNfbTMucGF0aF9zZWN1cml0eS5hdHRhY2tfdmVjdG9ycy5hdHRhY2tz"><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="11512.000000" y="1696.000000" width="688" height="136"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><ol>
<li><strong>Classic</strong>: <code>GET /../../../etc/passwd</code>
strncmp(&quot;/html/../../etc/passwd&quot;,&quot;/html&quot;) = PASS </li>
<li><strong>URL-Encoded</strong>: <code>GET /%2e%2e%2fetc%2fpasswd</code>
Must decode THEN check (not before)</li>
<li><strong>Symlink</strong>: <code>/var/www/secret  /etc</code>
<code>open(&quot;/var/www/secret/passwd&quot;)</code> = opens /etc/passwd</li>
<li><strong>Double-Encoded</strong>: <code>%252e</code>  <code>%2e</code>  <code>.</code></li>
<li><strong>Null-byte</strong>: <code>%00</code> truncates C string path</li>
</ol>
</div></foreignObject></g></g><g class="TDNfbTMucGF0aF9zZWN1cml0eS5zYWZlX2FsZ29yaXRobS5kZXNjcmlwdGlvbg=="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="10520.000000" y="1952.000000" width="2672" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Step 1:</strong> url_decode(req-&gt;path, decoded)
<strong>Step 2:</strong> snprintf(raw, sizeof(raw), &quot;%s%s&quot;, canonical_root, decoded)
<strong>Step 3:</strong> realpath(raw, resolved)  OS resolves ALL symlinks, .., .
<strong>Step 4 (security):</strong> strncmp(resolved, canonical_root, root_len)
<strong>Step 5 (boundary):</strong> resolved[root_len] must be '/' or '\0'
 realpath() requires file EXISTS (ENOENT  404)
 Run realpath(doc_root) ONCE at startup, not per-request</p>
</div></foreignObject></g></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy5wMQ=="><g class="shape" ><rect x="10310.000000" y="4082.000000" width="352.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="10486.000000" y="4120.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> resolve_safe_path()  400/403/404 on fail</text></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy5wMg=="><g class="shape" ><rect x="10732.000000" y="4082.000000" width="302.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="10883.000000" y="4120.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> stat(resolved, &amp;st)  file metadata</text></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy5wMw=="><g class="shape" ><rect x="11104.000000" y="4082.000000" width="390.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="11299.000000" y="4120.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> handle_directory_path()  append /index.html</text></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy5wNA=="><g class="shape" ><rect x="11564.000000" y="4082.000000" width="367.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="11747.500000" y="4120.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> S_ISREG(st.st_mode) check  reject devices</text></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy5wNQ=="><g class="shape" ><rect x="12001.000000" y="4082.000000" width="280.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="12141.000000" y="4120.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> mime_type_for_path(resolved)</text></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy5wNg=="><g class="shape" ><rect x="12351.000000" y="4082.000000" width="302.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="12502.000000" y="4120.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> should_send_304()  304 if cached</text></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy5wNw=="><g class="shape" ><rect x="12723.000000" y="4082.000000" width="291.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="12868.500000" y="4120.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> open(O_RDONLY) + send headers</text></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy5wOA=="><g class="shape" ><rect x="13084.000000" y="4082.000000" width="318.000000" height="66.000000" stroke="#000E3D" fill="#FFFFFF" class=" stroke-B1 fill-N7" style="stroke-width:2;" /></g><text x="13243.000000" y="4120.500000" fill="#0A0F25" class="text-bold fill-N1" style="text-anchor:middle;font-size:16px"> 64KB read/write loop (skip for HEAD)</text></g><g class="TDRfbTQucG9vbF9kYXRhX21vZGVsLndvcmtfaXRlbS5maWVsZHM="><g class="shape" ></g><g transform="translate(14765.000000 3228.000000)" class="light-code"><rect width="506.000000" height="99.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;{
</text><text class="text-mono" x="0" y="2.300000em">&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;client_fd;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x00&#160;accepted&#160;connection&#160;FD
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;pad[<tspan fill="#009999">4</tspan>];&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x04&#160;align&#160;to&#160;8-byte&#160;boundary
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan>}&#160;<tspan fill="#445588" class="text-mono-bold">work_item_t</tspan>;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;Total:&#160;8&#160;bytes
</tspan></text></g></g><g transform="translate(14765.000000 3228.000000)" class="dark-code"><rect width="506.000000" height="99.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">client_fd</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x00&#160;accepted&#160;connection&#160;FD
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">pad</tspan><tspan fill="#cdd6f4">[</tspan><tspan fill="#fab387">4</tspan><tspan fill="#cdd6f4">]</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x04&#160;align&#160;to&#160;8-byte&#160;boundary
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">work_item_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;Total:&#160;8&#160;bytes
</tspan></text></g></g></g><g class="TDRfbTQucG9vbF9kYXRhX21vZGVsLnBvb2xfc3RydWN0LmZpZWxkcw=="><g class="shape" ></g><g transform="translate(14755.000000 3447.000000)" class="light-code"><rect width="525.000000" height="515.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#ffffff;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#000000" class="text-mono-bold">typedef</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">struct</tspan>&#160;{
</text><text class="text-mono" x="0" y="2.300000em">&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;&#160;Queue&#160;Management&#160;
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">work_item_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>queue;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x00&#160;heap&#160;circular&#160;buf
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;queue_capacity;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x08&#160;default&#160;256
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;queue_size;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x0C&#160;current&#160;items
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;queue_head;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x10&#160;dequeue&#160;index
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;queue_tail;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x14&#160;enqueue&#160;index
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;&#160;Synchronization&#160;(cache-line&#160;boundary)&#160;
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">pthread_mutex_t</tspan>&#160;lock;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x18&#160;~40B&#160;global&#160;lock
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">pthread_cond_t</tspan>&#160;&#160;not_empty;<tspan fill="#999988" class="text-mono-italic">//&#160;0x40&#160;work&#160;available
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">pthread_cond_t</tspan>&#160;&#160;not_full;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0x70&#160;space&#160;available
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;&#160;Workers&#160;&amp;&#160;Lifecycle&#160;
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">pthread_t</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>threads;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0xA0&#160;thread&#160;handles
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;num_threads;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0xA8&#160;default&#160;16
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;shutdown;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0xAC&#160;0=run,&#160;1=stop
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;&#160;Config&#160;(read-only,&#160;no&#160;lock&#160;needed)&#160;
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#000000" class="text-mono-bold">const</tspan>&#160;<tspan fill="#445588" class="text-mono-bold">char</tspan>&#160;<tspan fill="#000000" class="text-mono-bold">*</tspan>doc_root;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0xB0&#160;canonical&#160;path
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;idle_timeout;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0xB8&#160;default&#160;30s
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;&#160;Stats&#160;(low-freq,&#160;kept&#160;at&#160;end)&#160;
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">int</tspan>&#160;&#160;active_conns;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0xBC&#160;active&#160;threads
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#999988" class="text-mono-italic"></tspan>&#160;&#160;<tspan fill="#445588" class="text-mono-bold">long</tspan>&#160;total_reqs;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<tspan fill="#999988" class="text-mono-italic">//&#160;0xC0&#160;cumulative&#160;count
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#999988" class="text-mono-italic"></tspan>}&#160;<tspan fill="#445588" class="text-mono-bold">thread_pool_t</tspan>;
</text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#999988" class="text-mono-italic">//&#160;NOTE:&#160;active_conns/total_reqs&#160;at&#160;end&#160;of&#160;struct
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#999988" class="text-mono-italic"></tspan><tspan fill="#999988" class="text-mono-italic">//&#160;avoids&#160;False&#160;Sharing&#160;with&#160;high-freq&#160;queue&#160;fields
</tspan></text></g></g><g transform="translate(14755.000000 3447.000000)" class="dark-code"><rect width="525.000000" height="515.000000" stroke="#0A0F25" class="shape stroke-N1" style="fill:#1e1e2e;stroke-width:2;" /><g transform="translate(8.000000 8.000000)"><text class="text-mono" x="0" y="1.000000em"><tspan fill="#cba6f7">typedef</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cba6f7">struct</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">{</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="2.300000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&#160;Queue&#160;Management&#160;
</tspan></text><text class="text-mono" x="0" y="3.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">work_item_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">queue</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x00&#160;heap&#160;circular&#160;buf
</tspan></text><text class="text-mono" x="0" y="4.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">queue_capacity</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x08&#160;default&#160;256
</tspan></text><text class="text-mono" x="0" y="6.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">queue_size</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x0C&#160;current&#160;items
</tspan></text><text class="text-mono" x="0" y="7.500000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">queue_head</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x10&#160;dequeue&#160;index
</tspan></text><text class="text-mono" x="0" y="8.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">queue_tail</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x14&#160;enqueue&#160;index
</tspan></text><text class="text-mono" x="0" y="10.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&#160;Synchronization&#160;(cache-line&#160;boundary)&#160;
</tspan></text><text class="text-mono" x="0" y="11.400000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">pthread_mutex_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">lock</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x18&#160;~40B&#160;global&#160;lock
</tspan></text><text class="text-mono" x="0" y="12.700000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">pthread_cond_t</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">not_empty</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x40&#160;work&#160;available
</tspan></text><text class="text-mono" x="0" y="14.000000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">pthread_cond_t</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">not_full</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0x70&#160;space&#160;available
</tspan></text><text class="text-mono" x="0" y="15.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&#160;Workers&#160;&amp;&#160;Lifecycle&#160;
</tspan></text><text class="text-mono" x="0" y="16.600000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">pthread_t</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">threads</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0xA0&#160;thread&#160;handles
</tspan></text><text class="text-mono" x="0" y="17.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">num_threads</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0xA8&#160;default&#160;16
</tspan></text><text class="text-mono" x="0" y="19.200000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">shutdown</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0xAC&#160;0=run,&#160;1=stop
</tspan></text><text class="text-mono" x="0" y="20.500000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&#160;Config&#160;(read-only,&#160;no&#160;lock&#160;needed)&#160;
</tspan></text><text class="text-mono" x="0" y="21.800000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cba6f7">const</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">char</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#89dceb" class="text-mono-bold">*</tspan><tspan fill="#cdd6f4">doc_root</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0xB0&#160;canonical&#160;path
</tspan></text><text class="text-mono" x="0" y="23.100000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">idle_timeout</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0xB8&#160;default&#160;30s
</tspan></text><text class="text-mono" x="0" y="24.400000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;&#160;Stats&#160;(low-freq,&#160;kept&#160;at&#160;end)&#160;
</tspan></text><text class="text-mono" x="0" y="25.700000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">int</tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#cdd6f4">active_conns</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0xBC&#160;active&#160;threads
</tspan></text><text class="text-mono" x="0" y="27.000000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">&#160;&#160;</tspan><tspan fill="#f38ba8">long</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#cdd6f4">total_reqs</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;0xC0&#160;cumulative&#160;count
</tspan></text><text class="text-mono" x="0" y="28.300000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#cdd6f4">}</tspan><tspan fill="#cdd6f4">&#160;</tspan><tspan fill="#f38ba8">thread_pool_t</tspan><tspan fill="#cdd6f4">;</tspan><tspan fill="#cdd6f4">
</tspan></text><text class="text-mono" x="0" y="29.600000em"><tspan fill="#cdd6f4"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;NOTE:&#160;active_conns/total_reqs&#160;at&#160;end&#160;of&#160;struct
</tspan></text><text class="text-mono" x="0" y="30.900000em"><tspan fill="#6c7086" class="text-mono-italic"></tspan><tspan fill="#6c7086" class="text-mono-italic">//&#160;avoids&#160;False&#160;Sharing&#160;with&#160;high-freq&#160;queue&#160;fields
</tspan></text></g></g></g><g class="TDRfbTQucG9vbF9kYXRhX21vZGVsLnF1ZXVlX3Zpei50eHQ="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="14197.000000" y="4082.000000" width="1641" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p>capacity=8, head=2, tail=5, size=3
idx: [0]  [1]  [2]  [3]  [4]  [5]  [6]  [7]
[ ]  [ ]  [9]  [12] [15] [  ] [  ] [  ]
head              tail
Enqueue: queue[tail] = item; tail=(tail+1)%cap
Dequeue: item = queue[head]; head=(head+1)%cap
Full when size==capacity  send 503</p>
</div></foreignObject></g></g><g class="TDRfbTQuc2lnbmFscy5ncmFjZWZ1bF9zaHV0ZG93bi5waGFzZXM="><g class="shape" ></g><g><foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" x="13990.000000" y="4840.000000" width="2056" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="md color-N1"><p><strong>Phase 1:</strong> Accept loop checks shutdown flag  stops accept()
<strong>Phase 2:</strong> close(server_fd)  EBADF unblocks accept()
<strong>Phase 3:</strong> shutdown=1 + broadcast  workers wake, drain queue
<strong>Phase 4:</strong> thread_pool_join()  pthread_join all workers  exit(0)
Kubernetes uses same pattern: SIGTERM  grace period  SIGKILL</p>
</div></foreignObject></g></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS4oczEgLSZndDsgczIpWzBd"><marker id="mk-d2-42667800-3488378134" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#000E3D" class="connection fill-B1" stroke-width="2" /> </marker><path d="M 398.000000 1624.000000 L 462.000000 1624.000000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS4oczIgLSZndDsgczMpWzBd"><path d="M 815.000000 1624.000000 L 879.000000 1624.000000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS4oczMgLSZndDsgczQpWzBd"><path d="M 1250.000000 1624.000000 L 1314.000000 1624.000000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS4oczQgLSZndDsgczUpWzBd"><path d="M 1661.000000 1624.000000 L 1725.000000 1624.000000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS4oczUgLSZndDsgczYpWzBd"><path d="M 2082.000000 1624.000000 L 2146.000000 1624.000000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS4oczYgLSZndDsgczcpWzBd"><path d="M 2492.000000 1624.000000 L 2556.000000 1624.000000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDBfY29uZmlnLm1haW5fYy5zdGFydHVwX3NlcS4oczcgLSZndDsgczgpWzBd"><path d="M 2793.000000 1624.000000 L 2857.000000 1624.000000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZS4oZDEgLSZndDsgZDIpWzBd"><path d="M 4224.000000 1273.500000 L 4288.000000 1273.500000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZS4oZDIgLSZndDsgZDMpWzBd"><path d="M 4800.000000 1273.500000 L 4864.000000 1273.500000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZS4oZDMgLSZndDsgZDQpWzBd"><path d="M 5414.000000 1273.500000 L 5478.000000 1273.500000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZS4oZDQgLSZndDsgZDUpWzBd"><path d="M 5923.000000 1273.500000 L 5987.000000 1273.500000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZS4oZDUgLSZndDsgZDYpWzBd"><path d="M 6518.000000 1273.500000 L 6582.000000 1273.500000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDFfbTEuc29ja2V0X2RhbmNlLnByb2NlZHVyZS4oZDYgLSZndDsgZDcpWzBd"><path d="M 7055.000000 1273.500000 L 7119.000000 1273.500000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy4ocDEgLSZndDsgcDIpWzBd"><path d="M 10664.000000 4115.750000 L 10728.000000 4115.750000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy4ocDIgLSZndDsgcDMpWzBd"><path d="M 11036.000000 4115.750000 L 11100.000000 4115.750000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy4ocDMgLSZndDsgcDQpWzBd"><path d="M 11496.000000 4115.750000 L 11560.000000 4115.750000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy4ocDQgLSZndDsgcDUpWzBd"><path d="M 11933.000000 4115.750000 L 11997.000000 4115.750000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy4ocDUgLSZndDsgcDYpWzBd"><path d="M 12283.000000 4115.750000 L 12347.000000 4115.750000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy4ocDYgLSZndDsgcDcpWzBd"><path d="M 12655.000000 4115.750000 L 12719.000000 4115.750000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="TDNfbTMuZmlsZV9oYW5kbGVyLnBoYXNlcy4ocDcgLSZndDsgcDgpWzBd"><path d="M 13016.000000 4115.750000 L 13080.000000 4115.750000" stroke="#000E3D" fill="none" class="connection stroke-B1" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3488378134)" mask="url(#d2-42667800)" /></g><g class="KEwwX2NvbmZpZyAtJmd0OyBMMV9tMSlbMF0="><marker id="mk-d2-42667800-2037767770" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#6366F1" class="connection" stroke-width="2" /> </marker><path d="M 3300.000000 1888.000000 L 3591.000000 1888.000000" stroke="#6366F1" fill="none" class="connection" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-2037767770)" mask="url(#d2-42667800)" /><text x="3447.000000" y="1886.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:12px"><tspan x="3447.000000" dy="0.000000">port: int 8080</tspan><tspan x="3447.000000" dy="14.000000">doc_root: char*</tspan></text></g><g class="KEwxX20xIC0mZ3Q7IEwyX20yKVswXQ=="><marker id="mk-d2-42667800-2996830758" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#22C55E" class="connection" stroke-width="2" /> </marker><path d="M 8589.000000 2310.500000 L 8820.000000 2310.500000" stroke="#22C55E" fill="none" class="connection" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-2996830758)" mask="url(#d2-42667800)" /><text x="8705.500000" y="2303.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:12px"><tspan x="8705.500000" dy="0.000000">req_buf: char[8192]</tspan><tspan x="8705.500000" dy="13.333333">header_end: int</tspan><tspan x="8705.500000" dy="13.333333">bytes: ssize_t</tspan></text></g><g class="KEwyX20yIC0mZ3Q7IEwzX20zKVswXQ=="><marker id="mk-d2-42667800-3854559256" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#F97316" class="connection" stroke-width="2" /> </marker><path d="M 9930.000000 2835.416016 L 10156.000000 2835.416016" stroke="#F97316" fill="none" class="connection" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-3854559256)" mask="url(#d2-42667800)" /><text x="10044.000000" y="2821.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:12px"><tspan x="10044.000000" dy="0.000000">http_request_t*</tspan><tspan x="10044.000000" dy="13.000000">method: enum</tspan><tspan x="10044.000000" dy="13.000000">path: char[8192]</tspan><tspan x="10044.000000" dy="13.000000">keep_alive: int</tspan></text></g><g class="KEwzX20zIC0mZ3Q7IEw0X200KVswXQ=="><marker id="mk-d2-42667800-1797808290" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#8B5CF6" class="connection" stroke-width="2" /> </marker><path d="M 13554.000000 4003.583008 L 13836.000000 4003.583008" stroke="#8B5CF6" fill="none" class="connection" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-1797808290)" mask="url(#d2-42667800)" /><text x="13696.000000" y="3996.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:12px"><tspan x="13696.000000" dy="0.000000">serve_static_file()</tspan><tspan x="13696.000000" dy="13.333333">file data: up to 64KB chunks</tspan><tspan x="13696.000000" dy="13.333333">Content-Length: long</tspan></text></g><g class="TDRfbTQuKHRocmVhZF9wb29sX2ltcGwgLSZndDsga2VlcGFsaXZlKVswXQ=="><path d="M 17060.000000 4595.250000 L 17290.000000 4595.250000" stroke="#8B5CF6" fill="none" class="connection" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-1797808290)" mask="url(#d2-42667800)" /><text x="17176.000000" y="4594.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:11px"><tspan x="17176.000000" dy="0.000000">client_fd: int</tspan><tspan x="17176.000000" dy="12.500000">pool: thread_pool_t*</tspan></text></g><g class="TDRfbTQuKHNpZ25hbHMgLSZndDsgdGhyZWFkX3Bvb2xfaW1wbClbMF0="><marker id="mk-d2-42667800-1368950235" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#DC2626" class="connection" stroke-width="2" /> </marker><path d="M 16148.000000 4595.250000 L 16381.000000 4595.250000" stroke="#DC2626" fill="none" class="connection" style="stroke-width:2;stroke-dasharray:10.000000,9.865639;" marker-end="url(#mk-d2-42667800-1368950235)" mask="url(#d2-42667800)" /><text x="16265.500000" y="4594.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:11px"><tspan x="16265.500000" dy="0.000000">shutdown=1</tspan><tspan x="16265.500000" dy="12.500000">broadcast not_empty</tspan></text></g><g class="TDFfbTEuKGFjY3VtdWxhdG9yIC0mZ3Q7IHJlc3BvbnNlX2J1aWxkZXIpWzBd"><marker id="mk-d2-42667800-691552559" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#F59E0B" class="connection" stroke-width="2" /> </marker><path d="M 7683.000000 2486.500000 L 7889.000000 2486.500000" stroke="#F59E0B" fill="none" class="connection" style="stroke-width:2;" marker-end="url(#mk-d2-42667800-691552559)" mask="url(#d2-42667800)" /><text x="7787.000000" y="2485.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:11px"><tspan x="7787.000000" dy="0.000000">header_end: int</tspan><tspan x="7787.000000" dy="12.500000">buf: char[8192]</tspan></text></g><g class="KGhhcmR3YXJlX25vdGVzIC0mZ3Q7IEwxX20xKVswXQ=="><marker id="mk-d2-42667800-1359331901" markerWidth="10.000000" markerHeight="12.000000" refX="7.000000" refY="6.000000" viewBox="0.000000 0.000000 10.000000 12.000000" orient="auto" markerUnits="userSpaceOnUse"> <polygon points="0.000000,0.000000 10.000000,6.000000 0.000000,12.000000" fill="#94A3B8" class="connection" stroke-width="2" /> </marker><path d="M 3299.500000 4271.333008 L 3328.000000 4271.333008 S 3338.000000 4271.333008 3338.000000 4261.333008 L 3338.000000 2743.000000 S 3338.000000 2733.000000 3348.000000 2733.000000 L 3591.000000 2733.000000" stroke="#94A3B8" fill="none" class="connection" style="stroke-width:2;stroke-dasharray:6.000000,5.919384;" marker-end="url(#mk-d2-42667800-1359331901)" mask="url(#d2-42667800)" /><text x="3338.500000" y="3392.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:11px"><tspan x="3338.500000" dy="0.000000">read() ~100ns cached</tspan><tspan x="3338.500000" dy="12.500000">accept() ~10-50s</tspan></text></g><g class="KGhhcmR3YXJlX25vdGVzIC0mZ3Q7IEwzX20zKVswXQ=="><path d="M 3299.500000 4355.333008 L 3378.000000 4355.333008 S 3388.000000 4355.333008 3388.000000 4365.333008 L 3388.000000 4639.000000 S 3388.000000 4649.000000 3398.000000 4649.000000 L 10156.000000 4649.000000" stroke="#94A3B8" fill="none" class="connection" style="stroke-width:2;stroke-dasharray:6.000000,5.919384;" marker-end="url(#mk-d2-42667800-1359331901)" mask="url(#d2-42667800)" /><text x="6582.000000" y="4648.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:11px"><tspan x="6582.000000" dy="0.000000">64KB = 16 pages</tspan><tspan x="6582.000000" dy="12.500000">page cache  ~5s</tspan></text></g><g class="KGhhcmR3YXJlX25vdGVzIC0mZ3Q7IEw0X200KVswXQ=="><path d="M 3299.500000 4439.333008 L 3328.000000 4439.333008 S 3338.000000 4439.333008 3338.000000 4449.333008 L 3338.000000 5442.750000 S 3338.000000 5452.750000 3348.000000 5452.750000 L 13836.000000 5452.750000" stroke="#94A3B8" fill="none" class="connection" style="stroke-width:2;stroke-dasharray:6.000000,5.919384;" marker-end="url(#mk-d2-42667800-1359331901)" mask="url(#d2-42667800)" /><text x="8062.000000" y="5451.000000" fill="#676C7E" class="text-italic fill-N2" style="text-anchor:middle;font-size:11px"><tspan x="8062.000000" dy="0.000000">CMPXCHG ~25ns</tspan><tspan x="8062.000000" dy="12.500000">futex ~2-5s</tspan></text></g><mask id="d2-42667800" maskUnits="userSpaceOnUse" x="-89" y="-200" width="18429" height="6155">
<rect x="-89" y="-200" width="18429" height="6155" fill="white"></rect>
<rect x="3406.000000" y="1874.000000" width="82" height="28" fill="black"></rect>
<rect x="8655.000000" y="2291.000000" width="101" height="40" fill="black"></rect>
<rect x="10001.000000" y="2809.000000" width="86" height="52" fill="black"></rect>
<rect x="13625.000000" y="3984.000000" width="142" height="40" fill="black"></rect>
<rect x="17126.000000" y="4583.000000" width="100" height="25" fill="black"></rect>
<rect x="16214.000000" y="4583.000000" width="103" height="25" fill="black"></rect>
<rect x="7749.000000" y="2474.000000" width="76" height="25" fill="black"></rect>
<rect x="3288.000000" y="3381.000000" width="101" height="25" fill="black"></rect>
<rect x="6537.000000" y="4637.000000" width="90" height="25" fill="black"></rect>
<rect x="8023.000000" y="5440.000000" width="78" height="25" fill="black"></rect>
</mask></svg></svg>
