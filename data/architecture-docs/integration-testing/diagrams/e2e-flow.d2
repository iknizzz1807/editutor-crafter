shape: sequence_diagram

test_runner: Test Runner {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

auth_service: Auth Service {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

business_api: Business API {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

database: Database {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

message_queue: Message Queue {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

notification_service: Notification Service {
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

test_runner -> test_runner: Setup test containers

test_runner -> database: Seed test data

test_runner -> auth_service: POST /auth/login

auth_service -> database: Validate credentials

database -> auth_service: User data

auth_service -> test_runner: JWT token

test_runner -> business_api: POST /orders (with JWT)

business_api -> auth_service: Validate token

auth_service -> business_api: Token valid

business_api -> database: Create order record

database -> business_api: Order ID

business_api -> message_queue: Publish order.created

business_api -> test_runner: Order created (201)

message_queue -> notification_service: order.created event

notification_service -> database: Log notification

test_runner -> database: Verify order exists

database -> test_runner: Order data

test_runner -> database: Verify notification logged

database -> test_runner: Notification record

test_runner -> test_runner: Assert all expectations met

test_runner -> test_runner: Cleanup containers