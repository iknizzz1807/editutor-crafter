title: Cron Expression Parsing

direction: down

classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  
  decision: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  error: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
  
  success: {
    style.fill: "#00b894"
    style.stroke: "#00a085"
    style.font-color: "#ffffff"
    style.bold: true
  }
}

start: Start {
  shape: circle
  style.fill: "#3fb950"
  style.font-color: "#ffffff"
}

input: "Input\nCron Expression" {
  class: process
}

tokenize: "Tokenization\nSplit into 5/6 fields\n(min hour day month dow [year])" {
  class: process
}

validate_count: "Valid\nField Count?" {
  shape: diamond
  class: decision
}

field_validation: "Field Validation\nCheck each field format\nand allowed values" {
  class: process
}

validate_fields: "All Fields\nValid?" {
  shape: diamond
  class: decision
}

range_expansion: "Range Expansion\nExpand wildcards (*)\nand ranges (1-5)" {
  class: process
}

next_calc: "Next Time Calculation\nFind next execution\nbased on current time" {
  class: process
}

timezone_check: "Timezone\nRequired?" {
  shape: diamond
  class: decision
}

timezone_convert: "Timezone Conversion\nConvert to target timezone" {
  class: process
}

result: "Parsed Cron\nSchedule Ready" {
  class: success
}

error_count: "Invalid Field Count\nMust be 5 or 6 fields" {
  class: error
}

error_format: "Invalid Field Format\nCheck syntax and ranges" {
  class: error
}

start -> input
input -> tokenize
tokenize -> validate_count

validate_count -> field_validation: "Yes (5-6 fields)"
validate_count -> error_count: "No"

field_validation -> validate_fields
validate_fields -> range_expansion: "Yes"
validate_fields -> error_format: "No"

range_expansion -> next_calc
next_calc -> timezone_check

timezone_check -> timezone_convert: "Yes"
timezone_check -> result: "No"

timezone_convert -> result