direction: right

classes: {
  entity: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  container: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

core: Core Entities {
  class: container
  
  testcase: TestCase {
    shape: class
    class: entity
    - "id: UUID"
    - "prompt: string"
    - "expected_output: string"
    - "metadata: Dict"
    - "tags: List<string>"
    - "dataset_id: UUID"
    - "created_at: DateTime"
    - "updated_at: DateTime"
    + "validate(): bool"
    + "to_dict(): Dict"
  }
  
  dataset: Dataset {
    shape: class
    class: entity
    - "id: UUID"
    - "name: string"
    - "description: string"
    - "current_version_id: UUID"
    - "created_at: DateTime"
    - "updated_at: DateTime"
    + "get_test_cases(): List<TestCase>"
    + "create_version(): Version"
  }
  
  version: Version {
    shape: class
    class: entity
    - "id: UUID"
    - "dataset_id: UUID"
    - "version_number: string"
    - "change_summary: string"
    - "test_case_count: int"
    - "created_at: DateTime"
    - "is_active: bool"
    + "get_changes(): Dict"
    + "activate(): void"
  }
}

evaluation: Evaluation System {
  class: container
  
  eval_run: EvaluationRun {
    shape: class
    class: entity
    - "id: UUID"
    - "name: string"
    - "dataset_version_id: UUID"
    - "model_name: string"
    - "model_version: string"
    - "config: Dict"
    - "status: RunStatus"
    - "started_at: DateTime"
    - "completed_at: DateTime"
    + "execute(): void"
    + "get_results(): List<EvaluationResult>"
  }
  
  eval_result: EvaluationResult {
    shape: class
    class: entity
    - "id: UUID"
    - "run_id: UUID"
    - "test_case_id: UUID"
    - "actual_output: string"
    - "execution_time: float"
    - "status: ResultStatus"
    - "error_message: string"
    - "created_at: DateTime"
    + "calculate_metrics(): Dict"
    + "is_passed(): bool"
  }
  
  metric: Metric {
    shape: class
    class: entity
    - "id: UUID"
    - "name: string"
    - "description: string"
    - "metric_type: MetricType"
    - "config: Dict"
    - "is_active: bool"
    + "calculate(): float"
    + "validate_config(): bool"
  }
}

# Relationships
dataset -> version: "has versions"
version -> testcase: "contains test cases"
dataset -> testcase: "current version"

eval_run -> version: "evaluates version"
eval_run -> eval_result: "produces results"
eval_result -> testcase: "tests case"
eval_result -> metric: "measured by"

# Styling arrows
dataset -> version: {
  style.stroke: "#8b949e"
}
version -> testcase: {
  style.stroke: "#8b949e"
}
dataset -> testcase: {
  style.stroke: "#8b949e"
  style.stroke-dash: 3
}
eval_run -> version: {
  style.stroke: "#8b949e"
}
eval_run -> eval_result: {
  style.stroke: "#8b949e"
}
eval_result -> testcase: {
  style.stroke: "#8b949e"
}
eval_result -> metric: {
  style.stroke: "#8b949e"
}