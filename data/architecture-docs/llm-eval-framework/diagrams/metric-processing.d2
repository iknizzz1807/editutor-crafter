classes: {
  container_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  process_style: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  metric_style: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  
  decision_style: {
    style.fill: "#2d3748"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  
  output_style: {
    style.fill: "#1a365d"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}

input: Raw Model Outputs {
  shape: parallelogram
  class: process_style
}

preprocessing: Data Preprocessing {
  class: container_style
  
  normalize: Text Normalization {
    class: process_style
  }
  
  tokenize: Tokenization {
    class: process_style
  }
  
  validate: Input Validation {
    class: process_style
  }
}

router: Metric Type Router {
  shape: diamond
  class: decision_style
}

exact_match: Exact Match Metrics {
  class: container_style
  
  string_comp: String Comparison {
    class: metric_style
  }
  
  case_handling: Case Handling {
    class: metric_style
  }
  
  exact_score: Score Calculation {
    class: metric_style
  }
}

semantic_sim: Semantic Similarity {
  class: container_style
  
  embedding: Generate Embeddings {
    class: metric_style
  }
  
  cosine: Cosine Similarity {
    class: metric_style
  }
  
  threshold: Threshold Check {
    class: metric_style
  }
}

llm_judge: LLM-as-Judge {
  class: container_style
  
  prompt_gen: Prompt Generation {
    class: metric_style
  }
  
  llm_call: LLM API Call {
    class: metric_style
  }
  
  parse_resp: Response Parsing {
    class: metric_style
  }
}

custom: Custom Metrics {
  class: container_style
  
  user_logic: User-Defined Logic {
    class: metric_style
  }
  
  custom_score: Custom Scoring {
    class: metric_style
  }
}

caching: Result Caching {
  shape: cylinder
  class: process_style
}

aggregator: Score Aggregation {
  class: process_style
}

final_scores: Final Metric Scores {
  shape: parallelogram
  class: output_style
}

input -> preprocessing: raw data
preprocessing.normalize -> preprocessing.tokenize
preprocessing.tokenize -> preprocessing.validate
preprocessing -> router: preprocessed data

router -> exact_match: exact match type
router -> semantic_sim: similarity type
router -> llm_judge: judge type
router -> custom: custom type

exact_match.string_comp -> exact_match.case_handling
exact_match.case_handling -> exact_match.exact_score

semantic_sim.embedding -> semantic_sim.cosine
semantic_sim.cosine -> semantic_sim.threshold

llm_judge.prompt_gen -> llm_judge.llm_call
llm_judge.llm_call -> llm_judge.parse_resp

custom.user_logic -> custom.custom_score

exact_match -> caching: exact scores
semantic_sim -> caching: similarity scores
llm_judge -> caching: judge scores
custom -> caching: custom scores

caching -> aggregator: cached results
aggregator -> final_scores: aggregated metrics