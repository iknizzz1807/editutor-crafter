title: Shell System Component Overview

classes: {
  core_component: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  data_flow: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  control_flow: {
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}

shell: Shell System {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"

  main_loop: Main Loop {
    class: core_component
    shape: rectangle
  }

  parser: Parser {
    class: core_component
    shape: rectangle
  }

  executor: Executor {
    class: core_component
    shape: rectangle
  }

  job_manager: Job Manager {
    class: core_component
    shape: rectangle
  }

  signal_handler: Signal Handler {
    class: core_component
    shape: rectangle
  }
}

external: External {
  style.fill: "#0f3460"
  style.stroke: "#8b949e"
  style.font-color: "#e6edf3"

  user_input: User Input {
    shape: parallelogram
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
  }

  processes: Child Processes {
    shape: oval
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
  }

  terminal: Terminal {
    shape: oval
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
  }
}

# Data Flow
external.user_input -> shell.main_loop: command line {
  class: data_flow
}

shell.main_loop -> shell.parser: raw input {
  class: data_flow
}

shell.parser -> shell.executor: parsed command {
  class: data_flow
}

shell.executor -> shell.job_manager: job info {
  class: data_flow
}

shell.executor -> external.processes: spawn/exec {
  class: control_flow
}

# Signal Flow
external.terminal -> shell.signal_handler: SIGINT/SIGTSTP {
  class: control_flow
}

shell.signal_handler -> shell.job_manager: signal routing {
  class: control_flow
}

shell.signal_handler -> external.processes: forward signals {
  class: control_flow
}

external.processes -> shell.signal_handler: SIGCHLD {
  class: control_flow
}

# Job Control Flow
shell.job_manager -> shell.executor: job status {
  class: data_flow
}

shell.job_manager -> shell.main_loop: job updates {
  class: data_flow
}

# Feedback Loop
shell.executor -> shell.main_loop: execution status {
  class: data_flow
}