classes: {
  core: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  layer: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  component: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  data_flow: {
    style.stroke: "#3fb950"
    style.font-color: "#3fb950"
  }
}

training_layer: Training System {
  class: layer
  
  engine: Training Engine {
    class: component
  }
  
  optimizer: Optimizer {
    class: component
  }
  
  loss: Loss Function {
    class: component
  }
  
  dataset: Dataset {
    class: component
  }
  
  dataset -> engine: training data
  engine -> optimizer: gradients
  optimizer -> loss: updated params
  loss -> engine: loss value
}

neural_layer: Neural Network Components {
  class: layer
  
  neuron: Neuron {
    class: component
  }
  
  layer_comp: Layer {
    class: component
  }
  
  mlp: Multi-Layer Perceptron {
    class: component
  }
  
  activation: Activation Functions {
    class: component
  }
  
  neuron -> layer_comp: neurons
  layer_comp -> mlp: layers
  activation -> neuron: non-linearity
  mlp -> activation: forward pass
}

core_layer: Value Engine Core {
  class: layer
  
  value: Value Class {
    class: core
    shape: rectangle
    data: "data: float"
    children: "_children: Set[Value]"
    op: "_op: str"
    grad: "grad: float"
    add_method: "+ __add__(other): Value"
    mul_method: "+ __mul__(other): Value"
    backward_method: "+ backward(): void"
    tanh_method: "+ tanh(): Value"
  }
  
  graph: Computation Graph {
    class: core
  }
  
  autodiff: Auto Differentiation {
    class: core
  }
  
  value -> graph: builds
  graph -> autodiff: enables
  autodiff -> value: computes gradients
}

training_layer -> neural_layer: loss gradients {
  class: data_flow
}

neural_layer -> core_layer: operations and gradients {
  class: data_flow
}

core_layer -> neural_layer: computed values {
  class: data_flow
}

neural_layer -> training_layer: network output {
  class: data_flow
}

diagram_title: System Component Architecture {
  near: top-center
  style.font-size: 20
  style.font-color: "#e6edf3"
  style.bold: true
}