direction: right

classes: {
  state: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  initial: {
    style.fill: "#3fb950"
    style.stroke: "#3fb950"
    style.font-color: "#1a1a2e"
  }
  error: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
  final: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.double-border: true
    style.bold: true
  }
  transition: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

init: {
  shape: circle
  label: ""
  class: initial
}

initialized: Initialized {
  shape: circle
  class: state
}

interface_selected: Interface Selected {
  shape: circle
  class: state
}

capturing: Capturing {
  shape: circle
  class: state
}

stopped: Stopped {
  shape: circle
  class: final
}

error: Error {
  shape: circle
  class: error
}

init -> initialized: system startup {
  class: transition
}

initialized -> interface_selected: select interface {
  class: transition
}

interface_selected -> capturing: start capture {
  class: transition
}

capturing -> stopped: user stop {
  class: transition
}

capturing -> capturing: packet received {
  class: transition
}

initialized -> error: privilege error {
  class: transition
}

interface_selected -> error: interface unavailable {
  class: transition
}

capturing -> error: capture failure {
  class: transition
}

error -> initialized: reset {
  class: transition
}

stopped -> interface_selected: restart {
  class: transition
}

interface_selected -> initialized: deselect interface {
  class: transition
}