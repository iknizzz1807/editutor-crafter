direction: down

classes: {
  error_node: {
    style.fill: "#d63031"
    style.font-color: "#ffffff"
    style.stroke: "#e17055"
    style.bold: true
  }
  
  recovery_node: {
    style.fill: "#00b894"
    style.font-color: "#ffffff"
    style.stroke: "#00a085"
    style.bold: true
  }
  
  process_node: {
    style.fill: "#1a1a2e"
    style.font-color: "#e6edf3"
    style.stroke: "#3fb950"
  }
  
  decision_node: {
    style.fill: "#fdcb6e"
    style.font-color: "#2d3436"
    style.stroke: "#e17055"
    style.bold: true
  }
}

packet_received: Packet Received {
  class: process_node
}

privilege_check: Privilege Check {
  shape: diamond
  class: decision_node
}

privilege_error: Privilege Error {
  class: error_node
}

privilege_recovery: Request Elevation {
  class: recovery_node
}

packet_validation: Packet Validation {
  shape: diamond
  class: decision_node
}

malformed_error: Malformed Packet {
  class: error_node
}

malformed_recovery: Extract Partial Data {
  class: recovery_node
}

resource_check: Resource Check {
  shape: diamond
  class: decision_node
}

resource_error: Resource Exhaustion {
  class: error_node
}

resource_recovery: Buffer Management {
  class: recovery_node
}

header_parse: Parse Headers {
  class: process_node
}

parsing_error: Parsing Error {
  class: error_node
}

partial_parse: Save Partial Results {
  class: recovery_node
}

protocol_analysis: Protocol Analysis {
  class: process_node
}

analysis_error: Analysis Failed {
  class: error_node
}

analysis_recovery: Mark as Unknown {
  class: recovery_node
}

output_generation: Generate Output {
  class: process_node
}

error_log: Error Logging {
  class: process_node
}

success_output: Success Output {
  class: recovery_node
}

packet_received -> privilege_check
privilege_check -> privilege_error: No Permission
privilege_check -> packet_validation: Authorized

privilege_error -> privilege_recovery
privilege_recovery -> error_log

packet_validation -> malformed_error: Invalid Format
packet_validation -> resource_check: Valid

malformed_error -> malformed_recovery
malformed_recovery -> error_log

resource_check -> resource_error: Insufficient Memory
resource_check -> header_parse: Resources OK

resource_error -> resource_recovery
resource_recovery -> error_log

header_parse -> parsing_error: Parse Failed
header_parse -> protocol_analysis: Headers OK

parsing_error -> partial_parse
partial_parse -> error_log

protocol_analysis -> analysis_error: Unknown Protocol
protocol_analysis -> output_generation: Analysis Complete

analysis_error -> analysis_recovery
analysis_recovery -> output_generation

output_generation -> success_output
success_output -> error_log: Log Success