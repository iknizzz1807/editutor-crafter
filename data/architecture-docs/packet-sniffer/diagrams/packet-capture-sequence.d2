shape: sequence_diagram

classes: {
  actor: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  message: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

user: User {
  class: actor
}

capture_engine: Capture Engine {
  class: actor
}

tcp_parser: TCP Parser {
  class: actor
}

ip_parser: IP Parser {
  class: actor
}

eth_parser: Ethernet Parser {
  class: actor
}

formatter: Output Formatter {
  class: actor
}

user -> capture_engine: start_capture("eth0") {
  class: message
}

capture_engine -> capture_engine: bind_raw_socket() {
  class: message
}

capture_engine -> capture_engine: set_promiscuous_mode() {
  class: message
}

capture_engine -> user: capture_started {
  class: message
}

capture_engine -> capture_engine: recv_packet() {
  class: message
}

capture_engine -> eth_parser: parse_ethernet(raw_data) {
  class: message
}

eth_parser -> capture_engine: ethernet_header {
  class: message
}

capture_engine -> ip_parser: parse_ip(payload) {
  class: message
}

ip_parser -> capture_engine: ip_header {
  class: message
}

capture_engine -> tcp_parser: parse_tcp(payload) {
  class: message
}

tcp_parser -> capture_engine: tcp_header {
  class: message
}

capture_engine -> formatter: format_packet(headers, payload) {
  class: message
}

formatter -> capture_engine: formatted_output {
  class: message
}

capture_engine -> user: packet_captured(formatted_data) {
  class: message
}

user -> capture_engine: stop_capture() {
  class: message
}

capture_engine -> capture_engine: close_socket() {
  class: message
}

capture_engine -> user: capture_stopped {
  class: message
}