classes: {
  packet_class: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  header_class: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  arrow_style: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

title: Network Protocol Stack Data Model {
  near: top-center
  style.font-size: 18
  style.bold: true
  style.font-color: "#e6edf3"
}

RawPacket: RawPacket {
  shape: class
  class: packet_class
  - "data: bytes"
  - "length: int"
  - "timestamp: DateTime"
  - "interface: string"
  + "get_data(): bytes"
  + "get_timestamp(): DateTime"
  + "parse_ethernet(): EthernetFrame"
}

EthernetFrame: EthernetFrame {
  shape: class
  class: header_class
  - "destination_mac: string"
  - "source_mac: string"
  - "ethertype: int"
  - "payload: bytes"
  - "raw_packet: RawPacket"
  + "get_mac_addresses(): tuple"
  + "parse_ip(): IPHeader"
  + "is_ip_packet(): bool"
}

IPHeader: IPHeader {
  shape: class
  class: header_class
  - "version: int"
  - "header_length: int"
  - "ttl: int"
  - "protocol: int"
  - "source_ip: string"
  - "destination_ip: string"
  - "payload: bytes"
  - "ethernet_frame: EthernetFrame"
  + "get_addresses(): tuple"
  + "parse_transport(): TCPHeader|UDPHeader"
  + "is_tcp(): bool"
  + "is_udp(): bool"
}

TCPHeader: TCPHeader {
  shape: class
  class: header_class
  - "source_port: int"
  - "destination_port: int"
  - "sequence_number: int"
  - "acknowledgment_number: int"
  - "flags: int"
  - "window_size: int"
  - "payload: bytes"
  - "ip_header: IPHeader"
  + "get_ports(): tuple"
  + "get_flags(): dict"
  + "is_syn(): bool"
  + "is_ack(): bool"
}

UDPHeader: UDPHeader {
  shape: class
  class: header_class
  - "source_port: int"
  - "destination_port: int"
  - "length: int"
  - "checksum: int"
  - "payload: bytes"
  - "ip_header: IPHeader"
  + "get_ports(): tuple"
  + "get_payload_length(): int"
  + "verify_checksum(): bool"
}

RawPacket -> EthernetFrame: {
  label: "parses to"
  class: arrow_style
}

EthernetFrame -> IPHeader: {
  label: "contains"
  class: arrow_style
}

IPHeader -> TCPHeader: {
  label: "contains (TCP)"
  class: arrow_style
}

IPHeader -> UDPHeader: {
  label: "contains (UDP)"
  class: arrow_style
}

EthernetFrame -> RawPacket: {
  label: "composed of"
  class: arrow_style
  style.stroke-dash: 3
}

IPHeader -> EthernetFrame: {
  label: "composed of"
  class: arrow_style
  style.stroke-dash: 3
}

TCPHeader -> IPHeader: {
  label: "composed of"
  class: arrow_style
  style.stroke-dash: 3
}

UDPHeader -> IPHeader: {
  label: "composed of"
  class: arrow_style
  style.stroke-dash: 3
}