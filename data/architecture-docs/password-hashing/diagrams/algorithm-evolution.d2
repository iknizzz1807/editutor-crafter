title: Algorithm Evolution State Machine

classes: {
  state_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  transition_style: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  migration_style: {
    style.stroke: "#d63031"
    style.font-color: "#d63031"
    style.bold: true
  }
  final_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    style.double-border: true
  }
}

init: {
  shape: circle
  style.fill: "#3fb950"
  label: ""
}

sha256: SHA-256 Basic {
  shape: circle
  class: state_style
}

pbkdf2: PBKDF2 Stretched {
  shape: circle
  class: state_style
}

bcrypt: bcrypt Memory-Hard {
  shape: circle
  class: state_style
}

argon2: Argon2 Modern {
  shape: circle
  class: final_style
}

migration_state: Migration Active {
  shape: circle
  style.fill: "#d63031"
  style.stroke: "#e17055"
  style.font-color: "#ffffff"
  style.bold: true
}

init -> sha256: System Start {
  class: transition_style
}

sha256 -> pbkdf2: Security Upgrade\nAdd Key Stretching {
  class: transition_style
}

pbkdf2 -> bcrypt: GPU Resistance\nMemory-Hard Function {
  class: transition_style
}

bcrypt -> argon2: Side-Channel Protection\nArgon2id Algorithm {
  class: transition_style
}

sha256 -> migration_state: Begin Migration {
  class: migration_style
}

pbkdf2 -> migration_state: Begin Migration {
  class: migration_style
}

bcrypt -> migration_state: Begin Migration {
  class: migration_style
}

migration_state -> pbkdf2: Migrate to PBKDF2 {
  class: migration_style
}

migration_state -> bcrypt: Migrate to bcrypt {
  class: migration_style
}

migration_state -> argon2: Migrate to Argon2 {
  class: migration_style
}

sha256 -> sha256: Verify Old Passwords {
  class: transition_style
  style.stroke-dash: 3
}

pbkdf2 -> pbkdf2: Verify Old Passwords {
  class: transition_style
  style.stroke-dash: 3
}

bcrypt -> bcrypt: Verify Old Passwords {
  class: transition_style
  style.stroke-dash: 3
}

argon2 -> argon2: Standard Operation {
  class: transition_style
  style.stroke-dash: 3
}

legend: |md
  **Algorithm Evolution States:**
  • **SHA-256**: Legacy basic hashing
  • **PBKDF2**: Key stretching added
  • **bcrypt**: Memory-hard protection
  • **Argon2**: Modern side-channel resistant
  
  **Migration Handling:**
  • Gradual algorithm upgrades
  • Backward compatibility maintained
  • User login triggers rehashing
| {
  shape: page
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
  near: bottom-right
}