title: Password Hash Data Model

classes: {
  primary: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  secondary: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  flow: {
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

PasswordHashRecord: {
  shape: class
  class: primary
  - "salt: Salt"
  - "hash_result: HashResult"
  - "algorithm_params: AlgorithmParameters"
  - "created_at: DateTime"
  + "verify(password: string): bool"
  + "is_valid(): bool"
}

Salt: {
  shape: class
  class: secondary
  - "value: byte[]"
  - "length: int"
  + "generate(length: int): Salt"
  + "to_bytes(): byte[]"
}

HashResult: {
  shape: class
  class: secondary
  - "value: byte[]"
  - "algorithm: string"
  - "computed_at: DateTime"
  + "compare(other: HashResult): bool"
  + "to_base64(): string"
}

AlgorithmParameters: {
  shape: class
  class: secondary
  - "algorithm_name: string"
  - "iterations: int"
  - "memory_cost: int"
  - "parallelism: int"
  - "output_length: int"
  + "validate(): bool"
  + "get_config(): Map<string,any>"
}

Salt -> PasswordHashRecord: contains {
  class: flow
}

HashResult -> PasswordHashRecord: contains {
  class: flow
}

AlgorithmParameters -> PasswordHashRecord: contains {
  class: flow
}

input_password: "Password Input" {
  shape: oval
  class: secondary
}

hashing_process: "Hash Generation" {
  shape: rectangle
  class: secondary
}

input_password -> Salt: generates {
  class: flow
}

input_password -> hashing_process: uses {
  class: flow
}

Salt -> hashing_process: input {
  class: flow
}

AlgorithmParameters -> hashing_process: configures {
  class: flow
}

hashing_process -> HashResult: produces {
  class: flow
}

verification_note: |md
  **Self-Contained Verification**
  
  All data needed to verify a password
  is stored within PasswordHashRecord
| {
  shape: page
  near: top-right
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}