direction: right

title: Password Hashing System Components {
  near: top-center
  style.font-size: 20
  style.bold: true
  style.font-color: "#e6edf3"
}

classes: {
  core_component: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  interface: {
    style.fill: "#16213e"
    style.stroke: "#58a6ff"
    style.font-color: "#e6edf3"
  }
  external: {
    style.fill: "#0f3460"
    style.stroke: "#f85149"
    style.font-color: "#e6edf3"
  }
}

# External interfaces
registration_api: Password Registration API {
  class: external
  shape: rectangle
}

verification_api: Password Verification API {
  class: external
  shape: rectangle
}

# Core system container
password_system: Password Hashing System {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"

  salt_generator: SaltGenerator {
    class: core_component
    shape: rectangle
  }

  basic_hasher: BasicHasher {
    class: core_component
    shape: rectangle
  }

  key_stretcher: KeyStretcher {
    class: core_component
    shape: rectangle
  }

  modern_hasher: ModernHasher {
    class: core_component
    shape: rectangle
  }

  # Internal dependencies
  basic_hasher -> salt_generator: uses
  key_stretcher -> salt_generator: uses
  key_stretcher -> basic_hasher: uses
  modern_hasher -> salt_generator: uses
}

# External to internal connections
registration_api -> password_system.modern_hasher: hash password {
  style.stroke: "#58a6ff"
}

verification_api -> password_system.modern_hasher: verify password {
  style.stroke: "#58a6ff"
}

# Storage
password_db: Password Database {
  shape: cylinder
  class: interface
}

password_system.modern_hasher -> password_db: store/retrieve hashes {
  style.stroke: "#8b949e"
}

# Component descriptions
salt_note: |md
  **SaltGenerator**
  Generates cryptographically
  secure random salts
| {
  shape: page
  near: bottom-left
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

modern_note: |md
  **ModernHasher**
  Main interface using
  Argon2/bcrypt with
  key stretching
| {
  shape: page
  near: bottom-right
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}