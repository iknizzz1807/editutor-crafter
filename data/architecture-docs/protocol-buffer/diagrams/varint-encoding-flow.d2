title: Varint Encoding Process {
  style.font-size: 20
  style.bold: true
  near: top-center
}

classes: {
  process_step: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  decision: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  data_step: {
    style.fill: "#0f3460"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  final_step: {
    style.fill: "#2d3748"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
}

start: Start {
  shape: circle
  class: process_step
}

input: Input Integer Value {
  class: process_step
}

init_result: Initialize Result Buffer\n(Empty byte array) {
  class: data_step
}

extract_7bits: Extract Lower 7 Bits\n(value & 0x7F) {
  class: process_step
}

shift_right: Right Shift Value\n(value >> 7) {
  class: process_step
}

check_more: More Bits\nRemaining?\n(value > 0) {
  shape: diamond
  class: decision
}

set_continuation: Set Continuation Bit\n(byte |= 0x80) {
  class: data_step
}

append_byte: Append Byte to Result {
  class: process_step
}

final_byte: Final Byte\n(No continuation bit) {
  class: data_step
}

complete: Varint Encoding\nComplete {
  shape: circle
  class: final_step
}

start -> input
input -> init_result
init_result -> extract_7bits
extract_7bits -> shift_right
shift_right -> check_more

check_more -> set_continuation: Yes
set_continuation -> append_byte
append_byte -> extract_7bits: Continue with\nremaining bits

check_more -> final_byte: No
final_byte -> append_byte
append_byte -> complete

example: |md
  **Example: 300 (decimal)**
  - Binary: 100101100
  - Chunk 1: 0101100 (44) + continuation → 10101100 (172)
  - Chunk 2: 0000010 (2) + no continuation → 00000010 (2)
  - Result: [172, 2]
| {
  shape: page
  near: bottom-right
  style.fill: "#2d3748"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}