Cost Estimation Flow {
  shape: sequence_diagram
  style.fill: "#1a1a2e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

QueryOptimizer: Query Optimizer {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

CostEstimator: Cost Estimator {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

StatisticsManager: Statistics Manager {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

SelectivityCalculator: Selectivity Calculator {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

CardinalityEstimator: Cardinality Estimator {
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}

QueryOptimizer -> CostEstimator: estimateOperationCost(operation)
CostEstimator -> StatisticsManager: getTableStatistics(tableName)
StatisticsManager -> CostEstimator: TableStats(rowCount, columnStats)
CostEstimator -> SelectivityCalculator: calculateSelectivity(predicate, stats)
SelectivityCalculator -> SelectivityCalculator: analyzePredicateType(predicate)
SelectivityCalculator -> CostEstimator: selectivity (0.0-1.0)
CostEstimator -> CardinalityEstimator: estimateCardinality(inputSize, selectivity)
CardinalityEstimator -> CostEstimator: estimatedRows
CostEstimator -> CostEstimator: calculateIOCost(estimatedRows)
CostEstimator -> CostEstimator: calculateCPUCost(operation, estimatedRows)
CostEstimator -> QueryOptimizer: TotalCost(ioCost, cpuCost, cardinality)