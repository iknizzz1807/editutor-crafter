direction: right

classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  decision: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  error: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
  }
  success: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

start: Start {
  shape: circle
  class: process
}

load_doc: Load Document {
  class: process
}

validate_file: Validate File {
  shape: diamond
  class: decision
}

detect_format: Detect Format {
  class: process
}

format_check: Supported Format? {
  shape: diamond
  class: decision
}

pdf_extract: PDF Text Extraction {
  class: process
}

html_extract: HTML Text Extraction {
  class: process
}

md_extract: Markdown Text Extraction {
  class: process
}

txt_extract: Plain Text Extraction {
  class: process
}

extract_success: Extraction Success? {
  shape: diamond
  class: decision
}

preserve_metadata: Preserve Metadata {
  class: process
}

select_strategy: Select Chunking Strategy {
  class: process
}

chunk_text: Chunk Text {
  class: process
}

apply_overlap: Apply Overlap {
  class: process
}

validate_chunks: Validate Chunks {
  shape: diamond
  class: decision
}

store_chunks: Store Processed Chunks {
  class: success
}

file_error: File Validation Error {
  class: error
}

format_error: Unsupported Format Error {
  class: error
}

extract_error: Text Extraction Error {
  class: error
}

chunk_error: Chunking Error {
  class: error
}

end: End {
  shape: circle
  class: success
}

start -> load_doc
load_doc -> validate_file
validate_file -> detect_format: Valid
validate_file -> file_error: Invalid
detect_format -> format_check
format_check -> pdf_extract: PDF
format_check -> html_extract: HTML
format_check -> md_extract: Markdown
format_check -> txt_extract: Text
format_check -> format_error: Unknown
pdf_extract -> extract_success
html_extract -> extract_success
md_extract -> extract_success
txt_extract -> extract_success
extract_success -> preserve_metadata: Success
extract_success -> extract_error: Failure
preserve_metadata -> select_strategy
select_strategy -> chunk_text
chunk_text -> apply_overlap
apply_overlap -> validate_chunks
validate_chunks -> store_chunks: Valid
validate_chunks -> chunk_error: Invalid
store_chunks -> end
file_error -> end
format_error -> end
extract_error -> end
chunk_error -> end