classes: {
  component: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  storage: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  external: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.stroke-dash: 3
  }
}

title: System Component Architecture {
  near: top-center
  style.font-size: 20
  style.bold: true
  style.font-color: "#e6edf3"
}

authorization_system: Authorization System {
  class: component
  
  role_engine: Role Engine {
    class: component
    label: "Role Engine\n• User role management\n• Role hierarchy\n• Permission assignment"
  }
  
  policy_engine: Policy Engine {
    class: component
    label: "Policy Engine\n• ABAC policies\n• Rule evaluation\n• Decision making"
  }
  
  audit_logger: Audit Logger {
    class: component
    label: "Audit Logger\n• Access logging\n• Compliance tracking\n• Event streaming"
  }
  
  resource_manager: Resource Manager {
    class: component
    label: "Resource Manager\n• Resource discovery\n• Metadata management\n• Access control"
  }
}

data_layer: Data Layer {
  user_db: User Database {
    shape: cylinder
    class: storage
    label: "User DB\n• Users\n• Roles\n• Groups"
  }
  
  policy_db: Policy Database {
    shape: cylinder
    class: storage
    label: "Policy DB\n• ABAC policies\n• Rules\n• Attributes"
  }
  
  audit_db: Audit Database {
    shape: cylinder
    class: storage
    label: "Audit DB\n• Access logs\n• Events\n• Compliance"
  }
  
  resource_db: Resource Database {
    shape: cylinder
    class: storage
    label: "Resource DB\n• Resources\n• Metadata\n• Hierarchies"
  }
}

cache_layer: Cache Layer {
  redis_cache: Redis Cache {
    shape: cylinder
    class: external
    label: "Redis\n• Policy cache\n• Session data\n• Decisions"
  }
}

external_systems: External Interfaces {
  class: external
  
  api_gateway: API Gateway {
    class: external
    label: "API Gateway\n• Request routing\n• Auth validation"
  }
  
  ldap: LDAP/AD {
    class: external
    label: "LDAP/AD\n• User directory\n• Group sync"
  }
  
  monitoring: Monitoring {
    class: external
    label: "Monitoring\n• Metrics\n• Alerts\n• Health checks"
  }
}

# Core component dependencies
role_engine -> policy_engine: role context
policy_engine -> resource_manager: resource info
policy_engine -> audit_logger: decisions
resource_manager -> audit_logger: access events

# Database connections
role_engine -> user_db: user/role queries
policy_engine -> policy_db: policy retrieval
audit_logger -> audit_db: event storage
resource_manager -> resource_db: resource queries

# Cache connections
role_engine -> redis_cache: role cache
policy_engine -> redis_cache: policy cache
resource_manager -> redis_cache: resource cache

# External interfaces
api_gateway -> role_engine: auth requests
api_gateway -> policy_engine: authorization
role_engine -> ldap: user sync
audit_logger -> monitoring: metrics
policy_engine -> monitoring: performance