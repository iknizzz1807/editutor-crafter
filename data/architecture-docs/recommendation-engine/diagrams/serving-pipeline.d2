shape: sequence_diagram

User: User
Gateway: API Gateway  
Cache: Redis Cache
CandidateGen: Candidate Generator
CollabFilter: Collaborative Filtering
ContentBased: Content-Based Filter
MatrixFactor: Matrix Factorization
HybridCombiner: Hybrid Combiner
Ranker: Final Ranker
ResponseBuilder: Response Builder

User -> Gateway: GET /recommendations/{user_id}
Gateway -> Cache: lookup user recommendations
Cache -> Gateway: cache miss
Gateway -> CandidateGen: generate candidates
CandidateGen -> CollabFilter: get collaborative candidates
CollabFilter -> CandidateGen: candidate items + scores
CandidateGen -> ContentBased: get content-based candidates  
ContentBased -> CandidateGen: candidate items + scores
CandidateGen -> MatrixFactor: get matrix factorization candidates
MatrixFactor -> CandidateGen: candidate items + scores
CandidateGen -> HybridCombiner: merge candidate sets
HybridCombiner -> Ranker: combined candidates + hybrid scores
Ranker -> HybridCombiner: final ranked recommendations
HybridCombiner -> ResponseBuilder: top-N recommendations
ResponseBuilder -> Gateway: formatted response
Gateway -> Cache: store recommendations (TTL=300s)
Gateway -> User: JSON response with recommendations

Gateway.style.fill: "#1a1a2e"
Gateway.style.stroke: "#3fb950"  
Gateway.style.font-color: "#e6edf3"

Cache.style.fill: "#16213e"
Cache.style.stroke: "#3fb950"
Cache.style.font-color: "#e6edf3"

CandidateGen.style.fill: "#0f3460"
CandidateGen.style.stroke: "#3fb950"
CandidateGen.style.font-color: "#e6edf3"
CandidateGen.style.bold: true

HybridCombiner.style.fill: "#0f3460"
HybridCombiner.style.stroke: "#3fb950"
HybridCombiner.style.font-color: "#e6edf3"
HybridCombiner.style.bold: true