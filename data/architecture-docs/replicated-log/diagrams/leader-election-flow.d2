direction: right

classes: {
  node_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  decision_style: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  leader_style: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  arrow_style: {
    style.stroke: "#8b949e"
  }
}

start: Start {
  shape: circle
  class: node_style
  style.fill: "#3fb950"
  label: ""
}

heartbeat_check: Heartbeat\nTimeout? {
  shape: diamond
  class: decision_style
}

start_election: Start\nElection {
  shape: rectangle
  class: node_style
}

request_votes: Request Votes\nfrom Followers {
  shape: rectangle
  class: node_style
}

count_responses: Count Vote\nResponses {
  shape: rectangle
  class: node_style
}

majority_check: Received\nMajority? {
  shape: diamond
  class: decision_style
}

become_leader: Become\nLeader {
  shape: rectangle
  class: leader_style
}

return_follower: Return to\nFollower {
  shape: rectangle
  class: node_style
}

send_heartbeats: Send\nHeartbeats {
  shape: rectangle
  class: leader_style
}

wait_state: Wait for\nHeartbeat {
  shape: rectangle
  class: node_style
}

start -> heartbeat_check {
  class: arrow_style
}

heartbeat_check -> start_election: Yes {
  class: arrow_style
}

heartbeat_check -> wait_state: No {
  class: arrow_style
}

start_election -> request_votes {
  class: arrow_style
}

request_votes -> count_responses {
  class: arrow_style
}

count_responses -> majority_check {
  class: arrow_style
}

majority_check -> become_leader: Yes {
  class: arrow_style
}

majority_check -> return_follower: No {
  class: arrow_style
}

become_leader -> send_heartbeats {
  class: arrow_style
}

return_follower -> wait_state {
  class: arrow_style
}

wait_state -> heartbeat_check {
  class: arrow_style
}

send_heartbeats -> send_heartbeats {
  class: arrow_style
  label: Continue as Leader
}