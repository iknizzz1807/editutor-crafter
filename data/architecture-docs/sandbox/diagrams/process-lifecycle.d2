title: Sandboxed Process Lifecycle

classes: {
  state: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  initial: {
    style.fill: "#3fb950"
    style.stroke: "#3fb950"
    style.font-color: "#1a1a2e"
  }
  final: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.double-border: true
  }
  transition: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

init: {
  shape: circle
  class: initial
  label: ""
}

created: Created {
  shape: circle
  class: state
}

configuring: Configuring {
  shape: circle
  class: state
}

running: Running {
  shape: circle
  class: state
}

terminated: Terminated {
  shape: circle
  class: state
}

cleaned_up: Cleaned Up {
  shape: circle
  class: final
}

init -> created: {
  class: transition
  label: "Process spawn request"
}

created -> configuring: {
  class: transition
  label: "Setup namespaces,\ncgroups, capabilities"
}

configuring -> running: {
  class: transition
  label: "Configuration complete,\nexec() target binary"
}

configuring -> terminated: {
  class: transition
  label: "Setup failure,\nsecurity violation"
}

running -> terminated: {
  class: transition
  label: "Process exit,\nkill signal,\nresource limit exceeded"
}

terminated -> cleaned_up: {
  class: transition
  label: "Cleanup namespaces,\nrelease resources,\nlog final state"
}

created -> terminated: {
  class: transition
  label: "Early termination\nrequest"
}

running -> running: {
  class: transition
  label: "System calls,\nseccomp filtering,\nresource monitoring"
}