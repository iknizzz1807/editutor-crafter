title: Function Instance Lifecycle

direction: right

states: {
  start: {
    shape: circle
    style.fill: "#3fb950"
    style.stroke: "#3fb950"
  }

  PROVISIONING: {
    shape: rectangle
    style: {
      fill: "#0f3460"
      stroke: "#3fb950"
      font-color: "#e6edf3"
      bold: true
    }
  }

  READY: Warm State {
    shape: rectangle
    style: {
      fill: "#0f3460"
      stroke: "#3fb950"
      font-color: "#e6edf3"
    }
  }

  ACTIVE: {
    shape: rectangle
    style: {
      fill: "#0f3460"
      stroke: "#3fb950"
      font-color: "#e6edf3"
    }
  }

  DRAINING: {
    shape: rectangle
    style: {
      fill: "#0f3460"
      stroke: "#3fb950"
      font-color: "#e6edf3"
    }
  }

  TERMINATED: {
    shape: rectangle
    style: {
      fill: "#0f3460"
      stroke: "#3fb950"
      font-color: "#e6edf3"
    }
  }
}

end: {
  shape: circle
  style.multiple: true
  style.stroke: "#3fb950"
}

# Initial transition
start -> PROVISIONING

# State transitions
PROVISIONING -> READY: "provisioning successful"
READY -> ACTIVE: "request assigned"
ACTIVE -> READY: "execution finished\n(no scale-down)"
ACTIVE -> DRAINING: "execution finished\n(scale-down signaled)"
READY -> DRAINING: "scale-down signal"
DRAINING -> TERMINATED: "draining complete"
PROVISIONING -> TERMINATED: "provisioning failed"

# Final state
TERMINATED -> end