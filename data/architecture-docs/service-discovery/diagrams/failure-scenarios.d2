classes: {
  failure: {
    style.fill: "#d63031"
    style.font-color: "#ffffff"
    style.stroke: "#e17055"
    style.bold: true
  }
  recovery: {
    style.fill: "#00b894"
    style.font-color: "#ffffff"
    style.stroke: "#00a085"
    style.bold: true
  }
  decision: {
    style.fill: "#0984e3"
    style.font-color: "#ffffff"
    style.stroke: "#74b9ff"
    style.bold: true
  }
  action: {
    style.fill: "#1a1a2e"
    style.font-color: "#e6edf3"
    style.stroke: "#3fb950"
  }
}

start: Start {
  shape: circle
  style.fill: "#3fb950"
  label: ""
}

failure_detected: Failure Detected {
  class: action
}

failure_type: Determine Failure Type {
  shape: diamond
  class: decision
}

network_timeout: Network Timeout? {
  shape: diamond
  class: decision
}

service_unavailable: Service Unavailable? {
  shape: diamond
  class: decision
}

registry_error: Registry Error? {
  shape: diamond
  class: decision
}

retry_timeout: Retry with\nExponential Backoff {
  class: recovery
}

timeout_exceeded: Max Retries\nExceeded? {
  shape: diamond
  class: decision
}

mark_unhealthy: Mark Service\nUnhealthy {
  class: action
}

circuit_breaker: Activate\nCircuit Breaker {
  class: recovery
}

health_check: Perform\nHealth Check {
  class: action
}

service_recovered: Service\nRecovered? {
  shape: diamond
  class: decision
}

restore_service: Restore Service\nTo Registry {
  class: recovery
}

rollback_registry: Rollback Registry\nState {
  class: recovery
}

validate_data: Validate Registry\nData Integrity {
  class: action
}

data_corrupted: Data\nCorrupted? {
  shape: diamond
  class: decision
}

rebuild_registry: Rebuild Registry\nFrom Backup {
  class: recovery
}

log_error: Log Error\nand Alert {
  class: failure
}

monitor: Continue\nMonitoring {
  class: action
}

end: End {
  shape: circle
  style.fill: "#d63031"
  label: ""
}

start -> failure_detected
failure_detected -> failure_type

failure_type -> network_timeout: Network Issue
failure_type -> service_unavailable: Service Issue  
failure_type -> registry_error: Registry Issue

network_timeout -> retry_timeout: Yes
retry_timeout -> timeout_exceeded
timeout_exceeded -> mark_unhealthy: Yes
timeout_exceeded -> monitor: No
mark_unhealthy -> log_error

service_unavailable -> circuit_breaker: Yes
circuit_breaker -> health_check
health_check -> service_recovered
service_recovered -> restore_service: Yes
service_recovered -> monitor: No
restore_service -> monitor

registry_error -> rollback_registry: Yes
rollback_registry -> validate_data
validate_data -> data_corrupted
data_corrupted -> rebuild_registry: Yes
data_corrupted -> monitor: No
rebuild_registry -> monitor

log_error -> end
monitor -> end