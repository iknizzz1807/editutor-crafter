Session Data Model: {
  style.fill: "#0f3460"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"

  User: {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    - "user_id: string"
    - "username: string"
    - "email: string"
    - "created_at: timestamp"
    - "updated_at: timestamp"
    + "authenticate(credentials: AuthData): boolean"
    + "create_session(device: Device): Session"
  }

  Session: {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    - "session_id: string"
    - "user_id: string"
    - "device_id: string"
    - "csrf_token_id: string"
    - "created_at: timestamp"
    - "last_accessed: timestamp"
    - "expires_at: timestamp"
    - "ip_address: string"
    - "user_agent: string"
    - "is_active: boolean"
    + "validate(): boolean"
    + "refresh(): void"
    + "invalidate(): void"
    + "update_access_time(): void"
  }

  Device: {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    - "device_id: string"
    - "user_id: string"
    - "device_fingerprint: string"
    - "device_name: string"
    - "browser: string"
    - "os: string"
    - "last_seen: timestamp"
    - "is_trusted: boolean"
    + "generate_fingerprint(): string"
    + "verify_fingerprint(fingerprint: string): boolean"
    + "mark_as_trusted(): void"
  }

  CSRFToken: {
    shape: class
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    - "token_id: string"
    - "session_id: string"
    - "token_value: string"
    - "created_at: timestamp"
    - "expires_at: timestamp"
    - "used_count: integer"
    - "max_uses: integer"
    + "validate(token: string): boolean"
    + "rotate(): string"
    + "increment_usage(): void"
  }

  User -> Session: "1 to many\n(has many sessions)" {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }

  User -> Device: "1 to many\n(owns multiple devices)" {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }

  Session -> Device: "many to 1\n(belongs to device)" {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }

  Session -> CSRFToken: "1 to 1\n(has csrf token)" {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

classes: {
  title_style: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    style.font-size: 16
  }
}