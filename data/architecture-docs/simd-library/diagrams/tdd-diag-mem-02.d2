classes: {
  interface: {
    style: {
      stroke-dash: 5
      fill: "#f5f5f5"
    }
  }
  struct: {
    style: {
      fill: "#e1f5fe"
      stroke: "#01579b"
    }
  }
  manager: {
    style: {
      fill: "#fff3e0"
      stroke: "#ef6c00"
      bold: true
    }
  }
}

MemoryManagement: {
  label: Aligned Memory & Buffer Manager (AMBM)

  OS_Abstraction: {
    label: Layer 0: OS Abstraction
    
    LowLevelAPI: {
      shape: class
      label: "PlatformAllocator"
      +PosixMemalign(size, align): int
      +WinAlignedMalloc(size, align): void*
      +MmapHugePages(size): void*
    }
  }

  Core_Logic: {
    label: Layer 1: Aligned Pointer Arithmetic
    
    AlignedBlockHeader: {
      shape: class
      class: struct
      +original_ptr: void*
      +requested_size: size_t
      +alignment_offset: uint32_t
      +magic_canary: uint32_t
    }

    AlignedBufferManager: {
      shape: class
      class: manager
      +Allocate(size: size_t, align: size_t): void*
      +Free(ptr: void*): void
      +IsAligned(ptr: void*, align: size_t): bool
      -CalculatePadding(raw: uintptr_t, align: size_t): size_t
    }
  }

  High_Level_Wrappers: {
    label: Layer 2: RAII Templates
    
    AlignedVector: {
      shape: class
      label: "AlignedVector<T>"
      -data: T*
      -capacity: size_t
      -alignment: size_t
      +resize(n: size_t): void
      +data(): T*
      +~AlignedVector()
    }
  }

  # Internal Relationships
  High_Level_Wrappers.AlignedVector -> Core_Logic.AlignedBufferManager: "uses for lifecycle"
  Core_Logic.AlignedBufferManager -> Core_Logic.AlignedBlockHeader: "embeds in allocation"
  Core_Logic.AlignedBufferManager -> OS_Abstraction.LowLevelAPI: "calls for raw heap"
}

# External Module Links
HDDE_Link: Hardware Detection Engine {
  shape: package
  style.stroke-dash: 3
  link: "layers.mod-hardware-dispatch"
}

MemoryManagement.High_Level_Wrappers.AlignedVector -> HDDE_Link: "queries optimal alignment" {
  style.stroke: gray
}

# Global Styles
MemoryManagement.style: {
  fill: "#fafafa"
  stroke: "#333333"
  stroke-width: 2
}

***.style.font-size: 14