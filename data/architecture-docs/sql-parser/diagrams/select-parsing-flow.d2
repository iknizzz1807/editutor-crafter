classes: {
  process: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  decision: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  error: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
  }
  success: {
    style.fill: "#00b894"
    style.stroke: "#3fb950"
    style.font-color: "#ffffff"
  }
}

start: Start Parsing {
  shape: circle
  class: process
}

parse_select: Parse SELECT Keyword {
  class: process
}

select_error: SELECT Expected {
  class: error
}

parse_columns: Parse Column List {
  class: process
}

columns_error: Invalid Column Expression {
  class: error
}

check_from: FROM Present? {
  shape: diamond
  class: decision
}

parse_from: Parse FROM Clause {
  class: process
}

from_error: Invalid Table Reference {
  class: error
}

check_where: WHERE Present? {
  shape: diamond
  class: decision
}

parse_where: Parse WHERE Condition {
  class: process
}

where_error: Invalid WHERE Expression {
  class: error
}

check_group: GROUP BY Present? {
  shape: diamond
  class: decision
}

parse_group: Parse GROUP BY {
  class: process
}

group_error: Invalid GROUP BY {
  class: error
}

check_having: HAVING Present? {
  shape: diamond
  class: decision
}

parse_having: Parse HAVING Condition {
  class: process
}

having_error: Invalid HAVING Expression {
  class: error
}

check_order: ORDER BY Present? {
  shape: diamond
  class: decision
}

parse_order: Parse ORDER BY {
  class: process
}

order_error: Invalid ORDER BY {
  class: error
}

check_limit: LIMIT Present? {
  shape: diamond
  class: decision
}

parse_limit: Parse LIMIT Clause {
  class: process
}

limit_error: Invalid LIMIT Value {
  class: error
}

build_ast: Build SELECT AST {
  class: success
}

complete: Parsing Complete {
  shape: circle
  class: success
}

error_recovery: Error Recovery {
  class: error
}

start -> parse_select
parse_select -> parse_columns: Success
parse_select -> select_error: Invalid token
parse_columns -> check_from: Success
parse_columns -> columns_error: Parse error

check_from -> parse_from: Yes
check_from -> check_where: No (subquery)

parse_from -> check_where: Success
parse_from -> from_error: Parse error

check_where -> parse_where: Yes
check_where -> check_group: No

parse_where -> check_group: Success
parse_where -> where_error: Parse error

check_group -> parse_group: Yes
check_group -> check_having: No

parse_group -> check_having: Success
parse_group -> group_error: Parse error

check_having -> parse_having: Yes
check_having -> check_order: No

parse_having -> check_order: Success
parse_having -> having_error: Parse error

check_order -> parse_order: Yes
check_order -> check_limit: No

parse_order -> check_limit: Success
parse_order -> order_error: Parse error

check_limit -> parse_limit: Yes
check_limit -> build_ast: No

parse_limit -> build_ast: Success
parse_limit -> limit_error: Parse error

build_ast -> complete

select_error -> error_recovery
columns_error -> error_recovery
from_error -> error_recovery
where_error -> error_recovery
group_error -> error_recovery
having_error -> error_recovery
order_error -> error_recovery
limit_error -> error_recovery

error_recovery -> complete: Recover and continue