title: System Component Architecture

classes: {
  component: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  data: {
    style.fill: "#16213e"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  flow: {
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

pty_manager: PTY Manager {
  class: component
  pty_sessions: PTY Sessions {
    class: data
    shape: cylinder
  }
  process_spawn: Process Spawning
  session_lifecycle: Session Lifecycle
}

terminal_emulator: Terminal Emulator {
  class: component
  escape_parser: Escape Sequence Parser
  screen_buffer: Screen Buffer {
    class: data
    shape: cylinder
  }
  cursor_state: Cursor State
}

window_manager: Window Manager {
  class: component
  layout_engine: Layout Engine
  pane_management: Pane Management
  display_output: Display Output {
    class: data
    shape: parallelogram
  }
}

input_handler: Input Handler {
  class: component
  key_capture: Key Capture
  command_router: Command Router
  focus_manager: Focus Manager
}

external_shell: External Shell Process {
  class: data
  shape: hexagon
}

user_terminal: User Terminal {
  class: data
  shape: hexagon
}

# Data flow connections
external_shell -> pty_manager.pty_sessions: shell output {
  class: flow
}

pty_manager.pty_sessions -> terminal_emulator.screen_buffer: raw terminal data {
  class: flow
}

terminal_emulator.screen_buffer -> window_manager.display_output: processed screen data {
  class: flow
}

window_manager.display_output -> user_terminal: rendered output {
  class: flow
}

user_terminal -> input_handler.key_capture: user input {
  class: flow
}

input_handler.command_router -> window_manager.pane_management: window commands {
  class: flow
}

input_handler.focus_manager -> pty_manager.pty_sessions: terminal input {
  class: flow
}

# Component interactions
pty_manager -> terminal_emulator: PTY data stream {
  class: flow
}

terminal_emulator -> window_manager: screen updates {
  class: flow
}

input_handler <-> window_manager: focus & layout events {
  class: flow
}

input_handler <-> pty_manager: session control {
  class: flow
}