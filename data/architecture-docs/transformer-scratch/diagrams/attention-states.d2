classes: {
  state: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  initial_state: {
    style.fill: "#3fb950"
    style.stroke: "#3fb950"
    style.font-color: "#1a1a2e"
    style.bold: true
  }
  final_state: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    style.double-border: true
  }
  transition: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

init: {
  shape: circle
  class: initial_state
  label: ""
}

input_processing: {
  shape: circle
  class: state
  label: "Input\nProcessing"
}

qkv_projection: {
  shape: circle
  class: state
  label: "Q/K/V\nProjection"
}

score_computation: {
  shape: circle
  class: state
  label: "Score\nComputation"
}

masking: {
  shape: circle
  class: state
  label: "Masking"
}

normalization: {
  shape: circle
  class: state
  label: "Softmax\nNormalization"
}

attention_weighting: {
  shape: circle
  class: state
  label: "Attention\nWeighting"
}

output_generation: {
  shape: circle
  class: final_state
  label: "Output\nGeneration"
}

init -> input_processing: {
  class: transition
  label: "begin"
}

input_processing -> qkv_projection: {
  class: transition
  label: "embed tokens"
}

qkv_projection -> score_computation: {
  class: transition
  label: "linear transform"
}

score_computation -> masking: {
  class: transition
  label: "Q @ K^T"
}

masking -> normalization: {
  class: transition
  label: "apply mask"
}

normalization -> attention_weighting: {
  class: transition
  label: "softmax"
}

attention_weighting -> output_generation: {
  class: transition
  label: "weight values"
}

score_computation -> score_computation: {
  class: transition
  label: "scale by âˆšd_k"
}

masking -> masking: {
  class: transition
  label: "causal/padding mask"
}