classes: {
  container: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  process: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  decision: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  data: {
    style.fill: "#2d1b69"
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
  error: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
  }
}

input_ast: Input AST {
  shape: page
  class: data
}

type_env: Type Environment {
  shape: cylinder
  class: data
}

ast_traversal: AST Traversal {
  class: process
}

expr_synthesis: Expression Type Synthesis {
  class: process
}

stmt_checking: Statement Type Checking {
  class: process
}

constraint_gen: Constraint Generation {
  class: process
}

has_constraints: Constraints Generated? {
  shape: diamond
  class: decision
}

unification: Unification Engine {
  class: process
}

unify_success: Unification Success? {
  shape: diamond
  class: decision
}

substitution: Apply Substitution {
  class: process
}

error_reporter: Error Reporter {
  class: error
}

type_errors: Type Errors {
  shape: page
  class: error
}

typed_ast: Final Typed AST {
  shape: page
  class: data
}

input_ast -> ast_traversal: parse
type_env -> ast_traversal: context

ast_traversal -> expr_synthesis: expressions
ast_traversal -> stmt_checking: statements

expr_synthesis -> constraint_gen: type requirements
stmt_checking -> constraint_gen: type constraints

constraint_gen -> has_constraints

has_constraints -> unification: Yes
has_constraints -> typed_ast: No (basic checking only)

unification -> unify_success

unify_success -> substitution: Success
unify_success -> error_reporter: Failure

substitution -> typed_ast: inferred types

error_reporter -> type_errors: generate

type_env -> expr_synthesis: variable types
type_env -> stmt_checking: scope info
type_env -> unification: type context