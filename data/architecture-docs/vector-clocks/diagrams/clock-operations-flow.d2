classes: {
  process: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  decision: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  endpoint: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    style.double-border: true
  }
}

title: "Vector Clock Operations Flow" {
  style.font-size: 18
  style.font-color: "#e6edf3"
  style.bold: true
  near: top-center
}

start: Start {
  shape: circle
  class: process
}

operation_type: "Operation Type?" {
  shape: diamond
  class: decision
}

increment_flow: "Increment Operation" {
  local_event: "Local Event Occurs" {
    class: process
  }
  
  get_node_id: "Get Node ID" {
    class: process
  }
  
  increment_counter: "Increment VC[node_id]" {
    class: process
  }
  
  increment_done: "Increment Complete" {
    class: endpoint
  }
  
  local_event -> get_node_id
  get_node_id -> increment_counter
  increment_counter -> increment_done
}

merge_flow: "Merge Operation" {
  receive_msg: "Receive Message with VC" {
    class: process
  }
  
  compare_clocks: "Compare Each Element" {
    class: process
  }
  
  take_max: "Take Max(local[i], remote[i])" {
    class: process
  }
  
  increment_local: "Increment Local Node Counter" {
    class: process
  }
  
  merge_done: "Merge Complete" {
    class: endpoint
  }
  
  receive_msg -> compare_clocks
  compare_clocks -> take_max
  take_max -> increment_local
  increment_local -> merge_done
}

compare_flow: "Compare Operation" {
  get_two_clocks: "Get Two Vector Clocks" {
    class: process
  }
  
  check_relation: "Check Causal Relation?" {
    shape: diamond
    class: decision
  }
  
  concurrent: "Concurrent\n(Incomparable)" {
    class: endpoint
  }
  
  happens_before: "A Happens Before B" {
    class: endpoint
  }
  
  happens_after: "B Happens Before A" {
    class: endpoint
  }
  
  identical: "Identical Clocks" {
    class: endpoint
  }
  
  get_two_clocks -> check_relation
  check_relation -> concurrent: "Neither ≤ other"
  check_relation -> happens_before: "A ≤ B and A ≠ B"
  check_relation -> happens_after: "B ≤ A and A ≠ B"
  check_relation -> identical: "A = B"
}

start -> operation_type

operation_type -> increment_flow.local_event: Increment
operation_type -> merge_flow.receive_msg: Merge
operation_type -> compare_flow.get_two_clocks: Compare