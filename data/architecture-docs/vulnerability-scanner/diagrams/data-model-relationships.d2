classes: {
  entity_style: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  relationship_style: {
    style.stroke: "#8b949e"
    style.font-color: "#e6edf3"
  }
}

title: Data Model Relationships {
  near: top-center
  style.font-size: 18
  style.font-color: "#e6edf3"
  style.bold: true
}

Host: {
  shape: class
  class: entity_style
  - "id: int"
  - "ip_address: string"
  - "hostname: string"
  - "mac_address: string"
  - "os_fingerprint: string"
  - "status: HostStatus"
  - "first_seen: datetime"
  - "last_seen: datetime"
  + "is_alive(): boolean"
  + "get_open_ports(): List<Port>"
}

Service: {
  shape: class
  class: entity_style
  - "id: int"
  - "host_id: int"
  - "port: int"
  - "protocol: string"
  - "service_name: string"
  - "version: string"
  - "banner: string"
  - "state: ServiceState"
  - "fingerprint_confidence: float"
  + "is_vulnerable(): boolean"
  + "get_cpe_string(): string"
}

Vulnerability: {
  shape: class
  class: entity_style
  - "id: int"
  - "cve_id: string"
  - "title: string"
  - "description: text"
  - "severity: SeverityLevel"
  - "cvss_score: float"
  - "published_date: date"
  - "affected_products: string[]"
  - "references: string[]"
  + "matches_service(service: Service): boolean"
  + "get_remediation(): string"
}

ScanResult: {
  shape: class
  class: entity_style
  - "id: int"
  - "service_id: int"
  - "vulnerability_id: int"
  - "scan_id: int"
  - "detection_method: string"
  - "confidence_score: float"
  - "evidence: text"
  - "detected_at: datetime"
  - "verified: boolean"
  + "false_positive(): boolean"
  + "get_exploit_available(): boolean"
}

Report: {
  shape: class
  class: entity_style
  - "id: int"
  - "scan_id: int"
  - "title: string"
  - "created_at: datetime"
  - "summary: text"
  - "total_hosts: int"
  - "total_vulnerabilities: int"
  - "risk_score: float"
  + "generate_pdf(): bytes"
  + "export_json(): string"
  + "get_executive_summary(): string"
}

Host -> Service: "hosts\n1:N" {
  class: relationship_style
}

Service -> ScanResult: "tested for\n1:N" {
  class: relationship_style
}

Vulnerability -> ScanResult: "found in\n1:N" {
  class: relationship_style
}

ScanResult -> Report: "included in\nN:1" {
  class: relationship_style
}

Host -> Report: "summarized in\nN:M" {
  class: relationship_style
  style.stroke-dash: 3
}

legend: |md
  ## Relationships
  - **Solid lines**: Direct foreign key relationships
  - **Dashed lines**: Derived/aggregated relationships
  - **1:N**: One-to-many relationship
  - **N:M**: Many-to-many relationship
| {
  shape: page
  near: bottom-right
  style.fill: "#16213e"
  style.stroke: "#3fb950"
  style.font-color: "#e6edf3"
}