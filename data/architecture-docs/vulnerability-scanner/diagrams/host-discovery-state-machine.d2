direction: right

classes: {
  state: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  final_state: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
    style.double-border: true
  }
  error_state: {
    style.fill: "#d63031"
    style.stroke: "#e17055"
    style.font-color: "#ffffff"
    style.bold: true
  }
}

init: {
  shape: circle
  style.fill: "#3fb950"
  label: ""
  style.stroke: "#3fb950"
}

unknown: Unknown {
  shape: circle
  class: state
}

probing: Probing {
  shape: circle
  class: state
}

responsive: Responsive {
  shape: circle
  class: state
}

unresponsive: Unresponsive {
  shape: circle
  class: state
}

scanned: Scanned {
  shape: circle
  class: final_state
}

timeout: Timeout {
  shape: circle
  class: error_state
}

max_retries: Max Retries Exceeded {
  shape: circle
  class: error_state
}

init -> unknown: Start Discovery

unknown -> probing: Begin Scan\n(ICMP/TCP/ARP)

probing -> responsive: Host Responds\n(Any Protocol)

probing -> unresponsive: No Response\n(All Protocols)

probing -> timeout: Scan Timeout

probing -> probing: Retry\n(< max_attempts)

timeout -> probing: Retry Scan\n(< max_attempts)

timeout -> max_retries: Retry Limit\nReached

responsive -> scanned: Mark as Live\nHost

unresponsive -> probing: Retry Different\nProtocol

unresponsive -> scanned: Mark as Dead\nHost (after retries)

max_retries -> scanned: Mark as\nUnknown Status

title: Host Discovery State Machine {
  near: top-center
  style.font-size: 20
  style.font-color: "#e6edf3"
  style.bold: true
}