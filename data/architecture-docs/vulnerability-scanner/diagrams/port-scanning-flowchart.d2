title: Port Scanning Decision Flow
direction: down

classes: {
  decision: {
    shape: diamond
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  process: {
    shape: rectangle
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  scan_technique: {
    shape: rectangle
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  start_end: {
    shape: oval
    style.fill: "#3fb950"
    style.font-color: "#1a1a2e"
    style.bold: true
  }
}

start: Start {
  class: start_end
}

host_discovery: Host Discovery\nPhase {
  class: process
}

target_type: What type of\ntarget? {
  class: decision
}

privileges_check: Running with\nroot/admin\nprivileges? {
  class: decision
}

stealth_required: Stealth\nrequired? {
  class: decision
}

udp_check: Need UDP\nservice\ndiscovery? {
  class: decision
}

icmp_ping: ICMP Ping Sweep {
  class: scan_technique
}

tcp_connect: TCP Connect Scan\n(Full handshake) {
  class: scan_technique
}

syn_scan: SYN Scan\n(Half-open) {
  class: scan_technique
}

udp_scan: UDP Scan {
  class: scan_technique
}

combine_results: Combine\nScan Results {
  class: process
}

service_fingerprint: Proceed to\nService Fingerprinting {
  class: start_end
}

start -> host_discovery
host_discovery -> target_type

target_type -> icmp_ping: Single host\nor small range
target_type -> privileges_check: Network range\nor multiple hosts

privileges_check -> stealth_required: Yes
privileges_check -> tcp_connect: No

stealth_required -> syn_scan: Yes
stealth_required -> tcp_connect: No

icmp_ping -> udp_check
tcp_connect -> udp_check
syn_scan -> udp_check

udp_check -> udp_scan: Yes
udp_check -> combine_results: No
udp_scan -> combine_results

combine_results -> service_fingerprint