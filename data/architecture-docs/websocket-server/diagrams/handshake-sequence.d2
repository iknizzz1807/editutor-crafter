shape: sequence_diagram

client: Client
server: HTTP Server
handler: Handshake Handler

client -> server: GET /websocket\nUpgrade: websocket\nConnection: Upgrade\nSec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==\nSec-WebSocket-Version: 13
server -> handler: validate_upgrade_request()
handler -> handler: check required headers
handler -> handler: validate Sec-WebSocket-Key
handler -> handler: generate accept key\n(SHA-1 + base64)
handler -> server: validation_result
server -> client: HTTP/1.1 101 Switching Protocols\nUpgrade: websocket\nConnection: Upgrade\nSec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=
client -> client: verify accept key
client -> server: WebSocket connection established

client.style.fill: "#1a1a2e"
client.style.stroke: "#3fb950"
client.style.font-color: "#e6edf3"

server.style.fill: "#1a1a2e"
server.style.stroke: "#3fb950"
server.style.font-color: "#e6edf3"

handler.style.fill: "#16213e"
handler.style.stroke: "#3fb950"
handler.style.font-color: "#e6edf3"
handler.style.bold: true