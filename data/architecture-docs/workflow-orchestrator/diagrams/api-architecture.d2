direction: right

classes: {
  ui_component: {
    style.fill: "#1a1a2e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
    style.bold: true
  }
  api_component: {
    style.fill: "#16213e"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
  core_component: {
    style.fill: "#0f3460"
    style.stroke: "#3fb950"
    style.font-color: "#e6edf3"
  }
}

title: API and UI Architecture {
  near: top-center
  style.font-size: 18
  style.bold: true
  style.font-color: "#e6edf3"
}

frontend: Frontend Layer {
  class: ui_component
  
  web_ui: Web UI {
    class: ui_component
    shape: rectangle
  }
  
  browser: Browser Client {
    class: ui_component
    shape: rectangle
  }
}

api_layer: API Layer {
  class: api_component
  
  rest_api: REST API {
    class: api_component
    shape: rectangle
  }
  
  websocket: WebSocket Handler {
    class: api_component
    shape: rectangle
  }
  
  auth: Authentication {
    class: api_component
    shape: rectangle
  }
}

core_services: Core Orchestrator {
  class: core_component
  
  scheduler: Scheduler Engine {
    class: core_component
    shape: rectangle
  }
  
  dag_manager: DAG Manager {
    class: core_component
    shape: rectangle
  }
  
  task_executor: Task Executor {
    class: core_component
    shape: rectangle
  }
  
  monitor: Monitoring Service {
    class: core_component
    shape: rectangle
  }
}

data_layer: Data Layer {
  class: core_component
  
  metadata_db: Metadata DB {
    class: core_component
    shape: cylinder
  }
  
  task_queue: Task Queue {
    class: core_component
    shape: queue
  }
}

# Frontend to API connections
web_ui -> rest_api: HTTP Requests\n(DAG Management)
web_ui -> websocket: Real-time Updates\n(Task Status)
browser -> auth: Authentication

# API to Core connections
rest_api -> dag_manager: CRUD Operations
rest_api -> scheduler: Schedule Control
websocket -> monitor: Status Subscriptions
auth -> rest_api: Validated Requests

# Core service connections
scheduler -> task_executor: Execute Tasks
dag_manager -> metadata_db: Store DAGs
task_executor -> task_queue: Queue Tasks
monitor -> metadata_db: Read Status
monitor -> websocket: Push Updates

# Data flow
task_executor -> metadata_db: Update Status
scheduler -> metadata_db: Read Schedules