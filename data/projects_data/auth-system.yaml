id: auth-system
name: Authentication System
description: >
  Build a complete authentication system with JWT tokens, OAuth2 flows,
  session management, and refresh token rotation for modern web applications.

difficulty: intermediate
estimated_hours: 30-40
domain: app-dev

essence: >
  Secure password storage with bcrypt/argon2, JWT token generation and
  validation, OAuth2 authorization code flow integration, refresh token
  management with rotation, and session security best practices.

why_important: >
  Authentication is fundamental to almost every application. Understanding
  auth deeply is valuable at $130K-220K+ for full-stack and backend
  engineers, especially at companies handling sensitive data.

learning_outcomes:
  - Implement secure password hashing (bcrypt/argon2)
  - Generate and validate JWT tokens
  - Implement OAuth2 authorization code flow
  - Build refresh token rotation system
  - Handle session management securely
  - Implement rate limiting for auth endpoints
  - Handle multi-factor authentication basics
  - Understand common auth vulnerabilities

skills:
  - Password Hashing
  - JWT Tokens
  - OAuth2
  - Session Management
  - Refresh Tokens
  - Rate Limiting
  - MFA Basics
  - Security Best Practices

tags:
  - authentication
  - authorization
  - intermediate
  - jwt
  - oauth2
  - security
  - sessions
  - web

languages:
  recommended:
    - TypeScript
    - Python
    - Go
  also_possible:
    - Rust
    - Java

resources:
  - name: "OAuth 2.0 Simplified"
    url: https://www.oauth.com/
    type: book
  - name: "JWT.io Introduction"
    url: https://jwt.io/introduction
    type: documentation
  - name: "OWASP Authentication Cheat Sheet"
    url: https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html
    type: documentation
  - name: "RFC 6749 - OAuth 2.0"
    url: https://datatracker.ietf.org/doc/html/rfc6749
    type: specification

prerequisites:
  - type: skill
    name: Backend web development basics
  - type: skill
    name: Understanding of HTTP and cookies
  - type: skill
    name: Database basics for user storage
  - type: project
    name: http-server-basic or equivalent

milestones:
  - id: auth-m1
    name: Password Authentication
    description: >
      Implement user registration and login with secure password storage.
    acceptance_criteria:
      - User registration with email/password
      - Password hashing with bcrypt or argon2
      - Password verification on login
      - Email uniqueness validation
      - Password strength requirements
      - Protection against timing attacks
      - Secure error messages (no information leakage)
    pitfalls:
      - Storing plaintext passwords (catastrophic)
      - Using fast hash functions (MD5, SHA1)
      - Timing attacks on login verification
      - Error messages reveal user existence
      - No rate limiting allows brute force
    concepts:
      - Password hashing
      - Salt generation
      - Timing attacks
      - Secure storage
    skills:
      - bcrypt/argon2 usage
      - Salt handling
      - Input validation
      - Secure coding
    deliverables:
      - Registration endpoint
      - Login endpoint
      - Password hashing module
      - Validation logic
    estimated_hours: "6-8"

  - id: auth-m2
    name: JWT Token System
    description: >
      Implement JWT access tokens with proper claims, signing, and validation.
    acceptance_criteria:
      - JWT generation with standard claims (sub, iat, exp)
      - Configurable token expiration
      - Token signing with HMAC or RSA
      - Token validation including expiration
      - Token refresh mechanism
      - Secure secret key management
      - Token revocation support (optional)
    pitfalls:
      - Storing sensitive data in JWT payload
      - Not validating token expiration
      - Weak signing secrets
      - Not checking algorithm (alg none attack)
      - JWT in localStorage vulnerable to XSS
    concepts:
      - JWT structure
      - Claims
      - Signing algorithms
      - Token lifecycle
    skills:
      - JWT generation
      - Token validation
      - Key management
      - Security awareness
    deliverables:
      - JWT generator
      - JWT validator
      - Token refresh
      - Key configuration
    estimated_hours: "6-8"

  - id: auth-m3
    name: OAuth2 Integration
    description: >
      Implement OAuth2 authorization code flow for third-party login
      (Google, GitHub, etc.).
    acceptance_criteria:
      - OAuth2 authorization code flow
      - State parameter for CSRF protection
      - PKCE support for public clients
      - Token exchange for access/refresh tokens
      - User info retrieval from provider
      - Account linking for existing users
      - Multiple provider support
    pitfalls:
      - Missing state parameter allows CSRF
      - Not validating ID token signature
      - Redirect URI validation bypasses
      - Storing tokens insecurely
      - Not handling token expiration
    concepts:
      - OAuth2 flows
      - Authorization code
      - PKCE
      - Provider integration
    skills:
      - OAuth implementation
      - Provider APIs
      - CSRF protection
      - Token handling
    deliverables:
      - OAuth flow handler
      - State management
      - Token exchange
      - Provider abstraction
    estimated_hours: "8-10"

  - id: auth-m4
    name: Refresh Token Rotation
    description: >
      Implement secure refresh token management with rotation and revocation.
    acceptance_criteria:
      - Refresh token generation
      - Refresh token rotation on use
      - Token family tracking for reuse detection
      - Automatic revocation on reuse detection
      - Secure storage (httpOnly cookies)
      - Token expiration and cleanup
      - Concurrent refresh handling
    pitfalls:
      - Refresh token theft enables persistent access
      - Not rotating tokens allows replay
      - Reuse detection needs family tracking
      - Concurrent requests cause race conditions
      - Not cleaning up expired tokens
    concepts:
      - Token rotation
      - Reuse detection
      - Token families
      - Secure storage
    skills:
      - Rotation implementation
      - Detection logic
      - Cookie security
      - Concurrency handling
    deliverables:
      - Refresh token system
      - Rotation logic
      - Reuse detector
      - Cleanup job
    estimated_hours: "6-8"

  - id: auth-m5
    name: Session Security & Hardening
    description: >
      Add security hardening including rate limiting, MFA basics, and
      security headers.
    acceptance_criteria:
      - Rate limiting on auth endpoints
      - Account lockout after failed attempts
      - Security headers (CSP, HSTS, X-Frame-Options)
      - Secure cookie settings
      - Basic TOTP MFA (optional)
      - Audit logging for auth events
      - Password reset flow
    pitfalls:
      - Rate limiting too strict locks legitimate users
      - Account lockout enables DoS
      - Missing security headers
      - Cookie misconfiguration
      - Logging sensitive data
    concepts:
      - Rate limiting
      - Account lockout
      - Security headers
      - MFA
    skills:
      - Rate limiting
      - Security hardening
      - Logging
      - User experience
    deliverables:
      - Rate limiter
      - Lockout mechanism
      - Security headers
      - Audit logging
      - Password reset
    estimated_hours: "6-8"
