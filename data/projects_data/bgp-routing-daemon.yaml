id: bgp-routing-daemon
name: BGP Routing Daemon
description: Implement a minimal BGP router that exchanges routing information with peers.
difficulty: advanced
domain: distributed
estimated_hours: 60-80
essence: BGP glues the Internet together using path-vector routing where each AS announces reachability.
why_important: Understanding BGP is essential for network engineers and debugging Internet connectivity.
learning_outcomes:
- Implement BGP finite state machine
- Parse and serialize BGP messages
- Implement path-vector routing
- Build RIB with best path selection
- Apply routing policies
skills:
- BGP Protocol
- Path-Vector Routing
- RIB Management
- Network Policy
tags:
- advanced
- networking
- bgp
- routing
- distributed
languages:
  recommended:
  - Go
  - Rust
  also_possible:
  - Python
  - C
prerequisites:
- type: skill
  name: TCP socket programming
- type: skill
  name: Binary protocol parsing
- type: skill
  name: IP addressing and routing
resources:
- name: RFC 4271 BGP-4
  type: specification
  url: https://datatracker.ietf.org/doc/html/rfc4271
- name: BGP Overview
  type: tutorial
  url: https://www.cloudflare.com/learning/security/glossary/what-is-bgp/
- name: Bird Routing Daemon
  type: code
  url: https://gitlab.nic.cz/labs/bird
milestones:
- id: bgp-m1
  name: BGP Messages and FSM
  description: Implement BGP finite state machine and message serialization.
  estimated_hours: 12-16
  concepts:
  - BGP states
  - Message format
  - State transitions
  skills:
  - Protocol state machine
  - Binary parsing
  acceptance_criteria:
  - Implement all 6 BGP states
  - Parse message header correctly
  - Handle state transitions on events
  - Serialize and parse all 4 message types
  - Unit tests cover all transitions
  - Handle invalid messages correctly
  pitfalls:
  - Marker is 16 bytes of 0xFF
  - Minimum message length 19 bytes
  deliverables:
  - BGP FSM implementation
  - Message parser and serializer
  - Timer management
- id: bgp-m2
  name: Session Establishment
  description: Implement BGP session setup with OPEN negotiation.
  estimated_hours: 12-16
  concepts:
  - OPEN message
  - Hold timer negotiation
  - Keepalive exchange
  skills:
  - TCP connection management
  - Timer implementation
  acceptance_criteria:
  - Establish TCP on port 179
  - Send OPEN with BGP identifier
  - Parse received OPEN fields
  - Negotiate hold time correctly
  - Calculate keepalive interval
  - Transition to Established state
  - Maintain session with keepalives
  pitfalls:
  - BGP identifier must be unique
  - Hold time 0 means never expire
  deliverables:
  - Session establishment
  - OPEN handling
  - Keepalive management
- id: bgp-m3
  name: UPDATE and RIB
  description: Implement UPDATE parsing and Routing Information Base.
  estimated_hours: 16-20
  concepts:
  - UPDATE format
  - Path attributes
  - RIB structure
  skills:
  - Complex parsing
  - Data structure design
  acceptance_criteria:
  - Parse UPDATE with withdrawn and NLRI
  - Parse ORIGIN, AS_PATH, NEXT_HOP attributes
  - Build RIB with three tables
  - Store routes with all attributes
  - Handle route withdrawal
  - Support 1000 routes without degradation
  - Implement longest prefix match
  pitfalls:
  - AS_PATH has sequence and set types
  - NLRI format varies
  deliverables:
  - UPDATE parser
  - Path attribute handlers
  - RIB implementation
- id: bgp-m4
  name: Best Path Selection
  description: Implement BGP best path selection algorithm.
  estimated_hours: 12-16
  concepts:
  - Decision process
  - Attribute comparison
  - Tie-breakers
  skills:
  - Comparison algorithms
  - Route ranking
  acceptance_criteria:
  - Implement selection by LOCAL_PREF first
  - Then by shortest AS_PATH
  - Then by lowest ORIGIN type
  - Then by lowest MED
  - Prefer eBGP over iBGP
  - Lowest IGP cost to next hop
  - Lowest router ID as tie-breaker
  - Generate UPDATE on changes
  pitfalls:
  - MED only valid from same AS
  - LOCAL_PREF within AS only
  deliverables:
  - Best path algorithm
  - Loc-RIB updates
  - Decision logging
- id: bgp-m5
  name: Route Filtering and Policy
  description: Implement route filtering and basic policy application.
  estimated_hours: 10-14
  concepts:
  - Prefix-list filtering
  - AS-path regex
  - Route maps
  skills:
  - Filter implementation
  - Attribute manipulation
  acceptance_criteria:
  - Implement prefix-list filter
  - Implement AS-path regex filter
  - Support permit and deny actions
  - Apply on import and export
  - Implement basic route-map
  - Support LOCAL_PREF and MED modification
  - Support AS_PATH prepending
  pitfalls:
  - Filter order matters
  - Implicit deny at end
  deliverables:
  - Prefix-list filter
  - AS-path filter
  - Route-map implementation
