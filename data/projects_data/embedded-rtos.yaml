id: embedded-rtos
name: Embedded RTOS
description: >
  Build a real-time operating system for microcontrollers. Implement task
  scheduling, inter-task communication, memory management, and real-time
  guarantees for embedded systems.

difficulty: advanced
estimated_hours: 60-80
domain: systems

essence: >
  Deterministic execution through preemptive priority scheduling, bounded
  interrupt latency, efficient context switching, small memory footprint,
  and real-time primitives (semaphores, mutexes, message queues).

why_important: >
  RTOS powers automotive, aerospace, medical devices, and IoT. Understanding
  real-time systems is valuable at $150K-280K+ for embedded engineers.

learning_outcomes:
  - Implement preemptive task scheduler
  - Build context switching for multiple tasks
  - Implement synchronization primitives (mutex, semaphore)
  - Build inter-task communication (queues, events)
  - Handle interrupts with bounded latency
  - Implement memory management for embedded
  - Build timer and delay services
  - Implement priority inheritance for mutexes

skills:
  - RTOS Design
  - Task Scheduling
  - Context Switching
  - Synchronization
  - Interrupt Handling
  - Memory Management
  - Real-Time Guarantees
  - Priority Inheritance

tags:
  - advanced
  - rtos
  - embedded
  - real-time
  - kernel
  - microcontroller

languages:
  recommended:
    - C
    - Rust
  also_possible: []

resources:
  - name: "Mastering the FreeRTOS Real Time Kernel"
    url: https://www.freertos.org/fr-content-src/uploads/2018/07/161204_Mastering_the_FreeRTOS_Real_Time_Kernel-A_Hands-On_Tutorial_Guide.pdf
    type: book
  - name: "Making Embedded Systems"
    url: https://www.oreilly.com/library/view/making-embedded-systems/9781449308885/
    type: book
  - name: "Real-Time Systems"
    url: https://www.cs.unc.edu/~anderson/teach/comp530/v1/
    type: course
  - name: "Tock OS Documentation"
    url: https://www.tockos.org/documentation/
    type: documentation

prerequisites:
  - type: skill
    name: C programming proficiency
  - type: skill
    name: Understanding of computer architecture
  - type: skill
    name: Assembly language basics
  - type: project
    name: build-kernel-module or equivalent low-level experience

milestones:
  - id: rtos-m1
    name: Task Control Blocks & Scheduler
    description: >
      Implement the basic task structure and priority-based
      preemptive scheduler.
    acceptance_criteria:
      - Task control block (TCB) with stack, registers, state
      - Ready queue organized by priority
      - Round-robin within same priority
      - Context switch saves/restores registers
      - Scheduler invoked on timer tick
      - Minimum 8 concurrent tasks supported
    pitfalls:
      - Stack overflow from deep call chains
      - Priority inversion
      - Context switch incomplete
      - Timer tick handling
    concepts:
      - Task structure
      - Priority scheduling
      - Context switching
      - Ready queue
    skills:
      - TCB design
      - Scheduler implementation
      - Context switch
      - Queue management
    deliverables:
      - TCB structure
      - Priority scheduler
      - Context switch
      - Task creation API
    estimated_hours: "14-18"

  - id: rtos-m2
    name: Synchronization Primitives
    description: >
      Implement mutexes and semaphores for inter-task
      synchronization.
    acceptance_criteria:
      - Binary semaphore for signaling
      - Counting semaphore for resource management
      - Mutex with ownership tracking
      - Blocking on unavailable resources
      - Priority inheritance in mutex
      - Timeout support for blocking calls
    pitfalls:
      - Priority inversion without inheritance
      - Deadlock from improper ordering
      - Semaphore vs mutex confusion
      - Unbounded blocking
    concepts:
      - Semaphores
      - Mutexes
      - Priority inheritance
      - Blocking
    skills:
      - Semaphore implementation
      - Mutex implementation
      - Priority handling
      - Timeout support
    deliverables:
      - Binary semaphore
      - Counting semaphore
      - Priority-inheritance mutex
      - Timeout support
    estimated_hours: "12-16"

  - id: rtos-m3
    name: Inter-Task Communication
    description: >
      Implement message queues and event flags for
      communication between tasks.
    acceptance_criteria:
      - Message queue with configurable size
      - Blocking send/receive with timeout
      - Event flag groups for multiple signals
      - ISR-safe queue operations
      - Message copying vs pointer passing
      - Queue peek without removal
    pitfalls:
      - Queue overflow/underflow
      - Memory allocation in queue
      - ISR priority inversion
      - Stale messages
    concepts:
      - Message queues
      - Event flags
      - ISR interaction
      - Memory management
    skills:
      - Queue implementation
      - Event handling
      - ISR safety
      - Memory strategies
    deliverables:
      - Message queue
      - Event flags
      - ISR-safe versions
      - Queue utilities
    estimated_hours: "10-14"

  - id: rtos-m4
    name: Interrupt Handling & Timers
    description: >
      Implement interrupt handling with bounded latency
      and timer services.
    acceptance_criteria:
      - Interrupt service routines (ISR) support
      - Deferred interrupt handling (DPC/tasklet)
      - Timer services (one-shot, periodic)
      - Delay functions (sleep, delay until)
      - Bounded interrupt latency measurable
      - Nested interrupt handling (optional)
    pitfalls:
      - ISR too long blocks other interrupts
      - Timer drift
      - Priority of timer ISR
      - Delay accuracy
    concepts:
      - ISR handling
      - Deferred processing
      - Timer services
      - Latency bounds
    skills:
      - ISR implementation
      - Timer management
      - Delay services
      - Latency measurement
    deliverables:
      - ISR framework
      - Timer services
      - Delay functions
      - Latency measurement
    estimated_hours: "10-14"

  - id: rtos-m5
    name: Memory Management
    description: >
      Implement memory management suitable for embedded
      systems with limited resources.
    acceptance_criteria:
      - Static memory pool allocation
      - Heap with configurable size
      - Memory block pools for fixed-size allocation
      - O(1) allocation/deallocation
      - Memory protection (MPU) optional
      - Stack overflow detection
    pitfalls:
      - Fragmentation over time
      - Memory leaks in long-running systems
      - Stack size estimation
      - Allocation failures
    concepts:
      - Memory pools
      - Heap management
      - Block allocation
      - Memory protection
    skills:
      - Pool allocator
      - Heap design
      - Protection setup
      - Overflow detection
    deliverables:
      - Memory pool
      - Block allocator
      - Stack protection
      - Memory API
    estimated_hours: "10-14"
