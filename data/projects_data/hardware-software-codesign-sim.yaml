id: hardware-software-codesign-sim
name: Hardware-Software Codesign Simulator
description: >
  Build a simulator for custom hardware accelerators, enabling
  hardware-software codesign for AI/ML workloads and specialized
  computing architectures.

difficulty: expert
estimated_hours: 90-120
domain: specialized

essence: >
  Cycle-accurate or instruction-set simulation of custom processors,
  memory hierarchy modeling, interconnect simulation, performance
  analysis, and co-simulation with software workloads.

why_important: >
  AI accelerator companies (Nvidia, Google TPU, startups) need engineers
  who understand hardware-software codesign. These roles pay $250K-500K+
  and require rare cross-domain expertise.

learning_outcomes:
  - Design instruction set for custom accelerator
  - Implement cycle-accurate simulator
  - Model memory hierarchy (caches, scratchpads)
  - Simulate interconnect and multi-core
  - Analyze performance bottlenecks
  - Co-simulate with real software workloads
  - Generate traces for hardware synthesis
  - Validate against reference implementations

skills:
  - Simulator Design
  - ISA Design
  - Memory Modeling
  - Performance Analysis
  - Hardware-Software Interface
  - Trace Generation
  - Validation
  - Co-simulation

tags:
  - accelerator
  - ai-hardware
  - codesign
  - expert
  - hardware
  - simulation
  - specialized
  - tpu

languages:
  recommended:
    - C++
    - Python
    - SystemVerilog
  also_possible:
    - Rust
    - Chisel

resources:
  - name: "gem5 Simulator"
    url: https://www.gem5.org/
    type: reference
  - name: "Spike RISC-V ISA Simulator"
    url: https://github.com/riscv-software-src/riscv-isa-sim
    type: reference
  - name: "Computer Architecture: A Quantitative Approach"
    url: https://www.elsevier.com/books/computer-architecture/hennessy/978-0-12-811905-1
    type: book
  - name: "Google TPU Paper"
    url: https://arxiv.org/abs/1704.04760
    type: paper

prerequisites:
  - type: skill
    name: Computer architecture fundamentals
  - type: skill
    name: C++ or Python proficiency
  - type: skill
    name: Understanding of pipelining and caches
  - type: project
    name: Emulator or interpreter experience

milestones:
  - id: hscs-m1
    name: Instruction Set Design
    description: >
      Design a simple instruction set architecture (ISA) for a
      matrix/tensor accelerator.
    acceptance_criteria:
      - ISA specification documented
      - Instruction encodings defined
      - Matrix/tensor operations (MADD, GEMM)
      - Memory load/store operations
      - Control flow operations
      - Register file architecture
      - Instruction decoder implementation
    pitfalls:
      - ISA too complex to simulate efficiently
      - Missing instructions for common patterns
      - Register pressure too high
      - Encoding conflicts or undefined space
      - No path to real hardware
    concepts:
      - ISA design
      - Instruction encoding
      - Register architecture
      - Accelerator operations
    skills:
      - ISA specification
      - Encoding design
      - Tradeoff analysis
      - Documentation
    deliverables:
      - ISA specification
      - Instruction decoder
      - Encoding documentation
      - Example programs
    estimated_hours: "16-20"

  - id: hscs-m2
    name: Functional Simulator
    description: >
      Build a functional (not timing-accurate) simulator that executes
      programs correctly.
    acceptance_criteria:
      - Fetch, decode, execute loop
      - All instructions implemented correctly
      - Register file read/write
      - Memory load/store
      - Program can run to completion
      - Execution trace output
      - Matches reference implementation (e.g., numpy)
    pitfalls:
      - Functional bugs hide in matrix operations
      - Floating-point precision differences
      - Memory bounds checking
      - Endless loops from bugs
      - Trace output too verbose
    concepts:
      - Functional simulation
      - Instruction execution
      - State management
      - Trace generation
    skills:
      - Simulator implementation
      - Correctness verification
      - Trace analysis
      - Debugging
    deliverables:
      - Functional simulator
      - Instruction implementations
      - Memory system
      - Trace output
    estimated_hours: "18-22"

  - id: hscs-m3
    name: Timing Model & Memory Hierarchy
    description: >
      Add cycle-accurate timing and model the memory hierarchy including
      caches and scratchpad memories.
    acceptance_criteria:
      - Cycle count tracking
      - Pipeline modeling (optional)
      - Cache hierarchy (L1, L2)
      - Scratchpad/local memory
      - Memory bandwidth modeling
      - DRAM timing model (basic)
      - Performance reports (cycles, CPI)
    pitfalls:
      - Cycle accuracy vs simulation speed tradeoff
      - Cache replacement policy effects
      - Memory aliasing issues
      - Timing bugs look like functional bugs
      - DRAM models very complex; simplify
    concepts:
      - Cycle-accurate simulation
      - Cache modeling
      - Memory hierarchy
      - Performance metrics
    skills:
      - Timing implementation
      - Cache simulation
      - Memory modeling
      - Performance analysis
    deliverables:
      - Timing model
      - Cache simulator
      - Memory system
      - Performance reporter
    estimated_hours: "20-24"

  - id: hscs-m4
    name: Workload Analysis & Optimization
    description: >
      Run real AI/ML workloads on the simulator and analyze performance
      bottlenecks.
    acceptance_criteria:
      - Matrix multiplication workload
      - Simple neural network layer
      - Roofline model analysis
      - Bottleneck identification (compute vs memory)
      - Optimization suggestions output
      - Comparison with GPU/CPU performance
      - Trace visualization (optional)
    pitfalls:
      - Workloads too small show no bottlenecks
      - Roofline model assumptions may not hold
      - Trace data overwhelming
      - Comparing to optimized libraries unfair
      - Simulation too slow for large workloads
    concepts:
      - Workload characterization
      - Roofline analysis
      - Bottleneck identification
      - Optimization
    skills:
      - Workload implementation
      - Performance analysis
      - Roofline modeling
      - Optimization
    deliverables:
      - Workload suite
      - Roofline analysis
      - Bottleneck report
      - Optimization guide
    estimated_hours: "18-22"

  - id: hscs-m5
    name: Multi-Core & Validation
    description: >
      Extend to multi-core simulation and validate against reference
      implementations.
    acceptance_criteria:
      - Multiple accelerator cores
      - Interconnect model (simple)
      - Shared memory or distributed memory
      - Parallel workload execution
      - Validation against numpy/tensorflow
      - Scaling analysis (weak/strong scaling)
      - Production-quality documentation
    pitfalls:
      - Multi-core synchronization bugs
      - Interconnect modeling complex
      - Validation tolerance for floating-point
      - Simulation slows with more cores
      - Deadlock detection difficult
    concepts:
      - Multi-core simulation
      - Interconnect
      - Validation
      - Scaling analysis
    skills:
      - Parallel simulation
      - Interconnect modeling
      - Validation methodology
      - Documentation
    deliverables:
      - Multi-core simulator
      - Interconnect model
      - Validation suite
      - Final documentation
    estimated_hours: "18-22"
