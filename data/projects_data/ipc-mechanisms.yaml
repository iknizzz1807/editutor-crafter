id: ipc-mechanisms
name: IPC Mechanisms
description: >
  Build inter-process communication primitives including shared memory,
  Unix domain sockets, named pipes, and message queues for process
  coordination.

difficulty: intermediate
estimated_hours: 25-35
domain: systems

essence: >
  Kernel IPC mechanisms (shared memory, pipes, sockets, message queues),
  synchronization primitives across processes, file descriptor passing,
  and performance tradeoffs between different IPC methods.

why_important: >
  IPC is fundamental to containers, microservices, and system programming.
  Understanding IPC deeply is valuable at $150K-280K+ for systems engineers,
  especially in container runtimes and high-performance computing.

learning_outcomes:
  - Implement shared memory communication
  - Use Unix domain sockets for local IPC
  - Build named pipes (FIFOs)
  - Implement POSIX message queues
  - Handle synchronization across processes
  - Pass file descriptors between processes
  - Benchmark IPC performance
  - Choose appropriate IPC for use case

skills:
  - Shared Memory
  - Unix Domain Sockets
  - Named Pipes
  - Message Queues
  - Process Synchronization
  - FD Passing
  - Performance Benchmarking
  - IPC Selection

tags:
  - intermediate
  - ipc
  - linux
  - pipes
  - shared-memory
  - sockets
  - systems
  - unix

languages:
  recommended:
    - C
    - Rust
  also_possible:
    - C++
    - Go

resources:
  - name: "The Linux Programming Interface (Chapters 44-52)"
    url: https://man7.org/tlpi/
    type: book
  - name: "Advanced Programming in the UNIX Environment"
    url: https://www.oreilly.com/library/view/advanced-programming-in/9780321638014/
    type: book
  - name: "Unix Domain Sockets Documentation"
    url: https://man7.org/linux/man-pages/man7/unix.7.html
    type: documentation
  - name: "Shared Memory Overview"
    url: https://man7.org/linux/man-pages/man7/shm_overview.7.html
    type: documentation

prerequisites:
  - type: skill
    name: C systems programming
  - type: skill
    name: Understanding of processes and memory
  - type: skill
    name: Basic socket programming
  - type: project
    name: process spawning experience

milestones:
  - id: ipc-m1
    name: Pipes & Named Pipes
    description: >
      Implement anonymous pipes and named pipes (FIFOs) for stream-based
      communication between processes.
    acceptance_criteria:
      - Anonymous pipe for parent-child communication
      - Named pipe (FIFO) for unrelated processes
      - Bidirectional communication with two pipes
      - Non-blocking I/O support
      - Handle SIGPIPE gracefully
      - Proper cleanup on process exit
      - Benchmark throughput
    pitfalls:
      - Deadlock with single pipe bidirectional
      - Blocking reads when writer closes
      - Named pipes persist after process exit
      - SIGPIPE kills process by default
      - Buffer size limits (usually 64KB)
    concepts:
      - Pipe semantics
      - Blocking vs non-blocking
      - Buffer limits
      - Signal handling
    skills:
      - Pipe creation
      - FIFO management
      - Signal handling
      - Error handling
    deliverables:
      - Anonymous pipe example
      - Named pipe implementation
      - Bidirectional pipe
      - Benchmark
    estimated_hours: "5-6"

  - id: ipc-m2
    name: Unix Domain Sockets
    description: >
      Implement Unix domain sockets for reliable stream and datagram
      communication between local processes.
    acceptance_criteria:
      - Stream socket (SOCK_STREAM) server and client
      - Datagram socket (SOCK_DGRAM) implementation
      - Abstract socket namespace support
      - File descriptor passing (SCM_RIGHTS)
      - Peer credentials (SO_PEERCRED)
      - Proper socket file cleanup
      - Performance comparison with TCP localhost
    pitfalls:
      - Socket files persist if not unlinked
      - Abstract sockets don't create files
      - Path length limit (107 chars typically)
      - FD passing requires careful message construction
      - Credential verification race conditions
    concepts:
      - Unix socket types
      - Abstract namespace
      - FD passing
      - Credentials
    skills:
      - Socket programming
      - FD passing
      - Cleanup handling
      - Performance comparison
    deliverables:
      - Stream socket server
      - Datagram socket example
      - FD passing implementation
      - Benchmark
    estimated_hours: "6-7"

  - id: ipc-m3
    name: Shared Memory
    description: >
      Implement shared memory regions for high-performance data sharing
      between processes.
    acceptance_criteria:
      - POSIX shared memory (shm_open)
      - System V shared memory (shmget)
      - Memory mapping with mmap
      - Synchronization with process-shared mutexes
      - Handle memory alignment
      - Cleanup on process exit
      - Performance benchmark vs other IPC
    pitfalls:
      - Synchronization required for concurrent access
      - Process-shared mutexes need PTHREAD_PROCESS_SHARED
      - Memory leaks if not unlinked
      - Size changes require remapping
      - Pointer validity across processes
    concepts:
      - Shared memory
      - Memory mapping
      - Process-shared sync
      - Memory consistency
    skills:
      - shm_open/mmap
      - Process-shared primitives
      - Synchronization
      - Memory management
    deliverables:
      - POSIX shm implementation
      - Process-shared mutex
      - Ring buffer on shm
      - Benchmark
    estimated_hours: "6-8"

  - id: ipc-m4
    name: Message Queues
    description: >
      Implement POSIX and System V message queues for structured message
      passing between processes.
    acceptance_criteria:
      - POSIX message queue (mq_open, mq_send, mq_receive)
      - System V message queue (msgget, msgsnd, msgrcv)
      - Message priorities
      - Non-blocking operation
      - Message type filtering (System V)
      - Notification on message arrival
      - Proper cleanup and unlink
    pitfalls:
      - Queue limits (messages and bytes)
      - Priority inversion possible
      - Message size limits
      - Queue persists after process exit
      - Notification race conditions
    concepts:
      - Message queuing
      - Priority handling
      - Notification
      - Queue limits
    skills:
      - POSIX mqueue
      - System V messages
      - Priority handling
      - Notification setup
    deliverables:
      - POSIX mqueue wrapper
      - System V wrapper
      - Priority demo
      - Notification demo
    estimated_hours: "5-6"

  - id: ipc-m5
    name: IPC Comparison & Integration
    description: >
      Build a comprehensive benchmark and selection guide for choosing
      the right IPC mechanism.
    acceptance_criteria:
      - Benchmark all IPC methods (throughput, latency)
      - Memory overhead comparison
      - CPU usage comparison
      - Scalability analysis (multiple processes)
      - Selection guide with tradeoffs
      - Sample application using appropriate IPC
      - Documentation for future reference
    pitfalls:
      - Benchmarks sensitive to message size
      - Results vary by kernel version
      - Real-world performance differs
      - No single best IPC for all cases
      - Complexity vs performance tradeoff
    concepts:
      - Performance analysis
      - Tradeoff evaluation
      - Selection criteria
      - Documentation
    skills:
      - Benchmarking
      - Analysis
      - Technical writing
      - System design
    deliverables:
      - Benchmark suite
      - Comparison report
      - Selection guide
      - Sample application
    estimated_hours: "5-6"
