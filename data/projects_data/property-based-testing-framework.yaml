id: property-based-testing-framework
name: Property-Based Testing Framework
description: >
  Build a property-based testing framework like Hypothesis or QuickCheck.
  Implement automatic test case generation, shrinking for minimal examples,
  and integrated failure reporting.

difficulty: advanced
estimated_hours: 40-55
domain: software-engineering

essence: >
  Automatic test generation through type-based arbitraries, property checking
  across thousands of random inputs, counterexample shrinking to find minimal
  failing cases, and stateful testing for protocols and state machines.

why_important: >
  Property-based testing catches edge cases that example-based tests miss.
  Understanding generative testing is valuable for QA engineers and backend
  developers at $150K-300K+.

learning_outcomes:
  - Implement type-based value generation (arbitraries)
  - Build property runner with multiple test cases
  - Implement shrinking for minimal counterexamples
  - Build combinators for complex types
  - Implement stateful property testing
  - Build integrated discovery mode
  - Implement deterministic replay of failures
  - Add coverage-guided generation

skills:
  - Property-Based Testing
  - Value Generation
  - Shrinking
  - Stateful Testing
  - Combinators
  - Test Oracles
  - Coverage Guidance
  - Reproducibility

tags:
  - advanced
  - testing
  - property-based
  - quickcheck
  - hypothesis
  - generative-testing

languages:
  recommended:
    - Python
    - Rust
  also_possible:
    - JavaScript
    - Go

resources:
  - name: "How to Specify It! (John Hughes)"
    url: https://www.dropbox.com/s/tx2b84kae4bxqyz/paper-jh.pdf
    type: paper
  - name: "Hypothesis Documentation"
    url: https://hypothesis.readthedocs.io/
    type: documentation
  - name: "QuickCheck Original Paper"
    url: https://www.eecs.northwestern.edu/~robby/courses/395-495-2015-fall/quick.pdf
    type: paper
  - name: "PropEr Testing"
    url: https://proper-testing.github.io/
    type: documentation

prerequisites:
  - type: skill
    name: Unit testing experience
  - type: skill
    name: Understanding of type systems
  - type: skill
    name: Python or Rust proficiency
  - type: project
    name: unit-testing-basics or equivalent

milestones:
  - id: pbt-m1
    name: Value Generation (Arbitraries)
    description: >
      Implement type-based value generators for primitive types
      and basic combinators.
    acceptance_criteria:
      - Integer generator with configurable range
      - Float generator handling NaN and infinity
      - String generator with configurable alphabet/length
      - List generator with element generator
      - Combinators: one_of, tuples, maps
      - Generator composition for custom types
    pitfalls:
      - Integer overflow in range generation
      - String generation creates invalid patterns
      - Biased distribution (too many edge cases or too few)
      - Infinite generation from recursive combinators
    concepts:
      - Arbitrary types
      - Generator composition
      - Distribution
      - Combinators
    skills:
      - Generator implementation
      - Combinator design
      - Distribution tuning
      - Type mapping
    deliverables:
      - Primitive generators
      - Collection generators
      - Combinators
      - Custom type support
    estimated_hours: "8-12"

  - id: pbt-m2
    name: Property Runner & Checking
    description: >
      Build the property runner that generates test cases
      and checks properties.
    acceptance_criteria:
      - Property is a function: generated_value -> bool
      - Runner generates N test cases (default 100-1000)
      - Failing case stops execution and reports
      - Random seed recorded for reproducibility
      - Configurable number of examples
      - Timeout for slow properties
    pitfalls:
      - Not handling exceptions in properties
      - Non-deterministic without seed
      - Timeout aborts without cleanup
      - Memory issues with large generated values
    concepts:
      - Property definition
      - Test execution
      - Reproducibility
      - Configuration
    skills:
      - Property runner
      - Error handling
      - Seed management
      - Configuration
    deliverables:
      - Property decorator/definition
      - Test runner
      - Seed handling
      - Failure reporting
    estimated_hours: "8-10"

  - id: pbt-m3
    name: Shrinking
    description: >
      Implement shrinking to find minimal counterexamples
      from failing test cases.
    acceptance_criteria:
      - Shrinker reduces value while preserving failure
      - Integer shrinks toward 0
      - String shrinks toward empty
      - List shrinks length and elements
      - Shrinking terminates with local minimum
      - Shrunk value reported in failure
    pitfalls:
      - Shrinking doesn't terminate
      - Shrinker misses simpler cases
      - Shrink steps too large
      - Compound types shrink incorrectly
    concepts:
      - Shrinking strategies
      - Local minimum
      - Compound shrinking
      - Termination
    skills:
      - Shrinker implementation
      - Strategy design
      - Compound handling
      - Termination detection
    deliverables:
      - Primitive shrinkers
      - Compound shrinkers
      - Shrink loop
      - Minimal example reporting
    estimated_hours: "10-14"

  - id: pbt-m4
    name: Stateful Testing
    description: >
      Implement stateful property testing for protocols
      and state machines.
    acceptance_criteria:
      - Rule-based state machine definition
      - Precondition filtering of invalid commands
      - Postcondition checking state invariants
      - Command sequence shrinking
      - Initial state and state transitions defined
      - Works for common protocols (e.g., stack, buffer)
    pitfalls:
      - Too many invalid sequences from preconditions
      - State explosion for complex machines
      - Non-deterministic state transitions
      - Shrinking invalidates preconditions
    concepts:
      - State machines
      - Rule-based testing
      - Preconditions
      - Sequence shrinking
    skills:
      - State machine definition
      - Rule design
      - Sequence generation
      - State shrinking
    deliverables:
      - Rule definition API
      - State machine runner
      - Sequence generation
      - State shrinking
    estimated_hours: "10-14"

  - id: pbt-m5
    name: Integration & Discovery Mode
    description: >
      Build integrated discovery mode that automatically
      finds properties to test.
    acceptance_criteria:
      - Integration with test frameworks (pytest, cargo test)
      - Discovery mode finds failing cases automatically
      - Database stores failing examples for regression
      - Coverage guidance prioritizes unexplored paths
      - Reporting shows coverage and example distribution
      - Works with CI pipelines
    pitfalls:
      - CI flakiness from randomness
      - Database corruption
      - Coverage overhead slows testing
      - Not replaying database examples
    concepts:
      - Framework integration
      - Regression database
      - Coverage guidance
      - CI compatibility
    skills:
      - Test integration
      - Database handling
      - Coverage tracking
      - CI design
    deliverables:
      - Framework integration
      - Example database
      - Coverage guidance
      - CI support
    estimated_hours: "8-12"
