id: risk-management-system
name: Risk Management System
description: >
  Build a real-time financial risk management system implementing
  VaR, stress testing, exposure tracking, and risk limit monitoring
  for a trading portfolio.

difficulty: advanced
estimated_hours: 55-75
domain: specialized

essence: >
  Real-time aggregation of positions across multiple asset classes,
  calculation of risk metrics (VaR, Greeks, exposure) with sub-second
  latency, scenario-based stress testing, limit monitoring with alerting,
  and regulatory reporting data preparation.

why_important: >
  Risk management systems are critical infrastructure at banks, hedge funds,
  and trading firms. Risk tech engineers earn $150K-300K+ building systems
  that protect billions in assets from market volatility.

learning_outcomes:
  - Implement real-time position aggregation across asset classes
  - Build VaR calculation with multiple methodologies
  - Implement stress testing with historical and hypothetical scenarios
  - Build exposure tracking for derivatives (delta, gamma, vega)
  - Implement risk limit monitoring with breach alerting
  - Build P&L attribution and decomposition
  - Implement correlation monitoring for diversification analysis
  - Build regulatory reporting data extracts (FRTB, Basel)

skills:
  - Real-Time Risk Calculation
  - VaR Methodologies
  - Stress Testing
  - Greeks Aggregation
  - Limit Monitoring
  - P&L Attribution
  - Regulatory Reporting
  - Event-Driven Architecture

tags:
  - advanced
  - finance
  - greeks
  - real-time
  - risk
  - stress-testing
  - var
  - trading

languages:
  recommended:
    - Python
    - Java
    - C++
  also_possible:
    - Rust
    - Go

resources:
  - name: "Risk Management in Trading"
    url: https://www.wiley.com/en-us/Risk+Management+in+Trading%3A+Techniques+to+Profit+from+Hedge+and+Mutual+Fund+Managers-p-9781118777548
    type: book
  - name: "FRM Part I Curriculum"
    url: https://www.garp.org/frm
    type: certification
  - name: "FRTB Fundamentals"
    url: https://www.bis.org/bcbs/publ/d457.htm
    type: documentation
  - name: "Open Source Risk Engine"
    url: https://www.opensourcerisk.org/
    type: reference

prerequisites:
  - type: project
    id: financial-modeling-engine
    name: Financial Modeling Engine
  - type: skill
    name: Understanding of derivatives and Greeks
  - type: skill
    name: Event-driven programming
  - type: skill
    name: Time series analysis

milestones:
  - id: risk-management-system-m1
    name: Position Management & Aggregation
    description: >
      Build a real-time position management system that aggregates
      positions across multiple instruments and books.
    acceptance_criteria:
      - Position store tracks positions by book, instrument, and counterparty
      - Real-time position updates via event feed (trades, corrections, settlements)
      - Aggregation hierarchy: instrument → book → desk → firm level
      - Handles long and short positions correctly
      - Supports multiple asset classes: equities, fixed income, FX, derivatives
      - Position snapshots at any point in time for historical analysis
      - Concurrent access safe with optimistic locking for updates
      - Latency < 100ms for position update to propagate to all aggregations
    pitfalls:
      - Trade corrections and cancellations must update positions correctly
      - Timezone handling for global positions (T+1 vs T+2 settlement)
      - Corporate actions (splits, dividends) affect position quantities
      - Instrument identifier mapping (ISIN, CUSIP, ticker) is error-prone
      - Concurrent updates to same position require careful locking
    concepts:
      - Position hierarchy and aggregation
      - Event-driven position updates
      - Multi-asset position handling
      - Point-in-time position queries
    skills:
      - Event-driven architecture
      - Concurrent data structures
      - Financial instrument modeling
      - Aggregation algorithms
    deliverables:
      - Position store with event-driven updates
      - Multi-level aggregation engine
      - Position snapshot system
      - API for position queries at any aggregation level
      - Performance benchmark showing < 100ms latency
    estimated_hours: "12-14"

  - id: risk-management-system-m2
    name: Real-Time VaR & Greeks
    description: >
      Implement real-time VaR and Greeks calculation with position
      aggregation and caching for performance.
    acceptance_criteria:
      - Parametric VaR calculated in real-time as positions change
      - Historical VaR with configurable lookback window
      - Greeks (delta, gamma, vega, theta) aggregated across portfolio
      - Greeks computed for options and converted for underlying positions
      - Incremental VaR: impact of new trade on portfolio VaR
      - Component VaR: contribution of each position to total VaR
      - Cache pricing data and Greeks; invalidate on market data updates
      - Full portfolio VaR calculation < 5 seconds for 10,000 position portfolio
    pitfalls:
      - VaR recalculation on every trade is expensive; use incremental updates
      - Option Greeks change with market moves; stale Greeks misstate risk
      - Correlation matrix estimation from short windows is noisy
      - Portfolio VaR requires position-level returns; handle missing data
      - Greeks for exotic options require numerical methods (slower)
    concepts:
      - Incremental risk calculation
      - Greeks aggregation
      - Caching strategies for risk metrics
      - Portfolio-level risk decomposition
    skills:
      - Efficient VaR implementation
      - Greeks aggregation
      - Cache invalidation design
      - Performance optimization
    deliverables:
      - Real-time parametric VaR calculator
      - Historical VaR implementation
      - Greeks aggregation engine
      - Incremental and component VaR
      - Caching layer with invalidation
      - Performance benchmark
    estimated_hours: "12-14"

  - id: risk-management-system-m3
    name: Stress Testing Engine
    description: >
      Build a stress testing framework for scenario-based risk
      analysis including historical and hypothetical scenarios.
    acceptance_criteria:
      - Historical scenarios: 2008 crisis, 2020 COVID, Flash Crash, etc.
      - Hypothetical scenarios: equity crash, rate shock, credit spread widening
      - User-defined custom scenarios with shock specifications
      - Multi-factor scenarios: simultaneous shocks to correlated factors
      - P&L impact calculation for each scenario per position and aggregate
      - Scenario ranking by severity for portfolio
      - Worst-case scenario identification
      - Results export for management reporting
    pitfalls:
      - Historical scenarios may not reflect current portfolio composition
      - Shock magnitudes should reflect realistic tail events
      - Correlation breakdown in crisis: correlations spike to 1.0 in stress
      - Liquidity assumptions in stress: bid-ask spreads widen dramatically
      - Model risk: stress tests only capture known scenarios
    concepts:
      - Historical vs hypothetical scenarios
      - Factor shock modeling
      - Correlation in stress periods
      - Liquidity-adjusted stress
    skills:
      - Scenario definition and modeling
      - Stress P&L calculation
      - Multi-factor analysis
      - Reporting and visualization
    deliverables:
      - Stress test scenario library
      - Custom scenario builder
      - Stress P&L calculator
      - Scenario comparison and ranking
      - Management reporting output
    estimated_hours: "10-12"

  - id: risk-management-system-m4
    name: Limit Monitoring & Alerting
    description: >
      Implement risk limit management with real-time monitoring
      and breach alerting.
    acceptance_criteria:
      - Limit hierarchy: trader → desk → firm level limits
      - Limit types: VaR, notional, Greeks, concentration, exposure
      - Real-time limit utilization calculation as positions change
      - Hard vs soft limits: warnings at soft, blocks at hard
      - Alert escalation: trader → manager → risk committee
      - Limit breach logging with full audit trail
      - Limit adjustment workflow with approval process
      - Dashboard showing all limits with utilization percentages
    pitfalls:
      - Limit breaches during high volatility require fast response
      - Multiple limits can breach simultaneously; prioritize alerts
      - Limit changes must be tracked for audit and compliance
      - Timezone differences affect limit monitoring for global trading
      - Limits may need intraday vs end-of-day variations
    concepts:
      - Limit hierarchy and types
      - Real-time monitoring architecture
      - Alert escalation workflows
      - Audit trail requirements
    skills:
      - Real-time monitoring systems
      - Alerting infrastructure
      - Workflow management
      - Compliance tracking
    deliverables:
      - Limit definition and storage
      - Real-time utilization calculator
      - Breach detection and alerting
      - Escalation workflow engine
      - Limit management dashboard
      - Audit logging system
    estimated_hours: "10-12"

  - id: risk-management-system-m5
    name: P&L Attribution & Reporting
    description: >
      Build P&L attribution system and regulatory reporting
      data extracts.
    acceptance_criteria:
      - Daily P&L decomposition: market moves, carry, new trades, time decay
      - Greeks-based P&L attribution: delta P&L, gamma P&L, vega P&L, etc.
      - Residual P&L identification (unexplained by risk factors)
      - Historical P&L tracking with drill-down capability
      - Regulatory report data extracts: FRTB risk metrics, Basel capital ratios
      - Data quality checks before report generation
      - Automated report scheduling and distribution
      - Report archive with version history
    pitfalls:
      - P&L attribution residual should be small; large residual indicates model issue
      - Intraday P&L is harder to attribute due to trade timing
      - Regulatory report formats are complex and change frequently
      - Data quality issues propagate to reports; validate before submission
      - Different accounting treatments affect P&L (trading vs banking book)
    concepts:
      - P&L decomposition methodology
      - Risk factor attribution
      - Regulatory reporting requirements
      - Data quality assurance
    skills:
      - P&L attribution implementation
      - Regulatory data extraction
      - Report automation
      - Data validation
    deliverables:
      - P&L attribution engine
      - Greeks-based decomposition
      - Historical P&L tracker
      - Regulatory report extracts
      - Automated report scheduler
      - Data quality validator
    estimated_hours: "12-14"
