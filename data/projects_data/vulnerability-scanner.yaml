id: vulnerability-scanner
name: Network Vulnerability Scanner
description: >-
  Network vulnerability scanner with host discovery, port scanning, service
  fingerprinting, CVE correlation, authenticated checks, and structured
  reporting.
difficulty: advanced
estimated_hours: "45-65"
essence: >-
  Raw packet construction and TCP/IP stack manipulation for host enumeration
  and port probing, protocol-specific banner analysis and service
  fingerprinting, CVE database correlation with CPE matching for
  version-based vulnerability identification, authenticated configuration
  assessment, and structured report generation with severity scoring.
why_important: >-
  Building this teaches you network protocol internals, security assessment
  methodology, and how to interact with real-world vulnerability databasesâ€”
  skills that directly translate to security engineering, penetration testing,
  and defensive security operations roles.
learning_outcomes:
  - Implement ICMP, ARP, and TCP-based host discovery with configurable rate limiting
  - Design multi-threaded TCP port scanners with connect and SYN scanning methods
  - Build service fingerprinting through banner grabbing and protocol-specific probing
  - Construct CPE strings from detected services and query NVD API for CVE correlation
  - Understand and document the false-positive problem with version-based vulnerability detection
  - Implement authenticated scanning via SSH to assess internal configuration
  - Handle asynchronous network I/O with configurable timeouts and rate limiting
  - Design structured vulnerability findings with CVSS scoring and remediation guidance
skills:
  - Raw Socket Programming
  - TCP/UDP Port Scanning
  - Service Fingerprinting
  - CVE/NVD Database Integration
  - CPE String Construction
  - Authenticated Scanning
  - Rate Limiting
  - Network Protocol Analysis
  - Multi-threading/Async I/O
  - Security Assessment Methodology
tags:
  - advanced
  - cve
  - detection
  - go
  - networking
  - python
  - reporting
  - security
  - scanning
architecture_doc: architecture-docs/vulnerability-scanner/index.md
languages:
  recommended:
    - Python
    - Go
  also_possible:
    - Rust
    - C
resources:
  - name: Nmap Network Scanning
    url: https://nmap.org/book/toc.html
    type: book
  - name: NIST NVD API
    url: https://nvd.nist.gov/developers/vulnerabilities
    type: documentation
  - name: CPE Specification
    url: https://nvd.nist.gov/products/cpe
    type: documentation
prerequisites:
  - type: skill
    name: TCP/IP networking fundamentals
  - type: skill
    name: Socket programming (TCP and raw sockets)
  - type: skill
    name: Multi-threading or async I/O
  - type: skill
    name: Basic security concepts (CVE, CVSS)
milestones:
  - id: vulnerability-scanner-m1
    name: Scan Configuration & Host Discovery
    description: >-
      Implement scan scope configuration with target specification, rate
      limiting, and multiple host discovery techniques.
    acceptance_criteria:
      - "Accept target specification as CIDR range (e.g., 192.168.1.0/24), IP range (192.168.1.1-254), or single IP"
      - "Support excluded hosts list to prevent scanning sensitive systems"
      - "Implement configurable rate limiting (max packets/second) enforced across all discovery probes"
      - "ICMP echo ping scan detects responsive hosts in target range (requires raw sockets / root)"
      - "TCP SYN probe to common ports (80, 443, 22) detects hosts that block ICMP"
      - "ARP scan discovers hosts on the local network segment by MAC address (Layer 2 only)"
      - "Gracefully handle permission errors when raw sockets unavailable (fall back to TCP connect probes)"
      - "Report discovered hosts with IP address, response method (ICMP/TCP/ARP), and response time in milliseconds"
      - "Store discovered hosts in an in-memory database for subsequent scanning phases"
      - "Support concurrent host probing with configurable parallelism (default: 50 concurrent probes)"
    pitfalls:
      - "Raw sockets require root/CAP_NET_RAW; provide clear error message and fallback when unavailable"
      - "ICMP is often blocked by firewalls; always combine with TCP probes for reliability"
      - "Rate limiting is essential: unthrottled scanning can DoS targets and trigger IDS alerts"
      - "ARP scanning only works on local network segment (same broadcast domain)"
      - "Large CIDR ranges (e.g., /16 = 65536 hosts) need efficient parallelism and progress reporting"
      - "Some hosts respond to ARP but not ICMP or TCP (network equipment, printers)"
    concepts:
      - ICMP echo request/reply protocol
      - TCP SYN probing without full handshake
      - ARP request/reply on local segments
      - Rate limiting with token bucket or leaky bucket
    skills:
      - Raw socket programming for ICMP and ARP
      - CIDR notation parsing and IP range expansion
      - Concurrent network probing with rate limiting
      - Privilege handling and graceful degradation
    deliverables:
      - Target specification parser (CIDR, range, single IP, exclusion list)
      - Rate limiter enforcing configurable packets/second across all probes
      - ICMP ping sweep with raw socket implementation
      - TCP SYN/connect probe for host discovery on common ports
      - ARP scanner for local network segment discovery
      - Host database storing discovered hosts with metadata
    estimated_hours: "7-10"

  - id: vulnerability-scanner-m2
    name: Port Scanning & Service Detection
    description: >-
      Implement TCP port scanning with connect and optional SYN methods,
      basic UDP probing, and banner-based service version detection.
    acceptance_criteria:
      - "TCP connect scan establishes full TCP connection to detect open, closed, and filtered ports"
      - "Classify port states: open (connection accepted), closed (RST received), filtered (no response within timeout)"
      - "Support configurable port list: default top-1000 ports (nmap-style), all ports (1-65535), or custom list"
      - "Scan 1000 ports on a single host in under 30 seconds with default concurrency settings"
      - "Banner grabbing: after TCP connect, read initial bytes sent by service (with 3-second read timeout)"
      - "Service version detection: parse banners to extract software name and version (e.g., 'OpenSSH 8.9p1', 'Apache/2.4.52')"
      - "Protocol-specific probes for services that don't send banners automatically (HTTP GET / probe, etc.)"
      - "UDP scanning for top-20 UDP services with protocol-specific payloads (DNS query, SNMP get, NTP version)"
      - "Clearly document that UDP scan results are unreliable: 'open|filtered' is the common state (no ICMP unreachable received)"
      - "Store results per host: list of (port, protocol, state, service_name, service_version, banner)"
    pitfalls:
      - "TCP connect scan is detectable (full handshake logged by target); SYN scan is stealthier but needs raw sockets"
      - "Too many concurrent connections to one host can trigger IDS/IPS or exhaust target's connection table"
      - "UDP scanning is fundamentally unreliable: ICMP Port Unreachable is rate-limited (often 1/sec) and often firewalled"
      - "Banner data may be binary; handle non-printable characters safely (don't crash on binary data)"
      - "Some services (HTTPS, SMTP with STARTTLS) require protocol initiation before revealing version info"
      - "Timeout tuning: too short = missed open ports (filtered), too long = slow scan"
    concepts:
      - TCP three-way handshake and port states
      - Banner grabbing and service fingerprinting
      - UDP scanning limitations and 'open|filtered' state
      - Concurrent connection management
    skills:
      - TCP and UDP socket programming
      - Concurrent scanning with connection pooling
      - Banner parsing with regex and protocol knowledge
      - Timeout management for unreliable networks
    deliverables:
      - TCP connect scanner with concurrent port probing and state classification
      - Banner grabber reading initial service data from open ports
      - Service version detector parsing banners for software name and version
      - Protocol-specific probes (HTTP, SSH, SMTP) for services without auto-banners
      - UDP scanner with protocol-specific payloads for top UDP services
      - Per-host results database storing port, state, service, version, and raw banner
    estimated_hours: "8-12"

  - id: vulnerability-scanner-m3
    name: Vulnerability Correlation & Authenticated Checks
    description: >-
      Correlate detected service versions with CVE databases, implement
      authenticated scanning via SSH, and check for common misconfigurations.
    acceptance_criteria:
      - "Construct CPE (Common Platform Enumeration) strings from detected service name and version"
      - "Query NIST NVD REST API using CPE strings to retrieve associated CVEs with CVSS scores"
      - "Handle NVD API rate limits (default: 5 requests/30 seconds without API key, 50/30 seconds with key)"
      - "Cache NVD responses locally to enable offline scanning and reduce API calls"
      - "Flag all version-based CVE matches with confidence level: 'unverified' (banner match only, may be false positive due to backported patches)"
      - "Check for common misconfigurations without authentication: open directories (HTTP 200 on /), default pages, exposed admin panels"
      - "Test for default credentials on detected services (SSH, databases, web admin panels) using configurable credential list"
      - "Authenticated SSH scanning: connect with provided credentials and run commands to check actual installed package versions"
      - "Authenticated checks compare actual package versions against CVE data for high-confidence vulnerability detection"
      - "Generate finding records with: host, port, service, vulnerability description, CVE ID, CVSS score, confidence level, evidence"
    pitfalls:
      - "Version-based CVE matching produces HIGH false-positive rates because Linux distros backport security patches (e.g., Apache 2.4.6-97.el7 is patched)"
      - "CPE string construction from banners is error-prone; version formats vary wildly across software"
      - "NVD API rate limits will throttle large scans; implement exponential backoff and caching"
      - "Default credential testing MUST be opt-in (not default) to avoid unintended authentication attempts"
      - "Authenticated scanning requires explicit user consent and credentials; store credentials securely in memory only"
      - "CVSS scores from NVD may not reflect actual exploitability in the target's context"
    concepts:
      - CPE (Common Platform Enumeration) naming convention
      - CVSS (Common Vulnerability Scoring System) severity levels
      - NVD REST API usage and rate limiting
      - Authenticated vs unauthenticated vulnerability assessment
      - False positive problem with version-based detection
    skills:
      - CPE string construction from service banners
      - REST API integration with rate limiting and caching
      - SSH client programming for authenticated checks
      - Vulnerability finding data modeling
    deliverables:
      - CPE string builder constructing platform identifiers from detected services
      - NVD API client with rate limiting, caching, and CVE retrieval by CPE
      - Misconfiguration checker testing for open directories, default pages, and exposed admin panels
      - Default credential tester (opt-in) for common services
      - Authenticated SSH scanner running commands to check actual package versions
      - Finding data model: host, port, service, CVE, CVSS, confidence, evidence, remediation
    estimated_hours: "10-15"

  - id: vulnerability-scanner-m4
    name: Report Generation
    description: >-
      Generate structured scan reports in multiple formats with severity
      prioritization, false-positive flagging, and remediation guidance.
    acceptance_criteria:
      - "JSON export produces machine-readable output with full finding details for pipeline automation"
      - "HTML report includes summary dashboard: total hosts, open ports, findings by severity (critical/high/medium/low/info)"
      - "Findings grouped by host, then by severity (critical first) within each host section"
      - "Each finding includes: description, CVE ID(s), CVSS score, confidence level (verified/unverified), evidence (banner/version), and remediation steps"
      - "Clearly distinguish between verified findings (authenticated check confirmed) and unverified findings (banner-based, possible false positive)"
      - "Executive summary section provides non-technical overview: risk level, top findings, recommended actions"
      - "Include scan metadata: scan date, target range, scan duration, scanner version, techniques used"
      - "Remediation suggestions are specific: 'upgrade Apache to 2.4.58+' not 'update your software'"
      - "Report generation completes within 10 seconds for scans with up to 1000 findings"
    pitfalls:
      - "Large reports (thousands of findings) need pagination or lazy rendering to avoid memory issues"
      - "Missing context makes findings unactionable; always include evidence (banner text, exact version detected)"
      - "Executive summaries should NOT include technical jargon; they're for management decision-making"
      - "Unverified findings should be clearly marked to prevent unnecessary remediation effort"
      - "CVSS scores without context can mislead; a critical CVE on an internal-only service may be lower priority"
      - "Report should include limitations section acknowledging what was NOT tested"
    concepts:
      - CVSS severity classification
      - Finding confidence levels
      - Executive vs technical reporting audiences
      - Machine-readable vs human-readable output formats
    skills:
      - Multi-format report generation (JSON, HTML)
      - Data aggregation and severity prioritization
      - Remediation guidance writing
      - Template-based document generation
    deliverables:
      - JSON export with complete finding data for automation integration
      - HTML report with summary dashboard and severity-grouped findings
      - Executive summary section for non-technical stakeholders
      - Per-finding detail including CVE, CVSS, confidence, evidence, and remediation
      - Scan metadata section documenting scope, duration, and techniques
      - Limitations section acknowledging scanner coverage gaps
    estimated_hours: "6-10"