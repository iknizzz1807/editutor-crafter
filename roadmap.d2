# ============================================================
# 40 PROJECTS ROADMAP - v4 (Revised)
# Render: d2 roadmap.d2 roadmap.svg --theme 200 --layout elk
# ============================================================

direction: right

# ============================================================
# PHASE 1 — Nền Tảng (4)
# ============================================================
ph1: "Phase 1 — Nền Tảng\n4 projects · ~3 tuần" {
  style: {
    fill: "#1a1a2e"
    stroke: "#4fc3f7"
    font-color: "#4fc3f7"
    border-radius: 12
    font-size: 16
    bold: true
  }

  p01: "#1 Tokenizer\nLexer/Scanner\n8-15h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p02: "#2 Hash Impl\nSHA-256\n10-15h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p03: "#3 HTTP Server\nTCP/Sockets\n15-24h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p04: "#4 Event Loop\nepoll/Async\n22-35h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }

  p01 -> p03
  p02 -> p03
  p03 -> p04
}

# ============================================================
# PHASE 2 — OS & Systems (6)
# ============================================================
ph2: "Phase 2 — OS & Systems\n6 projects · ~8 tuần" {
  style: {
    fill: "#1a1a2e"
    stroke: "#66bb6a"
    font-color: "#66bb6a"
    border-radius: 12
    font-size: 16
    bold: true
  }

  p05: "#5 strace\nSyscall Tracing\n22-35h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p06: "#6 Kernel Module\nKernel Space\n22-32h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p07: "#7 Container\nNamespaces/Cgroups\n25-40h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p08: "#8 Filesystem\nVFS/Inodes\n65-85h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p09: "#9 Virtual Memory\nPage Tables\n25-40h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p10: "#10 Shell\nJob Control\n40-60h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }

  p05 -> p06
  p05 -> p07
  p06 -> p08
  p07 -> p10
  p09 -> p10
}

# ============================================================
# PHASE 3 — Networking & Backend (4)
# ============================================================
ph3: "Phase 3 — Networking\n4 projects · ~4 tuần" {
  style: {
    fill: "#1a1a2e"
    stroke: "#ffa726"
    font-color: "#ffa726"
    border-radius: 12
    font-size: 16
    bold: true
  }

  p11: "#11 Message Queue\nPub/Sub\n30-40h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p12: "#12 Packet Sniffer\nRaw Packets\n20-30h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p13: "★ #13 TCP Stack\nFrom Scratch\n80-120h" {
    style: { fill: "#0a1628"; font-color: "#ffa726"; border-radius: 8; font-size: 12; stroke: "#ffa726" }
  }
  p14: "#14 Profiler\nCPU/Flame Graph\n25-40h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }

  p12 -> p13
}

# ============================================================
# PHASE 4 — Language & Data (5)
# ============================================================
ph4: "Phase 4 — Language & Data\n5 projects · ~6 tuần" {
  style: {
    fill: "#1a1a2e"
    stroke: "#ab47bc"
    font-color: "#ab47bc"
    border-radius: 12
    font-size: 16
    bold: true
  }

  p15: "#15 Bytecode VM\nOpcode/Stack\n30-45h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p16: "#16 Linker\nELF/Symbols\n35-50h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p17: "#17 WAL\nCrash Recovery\n20-30h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p18: "#18 Vector DB\nANN Search\n~96h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p19: "#19 Query Optimizer\nCost-Based\n25-40h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }

  p15 -> p16
  p17 -> p19
}

# ============================================================
# MILESTONE 1
# ============================================================
m1: "MILESTONE 1\n~Tháng 5\nMid-level\nBackend @ startup" {
  style: {
    fill: "#2d6a4f"
    font-color: "#fff"
    border-radius: 20
    font-size: 14
    bold: true
  }
}

# ============================================================
# PHASE 5 — Distributed (3)
# ============================================================
ph5: "Phase 5 — Distributed\n3 projects · ~5 tuần" {
  style: {
    fill: "#1a1a2e"
    stroke: "#ef5350"
    font-color: "#ef5350"
    border-radius: 12
    font-size: 16
    bold: true
  }

  p20: "#20 Gossip\nEpidemic\n20-30h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p21: "#21 Dist Cache\nHash Ring\n35-50h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p22: "★ #22 Raft\nConsensus\n80-120h" {
    style: { fill: "#0a1628"; font-color: "#ef5350"; border-radius: 8; font-size: 12; stroke: "#ef5350" }
  }

  p20 -> p21
  p21 -> p22
}

# ============================================================
# PHASE 6 — Performance & Nanosecond (8)
# ============================================================
ph6: "Phase 6 — Performance & ns\n8 projects · ~12 tuần" {
  style: {
    fill: "#1a1a2e"
    stroke: "#26c6da"
    font-color: "#26c6da"
    border-radius: 12
    font-size: 16
    bold: true
  }

  p23: "#23 Memory Pool\nAllocator\n12-18h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p24: "#24 SIMD\nVectorization\n20-30h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p25: "#25 Cache-Opt\nCache Lines\n~45h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p26: "#26 Lock-free\nAtomics\n~55h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p27: "#27 ECS\nData-Oriented\n25-40h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p28: "#28 io_uring\nZero-syscall\n40-55h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p29: "★ #29 Kernel Bypass\nDPDK\n100-140h" {
    style: { fill: "#0a1628"; font-color: "#26c6da"; border-radius: 8; font-size: 12; stroke: "#26c6da" }
  }
  p30: "#30 Zero-Copy IPC\nShared Mem\n50-70h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }

  p23 -> p24
  p24 -> p25
  p25 -> p27
  p26 -> p30
  p28 -> p29
}

# ============================================================
# MILESTONE 2
# ============================================================
m2: "MILESTONE 2\n~Tháng 10\nSenior\nBig Tech ready" {
  style: {
    fill: "#1b4332"
    font-color: "#fff"
    border-radius: 20
    font-size: 14
    bold: true
  }
}

# ============================================================
# PHASE 7 — AI/ML Infrastructure (6)
# ============================================================
ph7: "Phase 7 — AI/ML Infrastructure\n6 projects · ~10 tuần" {
  style: {
    fill: "#1a1a2e"
    stroke: "#76b900"
    font-color: "#76b900"
    border-radius: 12
    font-size: 16
    bold: true
  }

  p31: "#31 Neural Net\nBackprop\n18-28h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p32: "#32 Transformer\nAttention\n35-55h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p33: "★ #33 GPU Compute\nCUDA\n50-70h" {
    style: { fill: "#0a1628"; font-color: "#76b900"; border-radius: 8; font-size: 12; stroke: "#76b900" }
  }
  p34: "#34 Quantization\nINT8/FP16\n50-70h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p35: "#35 Inference Engine\nServing/Batching\n40-60h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }
  p36: "#36 Dist Training\nMulti-GPU\n80-110h" {
    style: { fill: "#16213e"; font-color: "#eee"; border-radius: 8; font-size: 12 }
  }

  p31 -> p32
  p32 -> p33
  p33 -> p34
  p34 -> p35
  p33 -> p36
}

# ============================================================
# MILESTONE 3
# ============================================================
m3: "MILESTONE 3\n~Tháng 14\nSenior + ML Infra\nNVIDIA ready" {
  style: {
    fill: "#081c15"
    font-color: "#52b788"
    border-radius: 20
    font-size: 14
    bold: true
    stroke: "#52b788"
  }
}

# ============================================================
# PHASE 8 — Capstone (4)
# ============================================================
ph8: "Phase 8 — Capstone\n4 projects · ~10 tuần" {
  style: {
    fill: "#1a1a2e"
    stroke: "#e94560"
    font-color: "#e94560"
    border-radius: 12
    font-size: 16
    bold: true
  }

  p37: "★ #37 Redis\nKV Store\n~65h" {
    style: { fill: "#0a1628"; font-color: "#e94560"; border-radius: 8; font-size: 12; stroke: "#e94560" }
  }
  p38: "★ #38 Docker\nContainer Runtime\n45-70h" {
    style: { fill: "#0a1628"; font-color: "#e94560"; border-radius: 8; font-size: 12; stroke: "#e94560" }
  }
  p39: "★ #39 Allocator\nmalloc/free\n40-60h" {
    style: { fill: "#0a1628"; font-color: "#e94560"; border-radius: 8; font-size: 12; stroke: "#e94560" }
  }
  p40: "★ #40 JIT Compiler\nCodegen\n60-90h" {
    style: { fill: "#0a1628"; font-color: "#e94560"; border-radius: 8; font-size: 12; stroke: "#e94560" }
  }
}

# ============================================================
# MILESTONE 4
# ============================================================
m4: "MILESTONE 4\n~Tháng 16\nStaff-level\nHFT/Principal" {
  style: {
    fill: "#0a0a0a"
    font-color: "#e94560"
    border-radius: 20
    font-size: 14
    bold: true
    stroke: "#e94560"
  }
}

# ============================================================
# PHASE FLOW (Horizontal)
# ============================================================
ph1 -> ph2 -> ph3 -> ph4 -> m1 -> ph5 -> ph6 -> m2 -> ph7 -> m3 -> ph8 -> m4: {
  style.stroke: "#444"
  style.stroke-width: 2
}

# ============================================================
# DEPENDENCY TRACKS (colored lines)
# ============================================================

# Parsing Track (blue)
ph1.p01 -> ph4.p15: { style.stroke: "#4fc3f7"; style.stroke-dash: 4 }
ph4.p15 -> ph4.p16: { style.stroke: "#4fc3f7"; style.stroke-dash: 4 }
ph4.p16 -> ph8.p40: { style.stroke: "#4fc3f7"; style.stroke-dash: 4 }

# Networking Track (orange)  
ph1.p03 -> ph3.p12: { style.stroke: "#ffa726"; style.stroke-dash: 4 }
ph3.p12 -> ph3.p13: { style.stroke: "#ffa726"; style.stroke-dash: 4 }
ph3.p13 -> ph6.p29: { style.stroke: "#ffa726"; style.stroke-dash: 4 }

# Memory Track (purple)
ph2.p09 -> ph6.p23: { style.stroke: "#ab47bc"; style.stroke-dash: 4 }
ph6.p23 -> ph8.p39: { style.stroke: "#ab47bc"; style.stroke-dash: 4 }

# Container Track (green)
ph2.p07 -> ph8.p38: { style.stroke: "#66bb6a"; style.stroke-dash: 4 }

# ML Track (NVIDIA green)
ph7.p31 -> ph7.p32: { style.stroke: "#76b900"; style.stroke-dash: 4 }
ph7.p32 -> ph7.p33: { style.stroke: "#76b900"; style.stroke-dash: 4 }
ph7.p33 -> ph7.p35: { style.stroke: "#76b900"; style.stroke-dash: 4 }
ph7.p35 -> ph7.p36: { style.stroke: "#76b900"; style.stroke-dash: 4 }

# ============================================================
# LEGEND
# ============================================================
legend: "Legend\n── Phase Flow\n- - - - Dependency Track\n★ = Capstone Project" {
  style: {
    fill: "#1a1a2e"
    font-color: "#888"
    border-radius: 8
    font-size: 12
  }
}

legend.near: bottom-center
